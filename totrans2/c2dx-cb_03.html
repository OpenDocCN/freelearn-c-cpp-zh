<html><head></head><body><div class="chapter" title="Chapter&#xA0;3.&#xA0;Working with Labels"><div class="titlepage"><div><div><h1 class="title"><a id="ch03"/>Chapter 3. Working with Labels</h1></div></div></div><p>In this chapter, we're going to create labels. To display labels on the screen, you can use the <code class="literal">Label</code> class with system fonts, true type fonts, and bitmap fonts. The following topics will be covered in this chapter:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Creating system font labels</li><li class="listitem" style="list-style-type: disc">Creating true type font labels</li><li class="listitem" style="list-style-type: disc">Creating bitmap font labels</li><li class="listitem" style="list-style-type: disc">Creating rich text</li></ul></div><div class="section" title="Creating system font labels"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec31"/>Creating system font labels</h1></div></div></div><p>Firstly, we will explain<a id="id145" class="indexterm"/> how to create a label with system fonts. System fonts are<a id="id146" class="indexterm"/> the fonts already installed on your devices. Since they are already installed, there is no need to go through the installation process. Therefore we will skip the installation instructions for system fonts in this recipe, and dive directly into creating labels.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec80"/>How to do it...</h2></div></div></div><p>Here's how to create a label by specifying a system font. You can create a single-line label by using the following code:</p><div class="informalexample"><pre class="programlisting">auto label = Label::createWithSystemFont("Cocos2d-x", "Arial", 40);
label-&gt;setPosition(size/2);
this-&gt;addChild(label);</pre></div><div class="mediaobject"><img src="graphics/B00561_03_01.jpg" alt="How to do it..."/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec81"/>How it works...</h2></div></div></div><p>You should use <a id="id147" class="indexterm"/>the <code class="literal">Label</code> class to display strings by specifying a string, a <a id="id148" class="indexterm"/>system font, and the font size. The <code class="literal">Label</code> class will display a string that is converted into an image. After creating a <code class="literal">Label</code> instance, you can use it in the same way as you use <code class="literal">Sprite</code>. Because <code class="literal">Label</code> is also a Node, we can use properties such as actions, scaling, and opacity functions to manipulate the labels.</p><div class="section" title="Line break"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec29"/>Line break</h3></div></div></div><p>You can also add a new line <a id="id149" class="indexterm"/>at any position by putting a line feed code into a string:</p><div class="informalexample"><pre class="programlisting">auto label = Label::createWithSystemFont("Hello\nCocos2d-x", "Arial", 40);
label-&gt;setPosition(size/2);
this-&gt;addChild(label);</pre></div><div class="mediaobject"><img src="graphics/B00561_03_02.jpg" alt="Line break"/></div></div><div class="section" title="Text align"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec30"/>Text align</h3></div></div></div><p>You can also specify the text alignment<a id="id150" class="indexterm"/> in both the horizontal and the vertical directions.</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Text alignment type</p>
</th><th style="text-align: left" valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">TextHAlignment::LEFT</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Aligns text horizontally to the left. This is the default value for horizontal alignment.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">TextHAlignment::CENTER</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Aligns text horizontally to the center.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">TextHAlignment::RIGHT</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Aligns text horizontally to the right.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">TextVAlignment::TOP</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Aligns text vertically to the top. This is the default value for vertical alignment.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">TextVAlignment::CENTER</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Aligns text vertically to the center.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">TextVAlignment::BOTTOM</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Aligns text vertically to the bottom.</p>
</td></tr></tbody></table></div><p>The following code is used for aligning text horizontally to the center:</p><div class="informalexample"><pre class="programlisting">label-&gt; setHorizontalAlignment(TextHAlignment::CENTER);</pre></div><div class="mediaobject"><img src="graphics/B00561_03_03.jpg" alt="Text align"/></div></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec82"/>There's more...</h2></div></div></div><p>You can also update the string<a id="id151" class="indexterm"/> after creating the label. If you want to update the string once every second, you can do so by setting the timer as follows:</p><p>First, edit <code class="literal">HelloWorld.h</code> as follows:</p><div class="informalexample"><pre class="programlisting">class HelloWorld : public cocos2d::Layer
{
private:
    int sec;
public:
    …
;</pre></div><p>Next, edit <code class="literal">HelloWorld.cpp</code> as follows:</p><div class="informalexample"><pre class="programlisting">sec = 0;
std::string secString = StringUtils::toString(sec);
auto label = Label::createWithSystemFont(secString, "Arial", 40);
label-&gt;setPosition(size/2);
this-&gt;addChild(label);

this-&gt;schedule([=](float dt) {
	sec++;
	std::string secString = StringUtils::toString(sec);
	label-&gt;setString(secString);
}, 1.0f, "myCallbackKey");</pre></div><p>First, you have to<a id="id152" class="indexterm"/> define an integer variable in the header file. Second, you need to create a label and add it on the layer. Next, you need to set the scheduler to execute the function every second. Then you can update the string by using the <code class="literal">setString</code> method.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip10"/>Tip</h3><p>You can convert an int or float value to a string value by using the <code class="literal">StringUtils::toString</code> method.</p><p>A scheduler can execute the method at a specified interval. We will explain how the scheduler works in <a class="link" href="ch04.html" title="Chapter 4. Building Scenes and Layers">Chapter 4</a>, <span class="emphasis"><em>Building Scenes and Layers</em></span>. Refer to it for more details on the scheduler.</p></div></div></div></div></div>
<div class="section" title="Creating true type font labels"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec32"/>Creating true type font labels</h1></div></div></div><p>In this recipe, we will <a id="id153" class="indexterm"/>explain how to create a label with true type fonts. True type<a id="id154" class="indexterm"/> fonts are fonts that you can install into your project. Cocos2d-x's project already has two true type fonts, namely <code class="literal">arial.ttf</code> and <code class="literal">Maker Felt.ttf</code>, which are present in the <code class="literal">Resources/fonts</code> folder.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec83"/>How to do it...</h2></div></div></div><p>Here's how to create a label by specifying a true type font. The following code can be used for creating a single-line label by using a true type font:</p><div class="informalexample"><pre class="programlisting">auto label = Label:: createWithTTF("True Type Font", "fonts/Marker
Felt.ttf", 40.0f);
label-&gt;setPosition(size/2);
this-&gt;addChild(label);</pre></div><div class="mediaobject"><img src="graphics/B00561_03_04.jpg" alt="How to do it..."/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec84"/>How it works...</h2></div></div></div><p>You can create a <code class="literal">Label</code> with <a id="id155" class="indexterm"/>a true type font by specifying a label string, the<a id="id156" class="indexterm"/> path to the true type font, and the font size. The true type fonts are located in the <code class="literal">font</code> folder of <code class="literal">Resources</code>. Cocos2d-x has two true type fonts, namely <code class="literal">arial.ttf</code> and <code class="literal">Marker Felt.ttf</code>. You can generate <code class="literal">Label</code> objects of different font sizes from one true type font file. If you want to add a true type font, you can use a original true type font if you added it into the <code class="literal">font</code> folder. However, a true type font is slower than a bitmap font with respect to rendering, and changing properties such as the font face and size is an expensive operation. You have to be careful to not update it frequently.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec85"/>There's more...</h2></div></div></div><p>If you want to create a <a id="id157" class="indexterm"/>lot of <code class="literal">Label</code> objects that have the same properties<a id="id158" class="indexterm"/> from a true type font, you can create them by specifying <code class="literal">TTFConfig</code>. <code class="literal">TTFConfig</code> has properties that are required by a true type font. You can create a label by using <code class="literal">TTFConfig</code> as follows:</p><div class="informalexample"><pre class="programlisting">TTFConfig config;
config.fontFilePath = "fonts/Marker Felt.ttf";
config.fontSize = 40.0f;
config.glyphs = GlyphCollection::DYNAMIC;
config.outlineSize = 0;
config.customGlyphs = nullptr;
config.distanceFieldEnabled = false;

auto label = Label::createWithTTF(config, "True Type Font");
label-&gt;setPosition(size/2);
this-&gt;addChild(label);</pre></div><p>A <code class="literal">TTFConfig</code> object<a id="id159" class="indexterm"/> allows you to set some labels that have the same properties.</p><p>If you want to change <a id="id160" class="indexterm"/>the color of <code class="literal">Label</code>, you can change its color property. For instance, by using the following code, you can change the color to <code class="literal">RED</code>:</p><div class="informalexample"><pre class="programlisting">label-&gt;setColor(Color3B::RED);</pre></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec86"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">You can set effects to labels. Please check the last recipe in this chapter.</li></ul></div></div></div>
<div class="section" title="Creating bitmap font labels"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec33"/>Creating bitmap font labels</h1></div></div></div><p>Lastly, we will explain <a id="id161" class="indexterm"/>how to create a label with bitmap type fonts. Bitmap fonts are also<a id="id162" class="indexterm"/> fonts that you can install into your project. A bitmap font is essentially an image file that contains a bunch of characters and a control file that details the size and location of each character within the image. If you use bitmap fonts in your game, you can see that the bitmap fonts will be the same size on all devices.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec87"/>Getting ready</h2></div></div></div><p>You have to prepare a bitmap font. You can create it by using a tool such as <code class="literal">GlyphDesigner</code>. We will explain this tool after <a class="link" href="ch10.html" title="Chapter 10. Improving Games with Extra Features">Chapter 10</a>, <span class="emphasis"><em>Improving Games with Extra Features</em></span>. Now, we will use a bitmap font in Cocos2d-x. It is located in the <code class="literal">COCOS_ROOT/tests/cpp-tests/Resources/fonts</code> folder. To begin with, you will have to add the files mentioned below to your <code class="literal">Resources/fonts</code> folder in your project.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">future-48.fnt</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">future-48.png</code></li></ul></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec88"/>How to do it...</h2></div></div></div><p>Here's how to create a label by specifying a bitmap font. The following code can be used for creating a single-line label using a bitmap font:</p><div class="informalexample"><pre class="programlisting">auto label = Label:: createWithBMFont("fonts/futura-48.fnt",
"Bitmap Font");
label-&gt;setPosition(size/2);
this-&gt;addChild(label);</pre></div><div class="mediaobject"><img src="graphics/B00561_03_05.jpg" alt="How to do it..."/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec89"/>How it works...</h2></div></div></div><p>You can <a id="id163" class="indexterm"/>create <code class="literal">Label</code> with a bitmap font by specifying a <code class="literal">label</code> string, the <a id="id164" class="indexterm"/>path to the true type font, and the font size. The characters in a bitmap font are made up of a matrix of dots. This font renders very fast but is not scalable. That's why it has a fixed font size when generated. A bitmap font requires the following two files: an .fnt file and a <code class="literal">.png</code> file.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec90"/>There's more...</h2></div></div></div><p>Each<a id="id165" class="indexterm"/> character in <code class="literal">Label</code> is a <code class="literal">Sprite</code>. This means that each character<a id="id166" class="indexterm"/> can be rotated or scaled and has other changeable properties:</p><div class="informalexample"><pre class="programlisting">auto sprite1 = label-&gt;getLetter(0);
sprite1-&gt;setRotation(30.0f);

auto sprite2 = label-&gt;getLetter(1);
sprite2-&gt;setScale(0.5f);</pre></div><div class="mediaobject"><img src="graphics/B00561_03_06.jpg" alt="There's more..."/></div></div></div>
<div class="section" title="Creating rich text"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec34"/>Creating rich text</h1></div></div></div><p>After creating <code class="literal">Label</code> objects on <a id="id167" class="indexterm"/>screen, you can create some effects such as a drop shadow and an outline on them easily without having your own custom class. The <code class="literal">Label</code> class can be used for applying the effects to these objects. However, note that not all label types support all effects.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec91"/>How to do it...</h2></div></div></div><div class="section" title="Drop shadow"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec31"/>Drop shadow</h3></div></div></div><p>Here's<a id="id168" class="indexterm"/> how to create <code class="literal">Label</code> with a <a id="id169" class="indexterm"/>drop<a id="id170" class="indexterm"/> shadow effect:</p><div class="informalexample"><pre class="programlisting">auto layer = LayerColor::create(Color4B::GRAY);
this-&gt;addChild(layer);
auto label = Label::createWithTTF("Drop Shadow", "fonts/Marker
Felt.ttf", 40);
label-&gt;setPosition(size/2);
this-&gt;addChild(label);
// shadow effect
label-&gt;enableShadow();</pre></div><div class="mediaobject"><img src="graphics/B00561_03_07.jpg" alt="Drop shadow"/></div></div><div class="section" title="Outline"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec32"/>Outline</h3></div></div></div><p>Here's how to<a id="id171" class="indexterm"/> create <code class="literal">Label</code> with<a id="id172" class="indexterm"/> an outline effect:</p><div class="informalexample"><pre class="programlisting">auto label = Label::createWithTTF("Outline", "fonts/Marker
Felt.ttf", 40);
label-&gt;setPosition(size/2);
this-&gt;addChild(label);
// outline effect
label-&gt;enableOutline(Color4B::RED, 5);</pre></div><div class="mediaobject"><img src="graphics/B00561_03_08.jpg" alt="Outline"/></div></div><div class="section" title="Glow"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec33"/>Glow</h3></div></div></div><p>Here's how to create <code class="literal">Label</code> <a id="id173" class="indexterm"/>with a <a id="id174" class="indexterm"/>glow <a id="id175" class="indexterm"/>effect:</p><div class="informalexample"><pre class="programlisting">auto label = Label::createWithTTF("Glow", "fonts/Marker Felt.ttf", 40);
label-&gt;setPosition(size/2);
this-&gt;addChild(label);
// glow effect label-&gt;enableGlow(Color4B::RED);</pre></div><div class="mediaobject"><img src="graphics/B00561_03_09.jpg" alt="Glow"/></div></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec92"/>How it works...</h2></div></div></div><p>Firstly, we generate a<a id="id176" class="indexterm"/> gray layer and change the background color to gray because otherwise we will not be able to see the shadow effect. Adding the effect to the label is very easy. You need to generate a <code class="literal">Label</code> instance and execute an effect method such as <code class="literal">enableShadow()</code>. This can be executed without arguments. The <code class="literal">enableOutline()</code> has two arguments, namely the outline color and the outline size. The outline size has a default value of -1. If it has a negative value, the outline does not show. Next, you have to set the second argument. The <code class="literal">enableGlow</code> method has only one argument, namely glow color.</p><p>Not all label types support all effects, but all label types support the drop shadow effect. The <code class="literal">Outline</code> and <code class="literal">Glow</code> effects are true type font effects only. In previous versions, we had to create our own custom fonts class if we wanted to apply effects to labels. However, the current version of Cocos2d-x, version 3, supports label effects such as drop shadow, outline, and glow.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec93"/>There's more...</h2></div></div></div><p>You can also change the shadow color<a id="id177" class="indexterm"/> and the offset. The first argument is shadow color, the second argument is the offset, and third argument is the blur radius. However, unfortunately, changing the blur radius is not supported in Cocos2d-x version 3.4.</p><div class="informalexample"><pre class="programlisting">auto label = Label::createWithTTF("Shadow", "fonts/Marker
Felt.ttf", 40);
label-&gt;setPosition(Vec2(size.width/2, size.height/3*2));
this-&gt;addChild(label);
label-&gt;enableShadow(Color4B::RED, Size(5,5), 0);</pre></div><p>It is also possible to set two or more of these effects at the same time. The following code can be used for setting the shadow and outline effects for a label:</p><div class="informalexample"><pre class="programlisting">auto label2 = Label::createWithTTF("Shadow &amp; Outline", "fonts/Marker Felt.ttf", 40); label2-&gt;setPosition(Vec2(size.width/2, size.height/3)); this-&gt;addChild(label2); label2-&gt;enableShadow(Color4B::RED, Size(10,-10), 0);
label2-&gt;enableOutline(Color4B::BLACK, 5);</pre></div><div class="mediaobject"><img src="graphics/B00561_03_10.jpg" alt="There's more..."/></div></div></div></body></html>