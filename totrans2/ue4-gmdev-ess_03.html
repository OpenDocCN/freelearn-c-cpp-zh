<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch03"/>Chapter 3. Materials</h1></div></div></div><p>Material is an asset that defines the look of a mesh with various graph nodes that include images (textures) and math expressions. Since Unreal Engine 4 utilizes <strong>Physically Based Rendering</strong> (<strong>PBR</strong>), creating<a id="id92" class="indexterm"/> realistic materials such as metal, concrete, bricks, and so on, can be quite easy. Materials in Unreal Engine define everything about the surface of the mesh, such as its color, shininess, bumpiness, and tessellation, and can even animate objects by manipulating the vertices! At this point you might think <em>Ok, Materials are only used for meshes</em> but, no, they are not actually limited to meshes. You use Materials for decals, post process, and light functions too.</p><p>Creating a Material is a pretty straightforward process. All you have to do is right-click in <strong>Content Browser</strong>, select <strong>Material</strong>, and give it a name. Done!</p><div><img src="img/B03950_03_01.jpg" alt="Materials"/></div><div><div><div><div><h1 class="title"><a id="ch03lvl1sec21"/>Material user interface</h1></div></div></div><p>Now that <a id="id93" class="indexterm"/>we know what a Material is and what it does, let's take a look at the user interface of Material graph.</p><div><img src="img/B03950_03_02.jpg" alt="Material user interface"/></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec20"/>Toolbar</h2></div></div></div><p>The <a id="id94" class="indexterm"/>
<strong>Toolbar</strong> panel <a id="id95" class="indexterm"/>contains various buttons that help to preview graph nodes, remove isolated nodes, Material stats, and so on. Let's take a look at what these buttons do:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Save</strong>: Applies the changes you made to the Material and saves the asset<div><img src="img/B03950_03_03.jpg" alt="Toolbar"/></div></li><li class="listitem" style="list-style-type: disc"><strong>Find in CB</strong>: Navigates and selects this Material in <strong>Content Browser</strong><div><img src="img/B03950_03_04.jpg" alt="Toolbar"/></div></li><li class="listitem" style="list-style-type: disc"><strong>Apply</strong>: Applies <a id="id96" class="indexterm"/>the changes to the Material. Note that this will not save the Material<div><img src="img/B03950_03_05.jpg" alt="Toolbar"/></div></li><li class="listitem" style="list-style-type: disc"><strong>Search</strong>: Searches for Material expressions or comments<div><img src="img/B03950_03_06.jpg" alt="Toolbar"/></div></li><li class="listitem" style="list-style-type: disc"><strong>Home</strong>: Navigates to and selects the main canvas node<div><img src="img/B03950_03_07.jpg" alt="Toolbar"/></div></li><li class="listitem" style="list-style-type: disc"><strong>Clean Up</strong>: Removes unconnected nodes<div><img src="img/B03950_03_08.jpg" alt="Toolbar"/></div></li><li class="listitem" style="list-style-type: disc"><strong>Connectors</strong>: Shows or hides unconnected pins<div><img src="img/B03950_03_09.jpg" alt="Toolbar"/></div></li><li class="listitem" style="list-style-type: disc"><strong>Live Preview</strong>: Toggles<a id="id97" class="indexterm"/> a real-time update of preview material<div><img src="img/B03950_03_10.jpg" alt="Toolbar"/></div></li><li class="listitem" style="list-style-type: disc"><strong>Live Nodes</strong>: Toggles a real-time update of graph nodes<div><img src="img/B03950_03_11.jpg" alt="Toolbar"/></div></li><li class="listitem" style="list-style-type: disc"><strong>Live Update</strong>: Recompiles a shader for every node in the graph<div><img src="img/B03950_03_12.jpg" alt="Toolbar"/></div></li><li class="listitem" style="list-style-type: disc"><strong>Stats</strong>: Toggles Material stats and compilation errors</li><li class="listitem" style="list-style-type: disc"><strong>Mobile Stats</strong>: Same as stats but for mobile<div><img src="img/B03950_03_13.jpg" alt="Toolbar"/></div></li></ul></div><p>Live nodes might be <a id="id98" class="indexterm"/>confusing for new users so I'll explain about them further.</p><div><div><div><div><h3 class="title"><a id="ch03lvl3sec11"/>Live preview</h3></div></div></div><p>Sometimes <a id="id99" class="indexterm"/>we need to preview the result of a specific node before connecting it to the main node or for debugging purposes. </p><p>To preview a node you need to right-click on the node and select <strong>Start Previewing Node</strong>.</p><div><img src="img/B03950_03_14.jpg" alt="Live preview"/></div><p>Unless you <a id="id100" class="indexterm"/>enable <strong>Live Preview</strong>, you will not see any changes in the preview material.</p><div><div><h3 class="title"><a id="tip12"/>Tip</h3><p>You can press the spacebar to force a preview.</p></div></div></div><div><div><div><div><h3 class="title"><a id="ch03lvl3sec12"/>Live nodes</h3></div></div></div><p>This <a id="id101" class="indexterm"/>will show a real-time update of nodes due to changes made by expressions to that node. See the following example:</p><div><img src="img/B03950_03_15.jpg" alt="Live nodes"/></div><p>In the preceding screenshot, the <strong>Sine</strong> node is getting a constant update from <strong>Time</strong>, multiplied by one. If you enable <strong>Live Nodes</strong>, you will see the <strong>Sine</strong> node pulsing between black and white. If you change the <strong>Multiply</strong> value from <strong>1</strong> to anything else (for example, <strong>5</strong>) you will not see the changes unless you enable <strong>Live Update</strong> too.</p></div><div><div><div><div><h3 class="title"><a id="ch03lvl3sec13"/>Live update</h3></div></div></div><p>When <a id="id102" class="indexterm"/>enabled, all expressions are compiled whenever you make a change, such as adding a new node, deleting a node, changing a property, and so on. If you have a complex graph, it is recommended to disable this option as it has to compile all nodes every time you make a change.</p></div></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec21"/>Preview panel</h2></div></div></div><p>The<a id="id103" class="indexterm"/> <strong>Preview</strong> panel <a id="id104" class="indexterm"/>shows the result of the Material that you are currently editing. You can navigate in preview Material using these options:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Rotate the mesh</strong>: Drag with the left mouse button</li><li class="listitem" style="list-style-type: disc"><strong>Pan</strong>: Drag with the middle mouse button</li><li class="listitem" style="list-style-type: disc"><strong>Zoom</strong>: Drag with the right mouse button</li><li class="listitem" style="list-style-type: disc"><strong>Update light</strong>: Hold <em>L</em> and drag with the left mouse button</li></ul></div><p>In the top-right corner of the preview viewport you can change some settings. This changes the preview mesh to the selected primitive shape:</p><div><img src="img/B03950_03_16.jpg" alt="Preview panel"/></div><p>This changes the preview mesh to a custom mesh. You need to select a <strong>Static Mesh</strong> in <strong>Content Browser</strong>:</p><div><img src="img/B03950_03_17.jpg" alt="Preview panel"/></div><p>This toggles the rendering of the grid in the preview viewport:</p><div><img src="img/B03950_03_18.jpg" alt="Preview panel"/></div><p>This toggles real-time rendering in the preview viewport:</p><div><img src="img/B03950_03_19.jpg" alt="Preview panel"/></div></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec22"/>Details panel</h2></div></div></div><p>The <a id="id105" class="indexterm"/>
<strong>Details</strong> panel <a id="id106" class="indexterm"/>shows all the properties you can edit when you select a node in the graph. If no nodes are selected, it will show the properties of the Material itself.</p><p>For more information on these settings, please visit the Material properties documentation at <a class="ulink" href="https://docs.unrealengine.com/latest/INT/Engine/Rendering/Materials/MaterialProperties/index.html">https://docs.unrealengine.com/latest/INT/Engine/Rendering/Materials/MaterialProperties/index.html</a>.</p></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec23"/>Graph panel</h2></div></div></div><p>This<a id="id107" class="indexterm"/> is <a id="id108" class="indexterm"/>the main area where you create all the nodes that decide how the Material should look and behave. By default, a Material graph contains one master node that has a series of inputs, and this master node cannot be deleted. Some of the inputs are grayed out and can be enabled by changing the <strong>Blend</strong> mode in the <strong>Details</strong> panel.</p><div><img src="img/B03950_03_20.jpg" alt="Graph panel"/></div></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec24"/>Palette panel</h2></div></div></div><p>The <a id="id109" class="indexterm"/>
<strong>Palette</strong> panel<a id="id110" class="indexterm"/> lists all the graph nodes and Material functions that can be placed in the graph using drag and drop.</p><div><div><h3 class="title"><a id="tip13"/>Tip</h3><p>Using the <strong>Category</strong> option, you can filter <strong>Palette</strong> contents between expressions or Material functions.</p></div></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec22"/>Common material expressions</h1></div></div></div><p>There are<a id="id111" class="indexterm"/> some common Material nodes that we use most of the time when we create a material. To create a node you need to right-click on the graph canvas and search for it, or you can use the <strong>Palette</strong> window to drag and drop. Some nodes also have shortcut keys assigned to them.</p><p>Let's take a look at these common nodes.</p><div><div><div><div><h2 class="title"><a id="ch03lvl2sec25"/>Constant</h2></div></div></div><p>Constant <a id="id112" class="indexterm"/>expression outputs a single float value and can be connected to almost any input. You can convert a constant expression to a parameter and make real-time changes to the Material instance. You can also access a parameter through Blueprint or C++ and see the changes in the game.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Shortcut key</strong>: Hold <em>1</em> and click on the graph area</li><li class="listitem" style="list-style-type: disc"><strong>Parameter shortcut key</strong>: Hold <em>S</em> and click on the graph area</li><li class="listitem" style="list-style-type: disc"><strong>Example usage</strong>: Brighten or darken a texture</li></ul></div><div><div><h3 class="title"><a id="tip14"/>Tip</h3><p>Constant parameter is called a scalar parameter</p></div></div><div><img src="img/B03950_03_21.jpg" alt="Constant"/></div><p>You can see <a id="id113" class="indexterm"/>a constant expression (0.2) being used to darken a texture.</p></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec26"/>Constant2Vector</h2></div></div></div><p>The<a id="id114" class="indexterm"/> Constant2Vector expression outputs two float values, which is a two-channel vector value (for example, red channel and green channel). You can convert Constant2Vector to a parameter and make real-time changes to the Material instance or access it in Blueprint or C++ to make dynamic changes to the material while playing the game.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Shortcut key</strong>: Hold <em>2</em> and click on the graph area</li><li class="listitem" style="list-style-type: disc"><strong>Parameter shortcut key</strong>: Hold <em>V</em> and click on the graph area</li><li class="listitem" style="list-style-type: disc"><strong>Example usage</strong>: Adjust the UVs of a texture separately</li></ul></div><div><img src="img/B03950_03_22.jpg" alt="Constant2Vector"/></div><p>You can see a <a id="id115" class="indexterm"/>Constant2Vector being used to tile a texture in the preceding screenshot.</p></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec27"/>Constant3Vector</h2></div></div></div><p>The <a id="id116" class="indexterm"/>Constant3Vector expression outputs three float values, which is a three-channel vector value (for example, red channel, green channel, and blue channel). You can convert Constant3Vector to a parameter and make real-time changes to a Material instance or access it in Blueprint or C++ to make dynamic changes to a material while playing the game.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Shortcut key</strong>: Hold <em>3</em> and click on the graph area</li><li class="listitem" style="list-style-type: disc"><strong>Parameter shortcut key</strong>: Hold <em>V</em> and click on the graph area</li><li class="listitem" style="list-style-type: disc"><strong>Example usage</strong>: Change the color of a given texture</li></ul></div><div><img src="img/B03950_03_23.jpg" alt="Constant3Vector"/></div><p>You can see Constant3Vector <a id="id117" class="indexterm"/>being used to color a grayscale texture in the preceding screenshot.</p></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec28"/>Texture coordinate (TexCoord)</h2></div></div></div><p>The texture coordinate <a id="id118" class="indexterm"/>expression outputs texture UV coordinates as a two-channel vector (for example, U and V), which helps with tiling and also allows you to use different UV coordinates.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Shortcut key</strong>: Hold <em>U</em> and click on the graph area</li></ul></div><div><img src="img/B03950_03_24.jpg" alt="Texture coordinate (TexCoord)"/></div><p>The preceding screenshot shows a texture coordinate being used to tile a texture. You can see the values used by looking at the <strong>Details</strong> panel in the bottom left corner.</p></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec29"/>Multiply</h2></div></div></div><p>This expression multiplies the <a id="id119" class="indexterm"/>given inputs and outputs the result:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Multiplication happens per channel. For example, if you multiply two vectors (0.2, 0.3, 0.4) and (0.5, 0.6, 0.7), the actual process is the following:<div><pre class="programlisting">0.2 x 0.5 = 0.1
0.3 x 0.6 = 0.18
0.4 x 0.7 = 0.28</pre></div><p>So the output is as follows:</p><div><pre class="programlisting">(0.1, 0.18, 0.28)</pre></div></li><li class="listitem" style="list-style-type: disc">The <a id="id120" class="indexterm"/><strong>Multiply</strong> node expects inputs to be the same type unless one of them is constant. In short, you cannot multiply Constant2Vector and Constant3Vector, but you can multiply Constant2Vector or Constant3Vector by a constant expression.<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Shortcut key</strong>: Hold <em>M</em> and click on the graph area</li></ul></div><div><img src="img/B03950_03_25.jpg" alt="Multiply"/></div></li></ul></div><p>The preceding screenshot shows a multiply node being used to boost an emissive effect.</p></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec30"/>Add</h2></div></div></div><p>This expression adds<a id="id121" class="indexterm"/> the given inputs and outputs the result:</p><p>Addition happens per channel. For example, if you add two vectors (1, 0, 0) and (0, 1, 0), the actual process is the following:</p><div><pre class="programlisting">1 + 0 = 1
0 + 1 = 1
0 + 0 = 0</pre></div><p>So the output is as follows:</p><div><pre class="programlisting">(1, 1, 0)</pre></div><p>The <strong>Add</strong> node expects inputs to be the same type unless one of them is constant. In short, you cannot <a id="id122" class="indexterm"/>add Constant2Vector and Constant3Vector, but you can add Constant2Vector or Constant3Vector to a constant expression. Let's take a look at why it is like this. See the following screenshot:</p><div><img src="img/B03950_03_26.jpg" alt="Add"/></div><p>Here we are trying to add Constant3Vector and Constant2Vector but it will not work. This is because, when the Material editor tries to compile the <strong>Add</strong> node, it fails since the last element of Constant3Vector has nothing to add to. It will be like the following calculation:</p><div><pre class="programlisting">1 + 2 = 3
1 + 2 = 3
1 + ? = fail</pre></div><p>But you can add Constant3Vector to a constant expression, as in the following figure:</p><div><img src="img/B03950_03_27.jpg" alt="Add"/></div><p>The result <a id="id123" class="indexterm"/>will be as follows:</p><div><pre class="programlisting">1 + 2 = 3
1 + 2 = 3
1 + 2 = 3</pre></div><p>And that will compile fine.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Shortcut key</strong>: Hold <em>A</em> and click on the graph area<div><img src="img/B03950_03_28.jpg" alt="Add"/></div></li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec31"/>Divide</h2></div></div></div><p>The divide expression divides <a id="id124" class="indexterm"/>the given inputs and outputs the result:</p><p>Division happens by channel. For example, if you divide two vectors (0.2, 0.3, 0.4) and (0.5, 0.6, 0.7), the actual process is like this:</p><div><pre class="programlisting">0.2 / 0.5 = 0.4
0.3 / 0.6 = 0.5
0.4 / 0.7 = 0.571</pre></div><p>So the output is as follows:</p><div><pre class="programlisting">(0.4, 0.5, 0.571)</pre></div><p>The <strong>Divide</strong> node expects inputs to be the same type unless one of them is constant. In short, you cannot divide Constant2Vector by Constant3Vector, but you can divide Constant2Vector or <a id="id125" class="indexterm"/>Constant3Vector by a constant expression.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Shortcut key</strong>: Hold <em>D</em> and click in the graph area<div><img src="img/B03950_03_29.jpg" alt="Divide"/></div></li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec32"/>Subtract</h2></div></div></div><p>This expression subtracts the <a id="id126" class="indexterm"/>given inputs and outputs the result:</p><p>Subtraction happens by channel. For example, if you subtract two vectors (0.2, 0.3, 0.4) and (0.5, 0.6, 0.7), the actual process is the following:</p><div><pre class="programlisting">0.2 - 0.5 = -0.3
0.3 - 0.6 = -0.3
0.4 - 0.7 = -0.3</pre></div><p>So the output is as follows:</p><div><pre class="programlisting">(-0.3, -0.3, -0.3)</pre></div><p>The <strong>Subtract</strong> node expects inputs to be the same type unless one of them is constant. In short, you <a id="id127" class="indexterm"/>cannot subtract Constant2Vector from Constant3Vector, but you can subtract Constant2Vector or Constant3Vector from a constant expression.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Shortcut key</strong>: No shortcut key<div><img src="img/B03950_03_30.jpg" alt="Subtract"/></div></li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec33"/>Texture sample (Texture2D)</h2></div></div></div><p>Texture<a id="id128" class="indexterm"/> sample outputs the given texture. It also outputs all four channels (namely, red, green, blue, and alpha) from the texture separately so you can use them for various things. This is especially useful if you work on multiple grayscale textures (such as mask textures, roughness textures, and so on). Instead of importing multiple textures, you can just create one texture in Photoshop and assign other textures to different channels and, in Material editor, you can get each channel and do all the fancy things. Oh, and did I mention Texture2D can use movie textures too?</p><p>You can <a id="id129" class="indexterm"/>convert <strong>Texture Sample</strong> to <strong>TextureSampleParameter2D</strong> and change textures in real-time via Material instance. You can also change textures dynamically in the game through Blueprints or C++.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Shortcut key</strong>: Hold <em>T</em> and click in the graph area</li><li class="listitem" style="list-style-type: disc"><strong>Parameter shortcut key</strong>: No shortcut key</li></ul></div><div><img src="img/B03950_03_31.jpg" alt="Texture sample (Texture2D)"/></div></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec34"/>Component mask</h2></div></div></div><p>The<a id="id130" class="indexterm"/> component mask expression can extract different channels from the input, which should be a vector channel such as <strong>Constant2Vector</strong>, <strong>Constant3Vector</strong>, <strong>Constant4Vector</strong>, <strong>TextureSample</strong>, and so on. For example, you know Constant4Vector has only one output, which is RGBA. So, if you want the green channel from RGBA, you use a component mask. You can right-click on a component <strong>Mask</strong> and convert it into a <strong>Parameter</strong> and make real-time changes in Material instance.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Shortcut key</strong>: No shortcut key</li><li class="listitem" style="list-style-type: disc"><strong>Parameter shortcut key</strong>: No shortcut key<div><img src="img/B03950_03_32.jpg" alt="Component mask"/></div></li></ul></div><p>In this<a id="id131" class="indexterm"/> screenshot, we extract the alpha channel and plug it into <strong>Opacity</strong> and plug the RGB channel into <strong>Base Color</strong>.</p></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec35"/>Linear interpolate (lerp)</h2></div></div></div><p>This blends two <a id="id132" class="indexterm"/>textures or values based on alpha. When the alpha value is <strong>0</strong> (black color), <strong>A</strong> input is used. If the alpha value is <strong>1</strong> (white color), <strong>B</strong> input is used. Most of the time, this is used to blend two textures based on a mask texture.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Shortcut key</strong>: Hold <em>L</em> and click in the graph area</li><li class="listitem" style="list-style-type: disc"><strong>Example usage</strong>: Blend two textures based on the alpha value, which can be a constant or a mask texture<div><img src="img/B03950_03_33.jpg" alt="Linear interpolate (lerp)"/></div></li></ul></div><p>Here, the <a id="id133" class="indexterm"/>lerp node is outputting 100% of input <strong>A</strong> because the alpha value is <strong>0</strong>. If we set the alpha value to <strong>1</strong> then we'll see 100% of <strong>B</strong>. If alpha is <strong>0.5</strong> then we'll see a blend of both <strong>A</strong> and <strong>B</strong>.</p></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec36"/>Power</h2></div></div></div><p>The <a id="id134" class="indexterm"/>
<strong>Power</strong> node multiplies the base input by itself with Exp times. For example, if you have <strong>4</strong> in <strong>Base</strong> and <strong>6</strong> in <strong>Exp</strong> then the actual process is like this:</p><div><pre class="programlisting">4 x 4 x 4 x 4 x 4 x 4 = 4096</pre></div><p>So the result of <strong>Power</strong> is <code class="literal">4096</code>.</p><p>If you apply a <strong>Texture</strong> to <strong>Base</strong> input and have a constant value (for example, <strong>4</strong>) then the <strong>Texture</strong> is multiplied four times.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Shortcut key</strong>: Hold <em>E</em> and click in the graph area</li><li class="listitem" style="list-style-type: disc"><strong>Example usage</strong>: Adjust the contrast of the height map or ambient occlusion map<div><img src="img/B03950_03_34.jpg" alt="Power"/></div></li></ul></div><p>The preceding image shows a Power <a id="id135" class="indexterm"/>node being used to boost the contrast of a <strong>Texture Sample</strong>.</p></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec37"/>PixelDepth</h2></div></div></div><p>
<strong>PixelDepth</strong> <a id="id136" class="indexterm"/>outputs the distance to the camera of the pixel currently being rendered. This can be useful to alter the appearance of the material based on the distance from the player.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Shortcut key</strong>: No shortcut key</li><li class="listitem" style="list-style-type: disc"><strong>Example usage</strong>: Change the color of an object based on the distance from the player<div><img src="img/B03950_03_35.jpg" alt="PixelDepth"/></div></li></ul></div><p>If you apply <a id="id137" class="indexterm"/>the previous material to a mesh, then the color of the mesh will be changed based on the distance to the player camera.</p><div><img src="img/B03950_03_36.jpg" alt="PixelDepth"/></div><p>The preceding screenshot shows how <a id="id138" class="indexterm"/>the mesh will look closer to the player camera.</p><div><img src="img/B03950_03_37.jpg" alt="PixelDepth"/></div><p>The preceding screenshot shows how <a id="id139" class="indexterm"/>the mesh will look when it's farther away from the player camera.</p></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec38"/>Desaturation</h2></div></div></div><p>As the title<a id="id140" class="indexterm"/> says, the <strong>Desaturation</strong> expression desaturates its input. Simply put, it can convert a color image to grayscale based on a certain percentage.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Shortcut key</strong>: No shortcut key</li></ul></div><div><img src="img/B03950_03_38.jpg" alt="Desaturation"/></div></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec39"/>Time</h2></div></div></div><p>This expression outputs <a id="id141" class="indexterm"/>the <strong>Time</strong> passage of the game (in seconds). This is used if you want your Material to change over time.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Shortcut key</strong>: No shortcut key</li><li class="listitem" style="list-style-type: disc"><strong>Example usage</strong>: Create a pulsing Material<div><img src="img/B03950_03_39.jpg" alt="Time"/></div></li></ul></div><p>In the previous <a id="id142" class="indexterm"/>material, we multiply <strong>Time</strong> by a constant expression. The result of the <strong>Multiply</strong> node is plugged into the <strong>Sine</strong> node, which outputs a continuous oscillating waveform that outputs the value in a range of <strong>-1</strong> to <strong>1</strong>. We then use a <strong>ConstantBiasScale</strong> node to prevent the value from going below <strong>0</strong>. A <strong>ConstantBiasScale</strong> node is basically a node that adds a bias value to the input and multiplies it by a scale value. By default, bias is set to <strong>0.5</strong> and scale to <strong>1</strong>. So if the <strong>Sine</strong> value is <strong>-1</strong>, then the result is <code class="literal">(-1 + 1) * 0.5</code>, which equals <strong>0</strong>.</p></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec40"/>Fresnel</h2></div></div></div><p>
<strong>Fresnel</strong> <a id="id143" class="indexterm"/>creates rim lighting, which means it will highlight the edges of the mesh.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Shortcut key</strong>: No shortcut key<div><img src="img/B03950_03_40.jpg" alt="Fresnel"/></div></li></ul></div><p>The result <a id="id144" class="indexterm"/>of the previous network is as follows:</p><div><img src="img/B03950_03_41.jpg" alt="Fresnel"/></div></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec41"/>Material types</h2></div></div></div><p>Now <a id="id145" class="indexterm"/>that you know some of the basic expressions, let's take a look at different Material types. First of all, obviously, is the main Material editor, but then you also have Material instances, Material functions, and layered Materials.</p></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec42"/>Material instances</h2></div></div></div><p>Material<a id="id146" class="indexterm"/> instance is used to change the appearance of a <a id="id147" class="indexterm"/>Material without recompiling it. When you change any value in Material editor and apply it, it will recompile the whole shader and create a set of shaders. When you create a Material instance from that Material, it will use the same set of shaders so you can change the values in real time without recompiling anything. But when you use <strong>Static Switch Parameter</strong> or <strong>Component Mask Parameter</strong> in your <strong>Parent Material</strong>, then it's different because each of those parameters has unique combinations. For example, let's say you have <strong>Material_1</strong> with no <strong>Static Switch Parameter</strong>, and <strong>Material_2</strong> with <strong>Static Switch Parameter</strong> called <strong>bEnableSwitch</strong>. <strong>Material_1</strong> will create only one set of shaders, while <strong>Material_2</strong> will create two sets of shaders with <strong>bEnableSwitch = False</strong> and <strong>bEnableSwitch = True</strong>.</p><p>An <a id="id148" class="indexterm"/>example <a id="id149" class="indexterm"/>workflow is to create a master Material that contains all the necessary parameters and let the designers make different versions.</p><p>There are two types of Material instances. They are:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Material Instance Constant</li><li class="listitem" style="list-style-type: disc">Material Instance Dynamic</li></ul></div><p>Only Material Instance Constant has a user interface. Material Instance Dynamic has no user interface and cannot be created in content browser.</p><div><div><div><div><h3 class="title"><a id="ch03lvl3sec14"/>Material Instance Constant</h3></div></div></div><p>As the<a id="id150" class="indexterm"/> title says, <strong>Material Instant Constant</strong> (<strong>MIC</strong>) is only editable in the editor. That means you cannot change the values at runtime. MIC exposes all parameters you created in the parent Material. You can create your own groups and organize all your parameters nicely.</p><div><img src="img/B03950_03_42.jpg" alt="Material Instance Constant"/><div><p>Material Instance User Interface</p></div></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Toolbar (1)</strong>: The following are toolbar options:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Save</strong>: Saves the asset</li><li class="listitem" style="list-style-type: disc"><strong>Find in CB</strong>: Navigates to this asset in Content Browser and selects it</li><li class="listitem" style="list-style-type: disc"><strong>Params</strong>: Exposes all parameters from Parent Material</li><li class="listitem" style="list-style-type: disc"><strong>Mobile Stats</strong>: Toggles Material stats for Mobile</li></ul></div></li><li class="listitem" style="list-style-type: disc"><strong>Details (2)</strong>: Displays <a id="id151" class="indexterm"/>all the parameters from parent Material and other properties of Material instance. Here you can also assign a physics Material and override the base properties of the parent Material, such as blend mode, two-sided, and so on.</li><li class="listitem" style="list-style-type: disc"><strong>Instance parents (3)</strong>: Here you will see a chain of parents all the way up to the main master Material. The instance currently being edited is shown in bold.</li><li class="listitem" style="list-style-type: disc"><strong>Viewport (4)</strong>: The viewport displays the material on a mesh so you can see your changes in real time. You <a id="id152" class="indexterm"/>can change the preview shape in the top-right corner. This is the same as it was in Material editor.</li></ul></div></div><div><div><div><div><h3 class="title"><a id="ch03lvl3sec15"/>Material Instance Constant example</h3></div></div></div><p>In <a id="id153" class="indexterm"/>order for Material instance to work, we need a master Material with parameters. Let's create a simple Material that will change its color based on the distance to the player, that is, when the player is near the mesh it will have a red color, and as they move further away it will change its color. Note that there are 21 parameter expressions in UE4. </p><p>Right now we will stick with two common parameters, and they are as follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Scalar parameter</li><li class="listitem" style="list-style-type: disc">Vector parameter<div><img src="img/B03950_03_43.jpg" alt="Material Instance Constant example"/></div></li></ul></div><p>As you can see in the previous screenshot, we created two vector parameters (<strong>Color1</strong>, <strong>Color2</strong>) and two scalar parameters (<strong>TransitionDistance</strong>, <strong>Speed</strong>). We will use these parameters to modify in real time. To create an instance of this Material you need to right-click on this Material in <strong>Content Browser</strong> and select <strong>Create Material Instance</strong>. This will create a new instance Material right next to this Material. </p><p>If you open that instance you will see all these parameters there, and you can edit them in real time without having to<a id="id154" class="indexterm"/> wait for the Material to recompile:</p><div><img src="img/B03950_03_44.jpg" alt="Material Instance Constant example"/></div><p>To change values in Material instance, you need to override them first. You need to click the checkbox near the parameter to override the values. As shown in the following screenshot:</p><div><img src="img/B03950_03_44A.jpg" alt="Material Instance Constant example"/></div></div></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec43"/>Material functions</h2></div></div></div><p>Material functions <a id="id155" class="indexterm"/>are graphs that contain <a id="id156" class="indexterm"/>a set of nodes that can be used across any number of Materials. If you often find yourself creating complex networks then it's better to make a Material function so you can contain all these complex networks in one single node. One thing to keep in mind is that Material function cannot contain any parameter nodes (for example, <strong>Scalar Parameter</strong>, <strong>Vector Parameter</strong>, <strong>Texture Parameter</strong>, and so on). To pass data into a Material function, you need to use a special <strong>FunctionInput</strong> node. Similarly, if <a id="id157" class="indexterm"/>you want data out of a Material function, you need to use the <strong>FunctionOutput</strong> node. By default, Material function creates one output for you but you can create more outputs if you want.</p><p>The UI of <a id="id158" class="indexterm"/>Material function is almost the same as of Material editor. If you check the <strong>Details</strong> panel you will see some options to help you get the most out of your Material function. Let's take a look at these options:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Description</strong>: This appears as a tooltip when you hover the mouse on this function node in Material graph.</li><li class="listitem" style="list-style-type: disc"><strong>Expose to Library</strong>: Enable this to show your Material function when you right-click inside your Material graph.</li><li class="listitem" style="list-style-type: disc"><strong>Library Categories</strong>: This list the categories this function belongs to. By default, it belongs to the <strong>Misc</strong> category but you can change it and add as many categories as you want.</li></ul></div><div><div><h3 class="title"><a id="tip15"/>Tip</h3><p>Material functions cannot be applied surface, so if you want to use a Material function you must use it in a Material.</p></div></div><div><div><div><div><h3 class="title"><a id="ch03lvl3sec16"/>Material function example</h3></div></div></div><p>To create<a id="id159" class="indexterm"/> a Material function, first right-click in <strong>Content Browser</strong> and go to <strong>Materials &amp; Textures</strong> and select <strong>Material Function</strong>. In this example, we will create a Material function called <strong>Normal Map Adjuster</strong> that can boost the intensity of a normal map. Let's see what we need to create such a function:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Texture [INPUT]</strong>: Obviously we need to pass a texture that needs to be modified.</li><li class="listitem" style="list-style-type: disc"><strong>Intensity [INPUT]</strong>: We also need to pass how intense the normal should be. A value of <strong>0</strong> means no changes to the normal map and a value of <strong>1</strong> means a boosted normal effect.</li><li class="listitem" style="list-style-type: disc"><strong>Result [OUTPUT]</strong>: Finally we will output the result, which we can connect to the normal channel in our Material.</li></ul></div><div><div><h3 class="title"><a id="tip16"/>Tip</h3><p>The final output node (result) can be renamed with any custom name you want. Select the node and, in the <strong>Details</strong> panel, change <strong>Output Name</strong>.</p></div></div><p>Open your Material function and right-click on the graph and search for <strong>Input</strong>.</p><div><img src="img/B03950_03_45.jpg" alt="Material function example"/></div><p>Select <a id="id160" class="indexterm"/>the <strong>FunctionInput</strong> node. You will see some properties in the <strong>Details</strong> panel for the <strong>Input</strong> node you just selected.</p><div><img src="img/B03950_03_46.jpg" alt="Material function example"/></div><p>Let's take a look at these settings:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Input Name</strong>: A custom name for the input. You can name it whatever you want. Here, I called it <strong>Normal Texture</strong>.</li><li class="listitem" style="list-style-type: disc"><strong>Description</strong>: Will be used as a tooltip when you hover over this input in Material graph.</li><li class="listitem" style="list-style-type: disc"><strong>Input Type</strong>: Defines the type of input for this node.</li><li class="listitem" style="list-style-type: disc"><strong>Preview Value</strong>: Value to use if this input is not connected in Material graph. Only used if <strong>Use Preview Value as Default</strong> is checked.</li><li class="listitem" style="list-style-type: disc"><strong>Use Preview Value as Default</strong>: If checked, it will use the <strong>Preview Value</strong> and will mark this input as optional. So when you use this function, you can leave this input unconnected. But if you disable this option, then you must connect the required node to this when in Material graph.</li><li class="listitem" style="list-style-type: disc"><strong>Sort Priority</strong>: Arranges this input in relation to other input nodes.</li></ul></div><p>Let's <a id="id161" class="indexterm"/>create a simple network to boost the normal effect. Take a look at the following screenshot:</p><div><img src="img/B03950_03_47.jpg" alt="Material function example"/></div><p>Here we are extracting the red, green, and blue channels separately. The reason behind this is simply that we need to multiply <strong>Intensity</strong> (scalar input value) by only the blue channel to increase the normal effect. The <strong>Intensity</strong> needs to be clamped between <strong>0</strong> and <strong>1</strong> and then inverted using the <strong>1-x</strong> (OneMinus) node because, when we use this Material function in a Material, we need <strong>0</strong> to have the default normal intensity and <strong>1</strong> to really boost the effect. Without the OneMinus node it will be the opposite, that is, <strong>0</strong> will boost the normal map effect and <strong>1</strong> will have a regular effect.</p><p>Now that the function is done, click the <strong>Save</strong> button on the toolbar.</p><div><div><h3 class="title"><a id="tip17"/>Tip</h3><p>Saving automatically compiles the Material.</p></div></div><p>Now to get this into Material, right-click inside the Material graph and search for <strong>NormalMapAdjuster</strong>. Then all you have to do is plug a <strong>Normal</strong> map and a <strong>Scalar Parameter</strong> to <strong>NormalMapAdjuster</strong> and connect it to the <strong>Normal</strong> channel.</p><div><div><h3 class="title"><a id="tip18"/>Tip</h3><p>If it doesn't show up in the context menu, make sure you enabled <strong>Expose to Library</strong> in Material Function.</p></div></div><div><img src="img/B03950_03_48.jpg" alt="Material function example"/></div><p>In your <a id="id162" class="indexterm"/>Material instance you can adjust <strong>NormalIntensity</strong> in real time.</p><div><div><div><div><h4 class="title"><a id="ch03lvl4sec01"/>Layered Material</h4></div></div></div><p>Layered Materials <a id="id163" class="indexterm"/>are basically <em>Materials within Materials</em> and exist as an extension of Material function. The basic workflow is as follows: you create a <strong>Make Material Attribute</strong> (which features all the material attributes, such as <strong>Base Color</strong>, <strong>Metallic</strong>, <strong>Specular</strong>, <strong>Roughness</strong>, and so on) and you connect your nodes to it. Then you connect the output of <strong>Make Material Attributes</strong> to the input of the <strong>Output Result</strong> node.</p><p>Layered Materials<a id="id164" class="indexterm"/> are most beneficial when your assets have different layers of materials. For example, think about a character with different elements such as metallic armor, leather gloves, skin, and so on. Defining each of these materials and blending them in a conventional way will make the material complexity increase significantly. If you use layered Material in such cases, you can define each of those materials as a single node and blend them very easily.</p><div><div><div><div><h5 class="title"><a id="ch03lvl5sec01"/>Creating layered Material using make material attributes</h5></div></div></div><p>For this example we will create two simple layered Materials and blend them together in our final <a id="id165" class="indexterm"/>material. First, create a Material function and open it. In Material function, follow these steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Right-click on the graph editor and search for <strong>Make Material Attributes</strong> and select the node from that menu.</li><li class="listitem">Create a <strong>Constant3Vector</strong> node and connect it to <strong>BaseColor</strong> of <strong>Make Material Attributes</strong>.</li><li class="listitem">Create a constant value and connect it to <strong>Metallic</strong> of <strong>Make Material Attributes</strong>.</li><li class="listitem">Create one more constant value and connect that to <strong>Roughness</strong> of <strong>Make Material Attributes</strong>.</li><li class="listitem">Finally, connect <strong>Make Material Attributes</strong> to the output of Material function.</li></ol></div><p>The final Material function should look like this. Note the values I'm using for constant nodes.</p><div><img src="img/B03950_03_49.jpg" alt="Creating layered Material using make material attributes"/></div><p>Since we <a id="id166" class="indexterm"/>want this to be <strong>Metallic</strong>, we set <strong>Metallic</strong> to <strong>1</strong>.</p><p>We will create a duplicate of this same Material function and make it a non-metallic Material with a different color. See the following image:</p><div><img src="img/B03950_03_50.jpg" alt="Creating layered Material using make material attributes"/></div><p>This is a <a id="id167" class="indexterm"/>non-metallic Material and we are going to blend these two Materials in our Material editor using a default <strong>Material Layer Blend</strong> function.</p><p>Make sure you expose both of these Material functions so we can use them in Material editor.</p><p>Open an existing Material or create a new one in <strong>Content Browser</strong> and open it:</p><div><ol class="orderedlist arabic"><li class="listitem">Right-click on the graph and search for your Material functions (select both of them).</li><li class="listitem">Right-click again on the graph and search and select <strong>MatLayerBlend_Simple</strong>.</li><li class="listitem">Connect your Material functions to <strong>MatLayerBlend_Simple</strong>. Connect one function to <strong>Base Material</strong> and the other one to <strong>Top Material</strong>.</li><li class="listitem">Now, to blend these two materials we need an <strong>Alpha (Scalar)</strong> value. A value of <strong>1</strong> (white) will output <strong>Base Material</strong> and a value of <strong>0</strong> will output <strong>Top Material</strong>. A value of <strong>0.5</strong> will output a mix of both <strong>Base</strong> and <strong>Top</strong> materials.</li></ol></div><p>Since we <a id="id168" class="indexterm"/>are using layered Material we cannot directly connect this to the Material editor like other nodes. To make this work, there are two ways we can connect.</p><div><div><div><div><h6 class="title"><a id="ch03lvl6sec01"/>Method 1:</h6></div></div></div><p>We can make the material use Material attributes instead of regular nodes. To use this feature, click anywhere on the graph and in the <strong>Details</strong> panel select <strong>Use Material Attributes</strong>:</p><div><img src="img/B03950_03_51.jpg" alt="Method 1:"/></div><p>When you <a id="id169" class="indexterm"/>enable this, the main material node will show only one node called Material attributes so you can connect the output of <strong>MatLayerBlend_Simple</strong> to this node.</p><p>The following is a screenshot of the final material using this method:</p><div><img src="img/B03950_03_52.jpg" alt="Method 1:"/></div></div><div><div><div><div><h6 class="title"><a id="ch03lvl6sec02"/>Method 2:</h6></div></div></div><p>In this method, instead of using Material attributes for the main node we use <strong>BreakMaterialAttributes</strong> and connect them as regular nodes:</p><div><ol class="orderedlist arabic"><li class="listitem">Right-click on the graph area and search and select <strong>BreakMaterialAttributes</strong>.</li><li class="listitem">Connect the output of <strong>MatLayerBlend_Simple</strong> to <strong>BreakMaterialAttributes</strong>.</li><li class="listitem">And finally, connect all the output nodes of <strong>BreakMaterialAttributes</strong> to the main node of Material editor.</li></ol></div><p>The <a id="id170" class="indexterm"/>following is a screenshot of the final material using this method:</p><div><img src="img/B03950_03_53.jpg" alt="Method 2:"/></div></div></div></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec23"/>Summary</h1></div></div></div><p>In the next chapter we will use post processing techniques to enhance the look of your scene. We will also create a simple Material and use it in post process Material.</p></div></body></html>