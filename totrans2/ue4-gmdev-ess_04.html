<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch04"/>Chapter 4. Post Process</h1></div></div></div><p>Post Process in Unreal Engine 4 allows you to create a variety of artistic effects and change the overall look and feel of the whole game. Post Process effects are activated using Post Process Volumes and can be used individually to affect only a specific area or the entire scene. You can have multiple Post Process Volumes overlapping and render their effects based on their priority. Post Process Volumes can be used to add or modify simple effects such as Bloom, Lens Flares, Eye Adaptation, Depth of Field, and so on and they can also be used to get advanced effects using Materials. Another great feature of Post Process Volume is <a id="id171" class="indexterm"/>
<strong>Look up Table</strong> (<strong>LUT</strong>), which is used to store color transformations from image editing software, such as Adobe Photoshop or GIMP. They are very easy to set up and can yield very good results. We will get into LUT later in this chapter.</p><p>When you first start a project without starter content, there will be no Post Process Volumes present in the scene, so Engine will use the default settings. You can change these settings per project under <strong>Project Settings</strong>:</p><div><ol class="orderedlist arabic"><li class="listitem">Click on <strong>Edit</strong> in the menu bar.</li><li class="listitem">Click on <strong>Project Settings</strong>.</li><li class="listitem">Go to the <strong>Rendering</strong> section.</li><li class="listitem">Expand <strong>Default Postprocessing Settings</strong>:<div><img src="img/B03950_04_01.jpg" alt="Post Process"/></div></li></ol></div><p>Here, you will see the default settings for Unreal Engine when there is no Post Process Volume in your scene. You can modify these settings or add a Post Process Volume to override them independently.</p><div><div><div><div><h1 class="title"><a id="ch04lvl1sec24"/>Adding Post Process</h1></div></div></div><p>To use <a id="id172" class="indexterm"/>Post Process, you need a Post Process Volume in your scene:</p><div><ol class="orderedlist arabic"><li class="listitem">Go to the <strong>Modes</strong> tab (if you closed it, press <em>Shift</em> + <em>1</em>).</li><li class="listitem">Select the <strong>Volumes</strong> tab.</li><li class="listitem">Drag and drop Post Process Volume into the scene:<div><img src="img/B03950_04_02.jpg" alt="Adding Post Process"/></div></li></ol></div><p>You now have a Post Process Volume in your scene. However, it only shows the effects when the player is inside that volume. To make it affect the whole scene perform the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Select <strong>Post Process Volume</strong></li><li class="listitem">In the <strong>Details</strong> panel, scroll down and expand the <strong>Post Process Volume</strong> section</li><li class="listitem">Enable <strong>Unbound</strong></li></ol></div><p>Enabling <strong>Unbound</strong> will<a id="id173" class="indexterm"/> ignore the bounds of this volume and affect the whole scene. Now, let's take a quick look at these Post Process settings:</p><div><img src="img/B03950_04_03.jpg" alt="Adding Post Process"/></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Priority</strong>: If multiple volumes are overlapping each other, then the volume with higher priority overrides the lower one.</li><li class="listitem" style="list-style-type: disc"><strong>Blend Radius</strong>: This is the radius of the volume used for blending. Generally, a value of <code class="literal">100</code> works best. This setting is ignored if you have <strong>Unbound</strong> enabled.</li><li class="listitem" style="list-style-type: disc"><strong>Blend Weight</strong>: This defines the influence of properties. <code class="literal">0</code> means no effect and <code class="literal">1</code> means full effect.</li><li class="listitem" style="list-style-type: disc"><strong>Enabled</strong>: This enables or disables this volume.</li><li class="listitem" style="list-style-type: disc"><strong>Unbound</strong>: If enabled, then Post Process effects will ignore the bounds of this volume and will affect the whole scene.</li></ul></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec44"/>LUT</h2></div></div></div><p>LUTs <a id="id174" class="indexterm"/>are <a id="id175" class="indexterm"/>color neutral textures unwrapped to a 256 x 16 size texture. They are used to create unique artistic effects and are modified using image editing software such as Adobe Photoshop. If you are not familiar with Photoshop, you can use free and open source software such as GIMP. The following is an image of the default LUT texture:</p><div><img src="img/B03950_04_04.jpg" alt="LUT"/></div><p>The <a id="id176" class="indexterm"/>procedure of LUT is as follows:</p><div><ol class="orderedlist arabic"><li class="listitem">First you take a screenshot of your world and bring it into Photoshop.</li><li class="listitem">On top of that screenshot, you insert the LUT texture.</li><li class="listitem">Then on top of both, apply color manipulations (for example: adjustment layer).</li><li class="listitem">Now select the LUT texture and save it with your color manipulation as PNG or TGA.</li><li class="listitem">Finally, import your LUT into Unreal Engine.<div><div><h3 class="title"><a id="note09"/>Note</h3><p>Note that after you import your LUT into <strong>Content Browser</strong>, open it and set the <strong>Texture Group</strong> to <strong>ColorLookupTable</strong>. This is an important step and should not be skipped.</p></div></div></li></ol></div><p>To apply the<a id="id177" class="indexterm"/> LUT, select the Post Process volume, and under the <strong>Scene Color</strong> section, you can enable <strong>Color Grading</strong> and set your LUT texture:</p><div><img src="img/B03950_04_05.jpg" alt="LUT"/></div><p>With the <strong>Color Grading Intensity</strong> option, you can change the intensity of the effect.</p></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec45"/>Post Process Materials</h2></div></div></div><p>Post Process Materials <a id="id178" class="indexterm"/>help you create custom <a id="id179" class="indexterm"/>post processing with the help of Material Editor. You need to create a Material with your desired effect and assign it to <strong>Blendables</strong> in Post Process Volume. Click on the plus sign to add more slots:</p><div><img src="img/B03950_04_06.jpg" alt="Post Process Materials"/></div><p>Before I explain about Post Process Materials, let's take a quick look at one of the most important Post Process nodes in Material Editor:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Scene Texture</strong>: This node has multiple selections that output different textures:<div><img src="img/B03950_04_07.jpg" alt="Post Process Materials"/></div></li><li class="listitem" style="list-style-type: disc"><strong>UVs</strong> (optional): This input tiles the texture. For UV operations on the <strong>SceneTexture</strong> node, it is good to use the <strong>ScreenPosition</strong> node instead of the regular <strong>Texture Coordinate</strong> node.</li><li class="listitem" style="list-style-type: disc"><strong>Color</strong>: This outputs the final texture as RGBA. If you want to multiply this with a<a id="id180" class="indexterm"/> color, you first need to use a component mask to extract R, G, and B and then multiply it by your color.</li><li class="listitem" style="list-style-type: disc"><strong>Size</strong>: This outputs the size (width and height) of the texture.</li><li class="listitem" style="list-style-type: disc"><strong>InvSize</strong>: This is the inverse of the <strong>Size</strong> output. (1/width and 1/height).<div><div><h3 class="title"><a id="note10"/>Note</h3><p>It is important to keep in mind that you should only use Post Process Materials when you really need them. For <strong>Color Correction</strong> and various other effects, you should stick with the settings from Post Process Volume since they are more efficient and optimized.</p></div></div></li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec46"/>Creating a Post Process Material</h2></div></div></div><p>With <a id="id181" class="indexterm"/>Post Process Material, you can create your own custom Post Processing effects. Some examples are:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Highlighting a specific object in your game</li><li class="listitem" style="list-style-type: disc">Rendering occluded objects</li><li class="listitem" style="list-style-type: disc">Edge detection, and so on</li></ul></div><p>In this quick example, we will see how to highlight an object in our world. To render a specific object separately, we need to put them to a custom depth buffer. The good thing is, it's as easy as clicking on a checkbox.</p><p>Select your Static Mesh and under the <strong>Rendering</strong> section, expand the options and enable <strong>Render Custom Depth</strong>:</p><div><img src="img/B03950_04_08.jpg" alt="Creating a Post Process Material"/></div><p>Now that<a id="id182" class="indexterm"/> the mesh is rendered in the <code class="literal">CustomDepth</code> buffer, we can use this information in Material Editor to mask out and render it separately. To do that:</p><div><ol class="orderedlist arabic"><li class="listitem">Create a new Material and open it.</li><li class="listitem">First thing to do now is to set <strong>Material Domain</strong> to <strong>Post Process</strong>. This will disable all inputs except <strong>Emissive Color</strong>.</li><li class="listitem">Now, right-click on the graph and search for <strong>SceneTexture</strong> and select it. Set <strong>Scene Texture Id</strong> to <strong>CustomDepth</strong>.</li><li class="listitem"><strong>CustomDepth</strong> outputs a raw value so let's divide it by the distance we want.</li><li class="listitem">Add a new <strong>Divide</strong> node and connect <strong>CustomDepth</strong> to input <em>A</em>. Select the divide node and for <em>Const B</em> give a high value (for example: <code class="literal">100000000</code>). Remember, 1 Unreal Unit is equal to <code class="literal">1</code> cm so if you give a small value like <code class="literal">100</code> or <code class="literal">1000</code>, you need to go really close to the object to see the effect. This is why we use a very large value.</li><li class="listitem">Add <a id="id183" class="indexterm"/>a <strong>Clamp</strong> node and connect <strong>Divide</strong> to the first input of the <strong>Clamp</strong> node.</li><li class="listitem">Create a <strong>Lerp</strong> node and connect the output of <strong>Clamp</strong> to the <em>Alpha</em> input of <strong>Lerp</strong>. The <strong>Lerp</strong> node will blend input <code class="literal">A</code> and <code class="literal">B</code> based on the alpha value. If the alpha value is <code class="literal">1</code>, then input <em>A</em> is used. If it is <code class="literal">0</code> then input <em>B</em> is used.</li><li class="listitem">Create another <strong>SceneTexture</strong> node and set its <em>Scene Texture Id</em> to <strong>PostProcessInput0</strong>. <strong>PostProcessInput0</strong> outputs the final HDR color so make sure you use this. There's another output called <strong>SceneColor</strong>, which does the same but it outputs lower quality of the current scene.</li><li class="listitem">Right-click on the graph again and search for the <strong>Desaturation</strong> node. Connect <strong>PostProcessInput0</strong> <em>Color</em> output to <strong>Desaturation</strong> input. We will use this to desaturate the whole scene except our mesh with <strong>CustomDepth</strong>.</li><li class="listitem">Connect the <strong>Desaturation</strong> output to <em>Lerp B</em> and <strong>PostProcessInput0</strong> to <em>Lerp A</em>, and finally, connect the <strong>Lerp</strong> to <strong>Emissive Color</strong>.</li></ol></div><p>Here is the final screenshot of the whole graph:</p><div><img src="img/B03950_04_09.jpg" alt="Creating a Post Process Material"/></div><p>And in this <a id="id184" class="indexterm"/>example scene, I've applied this Material to Post Process Blendables and you can see the effect:</p><div><img src="img/B03950_04_10.jpg" alt="Creating a Post Process Material"/></div><p>Everything <a id="id185" class="indexterm"/>that is in color has Render Custom Depth enabled so the Post Process Material is masking them out and applying the desaturation to the entire scene.</p></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch04lvl1sec25"/>Summary</h1></div></div></div><p>In next chapter, we will add lights and discuss Light Mobility, Lightmass, and Dynamic Lights.</p></div></body></html>