<html><head></head><body><div class="chapter" title="Chapter&#xA0;6.&#xA0;Playing Sounds"><div class="titlepage"><div><div><h1 class="title"><a id="ch06"/>Chapter 6. Playing Sounds</h1></div></div></div><p>A game without sound will be boring and lifeless. Background music and sound effects that suit the visuals will lighten up the game. Initially, we used a very famous audio engine called <code class="literal">SimpleAudioEngine</code>, but Cocos2d-x version 3.3 has now come up with an all-new <code class="literal">AudioEngine</code>. In this chapter, we're going to talk about both <code class="literal">SimpleAudioEngine</code> and <code class="literal">AudioEngine</code>. The following topics will be covered in this chapter:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Playing background music</li><li class="listitem" style="list-style-type: disc">Playing a sound effect</li><li class="listitem" style="list-style-type: disc">Controlling volume, pitch, and balance</li><li class="listitem" style="list-style-type: disc">Pausing and resuming background music</li><li class="listitem" style="list-style-type: disc">Pausing and resuming sound effects</li><li class="listitem" style="list-style-type: disc">Playing background music and a sound effect by using AudioEngine</li><li class="listitem" style="list-style-type: disc">Playing movies</li></ul></div><div class="section" title="Playing background music"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec53"/>Playing background music</h1></div></div></div><p>By using <code class="literal">SimpleAudioEngine</code>, we can<a id="id257" class="indexterm"/> play background music very easily. <code class="literal">SimpleAudioEngine</code> is a shared singleton object that can be called from anywhere in your code. In <code class="literal">SimpleAudioEngine</code>, we can play only one background score.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec140"/>Getting ready</h2></div></div></div><p>We have to include the header file of <code class="literal">SimpleAudioEngine</code> to use it. Therefore, you will need to add the following code:</p><div class="informalexample"><pre class="programlisting">#include "SimpleAudioEngine.h"</pre></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec141"/>How to do it...</h2></div></div></div><p>The following code is used to play background music called <code class="literal">background.mp3</code>.</p><div class="informalexample"><pre class="programlisting">auto audio = CocosDenshion::SimpleAudioEngine::getInstance();
audio-&gt;preloadBackgroundMusic("background.mp3");

// play the background music and continuously play it.
audio-&gt;playBackgroundMusic("background.mp3", true);</pre></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec142"/>How it works...</h2></div></div></div><p>
<code class="literal">SimpleAudioEngine</code> has a <a id="id258" class="indexterm"/>namespace called <code class="literal">CocosDenshion</code>. For <code class="literal">SimpleAudioEngine</code>, you just have to get an instance by using the <code class="literal">getInstance</code> method. You can play the background music without preloading it, but this could result in a delay in playback. That's why you should preload the music before playing it. If you want the playback to be continuous, you need to set the true value as the second argument.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec143"/>There's more...</h2></div></div></div><p>
<code class="literal">SimpleAudioEngine</code> supports a number <a id="id259" class="indexterm"/>of formats, including MP3 and Core Audio format. It can play the following formats:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Format</p>
</th><th style="text-align: left" valign="bottom">
<p>iOS (BGM)</p>
</th><th style="text-align: left" valign="bottom">
<p>iOS (SE)</p>
</th><th style="text-align: left" valign="bottom">
<p>Android (BGM)</p>
</th><th style="text-align: left" valign="bottom">
<p>Android (SE)</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>IMA (.caf)</p>
</td><td style="text-align: left" valign="top">
<p>○</p>
</td><td style="text-align: left" valign="top">
<p>○</p>
</td><td style="text-align: left" valign="top">
<p>□</p>
</td><td style="text-align: left" valign="top">
<p>□</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Vorbis (.ogg)</p>
</td><td style="text-align: left" valign="top">
<p>□</p>
</td><td style="text-align: left" valign="top">
<p>□</p>
</td><td style="text-align: left" valign="top">
<p>○</p>
</td><td style="text-align: left" valign="top">
<p>○</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>MP3 (.mp3)</p>
</td><td style="text-align: left" valign="top">
<p>○</p>
</td><td style="text-align: left" valign="top">
<p>○</p>
</td><td style="text-align: left" valign="top">
<p>○</p>
</td><td style="text-align: left" valign="top">
<p>○</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>WAVE (.wav)</p>
</td><td style="text-align: left" valign="top">
<p>○</p>
</td><td style="text-align: left" valign="top">
<p>○</p>
</td><td style="text-align: left" valign="top">
<p>△</p>
</td><td style="text-align: left" valign="top">
<p>△</p>
</td></tr></tbody></table></div><p>If you want to play a sound in a different format on iOS and Android, you can play it by using the following macro code:</p><div class="informalexample"><pre class="programlisting">#if (CC_TARGET_PLATFORM == CC_PLATFORM_ANDROID) 
#defie MUSIC_FILE        "background.ogg" 
#else
#define MUSIC_FILE        "background.caf" 
#endif

audio-&gt;playBackgroundMusic(MUSIC_FILE, true);</pre></div><p>In this code, if the device is Android, it plays a <code class="literal">.ogg</code> file. If the device is iOS, it plays a <code class="literal">.caf</code> file.</p></div></div></div>
<div class="section" title="Playing a sound effect"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec54"/>Playing a sound effect</h1></div></div></div><p>By using <code class="literal">SimpleAudioEngine</code>, we can <a id="id260" class="indexterm"/>play sound effects; to play them, we need to perform only two steps, namely preload and play. Sound effects are not background music; note that we can play multiple sound effects but only one background score at the same time. In this recipe, we will explain how to play sound effects.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec144"/>Getting ready</h2></div></div></div><p>As in the case of playing background music, you have to include a header file for <code class="literal">SimpleAudioEngine</code>.</p><div class="informalexample"><pre class="programlisting">#include "SimpleAudioEngine.h"</pre></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec145"/>How to do it...</h2></div></div></div><p>Let's try to immediately play a sound effect. The audio format is changed depending on the operating system by using the macro that was introduced at the time of playing the background music. The code for playing sound effects is as follows:</p><div class="informalexample"><pre class="programlisting">#if (CC_TARGET_PLATFORM == CC_PLATFORM_ANDROID) 
#define EFFECT_FILE        "effect.ogg" 
#else 
#define EFFECT_FILE        "effect.caf" 
#endif

auto audio = CocosDenshion::SimpleAudioEngine::getInstance();
audio-&gt;preloadEffect( EFFECT_FILE ); 
audio-&gt;playEffect(EFFECT_FILE); </pre></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec146"/>How it works...</h2></div></div></div><p>The overall flow is the same as that for playing background music. You need to preload a sound effect file before playing it. The sound effect file is smaller than the background music file. So, you can preload a lot of sound effects before playing them.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec147"/>There's more...</h2></div></div></div><p>The number of sound effects that we can play at the same time on Android is less than that on iOS. So, we will now explain how to increase this number for Android. The maximum number of simultaneous playbacks is defined in <code class="literal">Cocos2dxSound.java</code>.</p><p>The path of <code class="literal">Cocos2dxSound.java</code> is <code class="literal">cocos2d/cocos/platform/android/java/src/org/cocos2dx/lib</code>. Then, in line 66, the maximum number of simultaneous playbacks is defined.</p><div class="informalexample"><pre class="programlisting">private static final int MAX_SIMULTANEOUS_STREAMS_DEFAULT = 5;</pre></div><p>If we changed this value to 10, we can play 10 sound effects at the same time.</p></div></div>
<div class="section" title="Controlling volume, pitch, and balance"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec55"/>Controlling volume, pitch, and balance</h1></div></div></div><p>You can control the <a id="id261" class="indexterm"/>volume, pitch, and balance for sound effects. The right blend of<a id="id262" class="indexterm"/> these <a id="id263" class="indexterm"/>three factors makes your game sound more fun.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec148"/>How to do it...</h2></div></div></div><p>Let's try to immediately play a sound effect by controlling its volume, pitch, and balance. The following is the code snippet to do so:</p><div class="informalexample"><pre class="programlisting">auto audio = CocosDenshion::SimpleAudioEngine::getInstance(); 
// set volume 
audio-&gt;setEffectsVolume(0.5); 

// set pitch, pan, gain with playing a sound effect.
float pitch = 1.0f;
float pan = 1.0f;
float gain = 1.0f;
audio-&gt;playEffect(EFFECT_FILE, true, pitch, pan, gain);</pre></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec149"/>How it works...</h2></div></div></div><p>You can control the volume for sound effects by using the <code class="literal">setEffectsVolume</code> method. The maximum value for the volume is 1.0, and the minimum value is 0.0. If you set the volume to 0.0, the sound effect is muted. The default value of the volume is 1.0.</p><p>You can play multiple sound effects at the same time, but you cannot set the volume for these effects individually. To change the master volume for sound effects, set a volume by using the <code class="literal">setEffectsVolume</code> method. If you want to change the volume individually, you should use a <code class="literal">gain</code> value; which we will explain later.</p><p>The second argument in the <code class="literal">playEffect</code> method is the flag for continuously playing the sound effects. For the third and the subsequent arguments, please check the following table:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Arguments</p>
</th><th style="text-align: left" valign="bottom">
<p>Description</p>
</th><th style="text-align: left" valign="bottom">
<p>Minimum</p>
</th><th style="text-align: left" valign="bottom">
<p>Maximum</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>Third argument (<code class="literal">pitch</code>)</p>
</td><td style="text-align: left" valign="top">
<p>Playing speed</p>
</td><td style="text-align: left" valign="top">
<p>0.0</p>
</td><td style="text-align: left" valign="top">
<p>2.0</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Fourth argument (<code class="literal">pan</code>)</p>
</td><td style="text-align: left" valign="top">
<p>Balance of left and right</p>
</td><td style="text-align: left" valign="top">
<p>-1.0</p>
</td><td style="text-align: left" valign="top">
<p>1.0</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Fifth argument (<code class="literal">gain</code>)</p>
</td><td style="text-align: left" valign="top">
<p>Distance from a sound source</p>
</td><td style="text-align: left" valign="top">
<p>0.0</p>
</td><td style="text-align: left" valign="top">
<p>1.0</p>
</td></tr></tbody></table></div><p>The <code class="literal">pitch</code> is the <a id="id264" class="indexterm"/>quality that allows us to classify a sound as relatively high or low. By <a id="id265" class="indexterm"/>using this <code class="literal">pitch</code>, we can control the playing speed in the third <a id="id266" class="indexterm"/>argument. If you set the <code class="literal">pitch</code> to less than 1.0, the sound effect is played slowly. If you set it to more than 1.0, the sound effect is played quickly. If you set it to 1.0, the sound effect plays at the original speed. The maximum value of the <code class="literal">pitch</code> is 2.0. However, you can set the <code class="literal">pitch</code> to more than 2.0 in iOS. On the other hand, the maximum value of the <code class="literal">pitch</code> in Android is 2.0. Therefore, we adopted the maximum value as the lower.</p><p>You can change the balance of the left and the right speakers by changing the <code class="literal">pan</code> in the fourth argument. If you set it to -1.0, you can hear it only from the left speaker. If you set it to 1.0, you can hear it from only the right speaker. The default value is 0.0; you can hear it at the same volume from both the left and the right speakers. Unfortunately, you will not be able to figure out much difference in the speaker of the device. If you use the headphones, you can hear this difference.</p><p>You can change the volume of each sound effect by changing the <code class="literal">gain</code> in the fifth argument. You can set the master volume by using the <code class="literal">setEffectVolume</code> method and the volume of each effect by changing the gain value. If you set it to 0.0, its volume is mute. If you set it to 1.0, its volume is the maximum. The final volume of the sound effects will be a combination of the gain value and the value specified in the <code class="literal">setEffectsVolume</code> method.</p></div></div>
<div class="section" title="Pausing and resuming background music"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec56"/>Pausing and resuming background music</h1></div></div></div><p>This recipe will help you <a id="id267" class="indexterm"/>better understand the concept of pausing and <a id="id268" class="indexterm"/>resuming background music.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec150"/>How to do it...</h2></div></div></div><p>It is very easy to stop or pause the background music. You don't specify the argument by using these methods. The code for stopping the background music is as follows:</p><div class="informalexample"><pre class="programlisting">auto audio = CocosDenshion::SimpleAudioEngine::getInstance();
// stop the background music
audio-&gt;stopBackgroundMusic();</pre></div><p>Code for pausing:</p><div class="informalexample"><pre class="programlisting">// pause the background music 
audio-&gt;pauseBackgroundMusic();</pre></div><p>Code for resuming the paused background music:</p><div class="informalexample"><pre class="programlisting">// resume the background music 
audio-&gt;resumeBackgroundMusic();</pre></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec151"/>How it works...</h2></div></div></div><p>You can stop the<a id="id269" class="indexterm"/> background music that is playing by using the <code class="literal">stopBackgroundMusic</code> method. Alternatively, you can pause the background music by <a id="id270" class="indexterm"/>using the <code class="literal">pauseBackgroundMusic</code> method. Once you stop it, you can play it again by using the <code class="literal">playBackgroundMusic</code> method. Further, if you pause it, you can resume playing the music by using the <code class="literal">resumeBackgroundMusic</code> method.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec152"/>There's more...</h2></div></div></div><p>You can determine whether the background music is playing by using the <code class="literal">isBackgroundMusicPlaying</code> method. The following code can be used for doing so:</p><div class="informalexample"><pre class="programlisting">auto audio = CocosDenshion::SimpleAudioEngine::getInstance();
if (audio-&gt;isBackgroundMusicPlaying()) { 
    // background music is playing 
} else { // background music is not playing 
}</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip14"/>Tip</h3><p>However, you are required to be careful while using this method. This method always returns a true value that specifies the playing status in the iOS simulator. At line 201 of <code class="literal">audio/ios/CDAudioManager.m</code> in Cocos2d-x, if the device is the iOS simulator, <code class="literal">SimpleAudioEngine</code> sets the volume to zero and plays it continuously. That's why there is a problem in the iOS simulator. However, we tested the latest iOS simulator before commenting out this process and found that there was no problem. If you want to use this method, you should comment out this process.</p></div></div></div></div>
<div class="section" title="Pausing and resuming sound effects"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec57"/>Pausing and resuming sound effects</h1></div></div></div><p>You might want to stop <a id="id271" class="indexterm"/>sound effects too. Also, you may want to pause them and <a id="id272" class="indexterm"/>then resume them.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec153"/>How to do it...</h2></div></div></div><p>It is very easy to stop or pause a sound effect. The following is the code for stopping it:</p><div class="informalexample"><pre class="programlisting">auto audio = CocosDenshion::SimpleAudioEngine::getInstance();
unsigned int _soundId; 
// get the sound id as playing the sound effect
_soundId = audio-&gt;playEffect(EFFECT_FILE); 
// stop the sound effect by specifying the sound id
audio-&gt;stopEffect(_soundId);</pre></div><p>The following is the code for pausing it:</p><div class="informalexample"><pre class="programlisting">// pause the sound effect
audio-&gt;pauseEffect(_soundId);</pre></div><p>You can resume the paused code as follows:</p><div class="informalexample"><pre class="programlisting">// resume the sound effect
audio-&gt;resumeEffect(_soundId);</pre></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec154"/>How it works...</h2></div></div></div><p>
<code class="literal">SimpleAudioEngine</code> can <a id="id273" class="indexterm"/>play multiple sound effects. Therefore, you have to <a id="id274" class="indexterm"/>specify the sound effect if you want to stop or pause it individually. You can get the sound ID when you play the sound effect. You can stop, pause, or resume the specific sound effect by using this ID.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec155"/>There's more...</h2></div></div></div><p>You can stop, pause, or resume all the playing sound effects. The code to do so is as follows:</p><div class="informalexample"><pre class="programlisting">auto audio = CocosDenshion::SimpleAudioEngine::getInstance();
// stop all sound effects audio-&gt;stopAllEffects();
// pause all sound effects
audio-&gt;pauseAllEffects();
// resume all sound effects
audio-&gt;resumeAllEffects();</pre></div></div></div>
<div class="section" title="Playing background music and a sound effect by using AudioEngine"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec58"/>Playing background music and a sound effect by using AudioEngine</h1></div></div></div><p>
<code class="literal">AudioEngine</code> is a new<a id="id275" class="indexterm"/> class from Cocos2d-x version 3.3. <code class="literal">SimpleAudioEngine</code> cannot <a id="id276" class="indexterm"/>play <a id="id277" class="indexterm"/>multiple background <a id="id278" class="indexterm"/>scores, but <code class="literal">AudioEngine</code> can play them. Furthermore, <code class="literal">AudioEngine</code> can call a callback function when it finishes playing the background music. In addition, we can get the playtime by using the callback function. In this recipe, we will learn more about the brand new <code class="literal">AudioEngine</code>.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec156"/>Getting ready</h2></div></div></div><p>We have to<a id="id279" class="indexterm"/> include the header file of <code class="literal">AudioEngine</code> to use<a id="id280" class="indexterm"/> it. Further, <code class="literal">AudioEngine</code> has a<a id="id281" class="indexterm"/> namespace called <code class="literal">experimental</code>. To <a id="id282" class="indexterm"/>include the header file, you will need to add the following code:</p><div class="informalexample"><pre class="programlisting">#include "audio/include/AudioEngine.h" USING_NS_CC; 
using namespace experimental;</pre></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec157"/>How to do it...</h2></div></div></div><p>
<code class="literal">AudioEngine</code> is much easier than <code class="literal">SimpleAudioEngine</code>. Its API is very simple. The following code can be used to play, stop, pause, and resume the background music.</p><div class="informalexample"><pre class="programlisting">// play the background music 
int id = AudioEngine::play2d("sample_bgm.mp3"); 
// set continuously play
AudioEngine::setLoop(id, true); 
// change the volume, the value is from 0.0 to 1.0 
AudioEngine::setVolume(id, 0.5f); 
// pause it
AudioEngine::pause(id); 
// resume it that was pausing 
AudioEngine::resume(id); 
// stop it
AudioEngine::stop(id); 
// seek it by specifying the time 
AudioEngine::setCurrentTime(int id, 12.3f); 
// set the callback when it finished playing it
AudioEngine::setFinishCallback(int id, [](int audioId, std::string filePath){ 
    // this is the process when the background music was finished.
});</pre></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec158"/>How it works...</h2></div></div></div><p>
<code class="literal">AudioEngine</code> no longer needs the preload method. Further, <code class="literal">AudioEngine</code> does not distinguish between background music and sound effects. You can play both background music and sound effects by using the same method. When you play it, you can get a sound ID as the return value. You have to specify the sound ID when you change the volume, stop it, pause it, and so on.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec159"/>There's more...</h2></div></div></div><p>If you want <a id="id283" class="indexterm"/>to unload audio files from the memory, you<a id="id284" class="indexterm"/> can <code class="literal">uncache</code> by using <a id="id285" class="indexterm"/>the <code class="literal">AudioEngine::uncache</code> method<a id="id286" class="indexterm"/> or the <code class="literal">AudioEngine::uncacheAll</code> method. In the case of the <code class="literal">uncache</code> method, you have to specify the path that you want to unload. In the case of the <code class="literal">uncacheAll</code> method, all audio data is unloaded from the memory. While unloading files, you have to stop the related music and sound effects.</p></div></div>
<div class="section" title="Playing movies"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec59"/>Playing movies</h1></div></div></div><p>You might want to play a <a id="id287" class="indexterm"/>movie in your game in order to enrich the representation. Cocos2d-x provides a <code class="literal">VideoPlayer</code> class for this purpose. This class makes it easy to play a movie; however, it is still an <code class="literal">experimental</code> class. So, you have to be very careful while using it.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec160"/>Getting ready</h2></div></div></div><p>You have to prepare something before using the <code class="literal">VideoPlayer</code> class.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">You have to add the movie file to the <code class="literal">Resources/res</code> folder. In this case, we add the video called <code class="literal">splash.mp4</code>.</li><li class="listitem">Next, you have to including a header file. The code to do so is as follows:<div class="informalexample"><pre class="programlisting">#include "ui/CocosGUI.h"
USING_NS_CC;
using namespace experimental::ui;</pre></div></li><li class="listitem">Then, you have to add the following code to the <code class="literal">proj.android/jni/Android.mk</code> file for building an Android application.<div class="informalexample"><pre class="programlisting">LOCAL_WHOLE_STATIC_LIBRARIES += cocos_ui_static
$(call import-module,ui)</pre></div></li><li class="listitem">In Xcode, you have to add <code class="literal">MediaPlayer.framework</code> for iOS, as shown in the following image:</li></ol></div><div class="mediaobject"><img src="graphics/B0561_06_01.jpg" alt="Getting ready"/></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec161"/>How to do it...</h2></div></div></div><p>Let's try to play the<a id="id288" class="indexterm"/> video in your game. Here, it is:</p><div class="informalexample"><pre class="programlisting">auto visibleSize = Director::getInstance()-&gt;getVisibleSize(); auto videoPlayer = VideoPlayer::create(); 

videoPlayer-&gt;setContentSize(visibleSize); 
videoPlayer-&gt;setPosition(visibleSize/2); 
videoPlayer-&gt;setKeepAspectRatioEnabled(true); 
this-&gt;addChild(videoPlayer);

videoPlayer-&gt;addEventListener([](Ref *sender, 
VideoPlayer::EventType eventType) { 
    switch (eventType) { 
        case VideoPlayer::EventType::PLAYING: 
            CCLOG("PLAYING");
            break;
        case VideoPlayer::EventType::PAUSED: 
            CCLOG("PAUSED"); 
            break;
        case VideoPlayer::EventType::STOPPED: 
            CCLOG("STOPPED"); 
            break;
        case VideoPlayer::EventType::COMPLETED: 
            CCLOG("COMPLETED"); 
            break; 
        default:
            break; 
    }
});

videoPlayer-&gt;setFileName("res/splash.mp4"); 
videoPlayer-&gt;play();</pre></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec162"/>How it works...</h2></div></div></div><p>Basically, the<a id="id289" class="indexterm"/> <code class="literal">VideoPlayer</code> class is the same as the other nodes. First, you create an instance, specify its location, and then add it on a layer. Next, you set the content size by using the <code class="literal">setContentSize</code> method. If you set a false value by using the <code class="literal">setKeepAspectRatioEnabled</code> method, the video player's size becomes equal to the content size that you specify by using the <code class="literal">setContentSize</code> method. In contrast, if you set a true value, the video player retains the aspect ratio for the movie.</p><p>You can get the event of the playing status by adding an event listener. <code class="literal">VideoPlayer::EventType</code> has four types of events, namely <code class="literal">PLAYING</code>, <code class="literal">PAUSED</code>, <code class="literal">STOPPED</code>, and <code class="literal">COMPLETED</code>.</p><p>Finally, you set the movie file by using the <code class="literal">setFileName</code> method and you can play it by using the <code class="literal">play</code> method.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip15"/>Tip</h3><p>There are a lot of video formats. However, the video format that you can play on both iOS and Android is mp4. That's why you should use the mp4 format to play videos in your games.</p></div></div></div></div></body></html>