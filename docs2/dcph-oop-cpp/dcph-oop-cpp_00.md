# 前言

公司选择使用 C++是因为其速度；然而，面向对象（OO）的软件设计导致代码更健壮，更容易修改和维护。因此，了解如何将 C++用作面向对象（OOP）语言是至关重要的。在 C++中编程并不能保证面向对象（OOP）编程（OOP）——您必须理解面向对象（OO）概念以及它们如何映射到 C++语言特性和编程技术。此外，程序员还希望掌握超出面向对象（OOP）的额外技能，以使代码更通用和健壮，并采用在流行设计模式中可以找到的经过良好测试的创造性解决方案。对于程序员来说，理解可以使 C++成为更安全语言使用的语言特性和约定也是至关重要的。

一个学会如何按照安全编程约定使用 C++作为面向对象（OOP）语言的程序员将成为宝贵的 C++开发者——一个代码易于维护、修改且易于他人理解的开发者。

这本书对必要的面向对象（OO）概念进行了逐步解释，并配以代码中的实际示例，通常还配有图表，以便您真正理解事物是如何以及为什么工作的。书中还提供了自我评估问题，以测试您的技能。

本书首先提供了技能的必要构建块（可能不是面向对象的），这些构建块为构建面向对象（OOP）技能提供了基本的基础。接下来，将描述面向对象（OO）概念，并将其与语言特性以及编码技术相结合，以便您了解如何成功地将 C++用作面向对象（OOP）语言。此外，还增加了更多高级技能，以丰富程序员的技能库，包括友元函数/类、运算符重载、模板（构建更通用的代码）、异常处理（构建健壮的代码）、标准模板库（STL）基础，以及设计模式和惯用法。本书通过重新审视书中呈现的编程结构，并配以导致 C++更安全编程的约定，来结束全书。最终目标是使您能够生成健壮、易于维护且易于他人理解的代码。

在本书结束时，您将理解必要的和高级的面向对象（OO）概念，以及如何在 C++中实现这些概念。您将拥有一个多功能的 C++编程技能工具包。您还将了解如何使代码更安全、更健壮和易于维护，以及如何将经过良好测试的设计模式作为您编程技能的一部分。

# 这本书适合谁？

想要利用 C++进行面向对象编程的程序员会发现这本书对于理解如何在 C++中通过语言特性和精炼的编程技术实现面向对象设计至关重要，同时创建健壮且易于维护的代码。这本书假设读者有先前的编程经验；然而，如果你有有限的或没有先前的 C++经验，早期章节将帮助你学习必要的 C++技能，为许多面向对象部分、高级特性、设计模式和约定打下基础，以促进 C++中的安全编程。

# 本书涵盖的内容

*第一章*, *理解基本的 C++假设*，对书中假定知识的语言基本特性进行了简要回顾。现有程序员可以快速掌握本第一章中回顾的语言基础。

*第二章*, *添加语言需求*，回顾了关键的 C++构建块的非面向对象特性：`const`限定符、函数原型（默认值）和函数重载。

*第三章*, *间接寻址 – 指针*，回顾了 C++中的指针，包括内存分配/释放、指针使用/解引用、在函数参数中的使用、空指针，并介绍了智能指针的概念。

*第四章*, *间接寻址 – 引用*，介绍了引用作为指针的替代方案，包括初始化、函数参数/返回值和`const`限定符。

*第五章*, *详细探索类*，首先通过探索面向对象和封装、信息隐藏的概念来介绍面向对象编程，然后详细介绍了类特性：成员函数、`this`指针、访问标签和区域、构造函数、析构函数以及数据成员和成员函数的限定符（`const`、`static`和`inline`）。

*第六章*, *使用单一继承实现层次结构*，详细介绍了使用单一继承进行泛化和特殊化。本章涵盖了继承成员、使用基类构造函数、继承访问区域、构造/析构顺序、`final`类，以及公共与私有和受保护的基类，以及这些如何改变继承的含义。

*第七章*, *通过多态利用动态绑定*，描述了面向对象的多态概念，然后区分了操作和方法，详细介绍了虚拟函数和方法的运行时绑定到操作（包括 v-table 的工作原理），并区分了`virtual`、`override`和`final`的使用。

*第八章*, *掌握抽象类*，解释了面向对象（OO）中的抽象类概念，以及使用纯虚函数实现抽象类的方法，还介绍了接口的 OO 概念及其实现方式，以及在一个公有继承层次结构中的向上和向下转换。

*第九章*, *探索多重继承*，详细说明了如何使用多重继承以及它在 OO 设计中的争议。本章涵盖了虚基类、菱形层次结构，以及通过考察判别器的 OO 概念来确定考虑替代设计的情况。

*第十章*, *实现关联、聚合和组合*，描述了面向对象的关联、聚合和组合概念，以及如何使用指针、指针集合、包含和有时引用来实现每个概念。

*第十一章*, *处理异常*，通过考虑许多异常场景来解释如何`try`、`throw`和`catch`异常。本章展示了如何扩展异常处理层次结构。

*第十二章*, *朋友和运算符重载*，解释了正确使用朋友函数和类的方法，并检查了运算符重载（可能使用朋友）以允许运算符以与标准类型相同的方式与用户定义的类型一起工作。

*第十三章*, *使用模板*，详细说明了模板函数和类，以泛化某些类型的代码以与任何数据类型一起工作。本章还展示了运算符重载如何使选定的代码对任何类型更通用，从而进一步支持模板的使用。

*第十四章*, *理解 STL 基础*，介绍了 C++中的标准模板库（STL），并演示了如何使用常见的容器，如`list`、`iterator`、`deque`、`stack`、`queue`、`priority_queue`和`map`。此外，还介绍了 STL 算法和函数对象。

*第十五章*, *测试类和组件*，展示了使用规范类形式和驱动程序进行 OO 测试的方法，并展示了如何测试通过继承、关联和聚合相关联的类。本章还展示了如何测试利用异常处理的类。

*第十六章*, *使用观察者模式*，介绍了设计模式概述，然后解释了观察者模式，并通过一个深入示例说明了模式的组成部分。

*第十七章*, *应用工厂模式*，介绍了工厂方法模式，并展示了带和不带对象工厂的实现方式。它还比较了对象工厂与抽象工厂。

*评估* 包含了每一章的所有问题的答案。

*第十九章*，*使用单例模式*，详细探讨了单例模式，并使用复杂的配对类实现。还介绍了单例注册表。

*第二十章*，*使用 pImpl 模式移除实现细节*，描述了 pImpl 模式，该模式用于减少代码中的编译时依赖。使用唯一指针探讨了详细的实现，并探讨了与该模式相关的性能问题。

*第二十一章*，*使 C++更安全*，回顾了本书中涵盖的主题，目的是确定可以用来使 C++成为开发稳健软件更安全语言的核心理编程指南。

*评估* 包含了每一章的所有问题的答案。

# 为了充分利用本书

假设您有一个当前的 C++编译器。您将想要尝试许多在线代码示例！您可以使用任何 C++编译器；然而，建议使用 C++17 或更高版本。展示的代码将符合 C++20 规范。至少，请从[`gcc.gnu.org`](https://gcc.gnu.org)下载 g++。

![](img/B19087_Preface.jpg)

请记住，尽管 C++有一个 ISO 标准，但一些编译器有所不同，并且对标准的解释有细微的差异。

如果您正在使用这本书的数字版，我们建议您亲自输入代码或从书的 GitHub 仓库（下一节中有一个链接）获取代码。这样做将帮助您避免与代码复制粘贴相关的任何潜在错误。

在阅读本书时尝试编码示例是高度推荐的。完成评估将进一步增强您对每个新概念的理解。

# 下载示例代码文件

您可以从 GitHub 下载本书的示例代码文件：[`github.com/PacktPublishing/Deciphering-Object-Oriented-Programming-with-CPP`](https://github.com/PacktPublishing/Deciphering-Object-Oriented-Programming-with-CPP)。如果代码有更新，它将在 GitHub 仓库中更新。

我们还有其他来自我们丰富的图书和视频目录的代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。查看它们吧！

# 在行动中的代码

本书在行动中的代码视频可在[`bit.ly/3pylFkV`](https://bit.ly/3pylFkV)查看。

# 下载彩色图像

我们还提供了一个包含本书中使用的截图和图表彩色图像的 PDF 文件。您可以从这里下载：[`packt.link/ZvNhC`](https://packt.link/ZvNhC)。

# 使用的约定

本书使用了多种文本约定。

`文本中的代码`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“考虑到这一点，让我们看看我们的适配器类，`Humanoid`。”

代码块应如下设置：

```cpp
class Humanoid: private Person   // Humanoid is abstract
{                           
protected:
    void SetTitle(const string &t) { ModifyTitle(t); }
public:
    Humanoid() = default;   
    Humanoid(const string &, const string &, 
             const string &, const string &);
    // class definition continues 
```

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

```cpp
    const string &GetSecondaryName() const
       { return GetFirstName(); }  
    const string &GetPrimaryName() const 
       { return GetLastName(); } 
```

任何命令行输入或输出应如下编写：

```cpp
Orkan Mork McConnell
Nanu nanu
Romulan Donatra Jarok
jolan'tru
Earthling Eve Xu
Hello
Earthling Eve Xu
Bonjour
```

小贴士或重要提示

看起来像这样。

# 联系我们

我们始终欢迎读者的反馈。

一般反馈：如果您对本书的任何方面有疑问，请通过电子邮件发送给我们 customercare@packtpub.com，并在邮件主题中提及书名。

错误清单：尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，我们将不胜感激，如果您能向我们报告这一点。请访问 [www.packtpub.com/support/errata](http://www.packtpub.com/support/errata) 并填写表格。

侵权：如果您在互联网上以任何形式发现我们作品的非法副本，我们将不胜感激，如果您能提供位置地址或网站名称。请通过电子邮件发送给我们 copyright@packt.com，并提供材料的链接。

如果您有兴趣成为作者：如果您在某个主题上具有专业知识，并且您有兴趣撰写或为本书做出贡献，请访问 [authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

一旦您阅读了《用 C++解码面向对象编程》，我们很乐意听听您的想法！请[点击此处直接访问此书的亚马逊评论页面](https://packt.link/r/1-804-61390-8)并分享您的反馈。

您的评论对我们和科技社区都很重要，并将帮助我们确保我们提供高质量的内容。

# 第一部分：C++构建块基础

本部分的目标是确保您在非 OO C++技能方面有坚实的基础，以便在 C++中构建即将到来的 OOP 技能。这是本书最短的部分，旨在快速让您熟悉 OOP 和更高级的章节。

第一章快速回顾了您在阅读本书时假定具备的基本技能：基本语言语法、循环结构、运算符、函数使用、用户定义类型基础（`struct`、`typedef`、`class`基础、`using`语句、`enum`、强类型`enum`）和`namespace`基础。下一章讨论了`const`限定变量、函数原型、具有默认值的原型和函数重载。

下一章通过引入`new()`和`delete()`来分配基本数据类型，动态分配 1 维、2 维和 N 维数组，使用`delete`管理内存，将参数作为函数的参数传递，使用空指针，以及智能指针的概述，来介绍指针的间接寻址。本节以一个章节结束，该章节通过引用的间接寻址，将带您回顾引用的基础知识、对现有对象的引用，以及作为函数的参数。

虽然这本书会逐渐过渡到优先使用智能指针（并且推荐使用智能指针以确保安全），但熟练掌握原生 C++指针将是一项重要的技能。这项技能对于修改和解析使用原生指针的现有代码，以及清晰地理解原生指针的潜在误用和陷阱至关重要。

本部分包括以下章节：

+   *第一章*, *理解基本的 C++假设*

+   *第二章*, *添加语言需求*

+   *第三章*, *间接寻址 – 指针*

+   *第四章*, *间接寻址 – 引用*

第一部分：C++构建块基础
