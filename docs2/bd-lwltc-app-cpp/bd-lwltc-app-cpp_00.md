# 前言

对于构建实用的低延迟应用程序来说，C++的理论知识是不够的。C++编程语言功能丰富，因此对于超低延迟应用程序，决定使用哪些特性以及避免哪些特性可能很困难。本书深入探讨了 C++编程语言中可用的特性以及 C++编译器的技术细节，从低延迟性能优化的角度出发。

使用 C++进行低延迟交易系统开发是量化金融领域非常受欢迎的技能。从头开始设计和构建一个低延迟电子交易生态系统可能会令人望而却步，本书将详细介绍这一点。它从头开始构建了一个完整的低延迟交易生态系统，以便你可以通过跟随交易系统的开发和演变来学习。我们将通过逐步的示例和解释学习构建低延迟应用程序时的重要细节。

此外，测量和优化性能是所有低延迟系统的持续进化，本书也将涵盖这一内容。到本书结束时，你将非常了解低延迟交易系统以及专注于低延迟开发的 C++特性和技术。

# 本书面向的对象

本书面向希望学习如何构建低延迟系统的初学者或中级 C++开发者。本书也面向对学习 C++中的低延迟电子交易系统特别感兴趣的 C++开发者。

# 本书涵盖的内容

*第一章*，*介绍 C++中的低延迟应用程序开发*，介绍了低延迟应用程序期望的行为和性能特征。它还讨论了 C++编程语言的哪些属性使其成为低延迟应用程序开发的优先语言。本章还讨论了不同业务领域中一些最重要的低延迟应用程序。

*第二章*，*设计一些常见的 C++低延迟应用程序*，深入讨论了驱动实践中一些重要低延迟应用程序的技术细节。本章探讨了低延迟应用程序的细节，例如实时视频流、在线和离线游戏应用程序、**物联网**（**IoT**）应用程序和低延迟电子交易。

*第三章*, *从低延迟应用的角度探索 C++概念*，从低延迟应用开发的视角深入探讨了 C++编程语言的细节。它将讨论如何使用 C++设计和开发这些应用，以及最佳实践。它将讨论 C++编程语言本身的技术细节，并讨论哪些特性对于低延迟应用特别有帮助，以及尝试提升性能时应该避免哪些特性。本章还将深入探讨现代 C++编译器使用的所有现代编译器优化技术，以及 GCC 编译器支持的优化参数和标志。

*第四章*, *构建低延迟应用的 C++构建块*，实现了许多低延迟应用中使用的 C++基本构建块。本章构建的第一个组件是一个线程库，用于支持低延迟应用中的多线程处理。第二个组件是一个内存池抽象，它避免了动态内存分配，而动态内存分配非常慢。然后，本章构建了一个低延迟的无锁队列，用于在线程之间传输通用数据，而不使用锁，因为锁对于许多低延迟应用来说太慢了。本章还构建了一个灵活且低延迟的日志框架。最后，本章将构建一个实用程序和类库，以支持 TCP 和 UDP 网络套接字操作。

*第五章*, *设计我们的交易生态系统*，讨论了完整电子交易生态系统的理论、需求和设计，以及我们将在接下来的几章中从头开始使用 C++构建的所有组件。本章将描述交易交易所中匹配引擎的需求和设计，该引擎负责执行相互之间的订单。我们还将描述与市场参与者通信的订单服务器和市场数据发布者组件。我们还将讨论存在于交易客户端系统中的订单网关客户端和市场数据消费者组件的需求和设计，这些组件用于与交易所通信。本章最后将描述和设计用于在客户端系统中构建和运行不同交易算法的交易引擎框架。

*第六章*, *构建 C++匹配引擎*，描述了交易所中匹配引擎组件设计的细节，该组件负责构建限价订单簿并执行客户订单之间的匹配。限价订单簿跟踪所有市场参与者发送的所有订单。然后，本章完全使用 C++实现了匹配引擎和限价订单簿组件，并包含了它们所需的所有功能。

*第七章*, *与市场参与者沟通*，描述了交易所市场数据发布者和订单服务器组件设计的细节，这些组件负责发布市场数据更新并与交易客户端进行通信。然后，本章使用 C++完全实现了这两个组件，包括它们所需的所有功能。本章通过构建用于电子交易交易所的二进制文件来结束，将来自*第六章*和*第七章*的组件联系起来。

*第八章*, *在 C++中处理市场数据和向交易所发送订单*，描述了交易策略框架中市场数据消费者和限价订单簿设计的细节，这些组件负责消费市场数据更新并在客户端系统中构建订单簿。本章还将讨论交易客户端系统中用于与交易所通信并发送订单的订单网关。然后，本章使用 C++完全实现了这三个组件，包括所需的所有功能。

*第九章*, *构建 C++交易算法构建块*，描述了交易策略框架及其子组件的设计，这些组件将被用来运行交易算法。我们将使用 C++实现整个框架，包括跟踪仓位、利润和损失的所有组件，计算交易特征/信号以构建智能，发送和管理市场中的实时订单，以及执行风险管理。

*第十章*, *构建 C++市场做市和流动性获取算法*，完成了整个电子交易生态系统的 C++实现。本章在上一章构建的框架中构建了市场做市和流动性获取的交易算法。在我们实现交易算法之前，我们将讨论这些算法的交易行为、构建它们的动机以及这些策略如何旨在获利。本章还构建了构建最终交易客户端应用程序所需的交易引擎框架，将来自*第八章*、*第九章*和*第十章*的组件联系起来。本章通过运行一个完整的电子交易生态系统并理解不同交易所和交易客户端组件之间的交互来结束。

*第十一章*，*添加仪表和测量性能*，创建了一个系统来以更高的粒度级别测量我们的低延迟组件的性能。我们还将添加一个系统来通过我们的系统对订单和市场数据事件进行时间戳，当它们从组件移动到组件时。本章最后通过性能测量系统重新运行我们的电子交易生态系统，生成性能数据。

*第十二章*，*分析和优化我们的 C++系统性能*，首先分析并可视化上一章的性能数据。然后，它展示了可以用来优化我们的电子交易组件和整体生态系统的特定技巧和技术。它实现了某些性能优化想法，并对性能改进进行了基准测试。本章最后提出了一些可能的未来增强电子交易系统的方案，并实现并基准测试了其中一个想法。

# 为了充分利用本书

您至少需要具备 C++编程语言的入门级经验，并在 Linux 环境中编译、构建和运行 C++代码时有一定的舒适度。对低延迟应用和电子交易的了解是加分项，但不是必需的，因为所有相关的信息都将在本章中涵盖。

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| C++ 20 | Linux |
| GCC 11.3.0 | Linux |

本书是在`Linux 5.19.0-41-generic #42~22.04.1-Ubuntu x86_64 x86_64 x86_64 GNU/Linux`操作系统上开发的。它使用`CMake 3.23.2`和`Ninja 1.10.2`作为构建系统。然而，本书中展示的源代码预计可以在具有至少`GCC` `11.3.0`编译器的所有 Linux 发行版上运行。

**如果您正在使用本书的数字版，我们建议您亲自输入代码或从本书的 GitHub 仓库（下一节中提供链接）获取代码。这样做将帮助您避免与代码的复制和粘贴相关的任何潜在错误。**

# 下载示例代码文件

您可以从 GitHub（[`github.com/PacktPublishing/Building-Low-Latency-Applications-with-CPP`](https://github.com/PacktPublishing/Building-Low-Latency-Applications-with-CPP)）下载本书的示例代码文件。如果代码有更新，它将在 GitHub 仓库中更新。

我们还有来自我们丰富的书籍和视频目录中的其他代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。查看它们吧！

# 下载彩色图像

我们还提供了一份包含本书中使用的截图和图表的彩色图像的 PDF 文件。您可以从这里下载：[`packt.link/ulPYN`](https://packt.link/ulPYN)。

# 使用的约定

本书使用了多种文本约定。

`文本中的代码`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“`–Werror`参数将这些警告转换为错误，并将在编译成功之前强制开发人员检查并修复生成编译器警告的每个情况。”

代码块设置如下：

```cpp
if(!a && !b) {}
```

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

```cpp
main:
.LFB1
    Movl    $100, %edi
    Call    _Z9factorialj
```

任何命令行输入或输出都按以下方式编写：

```cpp
SpecificRuntimeExample::placeOrder()
SpecificCRTPExample::actualPlaceOrder()
```

小贴士或重要注意事项

它看起来像这样。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**：如果您对本书的任何方面有疑问，请通过电子邮件发送至 customercare@packtpub.com，并在邮件主题中提及书名。

**勘误表**：尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，如果您能向我们报告，我们将不胜感激。请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表格。

**盗版**：如果您在互联网上以任何形式发现我们作品的非法副本，如果您能向我们提供位置地址或网站名称，我们将不胜感激。请通过 copyright@packt.com 与我们联系，并提供材料的链接。

**如果您有兴趣成为作者**：如果您在某个主题上具有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问[authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

一旦您阅读了《使用 C++构建低延迟应用》，我们很乐意听听您的想法！请点击此处直接进入此书的亚马逊评论页面并分享您的反馈。

您的评论对我们和科技社区都至关重要，并将帮助我们确保我们提供高质量的内容。

# 下载此书的免费 PDF 副本

感谢您购买此书！

您喜欢在路上阅读，但无法携带您的印刷书籍到处走吗？您的电子书购买是否与您选择的设备不兼容？

别担心，现在，每购买一本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何设备上阅读。直接从您最喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠远不止于此，您还可以获得独家折扣、时事通讯和每日收件箱中的精彩免费内容。

按照以下简单步骤获取优惠：

1.  扫描下面的二维码或访问以下链接！二维码图片

https://packt.link/free-ebook/9781837639359

1.  提交您的购买证明

1.  就这样！我们将直接将您的免费 PDF 和其他优惠发送到您的电子邮件。

# 第一部分：介绍 C++概念和探索重要低延迟应用

在本部分，我们将介绍低延迟应用以及使用 C++ 开发低延迟应用的正确方法。我们将讨论不同业务领域中一些常见低延迟应用的技术细节。我们还将讨论与低延迟应用开发相关的细节，以及 C++ 概念和技术如何融入其中。此外，我们还将编写一些 C++ 代码，从电子交易交换的角度实现我们之前介绍的不同低延迟组件。

本部分包含以下章节：

+   *第一章**，介绍 C++ 低延迟应用开发*

+   *第二章**，设计一些常见的 C++ 低延迟应用*

+   *第三章**，从低延迟应用的角度探索 C++ 概念*

+   *第四章**，构建低延迟应用的 C++ 基础*
