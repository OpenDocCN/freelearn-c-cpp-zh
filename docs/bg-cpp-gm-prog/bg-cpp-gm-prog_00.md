# 前言

这本书是关于以有趣的方式学习 C ++编程。从零开始，您将学习 C ++的基础知识，如变量和循环，直到高级主题，如继承和多态。您学到的一切都将被应用到构建三个完全可玩的游戏中。

这是我们这本书的三个项目。

# Timber!!!

第一个游戏是一个令人上瘾的，快节奏的模仿非常成功的伐木工的游戏，[`store.steampowered.com/app/398710/`](http://store.steampowered.com/app/398710/)。我们的游戏 Timber!!!将让我们同时学习所有 C ++的基础知识，同时构建一个真正可玩的游戏。

# 僵尸竞技场

接下来，我们将构建一个疯狂的僵尸生存射击游戏，类似于 Steam 的热门游戏 Over 9,000 Zombies，[`store.steampowered.com/app/273500/`](http://store.steampowered.com/app/273500/)。玩家将拥有一把机关枪，并必须抵御不断增长的僵尸浪潮。所有这些将发生在一个随机生成的滚动世界中。为了实现这一点，我们将学习面向对象编程以及它如何使我们能够拥有一个大量的易于编写和维护的代码库。期待令人兴奋的功能，如数百个敌人，快速射击武器，拾取物品以及每一波后都可以“升级”的角色。

# Thomas was Late

第三个游戏将是一个时尚而具有挑战性的单人和合作解谜平台游戏。它基于非常受欢迎的游戏 Thomas was Alone，[`store.steampowered.com/app/220780/`](http://store.steampowered.com/app/220780/)。期待学习一些酷炫的主题，如粒子效果，OpenGL 着色器和分屏合作多人游戏。

# 本书涵盖的内容

第一章，“C ++，SFML，Visual Studio 和开始第一个游戏”，这是一个相当庞大的第一章，但我们将学到我们需要的一切，以便让我们的第一个游戏的第一部分运行起来。以下是我们将要做的事情：

+   了解我们将要构建的游戏更多信息

+   学习一些关于 C ++的知识

+   探索 SFML 及其与 C ++的关系

+   查看我们将在整本书中使用的软件 Visual Studio

+   设置游戏开发环境

+   创建一个可重复使用的项目模板，这将节省大量时间

+   计划并准备第一个游戏项目，伐木者！！！

+   编写本书的第一个 C ++代码，并制作一个可运行的游戏，绘制一个背景

第二章，“变量，运算符和决策-动画精灵”，在本章中，我们将在屏幕上进行更多的绘制，并且为了实现这一点，我们需要学习一些 C ++的基础知识。以下是我们将要做的事情：

+   学习所有关于 C ++变量的知识

+   了解如何操作存储在变量中的值

+   添加一个静态树，准备让玩家砍伐

+   绘制和动画一个蜜蜂和三朵云

第三章，“C++字符串，SFML 时间-玩家输入和 HUD”，在本章中，我们将花大约一半的时间学习如何操作文本并在屏幕上显示它，另一半时间看计时和视觉时间条如何通知玩家并在游戏中制造紧迫感。我们将涵盖：

+   暂停和重新开始游戏

+   C ++字符串

+   SFML 文本和 SFML 字体类

+   为 Timber!!!添加 HUD

+   为 Timber!!!添加一个时间条

第四章，*循环、数组、开关、枚举和函数-实现游戏机制*，这一章可能包含比书中其他任何章节都多的 C++信息。它充满了基本概念，将极大地提高我们的理解。它还将开始阐明一些我们一直略过的模糊领域，比如函数和游戏循环。一旦我们探索了 C++语言的一系列必需知识，我们将利用我们所知道的一切来使主要游戏机制——树枝移动。到本章结束时，我们将准备好进入最后阶段，完成 Timber!!!。准备好接下来的主题：

+   循环

+   数组

+   使用开关进行决策

+   枚举

+   开始使用函数

+   创建和移动树枝

第五章，*碰撞、声音和结束条件-使游戏可玩*，这是第一个项目的最后阶段。到本章结束时，你将拥有你的第一个完成的游戏。一旦你让 Timber!!!运行起来，请务必阅读本章的最后一节，因为它将提出改进游戏的建议：

+   添加其余的精灵

+   处理玩家输入

+   动画飞行原木

+   处理死亡

+   添加音效

+   添加功能和改进 Timber!!!

第六章，*面向对象编程、类和 SFML 视图*，这是本书最长的一章。有相当多的理论，但这些理论将使我们有能力开始有效地使用面向对象编程。此外，我们将不会浪费任何时间来充分利用这些理论。在探索 C++面向对象编程之前，我们将了解并计划我们的下一个游戏项目。我们将做以下事情：

+   计划僵尸竞技场游戏

+   了解面向对象编程和类

+   编写 Player 类

+   了解 SFML View 类

+   构建僵尸竞技场游戏引擎

+   让 Player 类投入使用

第七章，*C++引用、精灵表和顶点数组*，在本章中，我们将探索 C++引用，它允许我们处理变量和对象，否则超出范围。此外，引用将帮助我们避免在函数之间传递大型对象，这是一个缓慢的过程。这是一个缓慢的过程，因为每次这样做时，都必须复制变量或对象。

掌握了关于引用的新知识，我们将看看 SFML `VertexArray`类，它允许我们构建一个大图像，可以使用单个图像文件中的多个图像非常快速和高效地绘制到屏幕上。到本章结束时，我们将拥有一个可扩展的、随机的、滚动的背景，使用引用和`VertexArray`对象。

我们现在将讨论：

+   C++引用

+   SFML `VertexArrays`

+   编写随机滚动背景

第八章，*指针、标准模板库和纹理管理*，在本章中，我们将学到很多，同时也会为游戏做很多工作。我们将首先学习指针这一基本的 C++主题。指针是保存内存地址的变量。通常，指针将保存另一个变量的内存地址。这听起来有点像引用，但我们将看到它们更加强大，我们将使用指针来处理不断增多的僵尸群。

我们还将学习标准模板库（STL），这是一组允许我们快速、轻松地实现常见数据管理技术的类。

一旦我们理解了 STL 的基础知识，我们就能够利用这些新知识来管理游戏中的所有纹理，因为如果我们有 1000 个僵尸，我们实际上不想为每一个加载一份僵尸图形到 GPU 中。

我们还将深入了解面向对象编程，并使用静态函数，这是一个可以在没有类实例的情况下调用的类函数。同时，我们将看到如何设计一个类，以确保只能存在一个实例。当我们需要保证代码的不同部分将使用相同的数据时，这是理想的。

在这一章中，我们将：

+   学习指针

+   学习 STL

+   使用静态函数和单例类实现 Texture Holder 类

+   实现一个指向一群僵尸的指针

+   编辑一些现有的代码，使用 TextureHolder 类为玩家和背景

第九章, *碰撞检测、拾取物品和子弹*，到目前为止，我们已经实现了游戏的主要视觉部分。我们有一个可控制的角色在一个充满追逐他的僵尸的竞技场中奔跑。问题是它们彼此之间没有互动。僵尸可以毫无阻碍地穿过玩家。我们需要检测僵尸和玩家之间的碰撞。

如果僵尸能够伤害并最终杀死玩家，那么给玩家一些子弹是公平的。然后我们需要确保子弹能够击中并杀死僵尸。

同时，如果我们为子弹、僵尸和玩家编写碰撞检测代码，那么现在是添加一个用于健康和弹药拾取物品的类的好时机。

以下是我们将要做的事情和我们将要涵盖的顺序：

+   射击子弹

+   添加准星并隐藏鼠标指针

+   生成拾取物品

+   检测碰撞

第十章, *分层视图和实现 HUD*，在这一章中，我们将看到 SFML 视图的真正价值。我们将添加大量的 SFML 文本对象，并像之前在 Timber!!!项目中那样操纵它们。新的是我们将使用第二个视图实例来绘制 HUD。这样，HUD 将始终整齐地定位在主游戏动作的顶部，而不管背景、玩家、僵尸和其他游戏对象在做什么。

我们将做以下事情：

+   在主页/游戏结束屏幕上添加文本和背景

+   在升级屏幕上添加文本

+   创建第二个视图

+   添加 HUD

第十一章, *音效、文件 I/O 和完成游戏*，我们快要完成了。这一小节将演示我们如何使用 C++标准库轻松操作存储在硬盘上的文件，我们还将添加音效。当然，我们知道如何添加音效，但我们将讨论在代码中`play`的调用应该放在哪里。我们还将收尾一些松散的地方，使游戏完整。在这一章中，我们将做以下事情：

+   保存和加载最高分

+   添加音效

+   允许玩家升级

+   创建无尽的多波次

第十二章 ，*抽象和代码管理-更好地利用 OOP*，在本章中，我们将首次查看本书的最终项目。该项目将具有高级功能，例如与玩家位置相关的从扬声器发出的定向声音。它还将具有分屏合作游戏。此外，该项目将介绍着色器的概念，这是用另一种语言编写的直接在图形卡上运行的程序。到第十六章 结束时，您将拥有一个完全功能的多人平台游戏，其风格类似于经典游戏 Thomas Was Alone。本章的主要重点将是启动项目，特别是探索如何构造代码以更好地利用 OOP。以下是本章的详细信息。

+   介绍最终项目 Thomas Was Late，包括游戏功能和项目资产

+   详细讨论我们将如何改进代码结构，与之前的项目相比

+   编写 Thomas Was Late 游戏引擎

+   实现分屏功能

第十三章 ，*高级 OOP-继承和多态*，在本章中，我们将通过查看继承和多态的略微更高级的概念，进一步扩展我们对 OOP 的知识。然后，我们将能够使用这些新知识来实现我们游戏的明星角色 Thomas 和 Bob。以下是我们将更详细地涵盖的内容：

+   学习如何使用继承扩展和修改类

+   使用多态将类的对象视为多种类型的类

+   学习抽象类以及设计从未实例化的类如何实际上是有用的

+   构建一个抽象的`PlayableCharacter`类

+   使用继承与`Thomas`和`Bob`类

+   将 Thomas 和 Bob 添加到游戏项目

第十四章 ，*构建可玩关卡和碰撞检测*，本章可能是本项目中最令人满意的章节之一。原因是到最后，我们将拥有一个可玩的游戏。尽管还有一些功能需要实现（声音、粒子效果、HUD、着色器效果），但 Bob 和 Thomas 将能够奔跑、跳跃和探索世界。此外，您将能够通过简单地在文本文件中创建平台和障碍物，轻松创建几乎任何大小或复杂度的自己的关卡设计。我们将通过以下主题实现所有这些：

+   探索如何在文本文件中设计关卡

+   构建`LevelManager`类，该类将从文本文件加载关卡，将其转换为我们的游戏可以使用的数据，并跟踪关卡细节，如生成位置、当前关卡和允许的时间限制

+   更新游戏引擎以使用`LevelManager`

+   编写一个多态函数来处理 Bob 和 Thomas 的碰撞检测

第十五章 ，*声音空间化和 HUD*，在本章中，我们将添加所有的音效和 HUD。我们在之前的两个项目中都做过这个，但这次我们会有所不同。我们将探索声音空间化的概念，以及 SFML 如何使这个本来复杂的概念变得简单易行；此外，我们将构建一个 HUD 类来封装我们的代码，将信息绘制到屏幕上。

我们将按照以下顺序完成这些任务：

+   什么是空间化？

+   SFML 如何处理空间化

+   构建一个`SoundManager`类

+   部署发射器

+   使用`SoundManager`类

+   构建`HUD`类

+   使用 `HUD` 类

第十六章, *扩展 SFML 类、粒子系统和着色器*，在这一章中，我们将探讨 C++ 中扩展其他人类的概念。更具体地说，我们将研究 SFML `Drawable` 类以及将其用作我们自己类的基类的好处。我们还将浅尝 OpenGL 着色器的主题，并看看如何使用另一种语言（GLSL）编写代码，该代码可以直接在图形卡上运行，从而产生可能以其他方式不可能实现的平滑图形效果。像往常一样，我们还将使用我们的新技能和知识来增强当前项目。

以下是我们将按顺序涵盖的主题列表：

+   SFML 可绘制

+   构建粒子系统

+   OpenGl 着色器和 GLSL

+   在《Thomas Was Late》游戏中使用着色器

第十七章，“在你离开之前...”，快速讨论接下来可能要做的事情。

# 本书所需的内容

+   Windows 7 Service Pack 1、Windows 8 或 Windows 10

+   1.6 GHz 或更快的处理器

+   1 GB 的 RAM（对于 x86）或 2 GB 的 RAM（对于 x64）

+   15 GB 的可用硬盘空间

+   5400 RPM 硬盘驱动器

+   DirectX 9 兼容的视频卡，支持 1024 x 768 或更高的显示分辨率

本书中使用的所有软件都是免费的。在书中逐步介绍了获取和安装软件的步骤。本书始终在 Windows 上使用 Visual Studio，但有经验的 Linux 用户可能不会在其喜爱的 Linux 编程环境中运行代码和按照说明出现问题。

# 本书适合对象

如果以下任何情况描述您，本书非常适合您：您完全不了解 C++ 编程，或需要初学者级别的复习课程；如果您想学习制作游戏或者只是想以一种引人入胜的方式学习 C++；如果您有志于有朝一日发布游戏，也许是在 Steam 上；或者如果您只是想玩得开心，并以您的创作给朋友留下深刻印象。

# 约定

在本书中，您将找到一些区分不同信息种类的文本样式。以下是这些样式的一些示例及其含义的解释。

文本中的代码词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 句柄显示如下："我们可以通过使用 include 指令包含其他上下文。"

代码块设置如下：

```cpp
[default]
exten => s,1,Dial(Zap/1|30)
exten => s,2,Voicemail(u100)
exten => s,102,Voicemail(b100)
exten => i,1,Voicemail(s0)
```

当我们希望引起您对代码块的特定部分的注意时，相关行或项目将以粗体显示：

```cpp
[default]
exten => s,1,Dial(Zap/1|30)
exten => s,2,Voicemail(u100)
exten => s,102,Voicemail(b100)
exten => i,1,Voicemail(s0)
```

任何命令行输入或输出都将按如下方式书写：

```cpp
# cp /usr/src/asterisk-addons/configs/cdr_mysql.conf.sample     /etc/asterisk/cdr_mysql.conf

```

**新术语**和**重要单词**以粗体显示。您在屏幕上看到的单词，例如菜单或对话框中的单词，会以这种方式出现在文本中：“单击**下一步**按钮将您移至下一个屏幕。”

### 注意

警告或重要提示将以如下方式显示在一个框中。

### 提示

提示和技巧显示如下。

# 读者反馈

我们始终欢迎读者的反馈。请告诉我们您对本书的看法 - 您喜欢或不喜欢的地方。读者的反馈对我们很重要，因为它可以帮助我们开发您真正能够充分利用的标题。要向我们发送一般反馈，只需发送电子邮件至 feedback@packtpub.com，并在消息主题中提及书名。如果您在某个专题上有专业知识，并且有兴趣撰写或为书籍做出贡献，请参阅我们的作者指南，网址为 [www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

既然您是 Packt 书的自豪所有者，我们有许多东西可以帮助您充分利用您的购买。

## 下载示例代码

您可以从[`www.packtpub.com`](http://www.packtpub.com)的帐户中下载本书的示例代码文件。如果您在其他地方购买了本书，您可以访问[`www.packtpub.com/support`](http://www.packtpub.com/support)并注册，以便将文件直接发送到您的电子邮件。

您可以按照以下步骤下载代码文件：

1.  使用您的电子邮件地址和密码登录或注册到我们的网站。

1.  将鼠标指针悬停在顶部的**支持**选项卡上。

1.  点击**代码下载和勘误**。

1.  在**搜索**框中输入书名。

1.  选择您要下载代码文件的书。

1.  从下拉菜单中选择您购买本书的地点。

1.  点击**代码下载**。

下载了文件后，请确保使用最新版本的解压缩软件解压或提取文件夹：

+   WinRAR / 7-Zip for Windows

+   Zipeg / iZip / UnRarX for Mac

+   7-Zip / PeaZip for Linux

该书的代码包也托管在 GitHub 上，网址为[`github.com/PacktPublishing/Beginning-Cpp-Game-Programming`](https://github.com/PacktPublishing/CHANGE THIS)。我们还有来自丰富书籍和视频目录的其他代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)上找到。快去看看吧！

## 下载本书的彩色图像

我们还为您提供了一个 PDF 文件，其中包含本书中使用的屏幕截图/图表的彩色图像。彩色图像将帮助您更好地理解输出中的变化。您可以从[`www.packtpub.com/sites/default/files/downloads/BeginningCppGameProgramming_ColorImages.pdf`](https://www.packtpub.com/sites/default/files/downloads/BeginningCppGameProgramming_ColoredImages.pdf)下载此文件。

## 勘误

尽管我们已经尽一切努力确保内容的准确性，但错误是难免的。如果您在我们的书中发现错误——可能是文本或代码中的错误——我们将不胜感激，如果您能向我们报告。通过这样做，您可以帮助其他读者免受挫折，并帮助我们改进本书的后续版本。如果您发现任何勘误，请访问[`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)报告错误，选择您的书，点击**勘误提交表**链接，并输入您的勘误详情。一旦您的勘误被验证，您的提交将被接受，并且勘误将被上传到我们的网站或添加到该标题的勘误部分下的任何现有勘误列表中。

要查看先前提交的勘误，请转到[`www.packtpub.com/books/content/support`](https://www.packtpub.com/books/content/support)并在搜索字段中输入书名。所需信息将出现在**勘误**部分下。

## 盗版

互联网上的盗版行为是所有媒体的持续问题。在 Packt，我们非常重视版权和许可的保护。如果您在互联网上发现我们作品的任何非法副本，请立即向我们提供位置地址或网站名称，以便我们采取补救措施。

请通过 copyright@packtpub.com 与我们联系，并提供涉嫌盗版材料的链接。

感谢您帮助我们保护我们的作者和为您提供有价值的内容的能力。

## 问题

如果您对本书的任何方面有问题，您可以通过 questions@packtpub.com 与我们联系，我们将尽力解决问题。
