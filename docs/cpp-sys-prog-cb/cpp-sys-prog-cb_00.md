# 前言

这本书旨在为系统编程的基本方面提供现成的解决方案（给开发人员），尽可能使用最新的 C++标准。系统编程涉及构建与操作系统密切交互的计算机程序，并允许计算机硬件与程序员和用户进行接口。由于其高效的特性，即低级计算、数据抽象和面向对象的特性，C++是系统编程的首选语言。您将学习如何创建健壮和并发的系统，还将了解共享内存和管道的进程间通信机制。此外，您将深入研究 C++内置库和框架，以便根据您的需求设计健壮的系统。

# 这本书是为谁准备的

这本书适用于想要获得系统编程实际知识的 C++开发人员。虽然不需要有 Linux 系统编程的经验，但需要具备中级的 C++知识。

# 这本书涵盖了什么

第一章，*开始系统编程*，介绍了基本知识，如学习 shell、用户和组、进程 ID 和线程 ID，以便能够熟练使用 Linux 系统等等，这些是您必须了解的，以便能够阅读本书的其余部分。例如，您将学习 Linux 的设计、shell、用户和组、进程 ID 和线程 ID。此外，您还将学习如何开发一个简单的`Hello World`程序，编写其 makefile，执行它并进行调试。尽管这些知识很基础，但对于后面章节中将出现的更高级的主题来说是基础性的。

第二章，*重温 C++*，重新理解 C++17，这将贯穿整本书。它将展示为什么 C++代表了编写高质量、简洁和更具可移植性的代码的绝佳机会。本章包含了 C++11/17/20 引入的所有新特性，这些特性在本书中会很有用。

第三章，*处理进程和线程*，介绍了进程和线程，这是任何详细说明的基础。一个程序很少只由一个进程组成。本章揭示了处理 C++中线程和进程的技术。本章将演示如何处理线程（和任务）相对于 POSIX 来说是多么简单和方便。虽然 C++没有正式的创建进程的方式，但在极少数情况下，线程无法完成工作。

第四章，*深入探讨内存管理*，介绍了内存，这是处理系统开发的核心概念之一。分配、释放内存，以及了解内存管理和 C++可以提供的简化和管理内存的方法至关重要。此外，本章介绍了如何检查和分配对齐内存以及如何处理内存映射 I/O 的方法。

第五章，*使用互斥锁、信号量和条件变量*，向我们展示了 POSIX 机制解决方案以及 C++提供的同步线程和进程的方法。

第六章，*管道、先进先出（FIFO）、消息队列和共享内存*，着重于使进程之间进行通信。有不同的解决方案可用——管道、FIFO、消息队列和共享内存。对于每种进程间通信机制，都提供了一种解决方案。

第七章，*网络编程*，演示了通信从连接到结束的过程。不同机器上的进程之间的通信是当今互联网的基础，TCP/IP 是事实上的标准。**TCP**（传输控制协议）和**UDP**（用户数据报协议）将被详细描述，前者代表面向连接的，后者代表无连接的。这在当今是非常重要的，特别是在线视频流服务的可用性。

第八章，*处理控制台 I/O 和文件*，为您提供了处理文件、控制台 I/O 和字符串流的有用配方。

第九章，*处理时间接口*，为您提供了如何处理和测量 C++和 POSIX 提供的功能的深入理解。本章将为每种方法提供现成的配方。

第十章，*管理信号*，向我们介绍了软件中断信号。它们提供了一种管理异步事件的方式。例如，用户从终端键入中断键，或者另一个进程发送必须被管理的信号。每个信号都以`SIG`开头（例如`SIGABRT`）。本章将向读者展示如何编写代码来正确管理软件中断，Linux 为每个信号定义的默认操作是什么，以及如何覆盖它们。

第十一章，*调度*，向您展示如何使用 POSIX（C++标准不提供此功能）来设置调度程序参数、调度程序策略和调度程序优先级。系统编程是关于与底层操作系统的交互，调度程序是每个操作系统的主要组件之一，影响进程在 CPU 上的分配方式。有些情况下，开发人员需要对此进行控制，或者至少试图影响调度程序。

# 为了充分利用本书

以下是本书的要求列表：

+   中级 C++知识。

+   每章的*技术要求*部分提到了任何额外的要求。

+   免责声明：C++20 标准已经在二月底的布拉格会议上由 WG21 批准（即技术上已经最终确定）。这意味着本书使用的 GCC 编译器版本 8.3.0 不包括（或者对 C++20 的新功能支持非常有限）。因此，Docker 镜像不包括 C++20 的配方代码。

GCC 将最新功能的开发保留在分支中（您必须使用适当的标志，例如`-std=c++2a`）；因此，鼓励您自己尝试。因此，克隆并探索 GCC 合同和模块分支，并且玩得开心。

+   一些配方（特别是第十一章，*调度*）需要 Docker 镜像以管理员权限运行才能正确执行。根据您的 Docker 配置，您可能需要使用`sudo`来运行 Docker。为了避免这种情况，您可以创建一个 Linux 组（例如`docker`）并将用户添加到其中。

# 下载示例代码文件

您可以从[www.packt.com](http://www.packt.com)的帐户中下载本书的示例代码文件。如果您在其他地方购买了本书，可以访问[www.packtpub.com/support](https://www.packtpub.com/support)注册并直接将文件发送到您的邮箱。

您可以按照以下步骤下载代码文件：

1.  在[www.packt.com](http://www.packt.com)上登录或注册。

1.  选择支持选项卡。

1.  单击代码下载。

1.  在搜索框中输入书名，然后按照屏幕上的指示操作。

下载文件后，请确保使用以下最新版本的解压缩或提取文件夹：

+   Windows 的 WinRAR/7-Zip

+   Mac 的 Zipeg/iZip/UnRarX

+   Linux 的 7-Zip/PeaZip

该书的代码包也托管在 GitHub 上，网址为[`github.com/PacktPublishing/C-System-Programming-Cookbook`](https://github.com/PacktPublishing/C-System-Programming-Cookbook)。如果代码有更新，将在现有的 GitHub 存储库上进行更新。

我们还有来自丰富书籍和视频目录的其他代码包，可在**[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)**上找到。去看看吧！

# 下载彩色图片

我们还提供了一个 PDF 文件，其中包含本书中使用的屏幕截图/图表的彩色图像。您可以在这里下载：[`static.packt-cdn.com/downloads/9781838646554_ColorImages.pdf`](https://static.packt-cdn.com/downloads/9781838646554_ColorImages.pdf)。

# 代码实战

请访问以下链接查看 CiA 视频：[`bit.ly/2uXftdA`](http://bit.ly/2uXftdA)

# 使用的约定

本书中使用了许多文本约定。

`CodeInText`：表示文本中的代码词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 句柄。例如："在第二步中，我们开始开发`main`方法。"

代码块设置如下：

```cpp
 std::cout << "Start ... " << std::endl;
    {
        User* developer = new User();
        developer->cheers();
        delete developer;
    }
```

当我们希望引起您对代码块的特定部分的注意时，相关行或项目将以粗体显示：

```cpp
auto* mapPtr = static_cast<T*> (mmap(0, sizeof(T) * n, 
                                PROT_READ | PROT_WRITE, 
```

任何命令行输入或输出都是这样写的：

```cpp
 $ grep "text" filename
 $ ls -l | grep filename 
```

**粗体**：表示新术语、重要单词或屏幕上看到的单词。例如，菜单或对话框中的单词会在文本中出现。例如："从管理面板中选择系统信息。"

警告或重要说明看起来像这样。

提示和技巧看起来像这样。

# 章节

在本书中，您会经常看到几个标题（*准备工作*、*如何做*、*工作原理*、*还有*和*另请参阅*）。

为了清晰地说明如何完成食谱，请使用以下各节。

# 准备工作

本节告诉您在食谱中可以期待什么，并描述了为食谱设置任何软件或所需的任何初步设置。

# 如何做…

本节包含按照食谱所需的步骤。

# 工作原理…

本节通常包括对前一节发生的事情的详细解释。

# 还有…

本节包括有关食谱的其他信息，以使您对食谱更加了解。

# 另请参阅

本节提供了有关食谱的其他有用信息的有用链接。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**：如果您对本书的任何方面有疑问，请在邮件主题中提及书名，并发送电子邮件至`customercare@packtpub.com`。

**勘误**：尽管我们已经尽一切努力确保内容的准确性，但错误确实会发生。如果您在本书中发现错误，我们将不胜感激。请访问[www.packtpub.com/support/errata](https://www.packtpub.com/support/errata)，选择您的书，点击勘误提交表格链接，并输入详细信息。

**盗版**：如果您在互联网上发现我们作品的任何形式的非法副本，我们将不胜感激。请通过链接或网站名称与我们联系，链接地址为`copyright@packt.com`。

**如果您有兴趣成为作者**：如果您在某个专题上有专业知识，并且有兴趣撰写或为书籍做出贡献，请访问[authors.packtpub.com](http://authors.packtpub.com/)。

# 评论

请留下评论。当您阅读并使用了这本书之后，为什么不在购买它的网站上留下评论呢？潜在的读者可以看到并使用您的客观意见来做出购买决定，我们在 Packt 可以了解您对我们产品的看法，我们的作者也可以看到您对他们书籍的反馈。谢谢！

关于 Packt 的更多信息，请访问 [packt.com](http://www.packt.com/)。
