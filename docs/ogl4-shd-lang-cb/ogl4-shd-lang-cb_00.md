# 前言

OpenGL 着色语言（GLSL）现在是使用 OpenGL 编程的基本和关键部分。它通过使以前固定功能的图形管道可编程，为我们提供了前所未有的灵活性和强大的功能。使用 GLSL，我们可以利用图形处理单元（GPU）实现高级和复杂的渲染技术，甚至进行任意计算。由于细分着色器和计算着色器等着色阶段，使用 GLSL 4.x，程序员可以利用 GPU 做比以前更多的事情。

在这本书中，我们涵盖了 GLSL 编程的全谱系。从使用顶点和片段着色器进行着色的基础开始，我们带你从简单到高级技术。从纹理、阴影和图像处理，到噪声和粒子系统，我们提供了实用的例子，以给你在项目中利用 GLSL 所需的工具。我们还涵盖了如何使用几何着色器、细分着色器以及 GLSL 的最新补充：计算着色器。有了这些，你可以利用 GPU 执行超越仅着色的各种任务。使用几何和细分着色器，我们可以创建额外的几何形状或修改几何形状，而使用计算着色器，我们可以在 GPU 上执行任意计算。

对于那些刚开始接触 GLSL 的人来说，最好按顺序阅读这本书，从第一章，“GLSL 入门”开始。这些食谱会引导你从基础到高级技术。对于对 GLSL 有更多经验的人，你可能觉得挑选特定的食谱并直接跳到那里会更好。大多数食谱都是独立的，但有些可能会引用其他食谱。每章的介绍都提供了关于主题的重要一般信息，所以你可能还想阅读这些内容。

GLSL 4.x 使使用 OpenGL 编程更加有趣和有益。我真诚地希望你觉得这本书有用，并且在你自己的项目中使用这些食谱作为起点。我希望你觉得在 OpenGL 和 GLSL 中的编程和我一样愉快，并且这些技术能激发你创造美丽的图形。

# 这本书面向的对象

这本书的主要重点是 OpenGL 着色语言（GLSL）。因此，我们不花时间讨论使用 OpenGL 进行编程的基础。在这本书中，我假设读者在 OpenGL 编程方面有一些经验，并理解 3D 渲染概念，如模型坐标、视图坐标、裁剪坐标、透视变换以及其他相关变换。然而，没有假设任何着色器编程的经验，所以如果你是 GLSL 的新手，这是一个很好的起点。

如果你是一名希望学习 GLSL 编程的 OpenGL 程序员，那么这本书就是为你准备的。即使你有一些着色器编程经验，你也可能会发现这本书中的食谱非常有价值。我们涵盖了从简单到高级的各种技术，并使用了一些最新的 OpenGL 特性（如计算着色器和细分着色器）。因此，那些希望学习如何使用这些新特性的经验丰富的 GLSL 程序员也可能发现这本书很有用。

简而言之，这本书是为那些理解 OpenGL 3D 图形基础并希望学习 GLSL 或利用现代 GLSL 4.x 中的一些最新特性的程序员而编写的。

# 本书涵盖的内容

第一章，*GLSL 入门*，解释了在 OpenGL 程序中编译、链接和使用 GLSL 着色器的步骤。它还涵盖了如何保存和加载着色器二进制文件，以及如何使用 SPIR-V 与 OpenGL 一起使用。它还涵盖了使用 GLM 库进行数学支持。

第二章，*与 GLSL 程序一起工作*，介绍了着色器程序和 OpenGL 程序之间通信的基本知识。它涵盖了如何使用属性和统一变量向着色器发送数据，如何枚举变量，如何处理着色器管线，并提供了一个着色器程序类的示例。

第三章，*GLSL 着色器基础*，通过顶点着色介绍了 GLSL 编程的基础。在本章中，你可以看到基本着色技术，如 Phong 模型、双面着色和平滑着色。它还涵盖了基本 GLSL 概念，如函数和子程序。

第四章，*光照与着色*，继续介绍基本着色技术，重点关注片段着色器。它介绍了 Blinn-Phong 模型、聚光灯、片段着色、卡通着色、雾效以及基于物理的反射模型等技术。

第五章，*使用纹理*，提供了一系列涉及在 GLSL 着色器中使用纹理的食谱。纹理除了简单地“粘贴”图像到表面之外，还可以用于多种目的。在本章中，我们介绍了使用一个或多个 2D 纹理的基本应用，以及包括 alpha 图、法线图、视差贴图、立方体贴图、投影纹理、纹理渲染和基于扩散图像的照明在内的各种其他技术。我们还涵盖了采样器对象，这是一个相对较新的特性，它将采样参数与纹理对象本身解耦。

第六章，*图像处理和屏幕空间技术*，解释了渲染图像后处理的一些常见技术以及一些其他屏幕空间技术。图像后处理正成为现代游戏引擎和其他渲染管线中至关重要的一个部分。本章讨论了如何实现一些更常见的后处理技术，如色调映射、辉光、模糊、伽玛校正和边缘检测。我们还涵盖了屏幕空间渲染技术，如延迟着色、多重采样抗锯齿、屏幕空间环境遮挡和顺序无关透明度。

第七章，*使用几何和细分着色器*，介绍了如何使用这些强大的着色阶段的技术。阅读本章后，你应该会对它们的基本功能感到舒适，并了解如何使用它们。我们涵盖了如几何着色器生成的点精灵、轮廓线、基于深度的细分、贝塞尔曲面等技术。

第八章，*阴影*，介绍了产生实时阴影的基本技术。本章包括两种最常见阴影技术的配方：阴影贴图和阴影体积。我们涵盖了抗锯齿阴影贴图的常见技术，以及如何使用几何着色器帮助生成阴影体积。

第九章，*在着色器中使用噪声*，介绍了使用 Perlin 噪声创建各种效果的方法。第一个配方展示了如何使用 GLM（一个强大的数学库）创建包含噪声数据的各种纹理。然后我们转向使用噪声纹理创建木纹、云彩、破碎、油漆和静态等效果的配方。

第十章，*粒子系统和动画*，专注于创建粒子系统的技术。我们看到了如何创建一个粒子系统来模拟火焰、烟雾和水。我们还利用 OpenGL 中的变换反馈功能，将粒子更新移动到 GPU 上，以获得额外的效率。

第十一章，*使用计算着色器*，介绍了利用 OpenGL 最新特性之一——计算着色器的一些技术。计算着色器为我们提供了在 OpenGL 中进行通用计算的能力。在本章中，我们讨论了如何使用计算着色器进行粒子模拟、布料模拟、边缘检测以及生成程序化分形纹理。阅读本章后，读者应该对如何使用计算着色器进行任意计算任务有很好的感觉。

# 为了充分利用这本书

本书中的食谱使用了 OpenGL 4.x 中一些最新和最出色的功能。因此，为了实现这些功能，您需要支持至少 OpenGL 4.6 的图形硬件（显卡或集成 GPU）和驱动程序。然而，许多食谱也可以在早期版本上运行。如果您不确定您的设置支持哪个版本的 OpenGL，有许多实用程序可以帮助确定这些信息。一个选项是 Realtech VR 的 GLview，可在以下网址找到：[`www.realtech-vr.com/glview/`](http://www.realtech-vr.com/glview/)。

如果您正在运行 Windows 或 Linux，大多数现代硬件都提供了可用的驱动程序。然而，如果您正在使用 macOS，不幸的是，您将卡在 OpenGL 4.1 上。苹果公司已正式弃用 OpenGL，因此不会有任何官方更新。但是，大量这些食谱将在 OpenGL 4.1 下运行（有时需要一些小的调整）。

一旦您已验证您拥有所需的 OpenGL 驱动程序，您还需要以下内容：

+   C++编译器。在 Linux 上，GNU 编译器集合（gcc、g++等）可能已经可用，如果没有，则应通过您的发行版的软件包管理器提供。在 Windows 上，Microsoft Visual Studio 将工作得很好，但如果您没有副本，那么 MinGW 编译器（可在[`mingw.org/`](http://mingw.org/)找到）是一个不错的选择。

+   GLFW 库版本 3.0 或更高版本，可在[`www.glfw.org/`](http://www.glfw.org/)找到。此库提供 OpenGL 上下文创建、窗口支持和用户输入事件支持。

+   GLM 库版本 0.9.6 或更高版本，可在[`glm.g-truc.net/`](http://glm.g-truc.net/)找到。此库提供矩阵、向量、常见变换、噪声函数等数学支持类。

# 下载示例代码文件

您可以从[www.packtpub.com](http://www.packtpub.com)的账户下载本书的示例代码文件。如果您在其他地方购买了此书，您可以访问[www.packtpub.com/support](http://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给您。

您可以通过以下步骤下载代码文件：

1.  在[www.packtpub.com](http://www.packtpub.com/support)登录或注册。

1.  选择“支持”选项卡。

1.  点击“代码下载与勘误表”。

1.  在搜索框中输入书籍名称，并按照屏幕上的说明操作。

一旦文件下载完成，请确保您使用最新版本解压缩或提取文件夹，以下是一些选项：

+   WinRAR/7-Zip for Windows

+   Zipeg/iZip/UnRarX for Mac

+   7-Zip/PeaZip for Linux

本书代码包也托管在 GitHub 上，网址为[`github.com/PacktPublishing/OpenGL-4-Shading-Language-Cookbook-Third-Edition`](https://github.com/PacktPublishing/OpenGL-4-Shading-Language-Cookbook-Third-Edition)。如果代码有更新，它将在现有的 GitHub 仓库中更新。

我们还有其他来自我们丰富图书和视频目录的代码包，可在**[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)**找到。查看它们吧！

# 下载彩色图像

我们还提供了一个包含本书中使用的截图/图表彩色图像的 PDF 文件。

书籍。您可以从这里下载：[`www.packtpub.com/sites/default/files/downloads/9781789342253_ColorImages.pdf`](https://www.packtpub.com/sites/default/files/downloads/9781789342253_ColorImages.pdf)。

# 使用的约定

本书使用了多种文本约定。

`CodeInText`: 表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“着色器将通过内置变量如`gl_Vertex`和`gl_Normal`访问这些值。”

代码块设置如下：

```cpp
void main() 
{ 
  Color = VertexColor; 

  gl_Position = vec4(VertexPosition,1.0); 
}
```

任何命令行输入或输出都如下所示：

```cpp
Active attributes:
    1    VertexColor (vec3)
    0    VertexPosition (vec3)
```

**粗体**: 表示新术语、重要单词或你在屏幕上看到的单词。例如，菜单或对话框中的单词在文本中显示如下。以下是一个示例：“现在我们已经设置了缓冲区对象，我们将它们绑定在一起形成一个**顶点数组对象**（**VAO**）。”

警告或重要提示看起来像这样。

小贴士和技巧看起来像这样。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**: 如果你对本书的任何方面有疑问，请在邮件主题中提及书名，并通过`customercare@packtpub.com`给我们发送邮件。

**勘误表**: 尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，我们将不胜感激，如果您能向我们报告这一点。请访问[www.packt.com/submit-errata](http://www.packt.com/submit-errata)，选择您的书，点击勘误提交表链接，并输入详细信息。

**盗版**: 如果你在互联网上以任何形式遇到我们作品的非法副本，如果你能提供位置地址或网站名称，我们将不胜感激。请通过`copyright@packt.com`与我们联系，并附上材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为本书做出贡献，请访问[authors.packtpub.com](http://authors.packtpub.com/)。

# 评论

请留下评论。一旦您阅读并使用了这本书，为何不在您购买它的网站上留下评论？潜在的读者可以查看并使用您的客观意见来做出购买决定，Packt 公司可以了解您对我们产品的看法，我们的作者也可以看到他们对书籍的反馈。谢谢！

如需更多关于 Packt 的信息，请访问[packt.com](http://www.packt.com/)。
