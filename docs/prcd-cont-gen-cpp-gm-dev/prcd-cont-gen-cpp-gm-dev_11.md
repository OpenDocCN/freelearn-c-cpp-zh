# 第十一章：结语

我们的游戏已经完成，经过一次快速的组件设计探索，我们对程序内容生成的介绍也完成了。我们从生成和使用随机数开始，一直到创建复杂的程序行为和内容。我们涉及了许多主题，希望通过这本书的学习，能够帮助定义程序生成是什么，并提供一些如何在游戏中实现它的实例。

在你最后关闭这本书之前，让我们快速回顾一下项目，看看我们是如何以及在哪里实现程序生成的。然后在完成我们的工作之前，我们将再次重申它的优缺点。

# 项目分解

我们的游戏项目最初是一个空白的地牢游戏模板，功能有限，但通过我们的工作，我们将其变成了一个完全成熟的程序生成地牢游戏。让我们回顾一下项目，看看我们如何使用程序生成来实现这一点。

如果你希望深入探讨每一章的话，我们还将提供一些可能的进一步练习。这本书的目标是向你介绍这个主题的基础知识，希望你在进一步学习时能够快速上手。

## 程序生成环境

我们首先在关卡周围随机生成游戏物品。这涉及在给定范围内生成随机数，并将其用作瓷砖索引和枚举器值。这是我们第一次使用随机数和枚举器来选择随机值和物品，这是我们在整本书中都大量依赖的技术。

如果你希望进一步探索，可以看看如何偏向物品的生成位置，或者限制它在地图的某些区域。例如，你可以偏向生成位置，使所有宝石倾向于生成在关卡的右侧，所有黄金倾向于生成在左侧。虽然对我们的项目没有立即好处，但你可以想象在其他情况下它可能有用。你可能希望所有的敌人生成在关卡的某个特定部分，或者某个物品生成在地图的某个区域。更多地控制游戏关卡将非常有益。

## 创建独特和随机的游戏对象

现在我们的物品已经分布在各个关卡中，我们开始关注如何使它们更随机和独特。我们不是在运行时硬编码物品变量，而是在运行时生成它们，使物品更加多样化。我们使用这种技术从一个类中创建多个对象类型，比如所有药水都来自同一个类。

在项目中进一步扩展这一点，为什么不尝试添加一些随机的护甲和/或武器呢？它们可以被敌人掉落，并具有随机的精灵和统计数据。你可以采用我们在药水中采用的相同方法，创建一个模糊的类，可以生成各种可能性。

## 程序生成艺术

在本章中，我们看了如何通过程序生成艺术。我们从简单的方法开始，使用 SFML 内置的精灵修改函数，然后转向更复杂的方法，通过将多个精灵组件一起渲染，创建新的、独特的精灵，给敌人随机生成护甲。

如果你想学到更多，你应该看看如何完全从头开始创建艺术。有一些算法，比如 Perlin 和 Simplex 噪声，可以生成 2D 噪声。这些算法可以作为程序纹理的基础。开始研究这些算法，然后从那里开始。

## 程序修改音频的生成。

通过程序生成音频是一项复杂的任务。因此，在本章中，我们的工作有些简短，而且真正局限于对现有声音进行程序修改，而不是完全创作它们。与艺术一样，SFML 提供了一系列编辑声音的功能，比如音调和音量，这些功能被用来给简单的声音增加一些变化。然后，我们使用 SFML 的内置音频功能创建了空间化的 3D 声音，为我们的游戏增添了一些深度。

声音可以完全通过程序生成，但这是一个复杂而困难的过程，因此与其他程序实现相比并不那么受欢迎。然而，如果你想进一步了解这一点，也许可以先创建单个声音并学习计算机如何产生它们。从这里开始，就是学习如何将这些声音组合在一起创造出吸引人的东西，然后生成一个程序算法来实现。这绝对不是一件简单的事情！

## 程序行为和机制

从简单使用随机数和从枚举器中选择值开始，我们实现了一个更复杂和丰富的程序系统，为敌人提供了基本的 AI 形式的路径规划。我们实现了 A*路径规划，使敌人能够在迷宫中追逐玩家。我们还创建了一个系统来生成随机的关卡目标，因此现在我们的玩家定期会面临一个独特的目标，以换取独特的奖励。

我们生成的游戏机制相当简单，那么为什么不试着自己生成一些更复杂的呢？你可以给玩家一个真正需要完成的任务，以便继续玩游戏。或者，如果是 AI 工作吸引了你，你可以在此基础上进行扩展，使敌人更聪明，更具挑战性。也许如果他们失去了对玩家的视线，他们会停止追逐，或者他们会试图预测玩家的移动来挡住你，而不仅仅是跟随。

## 程序生成地牢

作为我们的巅峰之作，我们实现了程序生成地牢。在此之前，关卡是从文本文件中加载的，但我们实现了一个递归回溯算法来生成一个迷宫，然后在迷宫中添加房间以创建更开阔的区域。因此，关卡现在是程序生成的，我们可以通过一个函数调用生成一个新的关卡。

有很多方法可以用来实现程序生成地牢，以及许多不同的算法可以用于此。如果你对这个领域感兴趣，有很多探索的空间。看看一些替代算法，并尝试实现。尝试生成一些具有不同特征的房间，或者添加一些环境和美学特征，给关卡增添更多特色。

### 提示

进一步阅读的好资源是[`weblog.jamisbuck.org/`](http://weblog.jamisbuck.org/)。这个博客是关于迷宫生成的一切的宝库，涵盖了许多算法。你一定要去看看。

## 基于组件的架构

程序内容生成围绕灵活性展开，因此，我觉得涉及基于组件的设计会是结束我们工作的一个好方法。通过基于组件的设计，我们可以创建一个灵活的代码基础，其固有的灵活性将使实施程序系统变得更容易。

在本章中，我们介绍了基于组件的设计的基本原理，并看了一些孤立的例子。一个很好的练习是运行项目，将其完全转换为基于组件的方法。这将使你真正熟悉这个概念，并且你将准备好在下一个项目中使用它。

# 程序生成的利与弊

最后一次，让我们来看看在我们的游戏中使用程序生成的主要利与弊。

## 利与弊

+   它创造了动态内容

+   它可以节省内存使用

+   它可以节省开发时间和金钱

+   它创造了大量的选择

+   它增加了可重复性

## 缺点

+   您放弃控制*

+   它可能会对硬件造成负担

+   可能会感觉重复

+   很难编写游戏事件的脚本

+   可能会生成无法使用的内容

### 注意

*您放弃的控制量取决于您的算法质量。最终，你是写算法的人。因此，你可以让它做你想要的事情。

# 总结

我希望你觉得这本书中的内容有用。目标是向您介绍程序生成的广泛主题，我觉得与真实游戏一起工作是最好的方法。我们涵盖了开发的关键领域，并确定了在每个方面使用程序生成的方法。希望现在您已经有足够的知识来在自己的游戏中使用它，并且可以进行进一步阅读，了解更多您最感兴趣的领域。

记住，程序生成不仅仅是一种方法或一种途径。它是内容的动态生成。没有一种正确的实现方式，所以要进行实验。找到新的动态创建内容的方法并进行尝试。没有错误的答案。

愉快的编程！
