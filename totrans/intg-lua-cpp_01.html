<html><head></head><body>
<div><div><h1 class="chapter-number" id="_idParaDest-15"><a id="_idTextAnchor014"/>1</h1>
<h1 id="_idParaDest-16"><a id="_idTextAnchor015"/>Getting Your C++ Project Lua-Ready</h1>
<p>Throughout the course of this book, you will learn how to integrate Lua into your C++ projects. Each chapter will be based on the knowledge learned from the previous chapters. This chapter teaches you how to prepare a C++ project in which to integrate Lua and introduces the tools used in this book so that you can understand the examples better. If you already know how to use some of the tools, please feel free to skip those sections. If not, feel free to do a deeper dive after going through this chapter.</p>
<p>In this chapter, we will cover the following topics:</p>
<ul>
<li>Compiling the Lua source code</li>
<li>Building a C++ project with the Lua library</li>
<li>Building a C++ project with the Lua source code</li>
<li>Executing a simple Lua script</li>
<li>Other toolchain options</li>
</ul>
<h1 id="_idParaDest-17"><a id="_idTextAnchor016"/>Technical requirements</h1>
<p>To follow this chapter and this book, you will require the following:</p>
<ul>
<li>A working C++ compiler, preferably the <strong class="bold">GNU C++ Compiler</strong> or <strong class="bold">Clang/LLVM</strong></li>
<li>A build automation tool, preferably <strong class="bold">Make</strong></li>
<li>The code editor of your choice</li>
<li>The Lua source code</li>
<li>The source code for this chapter: <a href="https://github.com/PacktPublishing/Integrate-Lua-with-CPP/tree/main/Chapter01">https://github.com/PacktPublishing/Integrate-Lua-with-CPP/tree/main/Chapter01</a></li>
</ul>
<p>You do not need prior Lua programming knowledge to understand this chapter. If you have any doubts relating to the Lua code examples in this chapter, that is fine; you can read it as C++ code, although there are syntax differences. You will learn Lua as you progress through this book. While it would be beneficial, you do not need to be a Lua expert if your focus is only on the C++ side.</p>
<p>We decided to use open-source compilers and build tools to work with the code examples in this book because they are readily available to everyone and are also the tools of choice in most large-scale projects.</p>
<p>If you are using a Linux or Mac development machine, the GNU C++ Compiler (or Clang/LLVM) and Make should already be installed. If not, please install the versions that are supported by your system. If you are a Windows user, you can go to the last section of this chapter first: <em class="italic">Other </em><em class="italic">toolchain options</em>.</p>
<p>The build tool used is called Make. In real projects, you might use other build tools. But Make is a fundamental option with no other dependencies, and other build tools share similar ideas, which makes it suitable for the purpose of this book. If you wish to, you can adapt the examples in this book to another build tool of your choice.</p>
<p>You can download the Lua source code from <a href="https://www.lua.org/download.xhtml">https://www.lua.org/download.xhtml</a>. You can select a specific version, but you will most likely wish to use the latest release. You can also clone the source code from Lua’s Git repository, here: <a href="https://www.github.com/lua/lua">https://www.github.com/lua/lua</a>. However, this is not officially recommended because Lua is stable and compact with infrequent changes.</p>
<h1 id="_idParaDest-18"><a id="_idTextAnchor017"/>Compiling the Lua source code</h1>
<p>There are many ways to access the Lua language. If you are using Linux, you can install Lua for <a id="_idIndexMarker000"/>development with the distribution’s package manager. For Windows, you can also find prebuilt binaries. However, since our goal is to integrate Lua into your C++ project, instead of using it as a standalone interpreter, it’s best to build from the source code yourself. When studying Lua, this will help you learn more about Lua. For example, in a modern code editor,<em class="italic"> Visual Studio Code</em> included, you can easily check the declaration and implementation of Lua library functions.</p>
<p>In this section, we will focus on compiling Lua from its source code. Unarchive the downloaded Lua source code archive. Most compression tools support this, and the Lua download site also gives instructions. When you have done this, you will see a simple folder structure:</p>
<pre class="source-code">
lua-5.4.6 % ls
Makefile README doc src</pre>
<p>We will learn <a id="_idIndexMarker001"/>what the preceding code block does in the next section.</p>
<p>The Lua source code package has a typical <strong class="bold">POSIX</strong> (think Linux and Unix) folder structure.</p>
<ul>
<li><code>Makefile</code> is the root <code>Makefile</code> for the package</li>
<li><code>src</code> subfolder contains the source code</li>
<li><code>doc</code> subfolder contains the documentation</li>
</ul>
<h2 id="_idParaDest-19"><a id="_idTextAnchor018"/>Introducing shell</h2>
<p>In this section, we will <a id="_idIndexMarker002"/>learn <a id="_idIndexMarker003"/>what a <code>zsh</code> (<code>Z</code> <code>shell</code>) on a POSIX machine. Another popular shell is <code>bash</code>, using which you can also run the examples in this <a id="_idIndexMarker004"/>book directly. Even if you use an <strong class="bold">Integrated Development Environment</strong> (<strong class="bold">IDE</strong>) and adapt the examples manually to your IDE, understanding the basics of shell commands can help you understand the examples better. All IDEs internally use various command line programs to do their work, which is similar to what we will be doing in a shell.</p>
<p>In very basic terms, a shell provides a command-line interface to the system. When you access a shell interactively, it could also be said that you are accessing a terminal. The words shell and terminal are sometimes used interchangeably, although they are technically different things. Thankfully, we do not need to worry about the terminology differences here. All systems with graphic user interfaces will also provide an application in which to <a id="_idIndexMarker005"/>start a shell. Often, those <a id="_idIndexMarker006"/>applications are called a <strong class="bold">terminal</strong> or a <strong class="bold">console</strong>.</p>
<p>You can start a shell and try the following commands. To find out which shell you are using, use this:</p>
<pre class="source-code">
% echo $SHELL
/bin/zsh</pre>
<p>The output <code>/bin/zsh</code> indicates that the shell in use is the <code>Z</code> shell.</p>
<p>To go to a directory, use the following command:</p>
<pre class="source-code">
cd ~/Downloads/lua-5.4.6
lua-5.4.6 %</pre>
<p><code>cd</code> is the command <a id="_idIndexMarker007"/>to change the current working directory. This goes <a id="_idIndexMarker008"/>into the Lua source code folder.</p>
<p>And, as you have seen previously, <code>ls</code> is the command to list the contents of a directory:</p>
<pre class="source-code">
lua-5.4.6 % ls
Makefile README doc src</pre>
<p>Another thing of importance is the <code>%</code> sign. It signifies a shell prompt, and different shells or user roles may see a different sign. The part before <code>%</code> is the current working directory. The part after <code>%</code> is what command you would type into the terminal.</p>
<p>This section is only meant to be a brief explanation. If you encounter a shell command that you do not know, check it out online.</p>
<h2 id="_idParaDest-20"><a id="_idTextAnchor019"/>Building Lua</h2>
<p>In a shell terminal, go to the unarchived Lua source code folder and execute <code>make all test</code>. If your toolchain <a id="_idIndexMarker009"/>is found to be working, you will have compiled the Lua library and command-line interpreter. Now, let’s inspect the files of interest:</p>
<pre class="source-code">
lua-5.4.6 % ls src/*.a src/lua
src/liblua.a src/lua</pre>
<p><code>liblua.a</code> is the Lua library you can link with. <code>lua</code> is the Lua command-line interpreter.</p>
<p>Let’s now try the interpreter to see if we can run it successfully:</p>
<pre class="source-code">
lua-5.4.6 % src/lua
Lua 5.4.6 Copyright (C) 1994-2022 Lua.org, PUC-Rio
&gt; 1+1
2
&gt; os.exit()</pre>
<p>In the terminal, execute <code>src/lua</code> to start the interactive Lua interpreter. First, enter <code>1+1</code>: Lua will print <a id="_idIndexMarker010"/>back a result of <code>2</code>. Then enter <code>os.exit()</code> to exit the Lua interpreter.</p>
<p>You have now successfully compiled the Lua library from its source code. Next, we will see how to use it in your project.</p>
<h1 id="_idParaDest-21"><a id="_idTextAnchor020"/>Building a C++ project with the Lua library</h1>
<p>Building your C++ project with the Lua library has the benefit of not having to include the 100+ Lua <a id="_idIndexMarker011"/>source files in your project and your <a id="_idIndexMarker012"/>source control system. However, it has some disadvantages as well. For example, if your project needs to support multiple platforms, you will need to maintain multiple pre-compiled libraries. In such a case, building from the Lua source code might be easier.</p>
<h2 id="_idParaDest-22"><a id="_idTextAnchor021"/>Creating a project to work with the Lua library</h2>
<p>In the previous section, we built the Lua library from the source code. Now, let’s extract it <a id="_idIndexMarker013"/>to use within our project.</p>
<p>Remember the <code>Makefile</code> in the root of the source code folder? Open it and you will find the two lines shown here:</p>
<pre class="source-code">
TO_INC= lua.h luaconf.h lualib.h lauxlib.h lua.hpp
TO_LIB= liblua.a</pre>
<p>These are the header files and the static library you need.</p>
<p>Create a folder for your project. Within it, create an empty source file named <code>main.cpp</code>, an empty <code>Makefile</code>, and two empty folders named <code>include</code> and <code>lib</code>. Copy the header files into the <code>include</code> folder and the library file into the <code>lib</code> folder. The project folder should look like this:</p>
<pre class="source-code">
project-with-lua-lib % tree
.
├── Makefile
├── lua
│   ├── include
│   │   ├── lauxlib.h
│   │   ├── lua.h
│   │   ├── lua.hpp
│   │   ├── luaconf.h
│   │   └── lualib.h
│   └── lib
│       └── liblua.a
└── main.cpp</pre>
<p>If you are <a id="_idIndexMarker014"/>using Linux, <code>tree</code> is a shell program used to print a folder’s hierarchy. If you don’t have <code>tree</code> installed, no need to worry. You can also examine the folder structure inside your preferred IDE.</p>
<h2 id="_idParaDest-23"><a id="_idTextAnchor022"/>Writing the C++ code</h2>
<p>We will write <a id="_idIndexMarker015"/>a simple C++ program to test whether we can link to the Lua library. In C++, you only need to include one header file for Lua: <code>lua.hpp</code>.</p>
<p>Write <code>main.cpp</code> as shown here:</p>
<pre class="source-code">
#include &lt;iostream&gt;
#include &lt;lua.hpp&gt;
int main()
{
    lua_State *L = luaL_newstate();
    std::cout &lt;&lt; "Lua version number is "
              &lt;&lt; lua_version(L)
              &lt;&lt; std::endl;
    lua_close(L);
    return 0;
}</pre>
<p>The preceding <a id="_idIndexMarker016"/>source code opens Lua, prints its build number, and then closes Lua.</p>
<h2 id="_idParaDest-24"><a id="_idTextAnchor023"/>Writing the Makefile</h2>
<p>As part of the first project, writing the <code>Makefile</code> is very simple. Let’s use this as a chance to <a id="_idIndexMarker017"/>learn some more details about the <code>Makefile</code>, if you haven’t <a id="_idIndexMarker018"/>got a good understanding already. For more information, you can check out the official website at <a href="https://www.gnu.org/software/make/">https://www.gnu.org/software/make/</a>.</p>
<p>Write the <code>Makefile</code> as shown in the following code:</p>
<pre class="source-code">
project-with-lua-lib: main.cpp
    g++ -o project-with-lua-lib main.cpp -Ilua/include \
        -Llua/lib -llua</pre>
<p>This is a very basic <code>Makefile</code>. In a real project, you would need a more complex <code>Makefile</code> to make it more flexible. You will see more flexible examples later in this chapter. Here, the focus is <a id="_idIndexMarker019"/>simplicity for the first encounter. This initial <code>Makefile</code> has the following elements:</p>
<ul>
<li><code>project-with-lua-lib</code> is a <code>Makefile</code> target. You can have as many targets as needed in a <code>Makefile</code>. When you invoke <code>make</code> without an explicit target, it will execute the first one defined in the file.</li>
<li><code>main.cpp</code> is the target’s dependency. You can depend on another target or a file. You can have as many dependencies as needed.</li>
<li>The target invokes a <code>g++</code> command to compile <code>main.cpp</code> and link it with the Lua library. You will <a id="_idIndexMarker020"/>need to use a tab instead of spaces before the target commands.</li>
<li><code>-o project-with-lua-lib</code> specifies the name of the compiled executable file. You can change <code>project-with-lua-lib</code> to any name you want.</li>
<li><code>-Ilua/include</code> adds <code>lua/include</code> to the search path for header files.</li>
<li><code>-Llua/lib</code> adds <code>lua/lib</code> to the linker search path for libraries.</li>
<li><code>-llua</code> tells the linker to link with the static Lua library: <code>liblua.a</code>.</li>
</ul>
<h2 id="_idParaDest-25"><a id="_idTextAnchor024"/>Testing the project</h2>
<p>In a terminal, execute <code>make</code> to build the project. Then execute <code>./project-with-lua-lib</code> to run <a id="_idIndexMarker021"/>the compiled project:</p>
<pre class="source-code">
project-with-lua-lib % make
project-with-lua-lib % ./project-with-lua-lib
Lua version number is 504</pre>
<p>As shown in the preceding code, the C++ program will execute and print: <code>Lua version number </code><code>is 504</code>.</p>
<p>Congratulations! You have finished your first C++ project with Lua by linking to the pre-compiled Lua library. In the next section, we will explore how to use Lua source code directly to avoid the disadvantages stated at the beginning of this section.</p>
<h1 id="_idParaDest-26"><a id="_idTextAnchor025"/>Building a C++ project with the Lua source code</h1>
<p>Building your <a id="_idIndexMarker022"/>C++ project with the Lua source <a id="_idIndexMarker023"/>code has the benefit that it is always compiled as part of your project, and there is no possibility of any surprises arising from compiler incompatibilities.</p>
<p>The major difference from linking with a pre-compiled Lua library is that we will now compile the Lua library from its source code first. It is also better to use the source code package <a id="_idIndexMarker024"/>without modifying it or copying only <a id="_idIndexMarker025"/>a few selected files into a new folder hierarchy. This will help in the future if you need to use a newer Lua version. In such a case, all you will need to do is to replace the Lua source code folder with the new version.</p>
<h2 id="_idParaDest-27"><a id="_idTextAnchor026"/>Creating a project to work with the Lua source code</h2>
<p>To create <a id="_idIndexMarker026"/>a project using the Lua source code, we need to go back to the Lua source code package:</p>
<pre class="source-code">
lua-5.4.6 % ls
Makefile README doc src</pre>
<p>You will need the <code>src</code> subfolder.</p>
<p>Create a folder for a new project. Within it, create an empty <code>main.cpp</code> and an empty <code>Makefile</code>, and copy the <code>src</code> subfolder shown in the preceding shell output as the <code>lua</code> subfolder in your project folder. The project structure should look as follows:</p>
<pre class="source-code">
project-with-lua-src % tree
.
├── Makefile
├── lua
│   ├── Makefile
│   ├── lapi.c
│   ├── ...
│   ├── lzio.c
│   └── lzio.h
└── main.cpp</pre>
<h2 id="_idParaDest-28"><a id="_idTextAnchor027"/>Writing the C++ code</h2>
<p>You can <a id="_idIndexMarker027"/>write the C++ code in exactly the same way that you did when building with the Lua library.</p>
<h2 id="_idParaDest-29"><a id="_idTextAnchor028"/>Writing the Makefile</h2>
<p>Let’s go <a id="_idIndexMarker028"/>one step further compared to the last project, and write two targets for the <code>Makefile</code> as follows:</p>
<pre class="source-code">
pr<a id="_idTextAnchor029"/>oject-with-lua-src: main.cpp
    cd lua &amp;&amp; make
    g++ -o project-with-lua-src main.cpp -Ilua -Llua -llua
clean:
    rm -f project-with-lua-src
    cd lua &amp;&amp; make clean</pre>
<p>This <code>Makefile</code> first goes into the <code>lua</code> subfolder and then it builds the Lua library. After this, it compiles the C++ code and links it with the Lua library. The <code>lua</code> subfolder is a copy of the <code>src</code> folder from the Lua source code archive. If you accidentally copied the whole archive there, you may see some compile errors.</p>
<p>The <code>Makefile</code> also includes a <code>clean</code> target. This will delete compiled files. Usually, all build systems will have a <code>clean</code> target implemented.</p>
<h2 id="_idParaDest-30"><a id="_idTextAnchor030"/>Testing the project</h2>
<p>In a <a id="_idIndexMarker029"/>terminal, enter <code>make</code> to build the project. Then enter <code>./project-with-lua-src</code> to execute the compiled project:</p>
<pre class="source-code">
project-with-lua-src % make
project-with-lua-src % ./project-with-lua-arc
Lua version number is 504</pre>
<p>The C++ program will execute and print : <code>Lua version number </code><code>is 504</code>.</p>
<h2 id="_idParaDest-31"><a id="_idTextAnchor031"/>Testing the clean target</h2>
<p>Since we <a id="_idIndexMarker030"/>have implemented a <code>clean</code> target, let’s also test that:</p>
<pre class="source-code">
project-with-lua-src % make clean
rm -f project-with-lua-src
cd lua &amp;&amp; make clean
rm -f liblua.a lua luac lapi.o lcode.o lctype.o ldebug.o
ldo.o ldump.o lfunc.o lgc.o llex.o lmem.o lobject.o
lopcodes.o lparser.o lstate.o lstring.o ltable.o ltm.o
lundump.o lvm.o lzio.o lauxlib.o lbaselib.o lcorolib.o
ldblib.o liolib.o lmathlib.o loadlib.o loslib.o lstrlib.o
ltablib.o lutf8lib.o linit.o lua.o luac.o</pre>
<p>This cleans the working folder by deleting compiler-generated files. In a production-ready project, you would do more by first outputting all intermediate files to a separate folder during building, most likely called <code>build</code> or <code>output</code>, and exclude that folder from the source control system.</p>
<p>So far, we have learned two ways to integrate Lua with C++ projects. Next, let’s learn how to execute real Lua scripts from C++.</p>
<h1 id="_idParaDest-32"><a id="_idTextAnchor032"/>Executing a simple Lua script</h1>
<p>To execute a <a id="_idIndexMarker031"/>Lua script, you can choose to use either the Lua library or the Lua source code. For production projects, I personally recommend using the source code. For learning purposes, either way is fine. We will use Lua source code in the rest of this book.</p>
<p class="callout-heading">Can you notice this?</p>
<p class="callout">Even if you choose to use the Lua source code, in the <code>Makefile</code>, you are first building the Lua source code into the Lua library and then make your project link to the library. Compared to using the Lua library directly, using the Lua source code is just doing one more step in your project. You can focus more on the similarities rather than the differences.</p>
<p>Now, let’s look <a id="_idIndexMarker032"/>at a more general project structure.</p>
<h2 id="_idParaDest-33"><a id="_idTextAnchor033"/>Creating a project</h2>
<p>As said, there will be more complex projects in the following chapters. For now, we will explore a more <a id="_idIndexMarker033"/>general project structure. We will build and link to Lua in a shared location instead of making a copy for each project.</p>
<p>The following is the structure of the project as shown within its parent folders:</p>
<pre class="source-code">
% tree
.
├── Chapter01
│   ├── execute-lua-script
│   │   ├── Makefile
│   │   ├── main.cpp
│   │   └── script.lua
│   ├── project-with-lua-lib
│   └── project-with-lua-src
└── lua
     ├── Makefile
     ├── README
     ├── doc
     └── src</pre>
<p>The two relevant folders for this project are as follows:</p>
<ul>
<li>The <code>execute-lua-script</code> folder contains the main project, inside which there is a C++ source file, a <code>Makefile</code>, and a Lua script file</li>
<li>The <code>lua</code> folder contains the Lua source code package, which is unarchived and used as-is</li>
</ul>
<p>The other folders <a id="_idIndexMarker034"/>shown indicate how the source code of this book is organized – first into chapters and then into projects. Following the exact structure is optional, as long as you can make it work.</p>
<h2 id="_idParaDest-34"><a id="_idTextAnchor034"/>Writing the Makefile</h2>
<p>We’ve seen <a id="_idIndexMarker035"/>two simple <code>Makefiles</code> in the previous two projects. Let’s write a more flexible <code>Makefile</code> as follows:</p>
<pre class="source-code">
LUA_PATH = ../../lua
CXX = g++
CXXFLAGS = -Wall -Werror
CPPFLAGS = -I ${LUA_PATH}/src
LDFLAGS = -L ${LUA_PATH}/src
EXECUTABLE = executable
all: lua project
lua:
    @cd  ${LUA_PATH} &amp;&amp; make
project: main.cpp
    $(CXX) $(CXXFLAGS) $(CPPFLAGS) $(LDFLAGS) \
        -o $(EXECUTABLE) main.cpp -llua
clean:
    rm -f $(EXECUTABLE)</pre>
<p>This <code>Makefile</code> is more flexible and should be good enough to use as a template for study purposes. It differs <a id="_idIndexMarker036"/>from the previous ones in the following aspects:</p>
<ul>
<li>It defines a few variables at the beginning of the file. The benefit is that in a real-life project, you would need to compile multiple files. This way, you do not need to repeat yourself in each target. This is also clearer to read.</li>
<li>The default target, conventionally named <code>all</code>, depends on two other targets.</li>
<li>In the <code>lua</code> target, there is an <code>@</code> sign before the command. This will stop printing out the command content in the terminal when <code>make</code> executes.</li>
<li><code>LUA_PATH</code> is the path to the Lua source code relative to the folder where this <code>Makefile</code> resides.</li>
<li><code>CXX</code> is the conventional variable name to define the C++ compiler program. Use <code>CC</code> for the C compiler.</li>
<li><code>CXXFLAGS</code> defines the parameters provided to the C++ compiler. Use <code>CFLAGS</code> for the C compiler.</li>
<li><code>CPPFLAGS</code> defines the parameters provided to the C preprocessor, and C++ shares the same preprocessor.</li>
<li><code>LDFLAGS</code> defines the parameters provided to the linker. In some development systems, you may need to put <code>LDFLAGS</code> after <code>-</code><code>o $(EXECUTABLE)</code>.</li>
</ul>
<p>With the <code>Makefile</code> ready, let’s write the C++ code.</p>
<h2 id="_idParaDest-35"><a id="_idTextAnchor035"/>Writing the C++ code</h2>
<p>To execute <a id="_idIndexMarker037"/>a Lua script, we need some real actions, which we can get by calling some Lua library functions. Write <code>main.cpp</code> as follows:</p>
<pre class="source-code">
#include &lt;iostream&gt;
#include &lt;lua.hpp&gt;
int main()
{
    lua_State *L = luaL_newstate();
    luaL_openlibs(L);
    if (luaL_loadfile(L, "script.lua") ||
        lua_pcall(L, 0, 0, 0))
    {
        std::cout &lt;&lt; "Error: "
                  &lt;&lt; lua_tostring(L, -1)
                  &lt;&lt; std::endl;
        lua_pop(L, 1);
    }
    lua_close(L);
    return 0;
}</pre>
<p>The code <a id="_idIndexMarker038"/>is doing the following things:</p>
<ol>
<li>Opening Lua and creating a Lua state with <code>luaL_newstate</code>.</li>
<li>Opening Lua standard libs with <code>luaL_openlibs</code>.</li>
<li>Loading a Lua script named <code>script.lua</code> with <code>luaL_loadfile</code> and executing it with <code>lua_pcall</code>. We will write <code>script.lua</code> soon.</li>
<li>Outputting an error if the script has failed to execute. This is done inside the <code>if</code> clause.</li>
<li>Closing Lua with <code>lua_close</code>.</li>
</ol>
<p>The Lua functions used here, as well as the Lua state, will be explained in detail in <em class="italic">Chapter 3</em>.</p>
<h2 id="_idParaDest-36"><a id="_idTextAnchor036"/>Testing the project</h2>
<p>If you have <a id="_idIndexMarker039"/>created an empty <code>script.lua</code>, delete it. Compile and run the project:</p>
<pre class="source-code">
execute-lua-script % make
execute-lua-script % ./executable
Error: cannot open script.lua: No such file or directory</pre>
<p>As expected, it says <code>script.lua</code> is not found. Don’t worry. You will write it next. The important thing to note is that you have finished coding the C++ part of the project and have already compiled the project.</p>
<h2 id="_idParaDest-37"><a id="_idTextAnchor037"/>Writing the Lua script</h2>
<p>Write <code>script.lua</code> as the one-liner shown here:</p>
<pre class="source-code">
print("Hello C++!")</pre>
<p>This will <a id="_idIndexMarker040"/>print <code>Hello C++!</code>.</p>
<p>Execute the project again without recompiling the C++ code:</p>
<pre class="source-code">
execute-lua-script % ./executable
Hello C++!</pre>
<p>Congratulations! You have now executed a Lua script from a C++ program and changed what the C++ program does after it has been compiled.</p>
<p>The next section offers some ideas to set up your development environment differently.</p>
<h1 id="_idParaDest-38"><a id="_idTextAnchor038"/>Other toolchain options</h1>
<p>If you do not <a id="_idIndexMarker041"/>have access to a native POSIX system, there are many other toolchain options. Here we have given two examples. Because your development platform may be different and OS updates and situations change, these only serve as some ideas. You can always research online and experiment to get a comfortable setup for yourself.</p>
<h2 id="_idParaDest-39"><a id="_idTextAnchor039"/>Using Visual Studio or Xcode</h2>
<p>The Lua source <a id="_idIndexMarker042"/>code is written in C and does not need other dependencies. You can copy the <code>src</code> folder from the Lua source code <a id="_idIndexMarker043"/>package into Visual Studio or Xcode, either into your project directly or by configuring it as a Lua project that your main project depends on. Tweak the project settings as you need. This is quite doable.</p>
<p>Whatever IDE you choose to use, remember to check its license to see whether you can use the IDE for your purpose.</p>
<h2 id="_idParaDest-40"><a id="_idTextAnchor040"/>Using Cygwin</h2>
<p>If you <a id="_idIndexMarker044"/>use Windows, you can get Cygwin for a POSIX experience:</p>
<ol>
<li>Download <a id="_idIndexMarker045"/>the Cygwin installer from <a href="https://sourceware.org/cygwin/">https://sourceware.org/cygwin/</a> and run the installer.</li>
<li>During package selection, search for the two packages called <code>make</code> and <code>gcc-g++</code>. Select them for installation.</li>
<li>Change all your shell commands and project <code>Makefiles</code> related to Lua slightly. You need to build the Linux flavor of the library explicitly. For example, change <code>cd lua &amp;&amp; make</code> to <code>cd lua &amp;&amp; make linux</code>. This is because the Lua <code>Makefile</code> could not detect Cygwin as a Linux flavor.</li>
<li>Open the Cygwin terminal, and you can build and run projects as shown in the examples in this chapter.</li>
</ol>
<h1 id="_idParaDest-41"><a id="_idTextAnchor041"/>Summary</h1>
<p>In this chapter, we have learned how to compile the Lua source code, how to link to the Lua library, and how to include the Lua source code directly in your project. Finally, we executed a Lua script from C++ code. By following these steps yourself, you should be comfortable and confident in including Lua in your C++ projects and prepared for more complex work.</p>
<p>In the next chapter, we will learn the basics of the Lua programming language. If you are already familiar with the Lua programming language, feel free to skip <em class="italic">Chapter 2</em><em class="italic">, Lua Fundamentals</em>. We will come back to the communications between Lua and C++ in <em class="italic">Chapter 3</em><em class="italic">, How to Call Lua </em><em class="italic">from C++</em>.</p>
</div>
</div></body></html>