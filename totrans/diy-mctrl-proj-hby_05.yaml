- en: '*Chapter 5*: Humidity and Temperature Measurement'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*第五章*: 湿度和温度测量'
- en: This chapter describes how to practically measure humidity and temperature in
    an environment, as well as how to connect specialized sensors to a microcontroller
    board. You will find out how to use the commonly used sensors DHT11 and LM35\.
    In this chapter, you will gain valuable information regarding gaining data acquisition
    from a temperature and humidity sensor and a sensor module and how to display
    it to a user.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章描述了如何在环境中实际测量湿度和温度，以及如何将专用传感器连接到微控制器板。你将了解到如何使用常用的传感器DHT11和LM35。在本章中，你将获得有关从温度和湿度传感器以及传感器模块获取数据以及如何将其显示给用户的有价值信息。
- en: 'In this chapter, we are going to cover the following main topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主要内容：
- en: Introducing the DHT11 humidity and temperature sensor module
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 介绍DHT11湿度温度传感器模块
- en: Connecting the DHT11 and LM35 sensors to the microcontroller boards
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将DHT11和LM35传感器连接到微控制器板
- en: Coding to get data from the sensor module
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 编码从传感器模块获取数据
- en: Showing the humidity and temperature data results on the serial port monitor
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在串口监视器上显示湿度和温度数据结果
- en: By the end of this chapter, you will have learned how to properly connect a
    DHT11 humidity and temperature sensor and an LM35 temperature sensor to the Curiosity
    Nano and Blue Pill microcontroller boards. You will have also learned how to analyze
    and display the data obtained from these sensors.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 到本章结束时，你将学会如何正确地将DHT11湿度温度传感器和LM35温度传感器连接到Curiosity Nano和Blue Pill微控制器板。你还将学会如何分析和显示从这些传感器获得的数据。
- en: Technical requirements
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: The software tools that you will be using in this chapter are the *MPLAB X*
    and *Arduino* IDEs, for editing and uploading your programs to the Curiosity Nano
    and the Blue Pill microcontroller boards, respectively.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 本章中你将使用的软件工具是*MPLAB X*和*Arduino* IDE，分别用于编辑和上传你的程序到Curiosity Nano和Blue Pill微控制器板。
- en: 'The code that will be used in this chapter can be found in this book''s GitHub
    repository: [https://github.com/PacktPublishing/DIY-Microcontroller-Projects-for-Hobbyists/tree/master/Chapter05](https://github.com/PacktPublishing/DIY-Microcontroller-Projects-for-Hobbyists/tree/master/Chapter05)'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将使用的代码可以在本书的GitHub仓库中找到：[https://github.com/PacktPublishing/DIY-Microcontroller-Projects-for-Hobbyists/tree/master/Chapter05](https://github.com/PacktPublishing/DIY-Microcontroller-Projects-for-Hobbyists/tree/master/Chapter05)
- en: 'The Code in Action video for this chapter can be found here: [https://bit.ly/2UiRHVP](https://bit.ly/2UiRHVP)'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的“代码在行动”视频可以在以下链接找到：[https://bit.ly/2UiRHVP](https://bit.ly/2UiRHVP)
- en: 'In this chapter, we will be using the following pieces of hardware:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将使用以下硬件：
- en: A solderless breadboard.
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个无焊面包板。
- en: The Blue Pill and Curiosity Nano microcontroller boards.
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Blue Pill和Curiosity Nano微控制器板。
- en: A Micro USB cable for connecting your microcontroller boards to a computer.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一根Micro USB线，用于将你的微控制器板连接到电脑。
- en: The ST-LINK/V2 electronic interface needed for uploading the compiled code to
    the Blue Pill. Bear in mind that the ST-LINK/V2 requires four female-to-female
    DuPont wires.
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 上传编译后的代码到Blue Pill所需的ST-LINK/V2电子接口。请注意，ST-LINK/V2需要四根女性到女性的杜邦线。
- en: Green and yellow LEDs.
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 绿色和黄色LED。
- en: Two 220-ohm resistors rated at one-quarter watt. These resistors are for the
    LEDs.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 两个220欧姆、额定为四分之一瓦特的电阻。这些电阻是为LED准备的。
- en: One 4.7 kilo-ohm resistor rated as one-quarter watt. It is for the DHT11 sensor.
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个4.7千欧姆、额定为四分之一瓦特的电阻。它是为DHT11传感器准备的。
- en: One 2.2 kilo-ohm resistor rated as one-quarter watt. It is for the **Liquid
    Crystal Display** (**LCD**).
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个2.2千欧姆、额定为四分之一瓦特的电阻。它是为**液晶显示器**（**LCD**）准备的。
- en: One DHT11 humidity and temperature sensor module.
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个DHT11湿度温度传感器模块。
- en: One LM35 temperature sensor.
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个LM35温度传感器。
- en: Three male-to-female DuPont wires for connecting the sensor module to the solderless
    breadboard.
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 三根男性到女性的杜邦线，用于将传感器模块连接到无焊面包板。
- en: A dozen male-to-male DuPont wires.
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一打男性到男性的杜邦线。
- en: A 1602 16x2 LCD display.
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个1602 16x2液晶显示器。
- en: The next section provides a brief introduction to the DHT11 sensor module, its
    electrical characteristics, and how this module is used in electronic projects.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 下一节简要介绍了DHT11传感器模块，其电气特性以及该模块在电子项目中的应用。
- en: Introducing the DHT11 humidity and temperature sensor module
  id: totrans-27
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍DHT11湿度温度传感器模块
- en: In this section, we'll review the DHT11 sensor module. This section also describes
    what the sensor pins are, and how to connect them to a microcontroller board.
    The DHT11 is an easy-to-use, practical, and low-cost sensor module that measures
    temperature within a range of 0 to 50 degrees Celsius, with an error rate of +-2%.
    It also measures environmental **relative humidity** (**RH**) within a range of
    20% to 90%, with an accuracy of +-5%. These values can change a bit, depending
    on the sensor module's manufacturers. The next section describes what RH is, an
    environmental value that is read by the DHT11 sensor.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将回顾 DHT11 传感器模块。本节还描述了传感器引脚是什么，以及如何将它们连接到微控制器板。DHT11 是一个易于使用、实用且低成本的传感器模块，可以测量
    0 到 50 摄氏度范围内的温度，误差率为 +-2%。它还可以测量 20% 到 90% 范围内的环境**相对湿度**（**RH**），精度为 +-5%。这些值可能因传感器模块的制造商而略有不同。下一节将描述
    RH 是什么，这是一个由 DHT11 传感器读取的环境值。
- en: What is relative humidity?
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 什么是相对湿度？
- en: '**Relative humidity** is based on a combination of water vapor and the temperature
    of the environment. It is a ratio of the amount of water vapor present in the
    air at a certain temperature, expressed as a percentage. Generally, the amount
    of water vapor has a higher RH in cool air than hot or warm air. A related parameter
    is the **dew point**, which is the temperature that air from a place or environment
    must be cooled down to for it to become saturated with water vapor.'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '**相对湿度**是基于水蒸气和环境温度的组合。它是在一定温度下空气中存在的水蒸气量的比例，以百分比表示。一般来说，水蒸气的量在冷空气中比热或温暖空气中的相对湿度（RH）要高。一个相关的参数是**露点**，这是空气从某个地方或环境中冷却到必须达到的温度，以便它能够被水蒸气饱和。'
- en: Measuring RH is important because it is related to the degree of discomfort
    people feel in an environment, among other applications. RH measurements can have
    useful applications, such as in greenhouses, where some plants need a certain
    degree of RH to thrive.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 测量相对湿度很重要，因为它与人们在环境中的不适程度有关，以及其他应用。RH 测量可以有一些有用的应用，例如在温室中，有些植物需要一定程度的 RH 才能生长。
- en: The DHT11 pins and their values
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: DHT11 引脚及其值
- en: 'The following is a Fritzing diagram of the DHT11 sensor module. Please note
    that the DHT11 module may have a fourth pin, depending on its manufacturer. The
    fourth pin is not connected to anything (sometimes, it is labeled **not connected**,
    or **NC**):'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一个 DHT11 传感器模块的 Fritzing 图。请注意，DHT11 模块可能有一个第四个引脚，具体取决于其制造商。第四个引脚没有连接到任何东西（有时标记为
    **not connected** 或 **NC**）：
- en: '![Figure 5.1 – The DHT11 sensor module](img/Figure_5.1_B16413.jpg)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.1 – DHT11 传感器模块](img/Figure_5.1_B16413.jpg)'
- en: Figure 5.1 – The DHT11 sensor module
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.1 – DHT11 传感器模块
- en: As we can see, the DHT11's **v** pin (it can also be labeled **VCC** or **+**,
    depending on the manufacturer) can be connected to a voltage supply of 3 to 5.5
    V of **direct current** (**DC**). In this chapter, we will connect the DHT11 to
    a voltage of 3.3 volts, which can be supplied by both the Curiosity Nano and the
    Blue Pill boards. Pin **s** is the signal that provides the temperature and humidity
    data generated by the sensor. It can also be labeled as **OUT** or **DATA**, depending
    on the DHT11 manufacturer. Pin **g** (sometimes labeled as **G**, **GND**, or
    **-**) will be connected to the microcontroller board's ground. Most of the DHT11
    modules' operating current is 0.3mA when measuring temperature and humidity, and
    60 microamperes when in standby, making it a very low power sensor.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所见，DHT11 的 **v** 引脚（它也可以标记为 **VCC** 或 **+**，具体取决于制造商）可以连接到 3 到 5.5 伏的**直流**（**DC**）电源。在本章中，我们将
    DHT11 连接到 3.3 伏的电压，这可以由 Curiosity Nano 和 Blue Pill 板提供。引脚 **s** 是提供传感器生成的温度和湿度数据的信号。它也可以标记为
    **OUT** 或 **DATA**，具体取决于 DHT11 制造商。引脚 **g**（有时标记为 **G**、**GND** 或 **-**）将连接到微控制器板的地线。大多数
    DHT11 模块的测量温度和湿度时的运行电流为 0.3mA，待机时为 60 微安，使其成为一个功耗非常低的传感器。
- en: 'The following image shows two DHT11 sensor modules made by two different manufacturers:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图片显示了由两家不同制造商制造的两种 DHT11 传感器模块：
- en: '![Figure 5.2 – DHT11 sensor modules](img/Figure_5.2_B16413.jpg)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.2 – DHT11 传感器模块](img/Figure_5.2_B16413.jpg)'
- en: Figure 5.2 – DHT11 sensor modules
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.2 – DHT11 传感器模块
- en: Please note that the DHT11 modules have slight differences. For example, both
    DHT11 modules have a different pin order. The one on the left has ground (labeled
    as GND), signal (labeled as data), and voltage (labeled as VCC) pins in that order,
    whereas the right one has signal (data), voltage, and ground pins in that order.
    Also, the pins have different labels. However, both DHT11 modules work the same
    and can be used in the circuits shown in this chapter. The sensor itself is encased
    in the plastic blue box with a grid. The DHT11 modules have extra electronic components
    that facilitate the connections to the sensor.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，DHT11模块之间略有差异。例如，两个DHT11模块的引脚顺序不同。左侧的模块按照顺序有地线（标记为GND）、信号（标记为data）和电压（标记为VCC）引脚，而右侧的模块按照顺序有信号（data）、电压和地线引脚。此外，引脚的标签也不同。然而，两个DHT11模块的工作方式相同，可以用于本章中显示的电路。传感器本身被封装在带有网格的蓝色塑料盒中。DHT11模块有额外的电子元件，便于连接到传感器。
- en: In this section, you learn about the DHT11 sensor module, its pins, and the
    similarities and differences among DHT11 sensors made by different manufacturers.
    You also reviewed what relative humidity is, an important environmental value
    that the DHT11 can read.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，您将了解DHT11传感器模块、其引脚以及不同制造商制造的DHT11传感器之间的相似之处和不同之处。您还回顾了相对湿度是什么，这是DHT11可以读取的重要环境值。
- en: The next section will show you how to connect the DHT11 module to a Blue Pill's
    digital port so that you can read its values.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 下一节将向您展示如何将DHT11模块连接到Blue Pill的数字端口，以便您可以读取其值。
- en: Connecting a DHT11 sensor module to the microcontroller boards
  id: totrans-43
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将DHT11传感器模块连接到微控制器板
- en: This section deals with all the hardware components in this chapter. We will
    begin by connecting the DHT11 to the Blue Pill board. Connecting the DHT11 to
    microcontroller boards is easy because it only requires three wires.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 本节处理本章中所有硬件组件。我们将首先将DHT11连接到Blue Pill板。将DHT11连接到微控制器板很容易，因为它只需要三根线。
- en: Connecting the DHT11 to the Blue Pill board
  id: totrans-45
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将DHT11连接到Blue Pill板
- en: 'In this section, we will connect the DHT11 to the Blue Pill, as shown here:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将连接DHT11到Blue Pill，如图所示：
- en: '![Figure 5.3 – The DHT11 connected to a Blue Pill microcontroller board](img/Figure_5.3_B16413.jpg)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![图5.3 – DHT11连接到Blue Pill微控制器板](img/Figure_5.3_B16413.jpg)'
- en: Figure 5.3 – The DHT11 connected to a Blue Pill microcontroller board
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.3 – DHT11连接到Blue Pill微控制器板
- en: As we can see, the DHT11 connections are simple. In some DHT11 modules, their
    manufacturers recommend connecting a 5K-ohm pull-up resistor to the **S** (signal)
    pin. However, since 5K resistors are not commercially available, a resistor with
    a value of 4.7K-ohm is close enough to the recommended one. We did not need to
    connect a 4.7K-ohm to the DHT11 module that we used in our project because its
    electronic circuit already had a resistor like that.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所见，DHT11的连接很简单。在一些DHT11模块中，其制造商建议将一个5K欧姆的上拉电阻连接到**S**（信号）引脚。然而，由于5K欧姆电阻在商业上不可用，一个4.7K欧姆的电阻已经足够接近推荐值。在我们项目中使用的DHT11模块中，其电子电路已经有一个类似的电阻，所以我们不需要连接一个4.7K欧姆的电阻。
- en: Note
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Depending on the manufacturer, many DHT11 modules already include a pull-up
    resistor, so the 4.7k-ohm pull up resistor is not necessary. It is worth checking
    it out. Just connect the DHT11 to the microcontroller board. If it gives erratic
    temperature measurements, or not getting measurements at all, you may need to
    connect the pull-up resistor to it.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 根据制造商的不同，许多DHT11模块已经包括一个上拉电阻，因此4.7k欧姆的上拉电阻不是必需的。值得检查一下。只需将DHT11连接到微控制器板。如果它给出不规则的温度测量值，或者根本无法进行测量，您可能需要将上拉电阻连接到它。
- en: 'Follow these steps to connect the DHT11 to the Blue Pill:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤将DHT11连接到Blue Pill：
- en: Connect the Blue Pill's **GND** (also labeled as **G**) pin to the solderless
    breadboard rail.
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Blue Pill的**GND**（也标记为**G**）引脚连接到无焊面包板轨道。
- en: Connect the Blue Pill's **3.3** pin labeled (providing 3.3 volts) to the upper
    breadboard rail. Please note that in some Blue Pill boards, this pin is labeled
    as **3V3**.
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将标记为（提供3.3伏特）的Blue Pill的**3.3**引脚连接到上面包板轨道。请注意，在某些Blue Pill板上，此引脚标记为**3V3**。
- en: Connect the DHT11's **s** pin to the Blue Pill's **B12** pin.
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将DHT11的**s**引脚连接到Blue Pill的**B12**引脚。
- en: Connect the DHT11's **v** pin to the upper breadboard rail that was connected
    to the **3V3** pin.
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将DHT11的**v**引脚连接到连接到**3V3**引脚的上面包板轨道。
- en: Connect the HDT11's **g** pin to the ground pin (the lower breadboard rail).
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将HDT11的**g**引脚连接到地线引脚（下面包板轨道）。
- en: Connect the USB cable to the Blue Pill and then to your computer.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 USB 线缆连接到 Blue Pill，然后连接到您的计算机。
- en: 'The following image shows how everything should be connected:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图像显示了所有连接应该如何连接：
- en: '![Figure 5.4 – The DHT11 connected to the Blue Pill](img/Figure_5.4_B16413.jpg)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.4 – DHT11 连接到 Blue Pill](img/Figure_5.4_B16413.jpg)'
- en: Figure 5.4 – The DHT11 connected to the Blue Pill
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.4 – DHT11 连接到 Blue Pill
- en: Here, we can see that we need just a few DuPont wires to connect the DHT11 to
    the Blue Pill board. You will need to connect the ST-LINK/V2 interface to your
    computer to upload its code, as explained in [*Chapter 1*](B16413_01_Final_NM_ePub.xhtml#_idTextAnchor014),
    *Introduction to Microcontrollers and Microcontroller Boards*. Don't forget to
    disconnect the USB cable first (shown on the left of the preceding image) before
    uploading a program to the Blue Pill. Please note that the order of the pins shown
    in the preceding image is **GND**, **DATA**, and **VCC**, which is different from
    the DHT11's pin order shown in *Figure 5.3*. Again, this is because some DHT11
    manufacturers change the DHT11's pin order.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们可以看到我们只需要几根杜邦线就可以将 DHT11 连接到 Blue Pill 板。您需要将 ST-LINK/V2 接口连接到您的计算机以上传其代码，如在第
    [*1章*](B16413_01_Final_NM_ePub.xhtml#_idTextAnchor014) 中所述，*微控制器和微控制器板简介*。在上传程序到
    Blue Pill 之前，请务必先断开 USB 线缆（如前一张图像所示左侧）。请注意，前一张图像中显示的引脚顺序是 **GND**、**DATA** 和 **VCC**，这与
    *图 5.3* 中显示的 DHT11 的引脚顺序不同。再次强调，这是因为一些 DHT11 制造商改变了 DHT11 的引脚顺序。
- en: Note
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: All the Blue Pill's **ground** (**GND**) pins are the same; they are internally
    connected. This microcontroller board has more than one GND pin so that we can
    connect the electronic components to the board.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 所有 Blue Pill 的 **地**（**GND**）引脚都是相同的；它们是内部连接的。这块微控制器板有多个 GND 引脚，这样我们就可以将电子组件连接到板上。
- en: The temperature and humidity values will be shown on the computer's serial port
    monitor from the IDE. This will be explained in the *Programming the DHT11 sensor
    for the Blue Pill board* section.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 温度和湿度值将从 IDE 的计算机串口监视器中显示。这将在 *为 Blue Pill 板编程 DHT11 传感器* 部分进行解释。
- en: 'The following image shows a Fritzing diagram with the DHT11 and a 4.7k-ohm
    pull-up resistor connected to the signal (**S**) pin. The DHT11 module used in
    this example does not have a built-in pull up resistor, so we need to connect
    one:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图像显示了一个带有 DHT11 和 4.7k-ohm 上拉电阻的 Fritzing 图表连接到信号（**S**）引脚。在此示例中使用的 DHT11
    模块没有内置上拉电阻，因此我们需要连接一个：
- en: '![Figure 5.5 – A DHT11 with a pull-up resistor](img/Figure_5.5_B16413.jpg)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.5 – 带有上拉电阻的 DHT11](img/Figure_5.5_B16413.jpg)'
- en: Figure 5.5 – A DHT11 with a pull-up resistor
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.5 – 带有上拉电阻的 DHT11
- en: The preceding image shows the 4.7 k-ohm resistor working as a pull-up resistor.
    The next section describes how to connect an LCD to show the temperature and humidity
    data obtained from the DHT11.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 上一张图像显示了 4.7 k-ohm 电阻作为上拉电阻的工作情况。下一节将描述如何连接 LCD 来显示从 DHT11 获得的温度和湿度数据。
- en: Connecting an LCD to the Blue Pill
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将 LCD 连接到 Blue Pill
- en: 'This section shows an interesting and useful way of showing temperature and
    humidity data obtained from the DHT11 sensor, displaying it on a low-cost 1602
    LCD. The following is a Fritzing diagram showing all the connections:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 本节展示了显示从 DHT11 传感器获得的温度和湿度数据的一种有趣且实用的方法，将其显示在低成本 1602 LCD 上。以下是一个显示所有连接的 Fritzing
    图表：
- en: '![Figure 5.6 – A 1602 LCD connected to the Blue Pill board](img/Figure_5.6_B16413.jpg)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.6 – 连接到 Blue Pill 板的 1602 LCD](img/Figure_5.6_B16413.jpg)'
- en: Figure 5.6 – A 1602 LCD connected to the Blue Pill board
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.6 – 连接到 Blue Pill 板的 1602 LCD
- en: The preceding image depicts the 1602 LCD, which can display 16 alphanumeric
    and special characters (for example, %, $, and so on) in two rows (16x2). Each
    character is formed with a 5x8 dot matrix. The LCD has 16 pins, labeled from left
    to right as **VSS**, **VDD**, **V0**, **RS**, **RW**, **E**, **D0**, **D1**, **D2**,
    **D3**, **D4**, **D5**, **D6**, **D7**, **A**, and **K**. This is a popular LCD
    that can also be used with Arduino microcontroller boards. The 2.2k-ohm resistor,
    which is connected to the **V0** LCD pin, adjusts the LCD's contrast. Pins **VSS**
    and **VDD** are connected to a power supply. Pins **D0** to **D7** are used to
    send data to the LCD to form characters, but here, we're only using 4 bits (pins
    **D4** to **D7**) to display the letters and numbers on the LCD. The 1602 LCD
    is connected to a **5-volt** (**+5V**) power supply, which is supplied by the
    Blue Pill's 5V pin.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 前图展示了1602 LCD，它可以显示两行（16x2）的16个字母和特殊字符（例如%，$等）。每个字符由一个5x8点阵形成。LCD有16个引脚，从左到右标记为**VSS**、**VDD**、**V0**、**RS**、**RW**、**E**、**D0**、**D1**、**D2**、**D3**、**D4**、**D5**、**D6**、**D7**、**A**和**K**。这是一种流行的LCD，也可以与Arduino微控制器板一起使用。连接到**V0**
    LCD引脚的2.2k欧姆电阻调整LCD的对比度。**VSS**和**VDD**引脚连接到电源。**D0**到**D7**引脚用于向LCD发送数据以形成字符，但在这里，我们只使用4位（引脚**D4**到**D7**）来显示LCD上的字母和数字。1602
    LCD连接到**5伏**（**+5V**）电源，该电源由Blue Pill的5V引脚提供。
- en: Bear in mind that the upper and lower breadboard voltage rails shown in the
    preceding image are connected to Blue Pill's 5V pin, providing 5 volts to the
    LCD. The DHT11 is connected to the Blue Pill's 3.3 pin because this sensor works
    with 3.3 volts. Its resulting data will be sent to the Blue Pill's input data
    pin, **B12**, using a digital voltage level with 3.3 volts.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，前图中显示的上部和下部面包板电压轨连接到Blue Pill的5V引脚，为LCD提供5伏电压。DHT11连接到Blue Pill的3.3V引脚，因为该传感器使用3.3伏电压。其结果数据将通过3.3伏的数字电压级发送到Blue
    Pill的输入数据引脚**B12**。
- en: 'Follow these steps to connect the DHT11 and the LCD to the Blue Pill while
    following the preceding image:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤连接DHT11和LCD到Blue Pill，同时参考前图：
- en: Connect the Blue Pill's **GND** (also labeled as **G**) pins to the solderless
    breadboard rails.
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Blue Pill的**GND**（也标记为**G**）引脚连接到无焊面包板轨。
- en: Connect the Blue Pill's **5V** pin (providing 5 volts) to the breadboard rails.
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Blue Pill的**5V**引脚（提供5伏电压）连接到面包板轨。
- en: Connect the DHT11's **s** pin to the Blue Pill's **B12** pin.
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将DHT11的**s**引脚连接到Blue Pill的**B12**引脚。
- en: Connect the DHT11's **v** pin to the Blue Pill's **3V3** pin.
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将DHT11的**v**引脚连接到Blue Pill的**3V3**引脚。
- en: Connect the HDT11's **g** pin to the ground pin (the upper breadboard rail).
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将HDT11的**g**引脚连接到地线引脚（上部面包板轨）。
- en: Connect the USB cable to the Blue Pill and then to your computer or a USB power
    bank.
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将USB线连接到Blue Pill，然后连接到您的电脑或USB移动电源。
- en: Insert the LCD's 16 pins into the solderless breadboard.
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的16个引脚插入无焊面包板。
- en: Connect the LCD's **VSS** pin to the ground pin (the lower breadboard rail).
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的**VSS**引脚连接到地线引脚（下部面包板轨）。
- en: Connect the LCD's **VDD** pin to 5 volts (the lower breadboard rail).
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的**VDD**引脚连接到5伏（下部面包板轨）。
- en: Connect the 2.2K-ohm resistor to the LCD's **V0** pin and to the ground pin
    (the upper breadboard rail).
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将2.2K欧姆电阻连接到LCD的**V0**引脚和地线引脚（上部面包板轨）。
- en: Connect the LCD's **RS** pin to the Blue Pill's **B11** pin.
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的**RS**引脚连接到Blue Pill的**B11**引脚。
- en: Connect the LCD's **RW** pin to the ground pin (lower breadboard rail).
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的**RW**引脚连接到地线引脚（下部面包板轨）。
- en: Connect the LCD's **E** pin to the Blue Pill's **B10** pin.
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的**E**引脚连接到Blue Pill的**B10**引脚。
- en: Connect the LCD's **D4** pin to the Blue Pill's **B0** pin.
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的**D4**引脚连接到Blue Pill的**B0**引脚。
- en: Connect the LCD's **D5** pin to the Blue Pill's **A7** pin.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的**D5**引脚连接到Blue Pill的**A7**引脚。
- en: Connect the LCD's **D6** pin to the Blue Pill's **A6** pin.
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的**D6**引脚连接到Blue Pill的**A6**引脚。
- en: Connect the LCD's **D7** pin to the Blue Pill's **A5** pin.
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的**D7**引脚连接到Blue Pill的**A5**引脚。
- en: Connect the LCD's **A** pin to 5 volts (upper breadboard rail).
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的**A**引脚连接到5伏（上部面包板轨）。
- en: Connect the LCD's **K** pin to the ground pin (upper breadboard rail).
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的**K**引脚连接到地线引脚（上部面包板轨）。
- en: The LCD's **D0**, **D1**, **D2**, and **D3** pins are not connected.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: LCD的**D0**、**D1**、**D2**和**D3**引脚未连接。
- en: 'The following image shows how everything is connected:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图像展示了所有部件的连接方式：
- en: '![Figure 5.7 – The 1602 LCD connected to the Blue Pill microcontroller board](img/Figure_5.7_B16413.jpg)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![图5.7 – 连接到Blue Pill微控制器板的1602 LCD](img/Figure_5.7_B16413.jpg)'
- en: Figure 5.7 – The 1602 LCD connected to the Blue Pill microcontroller board
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.7 – 连接到Blue Pill微控制器板的1602 LCD
- en: Here, you can see the LCD working because the Blue Pill is connected to a USB
    power bank (not shown in the preceding image). The LCD is displaying the local
    temperature in degrees Celsius, and the humidity is shown as a percentage. The
    code for programming the LCD and the DHT11 will be shown later in this chapter.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，您可以看到LCD正在工作，因为Blue Pill连接到USB移动电源（前图未显示）。LCD显示当地温度（摄氏度），湿度以百分比显示。编程LCD和DHT11的代码将在本章后面展示。
- en: The next section will show you how to connect an LM35 temperature sensor to
    the Curiosity Nano board, demonstrating how to read temperature values from that
    sensor and sending them to an analog input port from the Curiosity Nano.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 下一节将向您展示如何将LM35温度传感器连接到Curiosity Nano板，演示如何从该传感器读取温度值并将它们发送到Curiosity Nano的模拟输入端口。
- en: Connecting an LM35 temperature sensor to the Curiosity Nano board
  id: totrans-102
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将LM35温度传感器连接到Curiosity Nano板
- en: 'In this section, we''ll describe how to measure temperature values on a Curiosity
    Nano, obtained from an LM35 sensor. For demonstration purposes, the temperature
    will be analyzed when it falls within a thermal comfort zone of 23 to 26 degrees
    Celsius. The LM35 is a low-cost and easy-to-connect sensor that measures a wide
    temperature range, from -55 to 150 degrees Celsius. The following is a diagram
    of the LM35 sensor pinout:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将描述如何在Curiosity Nano上测量由LM35传感器获取的温度值。为了演示目的，当温度在23到26摄氏度的舒适温度范围内时，将分析温度。LM35是一个低成本且易于连接的传感器，可测量从-55到150摄氏度的广泛温度范围。以下是LM35传感器引脚排布图：
- en: '![Figure 5.8 – The LM35 sensor showing pins 1, 2, and 3](img/Figure_5.8_B16413.jpg)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![图5.8 – 显示引脚1、2和3的LM35传感器](img/Figure_5.8_B16413.jpg)'
- en: Figure 5.8 – The LM35 sensor showing pins 1, 2, and 3
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.8 – 显示引脚1、2和3的LM35传感器
- en: 'As you can see, the LM35 has three pins: pin 1 (**Vs**), pin 2 (**Vout**),
    and pin 3 (**GND**). Pin 1 is the voltage coming from a power supply. The Curiosity
    Nano''s **VBUS** pin provides 5 volts, so the LM35''s pin 1 can be connected to
    it. Pin 2 is voltage out (**Vout**), providing the measured temperature value
    in terms of **millivolts** (**mV**) using a linear scale factor. This scale increases+10
    mV for each degree Celsius (+10 mV/C). Pin 3 is connected to the microcontroller
    board''s ground (**GND**).'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，LM35有三个引脚：引脚1（**Vs**）、引脚2（**Vout**）和引脚3（**GND**）。引脚1是来自电源的电压。Curiosity
    Nano的**VBUS**引脚提供5伏，因此LM35的引脚1可以连接到它。引脚2是输出电压（**Vout**），以**毫伏**（**mV**）的形式提供测量温度值，使用线性比例因子。这个比例因子每增加1摄氏度增加+10
    mV（+10 mV/C）。引脚3连接到微控制器板的接地（**GND**）。
- en: 'The LM35 sensor signal pin (pin 2) provides the temperature values in mV, which
    will be converted into digital values by the Curiosity Nano. To do this, we need
    to connect the LM35''s pin 2 to an input analog port from the Curiosity Nano.
    The temperature value is calculated as *temperature=(5.0/1023)*millivolts_from_LM35*,
    where 5.0 is the 5 volts connected to the LM35''s pin 1 and 1023 is the 10-bit
    ADC from the Curiosity Nano, which means that its ADC can detect (2^10) discrete
    analog levels. The formula converts the LM35''s output, in mV, into an equivalent
    value in degrees Celsius. The following image shows the LM35 sensor:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: LM35传感器信号引脚（引脚2）提供mV的温度值，将被Curiosity Nano转换为数字值。为此，我们需要将LM35的引脚2连接到Curiosity
    Nano的一个输入模拟端口。温度值计算为*温度=(5.0/1023)*millivolts_from_LM35*，其中5.0是连接到LM35引脚1的5伏，1023是Curiosity
    Nano的10位ADC，这意味着它的ADC可以检测（2^10）个离散的模拟级别。该公式将LM35的输出（以mV计）转换为等效的摄氏度值。以下图像显示了LM35传感器：
- en: '![Figure 5.9 – The LM35 temperature sensor](img/Figure_5.9_B16413.jpg)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![图5.9 – LM35温度传感器](img/Figure_5.9_B16413.jpg)'
- en: Figure 5.9 – The LM35 temperature sensor
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.9 – LM35温度传感器
- en: The preceding image shows the LM35 temperature sensor with its three pins. It
    is the same size as a regular transistor since both have a TO-92 semiconductor
    package type. However, the LM35 is not a transistor – it's a temperature sensor.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的图像展示了LM35温度传感器及其三个引脚。由于它和普通晶体管一样都采用TO-92半导体封装类型，因此它们的大小相同。然而，LM35不是一个晶体管——它是一个温度传感器。
- en: 'We must connect two LEDs to its output ports to show the temperature and humidity
    ranges, as shown here:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 我们必须将其两个LED连接到其输出端口以显示温度和湿度范围，如图所示：
- en: '![Figure 5.10 – Connecting the LM35 sensor and the LEDs to the Curiosity Nano
    board](img/Figure_5.10_B16413.jpg)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![图5.10 – 将LM35传感器和LED连接到Curiosity Nano板](img/Figure_5.10_B16413.jpg)'
- en: Figure 5.10 – Connecting the LM35 sensor and the LEDs to the Curiosity Nano
    board
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.10 – 将LM35传感器和LED连接到Curiosity Nano板
- en: 'As you can see, we must connect a green LED to show that the environment temperature
    being read by the LM35 sensor is within the thermal comfort zone for an office
    with a range of 23 to 26 degrees Celsius; and a yellow LED will be turned on if
    the temperature is outside that range. The temperature values from the thermal
    comfort zone used in this chapter are determined by the Canadian Standards Association,
    which are similar to the values defined by other agencies from other countries.
    The thermal comfort zone values can be found here: [https://www.ccohs.ca/oshanswers/phys_agents/thermal_comfort.html](https://www.ccohs.ca/oshanswers/phys_agents/thermal_comfort.html).'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，我们必须连接一个绿色LED来显示由LM35传感器读取的环境温度在23到26摄氏度的舒适温度范围内；如果温度超出这个范围，黄色LED将被点亮。本章中使用的舒适温度区间的温度值由加拿大标准协会确定，与其他国家机构定义的值相似。舒适温度区间的值可以在以下位置找到：[https://www.ccohs.ca/oshanswers/phys_agents/thermal_comfort.html](https://www.ccohs.ca/oshanswers/phys_agents/thermal_comfort.html)。
- en: 'Follow these steps to connect the LM35 and the LEDs to the Curiosity Nano board:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤将LM35和LED连接到Curiosity Nano板：
- en: Connect the Curiosity Nano's **GND** pin to the lower rail of the solderless
    breadboard rail.
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Curiosity Nano的**GND**引脚连接到无焊面包板轨道的下轨。
- en: Connect the LM35's **Vout** (signal) pin (2) to the Curiosity Nano's **RA0**
    pin. It will be used as an analog input port.
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LM35的**Vout**（信号）引脚（2）连接到Curiosity Nano的**RA0**引脚。它将被用作模拟输入端口。
- en: Connect the LM35's **Vs** pin (1) to the Curiosity Nano's **VBUS** pin. This
    pin provides 5 volts.
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LM35的**Vs**引脚（1）连接到Curiosity Nano的**VBUS**引脚。此引脚提供5伏特。
- en: Connect the LM35's **g** pin (3) to the Curiosity Nano's **GND** pin from its
    upper pin row.
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LM35的**g**引脚（3）连接到Curiosity Nano的**GND**引脚，从其上方的引脚行。
- en: Now, connect the two 220-ohm resistors to the Curiosity Nano's **RD2** and **RD3**
    ports and to the anodes of the two LEDs, respectively.
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，将两个220欧姆电阻连接到Curiosity Nano的**RD2**和**RD3**端口，以及两个LED的阳极。
- en: Connect the LEDs' cathodes to the ground pin.
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LED的阴极连接到地线引脚。
- en: Finally, connect the USB cable to the Curiosity Nano and then to your computer
    or a USB power bank.
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，将USB线缆连接到Curiosity Nano，然后连接到你的电脑或USB移动电源。
- en: 'The following image shows how everything should be connected:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图像显示了所有连接应该如何连接：
- en: '![Figure 5.11 – The LM35 sensor connected to the Curiosity Nano board](img/Figure_5.11_B16413.jpg)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![图5.11 – LM35传感器连接到Curiosity Nano板](img/Figure_5.11_B16413.jpg)'
- en: Figure 5.11 – The LM35 sensor connected to the Curiosity Nano board
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.11 – LM35传感器连接到Curiosity Nano板
- en: The preceding image shows the LM35 connected to the Curiosity Nano's RA0 at
    the upper pins row.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的图像显示了LM35连接到Curiosity Nano的RA0上方的引脚行。
- en: Note
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: All the Curiosity Nano's GND pins are the same; they are internally connected.
    This microcontroller board has more than one GND pin so that we can connect electronic
    components to the board.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: Curiosity Nano的所有GND引脚都是相同的；它们是内部连接的。这个微控制器板有多个GND引脚，这样我们就可以将电子组件连接到板上。
- en: In this section, you learned about the LM35 temperature sensor, its pins, and
    how to connect it to a microcontroller board. You also learned how to show the
    temperature information with LEDs. The next section will show you how to write
    programs for reading humidity and temperature values from the DHT11 sensor.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，你了解了LM35温度传感器、其引脚以及如何将其连接到微控制器板。你还学习了如何使用LED显示温度信息。下一节将展示如何编写程序从DHT11传感器读取湿度和温度值。
- en: Coding to get data from the sensor module
  id: totrans-130
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从传感器模块获取数据的编码
- en: This section describes how to code a program for both the Blue Pill and the
    Curiosity Nano boards so that they can read values from the DHT11\. You will also
    learn how to program the LM35 temperature sensor with the Blue Pill. Let's start
    by programming the DHT11 sensor for the Blue Pill board.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 本节描述了如何为Blue Pill和Curiosity Nano板编写程序，以便它们可以读取DHT11的值。你还将学习如何使用Blue Pill编程LM35温度传感器。让我们先为Blue
    Pill板编程DHT11传感器。
- en: Programming the DHT11 sensor for the Blue Pill board
  id: totrans-132
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 为Blue Pill板编程DHT11传感器
- en: 'In this section, you will review the code that gets data from the DHT11 sensor
    using a special library. The code will also show you how to display the temperature
    and humidity data on the serial port, and thus on the Arduino IDE''s serial monitor.
    The following code reads both the temperature and humidity from a DHT11 sensor
    module, which is connected to digital input port `B12` of the Blue Pill:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，你将回顾使用特殊库从DHT11传感器获取数据的代码。该代码还将展示如何在串行端口上显示温度和湿度数据，从而在Arduino IDE的串行监视器上显示。以下代码从连接到Blue
    Pill数字输入端口`B12`的DHT11传感器模块中读取温度和湿度：
- en: '[PRE0]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'In the preceding code, you can see that the first line includes a library called
    `DHT.h`. This is a very practical library for reading values from the DHT11\.
    This code can be found in this book''s GitHub repository, which contains useful
    comments explaining its main parts. To install the `DHT.h` library on the Arduino
    IDE, follow these steps:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 在前述代码中，你可以看到第一行包含一个名为`DHT.h`的库。这是一个非常实用的库，用于从DHT11读取值。此代码可在本书的GitHub仓库中找到，其中包含解释其主要部分的注释。要在Arduino
    IDE上安装`DHT.h`库，请按照以下步骤操作：
- en: Click on **Tools** | **Manage Libraries** from the IDE's main menu.
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从IDE的主菜单中选择**工具** | **管理库**。
- en: Type `DHT11` in the Library Manager's search field.
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在库管理器的搜索框中输入`DHT11`。
- en: Several libraries will be listed. Select and install the highest version of
    the DHT sensor library, made by Adafruit.
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将列出几个库。选择并安装由Adafruit制作的DHT传感器库的最高版本。
- en: Wait until the library has been installed. Then, close the Library Manager.
    Now, the DHT11 library should be ready to use in your code.
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 等待库安装完成。然后，关闭库管理器。现在，DHT11库应该可以在你的代码中使用了。
- en: Please note that the `dht.readTemperature()` function returns temperature values
    in degrees Celsius, while the `dht.readHumidity()` function returns values as
    a percentage of RH.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，`dht.readTemperature()`函数返回摄氏度的温度值，而`dht.readHumidity()`函数返回相对湿度的百分比值。
- en: 'The following screenshot shows the Arduino IDE''s **Library Manager** showing
    the library called **DHT sensor library** **by Adafruit**:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了Arduino IDE的**库管理器**显示名为**DHT传感器库**的库，由Adafruit提供：
- en: '![Figure 5.12 – The Arduino IDE''s Library Manager](img/Figure_5.12_B16413.jpg)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![图5.12 – Arduino IDE的库管理器](img/Figure_5.12_B16413.jpg)'
- en: Figure 5.12 – The Arduino IDE's Library Manager
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.12 – Arduino IDE的库管理器
- en: Here, you can see that by typing `DHT11` in the search field, you can find the
    DHT sensor library by Adafruit. Click on the **Install** button.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，你可以看到在搜索框中输入`DHT11`，你可以找到Adafruit的DHT传感器库。点击**安装**按钮。
- en: Tip
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 小贴士
- en: You can also connect a DHT11 sensor to an Arduino Uno microcontroller board.
    Just connect the DHT11's `DHT11_data_pin` shown in the preceding code. In addition,
    connect the DHT11's GND and VCC pins to the Arduino Uno's GND and 3V3 pins, respectively.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以将DHT11传感器连接到Arduino Uno微控制器板上。只需连接前述代码中显示的DHT11的`DHT11_data_pin`。此外，将DHT11的GND和VCC引脚分别连接到Arduino
    Uno的GND和3V3引脚。
- en: The next section will show you how to display the humidity and temperature data
    on a 1602 LCD.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个部分将展示如何在1602 LCD上显示湿度和温度数据。
- en: Coding the sensor module and the 1602 LCD
  id: totrans-148
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 编程传感器模块和1602 LCD
- en: 'The following code describes how to get the temperature and humidity data from
    the DHT11 sensor and how to display that data on the 1602 LCD:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码描述了如何从DHT11传感器获取温度和湿度数据，以及如何在1602 LCD上显示这些数据：
- en: '[PRE1]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Bear in mind that the code that's been uploaded to this book's GitHub repository
    contains many comments explaining the main parts of the preceding code. `LiquidCrystal.h`
    is the library that's used for controlling the 1602 LCD. The `math.h` library
    contains the `round()` function, which is used for rounding the humidity value.
    Both libraries belong to the Arduino IDE's original installation files, so we
    don't need to download or install them separately. `DHT.h` is a library for reading
    DHT11 values; its installation was explained previously in this chapter.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，上传到本书GitHub仓库的代码包含许多注释，解释了前述代码的主要部分。`LiquidCrystal.h`是用于控制1602 LCD的库。`math.h`库包含`round()`函数，用于四舍五入湿度值。这两个库都属于Arduino
    IDE的原始安装文件，因此我们不需要单独下载或安装它们。`DHT.h`是一个用于读取DHT11值的库；其安装在本章中已解释过。
- en: The next section describes how to code the LM35 temperature sensor to the Curiosity
    Nano microcontroller board.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个部分将描述如何将LM35温度传感器编程到Curiosity Nano微控制器板上。
- en: Programming the LM35 sensor on the Curiosity Nano board
  id: totrans-153
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在Curiosity Nano板上编程LM35传感器
- en: 'The following code reads the temperature from an LM35 sensor connected to analog
    input port `RA0` of the Curiosity Nano:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码从连接到 Curiosity Nano 的模拟输入端口 `RA0` 的 LM35 传感器读取温度：
- en: '[PRE2]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: As you can see, the Curiosity Nano performs an analog to digital conversion
    for the value that is read from the LM35 sensor using the `ADC_GetConversion()`
    function. We also used the formula for calculating the degrees Celsius according
    to the mV read from the LM35; that is, `temp=(5.0/1023)*LM35read;`.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，Curiosity Nano 使用 `ADC_GetConversion()` 函数将读取自 LM35 传感器的值进行模拟到数字转换。我们还使用了根据从
    LM35 读取的 mV 计算摄氏度的公式；即 `temp=(5.0/1023)*LM35read;`。
- en: With that, you have learned how to get data from the DHT11 sensor module and
    the LM35 sensor by coding the Blue Pill and Curiosoty Nano. The next section will
    show you how to display the DHT11 data on the Arduino IDE's serial monitor.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 通过这样，您已经学会了如何通过编码 Blue Pill 和 Curiosity Nano 来获取 DHT11 传感器模块和 LM35 传感器的数据。下一节将向您展示如何在
    Arduino IDE 的串行监视器上显示 DHT11 数据。
- en: Showing the humidity and temperature data results on the serial port monitor
  id: totrans-158
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在串行端口监视器上显示湿度和温度数据结果
- en: This section describes how the DHT11 data is displayed with the Blue Pill on
    the serial port monitor and the Curiosity Nano microcontroller boards, and also
    discusses what to do next with the data that's obtained from the DHT11 sensor
    module.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 本节描述了如何使用 Blue Pill 和 Curiosity Nano 在串行端口监视器上显示 DHT11 数据，并讨论了如何处理从 DHT11 传感器模块获得的数据。
- en: 'Open and run the code for the Blue Pill on the Arduino IDE. You can read the
    data that was obtained from the DHT11 by clicking on **Tools** | **Serial Monitor**
    from the Arduino IDE''s main menu. This can be seen in the following screenshot:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 打开并运行 Arduino IDE 上的 Blue Pill 代码。您可以通过点击 Arduino IDE 主菜单中的 **工具** | **串行监视器**
    来读取从 DHT11 获得的数据。以下截图显示了这一过程：
- en: '![Figure 5.13 – Screenshot of the Arduino IDE''s serial monitor](img/Figure_5.13_B16413.jpg)'
  id: totrans-161
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.13 – Arduino IDE 的串行监视器截图](img/Figure_5.13_B16413.jpg)'
- en: Figure 5.13 – Screenshot of the Arduino IDE's serial monitor
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.13 – Arduino IDE 的串行监视器截图
- en: Here, you can see that the humidity and temperature values that were obtained
    from the DHT11 are shown with decimal points, thus showing a more accurate temperature.
    Remember that the variables storing these values were declared with the `float`
    type.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，您可以看到从 DHT11 获得的湿度和温度值以小数点显示，从而显示了更精确的温度。请记住，存储这些值的变量是用 `float` 类型声明的。
- en: Tip
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 小贴士
- en: If you can't open the IDE's serial monitor and if the IDE shows a message telling
    you that the USB port cannot be found, it may be that the USB cable that you connected
    to the Blue Pill and to your computer is faulty. In addition, some USB cables
    are not capable of transmitting data because those cables are only used for charging
    devices, which you should not use with the Blue Pill.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您无法打开 IDE 的串行监视器，并且 IDE 显示一条消息告诉您找不到 USB 端口，那么可能是您连接到 Blue Pill 和电脑的 USB 线缆有故障。此外，一些
    USB 线缆只能用于充电设备，这些线缆您不应与 Blue Pill 一起使用。
- en: Please note that the temperature shown in the preceding screenshot is in degrees
    Celsius and that the RH is displayed as a percentage.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，前面截图中的温度是以摄氏度显示的，而相对湿度以百分比显示。
- en: Plotting the data
  id: totrans-167
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 绘制数据
- en: The Arduino IDE's serial port monitor has an interesting option for plotting
    the values that are read from the DHT11 and sent to the serial port graphically.
    Those values are plotted in real time.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: Arduino IDE 的串行端口监视器有一个有趣的选项，可以将从 DHT11 读取并发送到串行端口的值以图形方式绘制。这些值以实时方式绘制。
- en: 'Click on **Tools** | **Serial Plotter** from the Arduino IDE''s main menu and
    see how the data is displayed graphically, as shown here:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 点击 Arduino IDE 主菜单中的 **工具** | **串行绘图器**，查看数据是如何以图形方式显示的，如下所示：
- en: '![Figure 5.14 – Screenshot of the HDT11 serial plotter](img/Figure_5.14_B16413.jpg)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.14 – HDT11 串行绘图器截图](img/Figure_5.14_B16413.jpg)'
- en: Figure 5.14 – Screenshot of the HDT11 serial plotter
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.14 – HDT11 串行绘图器截图
- en: Here, you can see how the DHT11 data is plotted graphically. The *y* axis represents
    the amount of humidity, while the *x* axis represents the time in seconds. The
    graph shows a peak because the environmental humidity changed at that time. To
    test how the DHT11 sensor's humidity measures change, just blow on the sensor.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，您可以查看 DHT11 数据是如何以图形方式绘制的。*y* 轴表示湿度量，而 *x* 轴表示时间（秒）。图表显示了一个峰值，因为当时环境湿度发生了变化。要测试
    DHT11 传感器湿度测量的变化，只需对着传感器吹气。
- en: In this section, you learned how to open the Arduino IDE's serial monitor and
    how the DHT11 sensor module data is displayed on it, including how to plot that
    data graphically.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，你学习了如何打开Arduino IDE的串行监视器以及如何将DHT11传感器模块的数据显示在上面，包括如何以图形方式绘制这些数据。
- en: Summary
  id: totrans-174
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we learned the basics of the DHT11 humidity and temperature
    sensor and the LM35 temperature sensor, including their operating ranges and how
    these sensors send data to a microcontroller board. These are practical and low-cost
    sensors that the Blue Pill and the Curiosity Nano can easily handle. This chapter
    showed two ways of showing humidity and temperature results. The Blue Pill showed
    the humidity and temperature values directly on the computer monitor and on an
    LCD, while the Curiosity Nano showed temperature and humidity ranges with LEDs.
    This chapter was beneficial because you learned how to get environmental data
    from sensors using microcontroller boards and how to display it effectively, using
    the microcontroller boards' input and output ports. This chapter also highlighted
    the use of an LCD to show the temperature and humidity data.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了DHT11湿度和温度传感器以及LM35温度传感器的基础知识，包括它们的操作范围以及这些传感器如何将这些数据发送到微控制器板。这些是实用且低成本的传感器，Blue
    Pill和Curiosity Nano可以轻松处理。本章展示了两种显示湿度和温度结果的方法。Blue Pill直接在计算机监视器和LCD上显示湿度和温度值，而Curiosity
    Nano则使用LED显示温度和湿度范围。本章很有益，因为你学习了如何使用微控制器板从传感器获取环境数据以及如何有效地显示它，使用微控制器板的输入和输出端口。本章还强调了使用LCD显示温度和湿度数据的使用。
- en: '[*Chapter 6*](B16413_06_Final_NM_ePub.xhtml#_idTextAnchor087), *Morse Code
    SOS Visual Alarm with a Bright LED*, will review how to create a practical visual
    alarm.'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第6章*](B16413_06_Final_NM_ePub.xhtml#_idTextAnchor087)，*使用明亮的LED的Morse Code
    SOS视觉警报*，将回顾如何创建一个实用的视觉警报。'
- en: Further reading
  id: totrans-177
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'Horowitz, P., Hill, W. (2015). *The art of electronics*. [3rd ed.] Cambridge
    University Press: New York, NY.'
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Horowitz, P., Hill, W. (2015). *《电子艺术》* [第3版]。剑桥大学出版社：纽约，纽约。
- en: 'LM35 (2017). LM35 Precision Centigrade Temperature Sensor datasheet. Texas
    Instruments. Available from: [https://www.ti.com/lit/ds/symlink/lm35.pdf](https://www.ti.com/lit/ds/symlink/lm35.pdf)'
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: LM35 (2017). LM35精密摄氏度温度传感器数据表。德州仪器。可从：[https://www.ti.com/lit/ds/symlink/lm35.pdf](https://www.ti.com/lit/ds/symlink/lm35.pdf)
- en: 'Microchip (2019). *PIC16F15376 Curiosity Nano hardware user guide*. Microchip
    Technology, Inc. Available from: [http://ww1.microchip.com/downloads/en/DeviceDoc/50002900B.pdf](http://ww1.microchip.com/downloads/en/DeviceDoc/50002900B.pdf)'
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Microchip (2019). *PIC16F15376 Curiosity Nano硬件用户指南*。Microchip技术公司。可从：[http://ww1.microchip.com/downloads/en/DeviceDoc/50002900B.pdf](http://ww1.microchip.com/downloads/en/DeviceDoc/50002900B.pdf)
- en: 'Mouser (2020). *DHT11 humidity and temperature sensor datasheet*. Mouser, Inc.
    Available from: [https://www.mouser.com/datasheet/2/758/DHT11-Technical-Data-Sheet-Translated-Version-1143054.pdf](https://www.mouser.com/datasheet/2/758/DHT11-Technical-Data-Sheet-Translated-Version-1143054.pdf)'
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Mouser (2020). *DHT11湿度和温度传感器数据表*。Mouser公司。可从：[https://www.mouser.com/datasheet/2/758/DHT11-Technical-Data-Sheet-Translated-Version-1143054.pdf](https://www.mouser.com/datasheet/2/758/DHT11-Technical-Data-Sheet-Translated-Version-1143054.pdf)
