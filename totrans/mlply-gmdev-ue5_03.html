<html><head></head><body>
<div id="_idContainer053">
<h1 class="chapter-number" id="_idParaDest-64"><a id="_idTextAnchor065"/><span class="koboSpan" id="kobo.1.1">3</span></h1>
<h1 id="_idParaDest-65"><a id="_idTextAnchor066"/><span class="koboSpan" id="kobo.2.1">Testing the Multiplayer System with a Project Prototype</span></h1>
<p><span class="koboSpan" id="kobo.3.1">Now that you know how networks work and how computers communicate remotely, it’s time to test some of the basic functionalities of the Unreal Engine networking framework. </span><span class="koboSpan" id="kobo.3.2">The best way to understand how different elements interact within the UE environment is by using one of the available project templates and enabling its </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">multiplayer capabilities.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">The main goal of this chapter is to serve as a gentle introduction to the main UE multiplayer framework features and how to test them on a single device, such as your computer. </span><span class="koboSpan" id="kobo.5.2">By the end, you will have created your first multiplayer prototype and will be ready for the next step, which is creating a fully working networked game </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">from scratch.</span></span></p>
<p><span class="koboSpan" id="kobo.7.1">So, through the next few sections, I will present you with the </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.9.1">Creating a multiplayer </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">game prototype</span></span></li>
<li><span class="koboSpan" id="kobo.11.1">Testing a multiplayer </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">game locally</span></span></li>
<li><span class="koboSpan" id="kobo.13.1">Updating properties over </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">the network</span></span></li>
<li><span class="koboSpan" id="kobo.15.1">Executing functions over </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">the network</span></span></li>
</ul>
<h1 id="_idParaDest-66"><a id="_idTextAnchor067"/><span class="koboSpan" id="kobo.17.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.18.1">For this first prototype, you will just need UE 5 to be installed. </span><span class="koboSpan" id="kobo.18.2">For this chapter, you won’t be programming in C++, as the prototype will be </span><span class="No-Break"><span class="koboSpan" id="kobo.19.1">Blueprints only.</span></span></p>
<p><span class="koboSpan" id="kobo.20.1">To make things more interesting, I’ll be using some assets from Quixel Megascans by using the integrated plugin, but this is </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">not mandatory.</span></span></p>
<p><span class="koboSpan" id="kobo.22.1">The finished project can be found in this book’s project template on GitHub, in the </span><a href="B18203_03.xhtml#_idTextAnchor065"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.23.1">Chapter 3</span></em></span></a> <span class="No-Break"><span class="koboSpan" id="kobo.24.1">section: </span></span><a href="https://github.com/PacktPublishing/Multiplayer-Game-Development-with-Unreal-Engine-5"><span class="No-Break"><span class="koboSpan" id="kobo.25.1">https://github.com/PacktPublishing/Multiplayer-Game-Development-with-Unreal-Engine-5</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.26.1">.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.27.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.28.1">Starting from this chapter, I will use the terms “Blueprint” and “Blueprint Class” interchangeably. </span><span class="koboSpan" id="kobo.28.2">If a distinction needs to be made, I will use the appropriate term, such as “</span><span class="No-Break"><span class="koboSpan" id="kobo.29.1">Anim Blueprint.”</span></span></p>
<h1 id="_idParaDest-67"><a id="_idTextAnchor068"/><span class="koboSpan" id="kobo.30.1">Creating a multiplayer game prototype</span></h1>
<p><span class="koboSpan" id="kobo.31.1">For this project, gameplay will not be the primary focus; I want you to concentrate on the core components </span><a id="_idIndexMarker136"/><span class="koboSpan" id="kobo.32.1">of the multiplayer framework. </span><span class="koboSpan" id="kobo.32.2">Accordingly, the game will be quite simple and abide by the following </span><span class="No-Break"><span class="koboSpan" id="kobo.33.1">basic rules:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.34.1">Each player should control </span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">their character</span></span></li>
<li><span class="koboSpan" id="kobo.36.1">The server will spawn item pickups at </span><span class="No-Break"><span class="koboSpan" id="kobo.37.1">random positions</span></span></li>
<li><span class="koboSpan" id="kobo.38.1">Players will capture pickups and gain points </span><span class="No-Break"><span class="koboSpan" id="kobo.39.1">from that</span></span></li>
<li><span class="koboSpan" id="kobo.40.1">The game will go </span><span class="No-Break"><span class="koboSpan" id="kobo.41.1">on indefinitely</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.42.1">Using a pre-made project such as a template is a great opportunity for you to gain hands-on experience with the main multiplayer capabilities in UE without having to waste time creating a project from scratch. </span><span class="koboSpan" id="kobo.42.2">Here, you’ll start by creating your own multiplayer game prototype by using the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.43.1">TopDown</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.44.1"> template.</span></span></p>
<h2 id="_idParaDest-68"><a id="_idTextAnchor069"/><span class="koboSpan" id="kobo.45.1">Setting up the project from a template</span></h2>
<p><span class="koboSpan" id="kobo.46.1">When you are </span><a id="_idIndexMarker137"/><span class="koboSpan" id="kobo.47.1">ready, launch UE 5 from the Epic Games Launcher. </span><span class="koboSpan" id="kobo.47.2">Then, follow </span><span class="No-Break"><span class="koboSpan" id="kobo.48.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.49.1">Select </span><strong class="bold"><span class="koboSpan" id="kobo.50.1">Games</span></strong><span class="koboSpan" id="kobo.51.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.52.1">TopDown</span></strong><span class="koboSpan" id="kobo.53.1"> from the </span><span class="No-Break"><span class="koboSpan" id="kobo.54.1">available templates.</span></span></li>
<li><span class="koboSpan" id="kobo.55.1">Set the project </span><span class="No-Break"><span class="koboSpan" id="kobo.56.1">to </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.57.1">Blueprint</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.58.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.59.1">Name your project (for </span><span class="No-Break"><span class="koboSpan" id="kobo.60.1">instance, </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.61.1">TopDown_Multiplayer</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.62.1">).</span></span></li>
<li><span class="koboSpan" id="kobo.63.1">Leave the other settings as their </span><span class="No-Break"><span class="koboSpan" id="kobo.64.1">default values.</span></span></li>
<li><span class="koboSpan" id="kobo.65.1">Click the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.66.1">Create</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.67.1"> button.</span></span></li>
</ol>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.68.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.69.1">.1</span></em><span class="koboSpan" id="kobo.70.1"> shows the finished settings for </span><span class="No-Break"><span class="koboSpan" id="kobo.71.1">the project:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer029">
<span class="koboSpan" id="kobo.72.1"><img alt="Figure 3.1 – Project setup" src="image/Figure_03_01_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.73.1">Figure 3.1 – Project setup</span></p>
<p><span class="koboSpan" id="kobo.74.1">Once the project </span><a id="_idIndexMarker138"/><span class="koboSpan" id="kobo.75.1">has been created, you are ready to import </span><span class="No-Break"><span class="koboSpan" id="kobo.76.1">some content.</span></span></p>
<h2 id="_idParaDest-69"><a id="_idTextAnchor070"/><span class="koboSpan" id="kobo.77.1">Adding Quixel Megascans</span></h2>
<p><span class="koboSpan" id="kobo.78.1">In this project, I want </span><a id="_idIndexMarker139"/><span class="koboSpan" id="kobo.79.1">to use something </span><a id="_idIndexMarker140"/><span class="koboSpan" id="kobo.80.1">a bit crazy for my pickups: I am going to choose some fruit </span><a id="_idIndexMarker141"/><span class="koboSpan" id="kobo.81.1">and vegetables from the Quixel Megascans </span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">library (</span></span><a href="https://quixel.com/megascans"><span class="No-Break"><span class="koboSpan" id="kobo.83.1">https://quixel.com/megascans</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.84.1">)!</span></span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.85.1">Quixel Megascans</span></strong><span class="koboSpan" id="kobo.86.1"> is a free library that contains high-resolution 3D scans: it is fully integrated with UE; you </span><a id="_idIndexMarker142"/><span class="koboSpan" id="kobo.87.1">will just need to use your Epic Games account. </span><span class="koboSpan" id="kobo.87.2">To access the models from UE, you will need to use Quixel Bridge, a plugin that’s already installed in the Unreal </span><span class="No-Break"><span class="koboSpan" id="kobo.88.1">Engine Editor.</span></span></p>
<p><span class="koboSpan" id="kobo.89.1">To add some </span><a id="_idIndexMarker143"/><span class="koboSpan" id="kobo.90.1">Megascans to the project, just </span><span class="No-Break"><span class="koboSpan" id="kobo.91.1">do this:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.92.1">Open Quixel Bridge by clicking </span><strong class="bold"><span class="koboSpan" id="kobo.93.1">Quickly add to the project</span></strong><span class="koboSpan" id="kobo.94.1"> | </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.95.1">Quixel Bridge</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.96.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.97.1">From the </span><strong class="bold"><span class="koboSpan" id="kobo.98.1">3D Assets</span></strong><span class="koboSpan" id="kobo.99.1"> section, look for some fruit or vegetables – or anything that will spark </span><span class="No-Break"><span class="koboSpan" id="kobo.100.1">your imagination!</span></span></li>
<li><span class="koboSpan" id="kobo.101.1">Download the </span><a id="_idIndexMarker144"/><span class="koboSpan" id="kobo.102.1">assets and add them to your project by clicking the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.103.1">Download</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.104.1"> button.</span></span></li>
</ol>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.105.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.106.1">.2</span></em><span class="koboSpan" id="kobo.107.1"> depicts Quixel Bridge with some of my selected models during the </span><span class="No-Break"><span class="koboSpan" id="kobo.108.1">download phase:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer030">
<span class="koboSpan" id="kobo.109.1"><img alt="Figure 3.2 – Quixel Bridge" src="image/Figure_03_02_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.110.1">Figure 3.2 – Quixel Bridge</span></p>
<p><span class="koboSpan" id="kobo.111.1">Once you have obtained your assets, they will likely be of various sizes. </span><span class="koboSpan" id="kobo.111.2">However, you will need to resize them to create a visually appealing and functional pickup. </span><span class="koboSpan" id="kobo.111.3">To do so, follow </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.113.1">From the main menu, create an empty level by selecting </span><strong class="bold"><span class="koboSpan" id="kobo.114.1">File</span></strong><span class="koboSpan" id="kobo.115.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.116.1">New Level</span></strong><span class="koboSpan" id="kobo.117.1"> and selecting the </span><strong class="bold"><span class="koboSpan" id="kobo.118.1">Basic</span></strong><span class="koboSpan" id="kobo.119.1"> option. </span><span class="koboSpan" id="kobo.119.2">Then, add a reference character (I used the </span><strong class="bold"><span class="koboSpan" id="kobo.120.1">SKM_Quinn</span></strong><span class="koboSpan" id="kobo.121.1"> model located in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.122.1">Content</span></strong><span class="koboSpan" id="kobo.123.1"> | </span><strong class="source-inline"><span class="koboSpan" id="kobo.124.1">Characters</span></strong><span class="koboSpan" id="kobo.125.1"> | </span><strong class="source-inline"><span class="koboSpan" id="kobo.126.1">Mannequins</span></strong><span class="koboSpan" id="kobo.127.1"> | </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.128.1">Meshes</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.129.1"> folder).</span></span></li>
<li><span class="koboSpan" id="kobo.130.1">Add your </span><a id="_idIndexMarker145"/><span class="koboSpan" id="kobo.131.1">models next to </span><a id="_idIndexMarker146"/><span class="No-Break"><span class="koboSpan" id="kobo.132.1">the reference.</span></span></li>
<li><span class="koboSpan" id="kobo.133.1">Scale them so that they are about a third of the size of </span><span class="No-Break"><span class="koboSpan" id="kobo.134.1">the reference.</span></span></li>
</ol>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.135.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.136.1">.3</span></em><span class="koboSpan" id="kobo.137.1"> shows the models once they have </span><span class="No-Break"><span class="koboSpan" id="kobo.138.1">been resized:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer031">
<span class="koboSpan" id="kobo.139.1"><img alt="Figure 3.3 – The resized models" src="image/Figure_03_03_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.140.1">Figure 3.3 – The resized models</span></p>
<p><span class="koboSpan" id="kobo.141.1">Since the pickups will be created from a common Blueprint parent, the best thing to do is to set the scale of the models to 1, which we can achieve through the </span><strong class="bold"><span class="koboSpan" id="kobo.142.1">Modeling Tools</span></strong><span class="koboSpan" id="kobo.143.1"> available in UE. </span><span class="koboSpan" id="kobo.143.2">Open the </span><strong class="bold"><span class="koboSpan" id="kobo.144.1">Modeling Tools</span></strong><span class="koboSpan" id="kobo.145.1"> panel by selecting it from the </span><strong class="bold"><span class="koboSpan" id="kobo.146.1">Mode Selection</span></strong><span class="koboSpan" id="kobo.147.1"> dropdown in the </span><strong class="bold"><span class="koboSpan" id="kobo.148.1">Main Toolbar</span></strong><span class="koboSpan" id="kobo.149.1"> area, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.150.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.151.1">.4</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.152.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer032">
<span class="koboSpan" id="kobo.153.1"><img alt="Figure 3.4 – Activating the Modeling Tools panel" src="image/Figure_03_04_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.154.1">Figure 3.4 – Activating the Modeling Tools panel</span></p>
<p><span class="koboSpan" id="kobo.155.1">Once the </span><strong class="bold"><span class="koboSpan" id="kobo.156.1">Modeling Tools</span></strong><span class="koboSpan" id="kobo.157.1"> panel has been enabled, execute the following steps for each of </span><span class="No-Break"><span class="koboSpan" id="kobo.158.1">the models:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.159.1">Select </span><a id="_idIndexMarker147"/><span class="No-Break"><span class="koboSpan" id="kobo.160.1">the model.</span></span></li>
<li><span class="koboSpan" id="kobo.161.1">Select </span><strong class="bold"><span class="koboSpan" id="kobo.162.1">Transform</span></strong><span class="koboSpan" id="kobo.163.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.164.1">BakeRS</span></strong><span class="koboSpan" id="kobo.165.1"> to </span><a id="_idIndexMarker148"/><span class="koboSpan" id="kobo.166.1">activate the </span><strong class="bold"><span class="koboSpan" id="kobo.167.1">Rotation and Scale</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.168.1">baking tool.</span></span></li>
<li><span class="koboSpan" id="kobo.169.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.170.1">New Asset Location</span></strong><span class="koboSpan" id="kobo.171.1"> drop-down menu at the bottom of the tool, select </span><strong class="bold"><span class="koboSpan" id="kobo.172.1">AutoGen </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.173.1">Folder (Global)</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.174.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.175.1">Click the blue </span><strong class="bold"><span class="koboSpan" id="kobo.176.1">Accept</span></strong><span class="koboSpan" id="kobo.177.1"> button to start the </span><span class="No-Break"><span class="koboSpan" id="kobo.178.1">baking process.</span></span></li>
</ol>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.179.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.180.1">.5</span></em><span class="koboSpan" id="kobo.181.1"> depicts the </span><strong class="bold"><span class="koboSpan" id="kobo.182.1">BakeRS</span></strong><span class="koboSpan" id="kobo.183.1"> tool open and ready to process </span><span class="No-Break"><span class="koboSpan" id="kobo.184.1">a model:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer033">
<span class="koboSpan" id="kobo.185.1"><img alt="Figure 3.5 – The BakeRS tool" src="image/Figure_03_05_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.186.1">Figure 3.5 – The BakeRS tool</span></p>
<p><span class="koboSpan" id="kobo.187.1">At the end of this </span><a id="_idIndexMarker149"/><span class="koboSpan" id="kobo.188.1">process, all three </span><a id="_idIndexMarker150"/><span class="koboSpan" id="kobo.189.1">models will be of equal size, but each scaled to a value </span><span class="No-Break"><span class="koboSpan" id="kobo.190.1">of 1.</span></span></p>
<p><span class="koboSpan" id="kobo.191.1">The last thing you must do is generate a collision for each of </span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">the models:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.193.1">Open each of the static meshes in </span><span class="No-Break"><span class="koboSpan" id="kobo.194.1">the project.</span></span></li>
<li><span class="koboSpan" id="kobo.195.1">Open the </span><strong class="bold"><span class="koboSpan" id="kobo.196.1">Collision</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.197.1">drop-down menu.</span></span></li>
<li><span class="koboSpan" id="kobo.198.1">Select </span><strong class="bold"><span class="koboSpan" id="kobo.199.1">Add 26DOP Simplified Collision</span></strong><span class="koboSpan" id="kobo.200.1"> to add a collision area to </span><span class="No-Break"><span class="koboSpan" id="kobo.201.1">the mesh.</span></span></li>
<li><span class="koboSpan" id="kobo.202.1">Save the modified assets to apply </span><span class="No-Break"><span class="koboSpan" id="kobo.203.1">the changes.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.204.1">This scene can be safely closed as you won’t be using it anymore. </span><span class="koboSpan" id="kobo.204.2">Open </span><strong class="bold"><span class="koboSpan" id="kobo.205.1">TopDownMap</span></strong><span class="koboSpan" id="kobo.206.1">, which is located in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.207.1">Content</span></strong><span class="koboSpan" id="kobo.208.1"> | </span><strong class="source-inline"><span class="koboSpan" id="kobo.209.1">TopDown</span></strong><span class="koboSpan" id="kobo.210.1"> | </span><strong class="source-inline"><span class="koboSpan" id="kobo.211.1">Maps</span></strong><span class="koboSpan" id="kobo.212.1"> folder. </span><span class="koboSpan" id="kobo.212.2">By doing this, your assets will be ready to use as pickups in </span><span class="No-Break"><span class="koboSpan" id="kobo.213.1">the game.</span></span></p>
<p><span class="koboSpan" id="kobo.214.1">The next step will be to modify the Player Controller so that you can handle the </span><span class="No-Break"><span class="koboSpan" id="kobo.215.1">Pawn movement.</span></span></p>
<h2 id="_idParaDest-70"><a id="_idTextAnchor071"/><span class="koboSpan" id="kobo.216.1">Modifying the Player Controller</span></h2>
<p><span class="koboSpan" id="kobo.217.1">The Player Controller from the template is already operational and works properly, but to make the game a </span><a id="_idIndexMarker151"/><span class="koboSpan" id="kobo.218.1">bit more </span><a id="_idIndexMarker152"/><span class="koboSpan" id="kobo.219.1">exciting (it’s a multiplayer game, after all!), you’ll need to make some </span><span class="No-Break"><span class="koboSpan" id="kobo.220.1">minor adjustments.</span></span></p>
<p><span class="koboSpan" id="kobo.221.1">At the moment, character movement is controlled by a single click on a point on the map. </span><span class="koboSpan" id="kobo.221.2">However, we want players to be able to move their character by keeping the mouse button pressed and moving it around </span><span class="No-Break"><span class="koboSpan" id="kobo.222.1">the level.</span></span></p>
<p><span class="koboSpan" id="kobo.223.1">Follow these steps to modify the Player </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">Controller Blueprint:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.225.1">Navigate to </span><strong class="bold"><span class="koboSpan" id="kobo.226.1">Content</span></strong><span class="koboSpan" id="kobo.227.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.228.1">TopDown</span></strong><span class="koboSpan" id="kobo.229.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.230.1">Blueprints</span></strong><span class="koboSpan" id="kobo.231.1"> and open the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.232.1">BP_TopDownController</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.233.1"> Blueprint.</span></span></li>
<li><span class="koboSpan" id="kobo.234.1">Then, open the Event Graph by clicking the </span><strong class="bold"><span class="koboSpan" id="kobo.235.1">Event </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.236.1">Graph</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.237.1"> tab.</span></span></li>
<li><span class="koboSpan" id="kobo.238.1">Delete the </span><strong class="bold"><span class="koboSpan" id="kobo.239.1">Set Destination Input – Touch</span></strong><span class="koboSpan" id="kobo.240.1"> group as you won’t be </span><span class="No-Break"><span class="koboSpan" id="kobo.241.1">using it.</span></span></li>
<li><span class="koboSpan" id="kobo.242.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.243.1">Set Destination Input – Gamepad and Mouse</span></strong><span class="koboSpan" id="kobo.244.1"> group, delete all the nodes connected to the </span><strong class="bold"><span class="koboSpan" id="kobo.245.1">Canceled</span></strong><span class="koboSpan" id="kobo.246.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.247.1">Completed</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.248.1">execution pins.</span></span></li>
<li><span class="koboSpan" id="kobo.249.1">Connect the </span><strong class="bold"><span class="koboSpan" id="kobo.250.1">Ongoing</span></strong><span class="koboSpan" id="kobo.251.1"> execution pin to the same </span><strong class="bold"><span class="koboSpan" id="kobo.252.1">Branch</span></strong><span class="koboSpan" id="kobo.253.1"> node as the </span><strong class="bold"><span class="koboSpan" id="kobo.254.1">Triggered</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.255.1">execution pin.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.256.1">The modified graph should look </span><span class="No-Break"><span class="koboSpan" id="kobo.257.1">like this:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer034">
<span class="koboSpan" id="kobo.258.1"><img alt="Figure 3.6 – The modified graph for the Player Controller" src="image/Figure_03_06_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.259.1">Figure 3.6 – The modified graph for the Player Controller</span></p>
<p><span class="koboSpan" id="kobo.260.1">Now that the Player Controller has been modified, if you try playing the game as is, you should be able to move </span><a id="_idIndexMarker153"/><span class="koboSpan" id="kobo.261.1">your character </span><a id="_idIndexMarker154"/><span class="koboSpan" id="kobo.262.1">around whenever you keep the left mouse button pressed. </span><span class="koboSpan" id="kobo.262.2">This is the normal behavior you would expect when playing a </span><span class="No-Break"><span class="koboSpan" id="kobo.263.1">standalone game.</span></span></p>
<p><span class="koboSpan" id="kobo.264.1">In the next section, you’ll learn how to set up UE so that it simulates a multiplayer session on </span><span class="No-Break"><span class="koboSpan" id="kobo.265.1">your computer.</span></span></p>
<h1 id="_idParaDest-71"><a id="_idTextAnchor072"/><span class="koboSpan" id="kobo.266.1">Testing a multiplayer game locally</span></h1>
<p><span class="koboSpan" id="kobo.267.1">Testing a multiplayer game can pose a problem as it requires the game to be available across multiple </span><a id="_idIndexMarker155"/><span class="koboSpan" id="kobo.268.1">devices. </span><span class="koboSpan" id="kobo.268.2">Luckily, UE allows you to simulate this scenario on a single computer, making it much easier for developers to create and test multiplayer games. </span><span class="koboSpan" id="kobo.268.3">In this section, you will learn how to use your editor as a server and launch other game </span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">instances locally.</span></span></p>
<h2 id="_idParaDest-72"><a id="_idTextAnchor073"/><span class="koboSpan" id="kobo.270.1">Playing as a Listen Server</span></h2>
<p><span class="koboSpan" id="kobo.271.1">It’s time to start </span><a id="_idIndexMarker156"/><span class="koboSpan" id="kobo.272.1">testing how the game works in a multiplayer environment. </span><span class="koboSpan" id="kobo.272.2">You’ll be doing this by using UE’s </span><strong class="bold"><span class="koboSpan" id="kobo.273.1">Net </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.274.1">Mode</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.275.1"> feature:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.276.1">Open the </span><strong class="bold"><span class="koboSpan" id="kobo.277.1">Change Play Mode and Play Settings</span></strong><span class="koboSpan" id="kobo.278.1"> menu by clicking the hamburger button next to the </span><strong class="bold"><span class="koboSpan" id="kobo.279.1">Play</span></strong><span class="koboSpan" id="kobo.280.1"> button, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.281.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.282.1">.7</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.283.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer035">
<span class="koboSpan" id="kobo.284.1"><img alt="Figure 3.7 – The hamburger button" src="image/Figure_03_07_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.285.1">Figure 3.7 – The hamburger button</span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.286.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.287.1">Number of Players</span></strong><span class="koboSpan" id="kobo.288.1"> field, enter the number of players you want to simulate; for </span><span class="No-Break"><span class="koboSpan" id="kobo.289.1">instance, </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.290.1">3</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.291.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.292.1">Then, select </span><strong class="bold"><span class="koboSpan" id="kobo.293.1">Net Mode</span></strong><span class="koboSpan" id="kobo.294.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.295.1">Play As Listen Server</span></strong><span class="koboSpan" id="kobo.296.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.297.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.298.1">.8</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.299.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer036">
<span class="koboSpan" id="kobo.300.1"><img alt="Figure 3.8 – The Net Mode settings" src="image/Figure_03_08_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.301.1">Figure 3.8 – The Net Mode settings</span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.302.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.303.1">When you are testing a game in the Editor as a </span><strong class="bold"><span class="koboSpan" id="kobo.304.1">Listen Server</span></strong><span class="koboSpan" id="kobo.305.1">, the Editor acts as a server and a client. </span><span class="koboSpan" id="kobo.305.2">Depending on the number of players selected, additional instances will be opened for testing purposes. </span><span class="koboSpan" id="kobo.305.3">As a side note, launching the game in </span><strong class="bold"><span class="koboSpan" id="kobo.306.1">New Editor Window (PIE)</span></strong><span class="koboSpan" id="kobo.307.1"> mode will designate one of the screens as the server and the other screens as clients. </span><span class="koboSpan" id="kobo.307.2">This distinction can be identified by examining the title bar of the </span><span class="No-Break"><span class="koboSpan" id="kobo.308.1">launched windows.</span></span></p>
<p><span class="koboSpan" id="kobo.309.1">You can now click the </span><strong class="bold"><span class="koboSpan" id="kobo.310.1">Play</span></strong><span class="koboSpan" id="kobo.311.1"> button, after which the Editor will open one window for each additional player, as depicted in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.312.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.313.1">.9</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.314.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer037">
<span class="koboSpan" id="kobo.315.1"><img alt="Figure 3.9 – Testing the game as a Listen Server" src="image/Figure_03_09_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.316.1">Figure 3.9 – Testing the game as a Listen Server</span></p>
<p><span class="koboSpan" id="kobo.317.1">Focusing on each </span><a id="_idIndexMarker157"/><span class="koboSpan" id="kobo.318.1">window will let you play each </span><span class="No-Break"><span class="koboSpan" id="kobo.319.1">independent character.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.320.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.321.1">If you check the </span><strong class="bold"><span class="koboSpan" id="kobo.322.1">Outliner</span></strong><span class="koboSpan" id="kobo.323.1"> window while in Play Mode, you will notice that there are three </span><strong class="bold"><span class="koboSpan" id="kobo.324.1">BP_TopDownCharacter</span></strong><span class="koboSpan" id="kobo.325.1"> instances (one for each player), but just one </span><strong class="bold"><span class="koboSpan" id="kobo.326.1">BP_TopDownController</span></strong><span class="koboSpan" id="kobo.327.1"> – this is the one you will need for the </span><span class="No-Break"><span class="koboSpan" id="kobo.328.1">local player.</span></span></p>
<h2 id="_idParaDest-73"><a id="_idTextAnchor074"/><span class="koboSpan" id="kobo.329.1">Updating over the network</span></h2>
<p><span class="koboSpan" id="kobo.330.1">At this point, you </span><a id="_idIndexMarker158"/><span class="koboSpan" id="kobo.331.1">may be wondering how characters can be synchronized across different clients, given that we have not done anything related to </span><span class="No-Break"><span class="koboSpan" id="kobo.332.1">the network.</span></span></p>
<p><span class="koboSpan" id="kobo.333.1">The answer is </span><strong class="bold"><span class="koboSpan" id="kobo.334.1">replication</span></strong><span class="koboSpan" id="kobo.335.1">, which I explained in the previous chapter, and is demonstrated in this prototype: Character Actors are replication-enabled, so some of their properties, such as </span><strong class="bold"><span class="koboSpan" id="kobo.336.1">Location</span></strong><span class="koboSpan" id="kobo.337.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.338.1">Rotation</span></strong><span class="koboSpan" id="kobo.339.1">, are updated across clients </span><span class="No-Break"><span class="koboSpan" id="kobo.340.1">during gameplay.</span></span></p>
<p><span class="koboSpan" id="kobo.341.1">To see whether an Actor replicates, do </span><span class="No-Break"><span class="koboSpan" id="kobo.342.1">the following:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.343.1">Open the </span><strong class="bold"><span class="koboSpan" id="kobo.344.1">BP_TopDownCharacter</span></strong><span class="koboSpan" id="kobo.345.1"> Blueprint by going to </span><strong class="bold"><span class="koboSpan" id="kobo.346.1">Content</span></strong><span class="koboSpan" id="kobo.347.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.348.1">TopDown</span></strong><span class="koboSpan" id="kobo.349.1"> | </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.350.1">Blueprints</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.351.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.352.1">Open the </span><strong class="bold"><span class="koboSpan" id="kobo.353.1">Details</span></strong><span class="koboSpan" id="kobo.354.1"> panel by clicking the </span><strong class="bold"><span class="koboSpan" id="kobo.355.1">Class </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.356.1">Defaults</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.357.1"> tab.</span></span></li>
<li><span class="koboSpan" id="kobo.358.1">Find the </span><strong class="bold"><span class="koboSpan" id="kobo.359.1">Replication</span></strong><span class="koboSpan" id="kobo.360.1"> category and notice that the </span><strong class="bold"><span class="koboSpan" id="kobo.361.1">Replicates</span></strong><span class="koboSpan" id="kobo.362.1"> attribute has been selected. </span><span class="koboSpan" id="kobo.362.2">Additionally, notice that </span><strong class="bold"><span class="koboSpan" id="kobo.363.1">Replicate Movement</span></strong><span class="koboSpan" id="kobo.364.1"> is selected, as depicted in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.365.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.366.1">.10</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.367.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer038">
<span class="koboSpan" id="kobo.368.1"><img alt="Figure 3.10 – The Replication category" src="image/Figure_03_10_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.369.1">Figure 3.10 – The Replication category</span></p>
<p><span class="koboSpan" id="kobo.370.1">One of the best </span><a id="_idIndexMarker159"/><span class="koboSpan" id="kobo.371.1">parts of activating the </span><strong class="bold"><span class="koboSpan" id="kobo.372.1">Replicates</span></strong><span class="koboSpan" id="kobo.373.1"> attribute is that properties will be updated automatically over the network: you won’t need to do anything else. </span><span class="koboSpan" id="kobo.373.2">Later, you will learn how to execute functions by calling them over </span><span class="No-Break"><span class="koboSpan" id="kobo.374.1">the network.</span></span></p>
<h2 id="_idParaDest-74"><a id="_idTextAnchor075"/><span class="koboSpan" id="kobo.375.1">Adding additional character spawn points</span></h2>
<p><span class="koboSpan" id="kobo.376.1">As you may </span><a id="_idIndexMarker160"/><span class="koboSpan" id="kobo.377.1">have noticed, the three players have been spawned next to each other: this is because we have a single Player Start Actor in </span><span class="No-Break"><span class="koboSpan" id="kobo.378.1">the level.</span></span></p>
<p><span class="koboSpan" id="kobo.379.1">To fix things up, you will be adding some more </span><span class="No-Break"><span class="koboSpan" id="kobo.380.1">spawn points:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.381.1">Add several </span><strong class="bold"><span class="koboSpan" id="kobo.382.1">Player Start</span></strong><span class="koboSpan" id="kobo.383.1"> objects, up to the number of players you want to test – you can do this by clicking the </span><strong class="bold"><span class="koboSpan" id="kobo.384.1">Quickly Add To The Project</span></strong><span class="koboSpan" id="kobo.385.1"> button, then selecting </span><strong class="bold"><span class="koboSpan" id="kobo.386.1">Basic</span></strong><span class="koboSpan" id="kobo.387.1"> | </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.388.1">Player Start</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.389.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.390.1">Place them anywhere on the map that you deem suitable for your game. </span><span class="koboSpan" id="kobo.390.2">In </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.391.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.392.1">.11</span></em><span class="koboSpan" id="kobo.393.1">, you can see my choice for the three </span><span class="No-Break"><span class="koboSpan" id="kobo.394.1">spawn points:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer039">
<span class="koboSpan" id="kobo.395.1"><img alt="Figure 3.11 – Adding more spawn points" src="image/Figure_03_11_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.396.1">Figure 3.11 – Adding more spawn points</span></p>
<p><span class="koboSpan" id="kobo.397.1">If you test your game at this point, you will notice that players are now randomly spawning at the </span><strong class="bold"><span class="koboSpan" id="kobo.398.1">Player Start</span></strong><span class="koboSpan" id="kobo.399.1"> positions, but sometimes, two or more characters still end up at the same spawn point. </span><span class="koboSpan" id="kobo.399.2">This can easily be fixed by checking positions that have already been taken </span><a id="_idIndexMarker161"/><span class="koboSpan" id="kobo.400.1">and excluding them from the selection when a new player joins the session. </span><span class="koboSpan" id="kobo.400.2">To do this, follow </span><span class="No-Break"><span class="koboSpan" id="kobo.401.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.402.1">Open the </span><strong class="bold"><span class="koboSpan" id="kobo.403.1">BP_TopDownGameMode</span></strong><span class="koboSpan" id="kobo.404.1"> Blueprint by going to </span><strong class="bold"><span class="koboSpan" id="kobo.405.1">Content</span></strong><span class="koboSpan" id="kobo.406.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.407.1">Topdown</span></strong><span class="koboSpan" id="kobo.408.1"> | </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.409.1">Blueprints</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.410.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.411.1">Then, open the </span><span class="No-Break"><span class="koboSpan" id="kobo.412.1">Event Graph.</span></span></li>
<li><span class="koboSpan" id="kobo.413.1">In </span><strong class="bold"><span class="koboSpan" id="kobo.414.1">My Blueprints</span></strong><span class="koboSpan" id="kobo.415.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.416.1">Functions</span></strong><span class="koboSpan" id="kobo.417.1">, add an override to the </span><strong class="bold"><span class="koboSpan" id="kobo.418.1">ChoosePlayerStart</span></strong><span class="koboSpan" id="kobo.419.1"> function by clicking the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.420.1">Override</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.421.1"> option.</span></span></li>
<li><span class="koboSpan" id="kobo.422.1">Add a </span><strong class="bold"><span class="koboSpan" id="kobo.423.1">Get All Actors Of Class</span></strong><span class="koboSpan" id="kobo.424.1"> node and connect its incoming execution pin to the execution pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.425.1">Choose Player Start</span></strong><span class="koboSpan" id="kobo.426.1"> node. </span><span class="koboSpan" id="kobo.426.2">Then, set the </span><strong class="bold"><span class="koboSpan" id="kobo.427.1">Actor Class</span></strong><span class="koboSpan" id="kobo.428.1"> drop-down attribute to </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.429.1">Player Start</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.430.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.431.1">Add a </span><strong class="bold"><span class="koboSpan" id="kobo.432.1">For Each Loop</span></strong><span class="koboSpan" id="kobo.433.1"> node to cycle through all the </span><strong class="bold"><span class="koboSpan" id="kobo.434.1">Out Actor</span></strong><span class="koboSpan" id="kobo.435.1"> properties you found in the </span><span class="No-Break"><span class="koboSpan" id="kobo.436.1">previous node.</span></span></li>
<li><span class="koboSpan" id="kobo.437.1">Connect the </span><strong class="bold"><span class="koboSpan" id="kobo.438.1">Loop Body</span></strong><span class="koboSpan" id="kobo.439.1"> execution pin to a </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.440.1">Branch</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.441.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.442.1">Click and drag from the </span><strong class="bold"><span class="koboSpan" id="kobo.443.1">Array Element</span></strong><span class="koboSpan" id="kobo.444.1"> pin for the loop to get a </span><strong class="bold"><span class="koboSpan" id="kobo.445.1">Player Start Tag</span></strong><span class="koboSpan" id="kobo.446.1"> node and connect its outgoing pin to a not equal (</span><strong class="bold"><span class="koboSpan" id="kobo.447.1">!=</span></strong><span class="koboSpan" id="kobo.448.1">) node. </span><span class="koboSpan" id="kobo.448.2">Assign the comparison value of this node to </span><strong class="bold"><span class="koboSpan" id="kobo.449.1">Used</span></strong><span class="koboSpan" id="kobo.450.1">. </span><span class="koboSpan" id="kobo.450.2">Connect the outcome of this check to the </span><strong class="bold"><span class="koboSpan" id="kobo.451.1">Condition</span></strong><span class="koboSpan" id="kobo.452.1"> pin of the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.453.1">Branch</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.454.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.455.1">Connect the </span><strong class="bold"><span class="koboSpan" id="kobo.456.1">True</span></strong><span class="koboSpan" id="kobo.457.1"> execution pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.458.1">Branch</span></strong><span class="koboSpan" id="kobo.459.1"> node to a </span><strong class="bold"><span class="koboSpan" id="kobo.460.1">Set Player Start </span></strong><strong class="bold"><span class="koboSpan" id="kobo.461.1">Tag </span></strong><span class="koboSpan" id="kobo.462.1">node</span><strong class="bold"> </strong><span class="koboSpan" id="kobo.463.1">with a value </span><a id="_idIndexMarker162"/><span class="koboSpan" id="kobo.464.1">equal to </span><strong class="bold"><span class="koboSpan" id="kobo.465.1">Used</span></strong><span class="koboSpan" id="kobo.466.1">. </span><span class="koboSpan" id="kobo.466.2">The </span><strong class="bold"><span class="koboSpan" id="kobo.467.1">Target</span></strong><span class="koboSpan" id="kobo.468.1"> pin should be connected to the </span><strong class="bold"><span class="koboSpan" id="kobo.469.1">Array Element</span></strong><span class="koboSpan" id="kobo.470.1"> area of </span><span class="No-Break"><span class="koboSpan" id="kobo.471.1">the loop.</span></span></li>
<li><span class="koboSpan" id="kobo.472.1">Connect the outgoing execution pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.473.1">Set</span></strong><span class="koboSpan" id="kobo.474.1"> node to the graph’s </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.475.1">Return Node</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.476.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.477.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.478.1">Return Value</span></strong><span class="koboSpan" id="kobo.479.1"> pin of </span><strong class="bold"><span class="koboSpan" id="kobo.480.1">Return Node</span></strong><span class="koboSpan" id="kobo.481.1"> should be set to the </span><strong class="bold"><span class="koboSpan" id="kobo.482.1">Array Element</span></strong><span class="koboSpan" id="kobo.483.1"> property of </span><span class="No-Break"><span class="koboSpan" id="kobo.484.1">the loop.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.485.1">The resulting Blueprint is shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.486.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.487.1">.12</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.488.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer040">
<span class="koboSpan" id="kobo.489.1"><img alt="Figure 3.12 – The Game Mode graph" src="image/Figure_03_12_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.490.1">Figure 3.12 – The Game Mode graph</span></p>
<p><span class="koboSpan" id="kobo.491.1">What this graph does is cycle through all of the </span><strong class="bold"><span class="koboSpan" id="kobo.492.1">Player Start</span></strong><span class="koboSpan" id="kobo.493.1"> objects in the level and look for one that has not been tagged as </span><strong class="bold"><span class="koboSpan" id="kobo.494.1">Used</span></strong><span class="koboSpan" id="kobo.495.1"> (that is, it has not been taken already). </span><span class="koboSpan" id="kobo.495.2">Once a good candidate has been found, it is tagged as </span><strong class="bold"><span class="koboSpan" id="kobo.496.1">Used</span></strong><span class="koboSpan" id="kobo.497.1"> and its value is returned, ready to be used as a spawn point for </span><span class="No-Break"><span class="koboSpan" id="kobo.498.1">the character.</span></span></p>
<p><span class="koboSpan" id="kobo.499.1">Run the game – each character should now be spawned at unique locations. </span><span class="koboSpan" id="kobo.499.2">With that, your players are </span><a id="_idIndexMarker163"/><span class="koboSpan" id="kobo.500.1">now ready to interact with </span><span class="No-Break"><span class="koboSpan" id="kobo.501.1">the level!</span></span></p>
<p><span class="koboSpan" id="kobo.502.1">Play around and test your game: check that everything runs as expected and that players are correctly synchronized over </span><span class="No-Break"><span class="koboSpan" id="kobo.503.1">all clients.</span></span></p>
<p><span class="koboSpan" id="kobo.504.1">In the next section, you will learn how to update attributes across multiple clients by adding some pickups and assigning points to the characters as they </span><span class="No-Break"><span class="koboSpan" id="kobo.505.1">get them.</span></span></p>
<h1 id="_idParaDest-75"><a id="_idTextAnchor076"/><span class="koboSpan" id="kobo.506.1">Updating properties over the network</span></h1>
<p><span class="koboSpan" id="kobo.507.1">Now, it’s time </span><a id="_idIndexMarker164"/><span class="koboSpan" id="kobo.508.1">to add some gameplay and properly synchronize elements at runtime. </span><span class="koboSpan" id="kobo.508.2">In the next few subsections, you’ll work on the </span><span class="No-Break"><span class="koboSpan" id="kobo.509.1">following features:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.510.1">Creating the </span><span class="No-Break"><span class="koboSpan" id="kobo.511.1">pickup Blueprint</span></span></li>
<li><span class="koboSpan" id="kobo.512.1">Adding </span><span class="No-Break"><span class="koboSpan" id="kobo.513.1">pickup variants</span></span></li>
<li><span class="koboSpan" id="kobo.514.1">Adding a points counter to </span><span class="No-Break"><span class="koboSpan" id="kobo.515.1">the characters</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.516.1">Let’s add these </span><span class="No-Break"><span class="koboSpan" id="kobo.517.1">features now.</span></span></p>
<h2 id="_idParaDest-76"><a id="_idTextAnchor077"/><span class="koboSpan" id="kobo.518.1">Creating the pickup Blueprint</span></h2>
<p><span class="koboSpan" id="kobo.519.1">The first thing </span><a id="_idIndexMarker165"/><span class="koboSpan" id="kobo.520.1">we are going to create is a pickable item that will grant points to the character that picks it up by sending them </span><span class="No-Break"><span class="koboSpan" id="kobo.521.1">a message.</span></span></p>
<p><span class="koboSpan" id="kobo.522.1">To create this type of communication, you’ll need to create </span><span class="No-Break"><span class="koboSpan" id="kobo.523.1">an interface:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.524.1">In your </span><strong class="source-inline"><span class="koboSpan" id="kobo.525.1">Blueprint</span></strong><span class="koboSpan" id="kobo.526.1"> folder, right-click and select </span><strong class="bold"><span class="koboSpan" id="kobo.527.1">Blueprints</span></strong><span class="koboSpan" id="kobo.528.1"> | </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.529.1">Blueprint Interface</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.530.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.531.1">Name the </span><span class="No-Break"><span class="koboSpan" id="kobo.532.1">interface </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.533.1">PointsAdder</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.534.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.535.1">Open the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.536.1">Blueprint Interface</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.537.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.538.1">Rename the default </span><span class="No-Break"><span class="koboSpan" id="kobo.539.1">function </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.540.1">AddPoints</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.541.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.542.1">Add an </span><strong class="bold"><span class="koboSpan" id="kobo.543.1">Input</span></strong><span class="koboSpan" id="kobo.544.1"> parameter called </span><strong class="source-inline"><span class="koboSpan" id="kobo.545.1">Value</span></strong><span class="koboSpan" id="kobo.546.1"> that’s of the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.547.1">Integer</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.548.1"> type.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.549.1">The interface you have just created should be the same as the one shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.550.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.551.1">.13</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.552.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer041">
<span class="koboSpan" id="kobo.553.1"><img alt="Figure 3.13 – The PointsAdder interface with the AddPoints declaration" src="image/Figure_03_13_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.554.1">Figure 3.13 – The PointsAdder interface with the AddPoints declaration</span></p>
<p><span class="koboSpan" id="kobo.555.1">Once the interface is ready, you’ll </span><a id="_idIndexMarker166"/><span class="koboSpan" id="kobo.556.1">need to create the pickup Blueprint that will </span><span class="No-Break"><span class="koboSpan" id="kobo.557.1">use it:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.558.1">In your </span><strong class="source-inline"><span class="koboSpan" id="kobo.559.1">Blueprints</span></strong><span class="koboSpan" id="kobo.560.1"> folder, add a Blueprint Class that inherits from </span><strong class="bold"><span class="koboSpan" id="kobo.561.1">StaticMeshActor</span></strong><span class="koboSpan" id="kobo.562.1">, and name the </span><span class="No-Break"><span class="koboSpan" id="kobo.563.1">Blueprint </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.564.1">BP_BasePickup</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.565.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.566.1">Open the Blueprint. </span><span class="koboSpan" id="kobo.566.2">Then, select the </span><strong class="bold"><span class="koboSpan" id="kobo.567.1">Class Defaults</span></strong><span class="koboSpan" id="kobo.568.1"> tab and add a mesh of your choice to the </span><strong class="bold"><span class="koboSpan" id="kobo.569.1">Static </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.570.1">Mesh</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.571.1"> field.</span></span></li>
<li><span class="koboSpan" id="kobo.572.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.573.1">Physics</span></strong><span class="koboSpan" id="kobo.574.1"> section, enable the </span><strong class="bold"><span class="koboSpan" id="kobo.575.1">Simulate Physics</span></strong><span class="koboSpan" id="kobo.576.1"> attribute and check that the </span><strong class="bold"><span class="koboSpan" id="kobo.577.1">Enable Gravity</span></strong><span class="koboSpan" id="kobo.578.1"> attribute has </span><span class="No-Break"><span class="koboSpan" id="kobo.579.1">been enabled.</span></span></li>
<li><span class="koboSpan" id="kobo.580.1">Add a </span><strong class="bold"><span class="koboSpan" id="kobo.581.1">SphereCollision</span></strong><span class="koboSpan" id="kobo.582.1"> component to the Blueprint </span><span class="No-Break"><span class="koboSpan" id="kobo.583.1">components hierarchy.</span></span></li>
<li><span class="koboSpan" id="kobo.584.1">Name the component </span><strong class="source-inline"><span class="koboSpan" id="kobo.585.1">Trigger</span></strong><span class="koboSpan" id="kobo.586.1"> and ensure that the </span><strong class="bold"><span class="koboSpan" id="kobo.587.1">Generate Overlap Events</span></strong><span class="koboSpan" id="kobo.588.1"> attribute has </span><span class="No-Break"><span class="koboSpan" id="kobo.589.1">been enabled.</span></span></li>
<li><span class="koboSpan" id="kobo.590.1">Set the </span><strong class="bold"><span class="koboSpan" id="kobo.591.1">Sphere Radius</span></strong><span class="koboSpan" id="kobo.592.1"> attribute of the </span><strong class="bold"><span class="koboSpan" id="kobo.593.1">SphereCollision</span></strong><span class="koboSpan" id="kobo.594.1"> component to a value that is a little bigger than the static meshes you’ll be using (for </span><span class="No-Break"><span class="koboSpan" id="kobo.595.1">instance, </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.596.1">50</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.597.1">).</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.598.1">Now, you need to add some code logic to the Blueprint. </span><span class="koboSpan" id="kobo.598.2">First, let’s add a points value for the </span><span class="No-Break"><span class="koboSpan" id="kobo.599.1">picking character:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.600.1">Open the </span><span class="No-Break"><span class="koboSpan" id="kobo.601.1">Event Graph.</span></span></li>
<li><span class="koboSpan" id="kobo.602.1">Add a variable </span><a id="_idIndexMarker167"/><span class="koboSpan" id="kobo.603.1">of the </span><strong class="bold"><span class="koboSpan" id="kobo.604.1">Integer</span></strong><span class="koboSpan" id="kobo.605.1"> type and call </span><span class="No-Break"><span class="koboSpan" id="kobo.606.1">it </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.607.1">Points</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.608.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.609.1">Make it </span><strong class="bold"><span class="koboSpan" id="kobo.610.1">Instance Editable</span></strong><span class="koboSpan" id="kobo.611.1"> by clicking the eye button next to the </span><span class="No-Break"><span class="koboSpan" id="kobo.612.1">variable type.</span></span></li>
<li><span class="koboSpan" id="kobo.613.1">After compiling, set the variable's </span><strong class="bold"><span class="koboSpan" id="kobo.614.1">Default Value</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.615.1">to </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.616.1">1</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.617.1">.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.618.1">The Blueprint Viewport should look the same as what’s shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.619.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.620.1">.14</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.621.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer042">
<span class="koboSpan" id="kobo.622.1"><img alt="Figure 3.14 – The pickup Viewport" src="image/Figure_03_14_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.623.1">Figure 3.14 – The pickup Viewport</span></p>
<p><span class="koboSpan" id="kobo.624.1">Now, it’s time to set the overlap event behavior for </span><span class="No-Break"><span class="koboSpan" id="kobo.625.1">the Blueprint:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.626.1">Delete the </span><strong class="bold"><span class="koboSpan" id="kobo.627.1">Event BeginPlay</span></strong><span class="koboSpan" id="kobo.628.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.629.1">Event Tick</span></strong><span class="koboSpan" id="kobo.630.1"> nodes as you won’t be </span><span class="No-Break"><span class="koboSpan" id="kobo.631.1">using them.</span></span></li>
<li><span class="koboSpan" id="kobo.632.1">Add a </span><strong class="bold"><span class="koboSpan" id="kobo.633.1">Cast To Character</span></strong><span class="koboSpan" id="kobo.634.1"> node and connect its incoming execution pin to the outgoing pin of </span><strong class="bold"><span class="koboSpan" id="kobo.635.1">Event ActorBeginOverlap</span></strong><span class="koboSpan" id="kobo.636.1">, to check that the actor is of the required type (that is, </span><span class="No-Break"><span class="koboSpan" id="kobo.637.1">a Character).</span></span></li>
<li><span class="koboSpan" id="kobo.638.1">If the check succeeds, then add an </span><strong class="bold"><span class="koboSpan" id="kobo.639.1">AddPoints (Message)</span></strong><span class="koboSpan" id="kobo.640.1"> node: this is the function you previously declared in </span><span class="No-Break"><span class="koboSpan" id="kobo.641.1">the interface.</span></span></li>
<li><span class="koboSpan" id="kobo.642.1">Connect the </span><strong class="bold"><span class="koboSpan" id="kobo.643.1">As Character</span></strong><span class="koboSpan" id="kobo.644.1"> pin of the cast to the </span><strong class="bold"><span class="koboSpan" id="kobo.645.1">Target</span></strong><span class="koboSpan" id="kobo.646.1"> pin of the </span><span class="No-Break"><span class="koboSpan" id="kobo.647.1">function node.</span></span></li>
<li><span class="koboSpan" id="kobo.648.1">Add a </span><strong class="bold"><span class="koboSpan" id="kobo.649.1">Get Points</span></strong><span class="koboSpan" id="kobo.650.1"> node </span><a id="_idIndexMarker168"/><span class="koboSpan" id="kobo.651.1">to the graph and connect the pin to the </span><strong class="bold"><span class="koboSpan" id="kobo.652.1">Value</span></strong><span class="koboSpan" id="kobo.653.1"> pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.654.1">Add Points</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.655.1">function node.</span></span></li>
<li><span class="koboSpan" id="kobo.656.1">Finally, connect the outgoing execution pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.657.1">Add Points</span></strong><span class="koboSpan" id="kobo.658.1"> node to a </span><strong class="bold"><span class="koboSpan" id="kobo.659.1">Destroy Actor</span></strong><span class="koboSpan" id="kobo.660.1"> node to remove the pickup once it has </span><span class="No-Break"><span class="koboSpan" id="kobo.661.1">been taken.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.662.1">The final graph should be similar to the one shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.663.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.664.1">.15</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.665.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer043">
<span class="koboSpan" id="kobo.666.1"><img alt="Figure 3.15 – The pickup Event Graph" src="image/Figure_03_15_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.667.1">Figure 3.15 – The pickup Event Graph</span></p>
<p><span class="koboSpan" id="kobo.668.1">What this graph does is pretty straightforward: whenever an actor overlaps with the pickup, the pickup will send an </span><strong class="bold"><span class="koboSpan" id="kobo.669.1">AddPoints</span></strong><span class="koboSpan" id="kobo.670.1"> message through the interface and then destroy itself. </span><span class="koboSpan" id="kobo.670.2">If the overlapping actor won’t implement the interface, the message will simply be lost without dispatching </span><span class="No-Break"><span class="koboSpan" id="kobo.671.1">any errors.</span></span></p>
<p><span class="koboSpan" id="kobo.672.1">Now, it’s time to take the most crucial step in the process: enabling replication. </span><span class="koboSpan" id="kobo.672.2">To do this, do </span><span class="No-Break"><span class="koboSpan" id="kobo.673.1">the following:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.674.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.675.1">Components</span></strong><span class="koboSpan" id="kobo.676.1"> tab, select the </span><strong class="bold"><span class="koboSpan" id="kobo.677.1">BP_BasePickup (</span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.678.1">self)</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.679.1"> element.</span></span></li>
<li><span class="koboSpan" id="kobo.680.1">Then, in the </span><strong class="bold"><span class="koboSpan" id="kobo.681.1">Details</span></strong><span class="koboSpan" id="kobo.682.1"> panel, look </span><a id="_idIndexMarker169"/><span class="koboSpan" id="kobo.683.1">for the </span><strong class="bold"><span class="koboSpan" id="kobo.684.1">Replication</span></strong><span class="koboSpan" id="kobo.685.1"> category and enable the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.686.1">Replicates</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.687.1"> attribute.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.688.1">Now that you have a base pickup, you can create variants, ready to be </span><span class="No-Break"><span class="koboSpan" id="kobo.689.1">used in-game.</span></span></p>
<h2 id="_idParaDest-77"><a id="_idTextAnchor078"/><span class="koboSpan" id="kobo.690.1">Adding pickup variants</span></h2>
<p><span class="koboSpan" id="kobo.691.1">Creating a </span><a id="_idIndexMarker170"/><span class="koboSpan" id="kobo.692.1">variant for the pickup Blueprint is </span><span class="No-Break"><span class="koboSpan" id="kobo.693.1">quite easy:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.694.1">Right-click on your </span><strong class="bold"><span class="koboSpan" id="kobo.695.1">BP_BasePickup</span></strong><span class="koboSpan" id="kobo.696.1"> item in the </span><span class="No-Break"><span class="koboSpan" id="kobo.697.1">Content Browser.</span></span></li>
<li><span class="koboSpan" id="kobo.698.1">Select </span><strong class="bold"><span class="koboSpan" id="kobo.699.1">Create Child Blueprint Class</span></strong><span class="koboSpan" id="kobo.700.1">, give your new pickup a name, and </span><span class="No-Break"><span class="koboSpan" id="kobo.701.1">open it.</span></span></li>
<li><span class="koboSpan" id="kobo.702.1">Open the </span><strong class="bold"><span class="koboSpan" id="kobo.703.1">Class Defaults</span></strong><span class="koboSpan" id="kobo.704.1"> tab. </span><span class="koboSpan" id="kobo.704.2">Then, assign a mesh to the </span><strong class="bold"><span class="koboSpan" id="kobo.705.1">Static Mesh</span></strong><span class="koboSpan" id="kobo.706.1"> field (in my case, a </span><span class="No-Break"><span class="koboSpan" id="kobo.707.1">fruit Megascan).</span></span></li>
<li><span class="koboSpan" id="kobo.708.1">Assign a value of your choice to the </span><strong class="bold"><span class="koboSpan" id="kobo.709.1">Points</span></strong><span class="koboSpan" id="kobo.710.1"> attribute, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.711.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.712.1">.16</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.713.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer044">
<span class="koboSpan" id="kobo.714.1"><img alt="Figure 3.16 – The settings for the orange pickup" src="image/Figure_03_16_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.715.1">Figure 3.16 – The settings for the orange pickup</span></p>
<p><span class="koboSpan" id="kobo.716.1">Repeat these steps for each of your pickups and you’ll be ready </span><span class="No-Break"><span class="koboSpan" id="kobo.717.1">to go!</span></span></p>
<p><span class="koboSpan" id="kobo.718.1">Before you implement </span><a id="_idIndexMarker171"/><span class="koboSpan" id="kobo.719.1">the </span><strong class="bold"><span class="koboSpan" id="kobo.720.1">AddPoints</span></strong><span class="koboSpan" id="kobo.721.1"> interface for the Blueprint character, you are free to add some of the brand-new pickups and test the game as a listen server </span><span class="No-Break"><span class="koboSpan" id="kobo.722.1">multiplayer game.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.723.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.724.1">If your pickups seem to have different rotations through the clients, this means that you probably didn’t enable replication. </span><span class="koboSpan" id="kobo.724.2">Please make sure that the </span><strong class="bold"><span class="koboSpan" id="kobo.725.1">Replicates</span></strong><span class="koboSpan" id="kobo.726.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.727.1">Replicate Movement</span></strong><span class="koboSpan" id="kobo.728.1"> fields are checked for </span><span class="No-Break"><span class="koboSpan" id="kobo.729.1">your Blueprints!</span></span></p>
<h2 id="_idParaDest-78"><a id="_idTextAnchor079"/><span class="koboSpan" id="kobo.730.1">Adding a points counter to the character</span></h2>
<p><span class="koboSpan" id="kobo.731.1">Now that you know </span><a id="_idIndexMarker172"/><span class="koboSpan" id="kobo.732.1">how to replicate Actors across the network, it is time to learn how to replicate single variables and how to intercept changes </span><span class="No-Break"><span class="koboSpan" id="kobo.733.1">at runtime.</span></span></p>
<p><span class="koboSpan" id="kobo.734.1">You’ll be doing this by keeping track of the points that have been gained by each player by displaying them next to the gaming Actor. </span><span class="koboSpan" id="kobo.734.2">Follow </span><span class="No-Break"><span class="koboSpan" id="kobo.735.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.736.1">Open </span><strong class="bold"><span class="koboSpan" id="kobo.737.1">BP_TopDownCharacter</span></strong><span class="koboSpan" id="kobo.738.1">, which is located in your </span><strong class="source-inline"><span class="koboSpan" id="kobo.739.1">Blueprints</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.740.1">project folder.</span></span></li>
<li><span class="koboSpan" id="kobo.741.1">Add a </span><strong class="bold"><span class="koboSpan" id="kobo.742.1">Points</span></strong><span class="koboSpan" id="kobo.743.1"> variable of the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.744.1">Integer</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.745.1"> type.</span></span></li>
<li><span class="koboSpan" id="kobo.746.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.747.1">Details</span></strong><span class="koboSpan" id="kobo.748.1"> panel of the </span><strong class="bold"><span class="koboSpan" id="kobo.749.1">Points</span></strong><span class="koboSpan" id="kobo.750.1"> property, look for the </span><strong class="bold"><span class="koboSpan" id="kobo.751.1">Replication</span></strong><span class="koboSpan" id="kobo.752.1"> field and, from the drop-down menu, </span><span class="No-Break"><span class="koboSpan" id="kobo.753.1">select </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.754.1">RepNotify</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.755.1">.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.756.1">You will notice that, once the </span><strong class="bold"><span class="koboSpan" id="kobo.757.1">RepNotify</span></strong><span class="koboSpan" id="kobo.758.1"> field has been selected, a function named </span><strong class="bold"><span class="koboSpan" id="kobo.759.1">OnRep_Points</span></strong><span class="koboSpan" id="kobo.760.1"> has been added to your Blueprint – this function will be called on the clients every time the variable is updated by the </span><span class="No-Break"><span class="koboSpan" id="kobo.761.1">authoritative Actor.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.762.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.763.1">The difference between the </span><strong class="bold"><span class="koboSpan" id="kobo.764.1">RepNotify</span></strong><span class="koboSpan" id="kobo.765.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.766.1">Replicated</span></strong><span class="koboSpan" id="kobo.767.1"> values is that in the second case, the variable will be updated over the network without executing any notification function. </span><span class="koboSpan" id="kobo.767.2">It should also be noted that the </span><strong class="bold"><span class="koboSpan" id="kobo.768.1">OnRep_XXX</span></strong><span class="koboSpan" id="kobo.769.1"> function is called from the server on each client, and will not be executed on the </span><span class="No-Break"><span class="koboSpan" id="kobo.770.1">server itself.</span></span></p>
<p><span class="koboSpan" id="kobo.771.1">You are now going to add a text component to the character to display the points they have gained during </span><span class="No-Break"><span class="koboSpan" id="kobo.772.1">the match:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.773.1">Add a </span><strong class="bold"><span class="koboSpan" id="kobo.774.1">TextRenderer</span></strong><span class="koboSpan" id="kobo.775.1"> component to the character and name </span><span class="No-Break"><span class="koboSpan" id="kobo.776.1">it </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.777.1">PointsLabel</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.778.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.779.1">Place the component anywhere you deem appropriate. </span><span class="koboSpan" id="kobo.779.2">I opted for these </span><strong class="bold"><span class="koboSpan" id="kobo.780.1">Transform</span></strong><span class="koboSpan" id="kobo.781.1"> values: </span><strong class="bold"><span class="koboSpan" id="kobo.782.1">Location (-120, 0, -80)</span></strong><span class="koboSpan" id="kobo.783.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.784.1">Rotation (0, </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.785.1">90, 180)</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.786.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.787.1">Enhance the characteristics of the components according to your wishes. </span><span class="koboSpan" id="kobo.787.2">I opted for the settings shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.788.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.789.1">.17</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.790.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer045">
<span class="koboSpan" id="kobo.791.1"><img alt="Figure 3.17 – The PointsLabel component" src="image/Figure_03_17_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.792.1">Figure 3.17 – The PointsLabel component</span></p>
<p><span class="koboSpan" id="kobo.793.1">It’s finally time </span><a id="_idIndexMarker173"/><span class="koboSpan" id="kobo.794.1">to let pickups communicate with the character. </span><span class="koboSpan" id="kobo.794.2">We will do this by implementing the interface we defined some </span><span class="No-Break"><span class="koboSpan" id="kobo.795.1">time ago:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.796.1">With </span><strong class="bold"><span class="koboSpan" id="kobo.797.1">BP_TopDownCharacter</span></strong><span class="koboSpan" id="kobo.798.1"> open, select the </span><strong class="bold"><span class="koboSpan" id="kobo.799.1">Class </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.800.1">Settings</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.801.1"> tab.</span></span></li>
<li><span class="koboSpan" id="kobo.802.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.803.1">Details</span></strong><span class="koboSpan" id="kobo.804.1"> panel, click the </span><strong class="bold"><span class="koboSpan" id="kobo.805.1">Add</span></strong><span class="koboSpan" id="kobo.806.1"> drop-down button on the </span><strong class="bold"><span class="koboSpan" id="kobo.807.1">Implemented Interfaces</span></strong><span class="koboSpan" id="kobo.808.1"> field and select the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.809.1">PointsAdded</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.810.1"> interface.</span></span></li>
<li><span class="koboSpan" id="kobo.811.1">A new function named </span><strong class="bold"><span class="koboSpan" id="kobo.812.1">AddPoints</span></strong><span class="koboSpan" id="kobo.813.1"> will be added to the </span><strong class="bold"><span class="koboSpan" id="kobo.814.1">Interfaces</span></strong><span class="koboSpan" id="kobo.815.1"> section of the </span><strong class="bold"><span class="koboSpan" id="kobo.816.1">MyBlueprint</span></strong><span class="koboSpan" id="kobo.817.1"> tab. </span><span class="koboSpan" id="kobo.817.2">Right-click on the function’s name and select </span><strong class="bold"><span class="koboSpan" id="kobo.818.1">Implement Event</span></strong><span class="koboSpan" id="kobo.819.1"> – this will add the corresponding node to the Event Graph and </span><span class="No-Break"><span class="koboSpan" id="kobo.820.1">select it.</span></span></li>
<li><span class="koboSpan" id="kobo.821.1">Drag the </span><strong class="bold"><span class="koboSpan" id="kobo.822.1">Points</span></strong><span class="koboSpan" id="kobo.823.1"> variable into the Event Graph and select the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.824.1">Set</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.825.1"> option.</span></span></li>
<li><span class="koboSpan" id="kobo.826.1">Drag the </span><strong class="bold"><span class="koboSpan" id="kobo.827.1">Points</span></strong><span class="koboSpan" id="kobo.828.1"> variable again, this time selecting the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.829.1">Get</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.830.1"> option.</span></span></li>
<li><span class="koboSpan" id="kobo.831.1">Add the outgoing </span><strong class="bold"><span class="koboSpan" id="kobo.832.1">Value</span></strong><span class="koboSpan" id="kobo.833.1"> pin from the event to the </span><strong class="bold"><span class="koboSpan" id="kobo.834.1">Get Points</span></strong><span class="koboSpan" id="kobo.835.1"> node by using an </span><strong class="bold"><span class="koboSpan" id="kobo.836.1">Add</span></strong><span class="koboSpan" id="kobo.837.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.838.1">+</span></strong><span class="koboSpan" id="kobo.839.1">) </span><span class="No-Break"><span class="koboSpan" id="kobo.840.1">node.</span></span></li>
<li><span class="koboSpan" id="kobo.841.1">Connect the execution pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.842.1">Event</span></strong><span class="koboSpan" id="kobo.843.1"> node to the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.844.1">Set</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.845.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.846.1">Connect the result pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.847.1">Add</span></strong><span class="koboSpan" id="kobo.848.1"> node to the </span><strong class="bold"><span class="koboSpan" id="kobo.849.1">Points</span></strong><span class="koboSpan" id="kobo.850.1"> pin of the </span><span class="No-Break"><span class="koboSpan" id="kobo.851.1">set node.</span></span></li>
</ol>
<p class="callout-heading"><span class="koboSpan" id="kobo.852.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.853.1">You will notice that both the </span><strong class="bold"><span class="koboSpan" id="kobo.854.1">Set</span></strong><span class="koboSpan" id="kobo.855.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.856.1">Get</span></strong><span class="koboSpan" id="kobo.857.1"> nodes you added to your graph now have an icon in the top-right corner. </span><span class="koboSpan" id="kobo.857.2">In addition, the </span><strong class="bold"><span class="koboSpan" id="kobo.858.1">Set</span></strong><span class="koboSpan" id="kobo.859.1"> node is decorated with text stating </span><strong class="bold"><span class="koboSpan" id="kobo.860.1">w/Notify</span></strong><span class="koboSpan" id="kobo.861.1">: this means that the </span><strong class="bold"><span class="koboSpan" id="kobo.862.1">Points</span></strong><span class="koboSpan" id="kobo.863.1"> variable is replicated with a </span><span class="No-Break"><span class="koboSpan" id="kobo.864.1">function notification.</span></span></p>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.865.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.866.1">.18</span></em><span class="koboSpan" id="kobo.867.1"> shows the </span><a id="_idIndexMarker174"/><span class="koboSpan" id="kobo.868.1">final graph for the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.869.1">AddPoints</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.870.1"> event:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer046">
<span class="koboSpan" id="kobo.871.1"><img alt="Figure 3.18 – The AddPoints event" src="image/Figure_03_18_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.872.1">Figure 3.18 – The AddPoints event</span></p>
<p><span class="koboSpan" id="kobo.873.1">The last thing we need to do is implement the notification function so that we can update the points that are displayed to </span><span class="No-Break"><span class="koboSpan" id="kobo.874.1">the character:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.875.1">Double-click on the </span><strong class="bold"><span class="koboSpan" id="kobo.876.1">OnRep_Points</span></strong><span class="koboSpan" id="kobo.877.1"> function to </span><span class="No-Break"><span class="koboSpan" id="kobo.878.1">open it.</span></span></li>
<li><span class="koboSpan" id="kobo.879.1">Drag a </span><strong class="bold"><span class="koboSpan" id="kobo.880.1">Get</span></strong><span class="koboSpan" id="kobo.881.1"> node from the </span><strong class="bold"><span class="koboSpan" id="kobo.882.1">PointsLabel</span></strong><span class="koboSpan" id="kobo.883.1"> component in the </span><span class="No-Break"><span class="koboSpan" id="kobo.884.1">Event Graph.</span></span></li>
<li><span class="koboSpan" id="kobo.885.1">From its outgoing pin, add a </span><strong class="bold"><span class="koboSpan" id="kobo.886.1">Set Text</span></strong><span class="koboSpan" id="kobo.887.1"> node, and connect its incoming execution pin to the outgoing execution pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.888.1">On Rep </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.889.1">Points</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.890.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.891.1">Drag a </span><strong class="bold"><span class="koboSpan" id="kobo.892.1">Get</span></strong><span class="koboSpan" id="kobo.893.1"> node from the </span><strong class="bold"><span class="koboSpan" id="kobo.894.1">Points</span></strong><span class="koboSpan" id="kobo.895.1"> variable in the Event Graph and connect its pin to the </span><strong class="bold"><span class="koboSpan" id="kobo.896.1">Value</span></strong><span class="koboSpan" id="kobo.897.1"> pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.898.1">Set Text</span></strong><span class="koboSpan" id="kobo.899.1"> node. </span><span class="koboSpan" id="kobo.899.2">Unreal will automatically add a </span><strong class="bold"><span class="koboSpan" id="kobo.900.1">To Text</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.901.1">conversion node.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.902.1">The final graph </span><a id="_idIndexMarker175"/><span class="koboSpan" id="kobo.903.1">should be pretty similar to the one depicted in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.904.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.905.1">.19</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.906.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer047">
<span class="koboSpan" id="kobo.907.1"><img alt="Figure 3.19 – The On Rep Points graph" src="image/Figure_03_19_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.908.1">Figure 3.19 – The On Rep Points graph</span></p>
<p><span class="koboSpan" id="kobo.909.1">Now, if you test the game, you should be able to see all the clients update whenever a player gets a pickup in </span><span class="No-Break"><span class="koboSpan" id="kobo.910.1">the level.</span></span></p>
<p><span class="koboSpan" id="kobo.911.1">With that, you’ve learned about how objects are updated during a multiplayer session. </span><span class="koboSpan" id="kobo.911.2">Specifically, you gained insight into how Actors are replicated and how to detect changes in variables through replication notifications. </span><span class="koboSpan" id="kobo.911.3">In the next section, you will work on enhancing your prototype by adding a spawn area for your pickups and making some aesthetic improvements to your characters so that they can easily be identified. </span><span class="koboSpan" id="kobo.911.4">You will achieve this by calling functions over </span><span class="No-Break"><span class="koboSpan" id="kobo.912.1">the network.</span></span></p>
<h1 id="_idParaDest-79"><a id="_idTextAnchor080"/><span class="koboSpan" id="kobo.913.1">Executing functions over the network</span></h1>
<p><span class="koboSpan" id="kobo.914.1">In this section, you will learn how to properly call functions over the network and what the word “authority” really </span><a id="_idIndexMarker176"/><span class="koboSpan" id="kobo.915.1">means for the UE multiplayer system. </span><span class="koboSpan" id="kobo.915.2">In particular, you will get some insight into which entity should execute a function when it has been called: a client or </span><span class="No-Break"><span class="koboSpan" id="kobo.916.1">the server.</span></span></p>
<h2 id="_idParaDest-80"><a id="_idTextAnchor081"/><span class="koboSpan" id="kobo.917.1">Spawning Actors</span></h2>
<p><span class="koboSpan" id="kobo.918.1">It is time to start </span><a id="_idIndexMarker177"/><span class="koboSpan" id="kobo.919.1">adding pickups at runtime. </span><span class="koboSpan" id="kobo.919.2">You </span><a id="_idIndexMarker178"/><span class="koboSpan" id="kobo.920.1">are going to achieve this by adding a spawn area Blueprint to </span><span class="No-Break"><span class="koboSpan" id="kobo.921.1">the level.</span></span></p>
<p><span class="koboSpan" id="kobo.922.1">This Blueprint should be able to do </span><span class="No-Break"><span class="koboSpan" id="kobo.923.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.924.1">Choose a random position every time it </span><span class="No-Break"><span class="koboSpan" id="kobo.925.1">spawns something</span></span></li>
<li><span class="koboSpan" id="kobo.926.1">Spawn random pickups at </span><span class="No-Break"><span class="koboSpan" id="kobo.927.1">predefined intervals</span></span></li>
<li><span class="koboSpan" id="kobo.928.1">And obviously... </span><span class="koboSpan" id="kobo.928.2">behave correctly over </span><span class="No-Break"><span class="koboSpan" id="kobo.929.1">the network!</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.930.1">Let’s </span><span class="No-Break"><span class="koboSpan" id="kobo.931.1">get started.</span></span></p>
<h3><span class="koboSpan" id="kobo.932.1">Choosing a random spawn position</span></h3>
<p><span class="koboSpan" id="kobo.933.1">Let’s start </span><a id="_idIndexMarker179"/><span class="koboSpan" id="kobo.934.1">by creating the Blueprint and setting </span><span class="No-Break"><span class="koboSpan" id="kobo.935.1">its parameters:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.936.1"> Create a new Actor Blueprint and call </span><span class="No-Break"><span class="koboSpan" id="kobo.937.1">it </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.938.1">BP_Spawner</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.939.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.940.1">Add a </span><strong class="bold"><span class="koboSpan" id="kobo.941.1">Box Collision</span></strong><span class="koboSpan" id="kobo.942.1"> component, name it </span><strong class="source-inline"><span class="koboSpan" id="kobo.943.1">SpawnArea</span></strong><span class="koboSpan" id="kobo.944.1">, and make it the </span><strong class="bold"><span class="koboSpan" id="kobo.945.1">Scene Root</span></strong><span class="koboSpan" id="kobo.946.1"> component by dragging it onto the </span><span class="No-Break"><span class="koboSpan" id="kobo.947.1">default one.</span></span></li>
<li><span class="koboSpan" id="kobo.948.1">Add an </span><strong class="bold"><span class="koboSpan" id="kobo.949.1">Array</span></strong><span class="koboSpan" id="kobo.950.1"> variable of the </span><strong class="bold"><span class="koboSpan" id="kobo.951.1">Actor (Class Reference)</span></strong><span class="koboSpan" id="kobo.952.1"> type and name it </span><strong class="source-inline"><span class="koboSpan" id="kobo.953.1">SpawnableObjects</span></strong><span class="koboSpan" id="kobo.954.1">, making it </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.955.1">Instance Editable</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.956.1">.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.957.1">Once you have compiled and saved the Blueprint, open its Event Graph. </span><span class="koboSpan" id="kobo.957.2">Then, do </span><span class="No-Break"><span class="koboSpan" id="kobo.958.1">the following:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.959.1">Create a function named </span><strong class="source-inline"><span class="koboSpan" id="kobo.960.1">Spawn</span></strong><span class="koboSpan" id="kobo.961.1"> and </span><span class="No-Break"><span class="koboSpan" id="kobo.962.1">open it.</span></span></li>
<li><span class="koboSpan" id="kobo.963.1">Connect the execution node of the function to a </span><strong class="bold"><span class="koboSpan" id="kobo.964.1">SpawnActor from </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.965.1">Class</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.966.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.967.1">Add a </span><strong class="bold"><span class="koboSpan" id="kobo.968.1">Get</span></strong><span class="koboSpan" id="kobo.969.1"> node for the </span><strong class="bold"><span class="koboSpan" id="kobo.970.1">SpawnableObjects</span></strong><span class="koboSpan" id="kobo.971.1"> variable and connect its outgoing pin to a </span><strong class="bold"><span class="koboSpan" id="kobo.972.1">Random Array </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.973.1">Item</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.974.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.975.1">Connect the outgoing </span><strong class="bold"><span class="koboSpan" id="kobo.976.1">Actor Class Reference</span></strong><span class="koboSpan" id="kobo.977.1"> pin of </span><strong class="bold"><span class="koboSpan" id="kobo.978.1">Random Node</span></strong><span class="koboSpan" id="kobo.979.1"> to the </span><strong class="bold"><span class="koboSpan" id="kobo.980.1">Class</span></strong><span class="koboSpan" id="kobo.981.1"> pin of the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.982.1">Spawn</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.983.1"> node.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.984.1">To get a position for the spawned item, we will get a random location inside the </span><strong class="bold"><span class="koboSpan" id="kobo.985.1">Box </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.986.1">Collision</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.987.1"> component:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.988.1">Right-click on the </span><strong class="bold"><span class="koboSpan" id="kobo.989.1">Spawn Transform</span></strong><span class="koboSpan" id="kobo.990.1"> pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.991.1">SpawnActor</span></strong><span class="koboSpan" id="kobo.992.1"> node and select </span><strong class="bold"><span class="koboSpan" id="kobo.993.1">Split </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.994.1">Struct Pin</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.995.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.996.1">Drag the </span><strong class="bold"><span class="koboSpan" id="kobo.997.1">SpawnArea</span></strong><span class="koboSpan" id="kobo.998.1"> component into the function graph and connect its pin to a </span><strong class="bold"><span class="koboSpan" id="kobo.999.1">Get Scaled Box </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1000.1">Extent</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1001.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.1002.1">Add a </span><strong class="bold"><span class="koboSpan" id="kobo.1003.1">Get Actor Location</span></strong><span class="koboSpan" id="kobo.1004.1"> node and connect its outgoing pin to a </span><strong class="bold"><span class="koboSpan" id="kobo.1005.1">Random Point in Bounding </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1006.1">Box</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1007.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.1008.1">Connect the </span><a id="_idIndexMarker180"/><span class="koboSpan" id="kobo.1009.1">outgoing pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.1010.1">Get Scaled Box Extent</span></strong><span class="koboSpan" id="kobo.1011.1"> node to the </span><strong class="bold"><span class="koboSpan" id="kobo.1012.1">Half Size</span></strong><span class="koboSpan" id="kobo.1013.1"> pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.1014.1">Random Point in Bounding </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1015.1">Box</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1016.1"> one.</span></span></li>
<li><span class="koboSpan" id="kobo.1017.1">Connect the </span><strong class="bold"><span class="koboSpan" id="kobo.1018.1">Return Value</span></strong><span class="koboSpan" id="kobo.1019.1"> pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.1020.1">Random Point in Bounding Box</span></strong><span class="koboSpan" id="kobo.1021.1"> node to the </span><strong class="bold"><span class="koboSpan" id="kobo.1022.1">Spawn Transform Location</span></strong><span class="koboSpan" id="kobo.1023.1"> pin of the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1024.1">SpawnActor</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1025.1"> one.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.1026.1">The final graph can be seen in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1027.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1028.1">.20</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1029.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer048">
<span class="koboSpan" id="kobo.1030.1"><img alt="Figure 3.20 – The Spawn function graph" src="image/Figure_03_20_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1031.1">Figure 3.20 – The Spawn function graph</span></p>
<p><span class="koboSpan" id="kobo.1032.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.1033.1">Spawn</span></strong><span class="koboSpan" id="kobo.1034.1"> function </span><a id="_idIndexMarker181"/><span class="koboSpan" id="kobo.1035.1">selects a random Blueprint Class from a given list of elements and generates an instance of it at a random position within a </span><span class="No-Break"><span class="koboSpan" id="kobo.1036.1">defined area.</span></span></p>
<h3><span class="koboSpan" id="kobo.1037.1">Spawning random pickups at predefined intervals</span></h3>
<p><span class="koboSpan" id="kobo.1038.1">You are now </span><a id="_idIndexMarker182"/><span class="koboSpan" id="kobo.1039.1">going to add a timer to spawn pickups at </span><span class="No-Break"><span class="koboSpan" id="kobo.1040.1">predefined intervals:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1041.1">Open the Event Graph section of the Blueprint and delete the </span><strong class="bold"><span class="koboSpan" id="kobo.1042.1">Actor BeginOverlap</span></strong><span class="koboSpan" id="kobo.1043.1"> and </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1044.1">Tick</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1045.1"> events.</span></span></li>
<li><span class="koboSpan" id="kobo.1046.1">Add a </span><strong class="bold"><span class="koboSpan" id="kobo.1047.1">Set Timer by Event</span></strong><span class="koboSpan" id="kobo.1048.1"> node and connect its incoming execution pin to the outgoing one of the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1049.1">BeginPlay</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1050.1"> event.</span></span></li>
<li><span class="koboSpan" id="kobo.1051.1">Set the </span><strong class="bold"><span class="koboSpan" id="kobo.1052.1">Time</span></strong><span class="koboSpan" id="kobo.1053.1"> value equal to </span><strong class="bold"><span class="koboSpan" id="kobo.1054.1">1</span></strong><span class="koboSpan" id="kobo.1055.1"> and check the box </span><span class="No-Break"><span class="koboSpan" id="kobo.1056.1">in </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1057.1">Looping</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1058.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1059.1">Connect the </span><strong class="bold"><span class="koboSpan" id="kobo.1060.1">Event</span></strong><span class="koboSpan" id="kobo.1061.1"> pin to a </span><strong class="bold"><span class="koboSpan" id="kobo.1062.1">Custom Event</span></strong><span class="koboSpan" id="kobo.1063.1"> node and call </span><span class="No-Break"><span class="koboSpan" id="kobo.1064.1">it </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1065.1">OnTimer</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1066.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1067.1">Connect the execution pin of the custom event to the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1068.1">Spawn</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1069.1"> function.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.1070.1">What you have just done may seem pretty straightforward and correct, but it is actually wrong... </span><span class="koboSpan" id="kobo.1070.2">or, at least, it’s missing something: the code will behave differently on each client. </span><span class="koboSpan" id="kobo.1070.3">Bear with me for a minute while we test this </span><span class="No-Break"><span class="koboSpan" id="kobo.1071.1">wrong behavior:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1072.1">Delete all the pickups you may have previously added to your </span><span class="No-Break"><span class="koboSpan" id="kobo.1073.1">game level.</span></span></li>
<li><span class="koboSpan" id="kobo.1074.1">Add an instance of </span><strong class="bold"><span class="koboSpan" id="kobo.1075.1">BP_Spawner</span></strong><span class="koboSpan" id="kobo.1076.1"> to </span><span class="No-Break"><span class="koboSpan" id="kobo.1077.1">the level.</span></span></li>
<li><span class="koboSpan" id="kobo.1078.1">Place the instance approximately at the center of the scene and change the </span><strong class="bold"><span class="koboSpan" id="kobo.1079.1">Box Extent</span></strong><span class="koboSpan" id="kobo.1080.1"> values of the </span><strong class="bold"><span class="koboSpan" id="kobo.1081.1">SpawnArea</span></strong><span class="koboSpan" id="kobo.1082.1"> component so that the box will cover the entire play area; if you are using the default scene, something such as </span><strong class="bold"><span class="koboSpan" id="kobo.1083.1">(1300, 1600, 32)</span></strong><span class="koboSpan" id="kobo.1084.1"> should </span><span class="No-Break"><span class="koboSpan" id="kobo.1085.1">be fine.</span></span></li>
<li><span class="koboSpan" id="kobo.1086.1">Place the </span><strong class="bold"><span class="koboSpan" id="kobo.1087.1">SpawnArea</span></strong><span class="koboSpan" id="kobo.1088.1"> component above the ground – pickups should be dropped from above and fall to </span><span class="No-Break"><span class="koboSpan" id="kobo.1089.1">the ground.</span></span></li>
<li><span class="koboSpan" id="kobo.1090.1">Add all the pickups you have created to the </span><strong class="bold"><span class="koboSpan" id="kobo.1091.1">Spawnable </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1092.1">Objects</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1093.1"> array.</span></span></li>
<li><span class="koboSpan" id="kobo.1094.1">Run the </span><span class="No-Break"><span class="koboSpan" id="kobo.1095.1">multiplayer simulation.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.1096.1">You will notice that things will seem totally out of sync between clients: in particular, the UE instance (that is, the server) will spawn a single pickup at each interval, while the additional client will be </span><span class="No-Break"><span class="koboSpan" id="kobo.1097.1">spawning two.</span></span></p>
<p><span class="koboSpan" id="kobo.1098.1">What did we do </span><a id="_idIndexMarker183"/><span class="koboSpan" id="kobo.1099.1">wrong? </span><span class="koboSpan" id="kobo.1099.2">Put simply, at the moment, every spawner in every client is spawning items, but only the server (the one who has the authority) is spawning items across the network. </span><span class="koboSpan" id="kobo.1099.3">This means that the server will get only one pickup at a time, but the clients will get two: one spawned by the server, and one created by themselves for which the server has no knowledge </span><span class="No-Break"><span class="koboSpan" id="kobo.1100.1">at all.</span></span></p>
<h3><span class="koboSpan" id="kobo.1101.1">Using Actor authority to correctly spawn pickups</span></h3>
<p><span class="koboSpan" id="kobo.1102.1">To fix the spawning </span><a id="_idIndexMarker184"/><span class="koboSpan" id="kobo.1103.1">issue, we just have to tell the spawner to generate pickups only if they have the authority to do so (that is, that it is </span><span class="No-Break"><span class="koboSpan" id="kobo.1104.1">the server):</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1105.1">Add a </span><strong class="bold"><span class="koboSpan" id="kobo.1106.1">Switch Has Authority</span></strong><span class="koboSpan" id="kobo.1107.1"> node in between the execution pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.1108.1">BeginPlay</span></strong><span class="koboSpan" id="kobo.1109.1"> event and </span><strong class="bold"><span class="koboSpan" id="kobo.1110.1">Set Timer </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1111.1">by Event</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1112.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1113.1">Connect the </span><strong class="bold"><span class="koboSpan" id="kobo.1114.1">Authority</span></strong><span class="koboSpan" id="kobo.1115.1"> execution pin to the incoming pin of the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1116.1">Timer</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1117.1"> node.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.1118.1"> The corrected graph is shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1119.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1120.1">.21</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1121.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer049">
<span class="koboSpan" id="kobo.1122.1"><img alt="Figure 3.21 – The spawn timer graph" src="image/Figure_03_21_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1123.1">Figure 3.21 – The spawn timer graph</span></p>
<p><span class="koboSpan" id="kobo.1124.1">When you test the game now, it should behave correctly: the same object should be spawned at the same time in each </span><span class="No-Break"><span class="koboSpan" id="kobo.1125.1">client instance.</span></span></p>
<p><span class="koboSpan" id="kobo.1126.1">The prototype is </span><a id="_idIndexMarker185"/><span class="koboSpan" id="kobo.1127.1">almost finished, but I want you to create one last networked feature: a personalized skin for </span><span class="No-Break"><span class="koboSpan" id="kobo.1128.1">your characters.</span></span></p>
<h2 id="_idParaDest-81"><a id="_idTextAnchor082"/><span class="koboSpan" id="kobo.1129.1">Skinning characters</span></h2>
<p><span class="koboSpan" id="kobo.1130.1">Playing the game with two or more identical characters may soon become very confusing. </span><span class="koboSpan" id="kobo.1130.2">The best option for a prototype is to quickly create some colorized materials and assign them </span><a id="_idIndexMarker186"/><span class="koboSpan" id="kobo.1131.1">to the characters as soon as they are spawned. </span><span class="koboSpan" id="kobo.1131.2">We will do this in a </span><span class="No-Break"><span class="koboSpan" id="kobo.1132.1">networked environment.</span></span></p>
<p><span class="koboSpan" id="kobo.1133.1">Let’s start by creating some </span><span class="No-Break"><span class="koboSpan" id="kobo.1134.1">material instances:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1135.1">In the Content Browser, navigate to </span><strong class="bold"><span class="koboSpan" id="kobo.1136.1">Content</span></strong><span class="koboSpan" id="kobo.1137.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.1138.1">Characters</span></strong><span class="koboSpan" id="kobo.1139.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.1140.1">Mannequins</span></strong><span class="koboSpan" id="kobo.1141.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.1142.1">Materials</span></strong><span class="koboSpan" id="kobo.1143.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.1144.1">Instances</span></strong><span class="koboSpan" id="kobo.1145.1"> | </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1146.1">Manny</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1147.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1148.1">Duplicate </span><strong class="bold"><span class="koboSpan" id="kobo.1149.1">MI_Manny_01</span></strong><span class="koboSpan" id="kobo.1150.1"> several times to equal the number of connections you set in the </span><strong class="bold"><span class="koboSpan" id="kobo.1151.1">Play as a Listen Server</span></strong><span class="koboSpan" id="kobo.1152.1"> section (that </span><span class="No-Break"><span class="koboSpan" id="kobo.1153.1">is, </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1154.1">3</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1155.1">).</span></span></li>
<li><span class="koboSpan" id="kobo.1156.1">Name the new materials with your own preferred conventions; I </span><span class="No-Break"><span class="koboSpan" id="kobo.1157.1">used </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1158.1">MI_Manny_01_[ColorName]</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1159.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1160.1">Open each new instance and change the </span><strong class="bold"><span class="koboSpan" id="kobo.1161.1">Tint</span></strong><span class="koboSpan" id="kobo.1162.1"> property to a color that </span><span class="No-Break"><span class="koboSpan" id="kobo.1163.1">you like.</span></span></li>
<li><span class="koboSpan" id="kobo.1164.1">Save all the material instances and </span><span class="No-Break"><span class="koboSpan" id="kobo.1165.1">close them.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.1166.1">Now, let’s open the character Blueprint and add another </span><span class="No-Break"><span class="koboSpan" id="kobo.1167.1">replicated variable:</span></span></p>
<ol>
<li><span class="No-Break"><span class="koboSpan" id="kobo.1168.1">Open </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1169.1">BP_TopDownCharacter</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1170.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1171.1">Add a new variable called </span><strong class="bold"><span class="koboSpan" id="kobo.1172.1">SkinMaterial</span></strong><span class="koboSpan" id="kobo.1173.1"> of the </span><strong class="bold"><span class="koboSpan" id="kobo.1174.1">Material Interface Object Reference</span></strong><span class="koboSpan" id="kobo.1175.1"> type and make it </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1176.1">Instance Editable</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1177.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1178.1">Set the drop-down menu for the </span><strong class="bold"><span class="koboSpan" id="kobo.1179.1">Replication</span></strong><span class="koboSpan" id="kobo.1180.1"> field to </span><strong class="bold"><span class="koboSpan" id="kobo.1181.1">RepNotify</span></strong><span class="koboSpan" id="kobo.1182.1">. </span><span class="koboSpan" id="kobo.1182.2">This will create a function </span><span class="No-Break"><span class="koboSpan" id="kobo.1183.1">called </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1184.1">OnRep_SkinMaterial</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1185.1">.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.1186.1">Next, open the </span><strong class="bold"><span class="koboSpan" id="kobo.1187.1">OnRep_SkinMaterial</span></strong><span class="koboSpan" id="kobo.1188.1"> function to add the skin change logic. </span><span class="koboSpan" id="kobo.1188.2">Then, do </span><span class="No-Break"><span class="koboSpan" id="kobo.1189.1">the following:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1190.1">Drag a reference for </span><strong class="bold"><span class="koboSpan" id="kobo.1191.1">Mesh</span></strong><span class="koboSpan" id="kobo.1192.1"> from the </span><strong class="bold"><span class="koboSpan" id="kobo.1193.1">Components</span></strong><span class="koboSpan" id="kobo.1194.1"> panel in the </span><span class="No-Break"><span class="koboSpan" id="kobo.1195.1">Event Graph.</span></span></li>
<li><span class="koboSpan" id="kobo.1196.1">Drag a </span><strong class="bold"><span class="koboSpan" id="kobo.1197.1">Get</span></strong><span class="koboSpan" id="kobo.1198.1"> node </span><a id="_idIndexMarker187"/><span class="koboSpan" id="kobo.1199.1">for the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1200.1">SkinMaterial</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1201.1"> variable.</span></span></li>
<li><span class="koboSpan" id="kobo.1202.1">Connect the function execution pin to a </span><strong class="bold"><span class="koboSpan" id="kobo.1203.1">Set </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1204.1">Material</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1205.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.1206.1">Connect the </span><strong class="bold"><span class="koboSpan" id="kobo.1207.1">Mesh</span></strong><span class="koboSpan" id="kobo.1208.1"> reference to the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1209.1">Target</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1210.1"> pin.</span></span></li>
<li><span class="koboSpan" id="kobo.1211.1">Connect the </span><strong class="bold"><span class="koboSpan" id="kobo.1212.1">SkinMaterial</span></strong><span class="koboSpan" id="kobo.1213.1"> reference to the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1214.1">Material</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1215.1"> pin.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.1216.1">The graph for this function is shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1217.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1218.1">.22</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1219.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer050">
<span class="koboSpan" id="kobo.1220.1"><img alt="Figure 3.22 – The function for the replicated SkinMaterial variable" src="image/Figure_03_22_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1221.1">Figure 3.22 – The function for the replicated SkinMaterial variable</span></p>
<ol>
<li><span class="koboSpan" id="kobo.1222.1">Whenever the </span><strong class="bold"><span class="koboSpan" id="kobo.1223.1">SkinMaterial</span></strong><span class="koboSpan" id="kobo.1224.1"> variable is changed, </span><strong class="bold"><span class="koboSpan" id="kobo.1225.1">OnRep_SkinMaterial</span></strong><span class="koboSpan" id="kobo.1226.1"> will take care of assigning it to the first material of </span><span class="No-Break"><span class="koboSpan" id="kobo.1227.1">the character.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.1228.1">Now, you need to change the material for each character once it has been added to </span><span class="No-Break"><span class="koboSpan" id="kobo.1229.1">the level:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1230.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1231.1">Blueprints</span></strong><span class="koboSpan" id="kobo.1232.1"> folder, </span><span class="No-Break"><span class="koboSpan" id="kobo.1233.1">open </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1234.1">BP_TopDownGameMode</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1235.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1236.1">Add an </span><strong class="bold"><span class="koboSpan" id="kobo.1237.1">Array</span></strong><span class="koboSpan" id="kobo.1238.1"> variable of the </span><strong class="bold"><span class="koboSpan" id="kobo.1239.1">Material Interface Object Reference</span></strong><span class="koboSpan" id="kobo.1240.1"> type; name </span><span class="No-Break"><span class="koboSpan" id="kobo.1241.1">it </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1242.1">SkinMaterials</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1243.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1244.1">Once you have compiled the Blueprint, add all the materials you previously created to the </span><strong class="bold"><span class="koboSpan" id="kobo.1245.1">Default Value</span></strong><span class="koboSpan" id="kobo.1246.1"> field in the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1247.1">Details</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1248.1"> panel.</span></span></li>
<li><span class="koboSpan" id="kobo.1249.1">Add a variable of the </span><strong class="bold"><span class="koboSpan" id="kobo.1250.1">Integer</span></strong><span class="koboSpan" id="kobo.1251.1"> type named </span><strong class="source-inline"><span class="koboSpan" id="kobo.1252.1">SkinCount</span></strong><span class="koboSpan" id="kobo.1253.1">; this variable will be used as an index counter for selecting </span><span class="No-Break"><span class="koboSpan" id="kobo.1254.1">the skins.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.1255.1">You may have noticed that we are not replicating the </span><strong class="bold"><span class="koboSpan" id="kobo.1256.1">SkinCount</span></strong><span class="koboSpan" id="kobo.1257.1"> variable; in this case, we don’t need to do </span><a id="_idIndexMarker188"/><span class="koboSpan" id="kobo.1258.1">this as this variable only exists in the server and it is used to handle the skin of the character as soon as they are spawned in the game. </span><span class="koboSpan" id="kobo.1258.2">Knowing what variables to replicate and when is a topic I’ll cover in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1259.1">Chapter 6</span></em></span><span class="koboSpan" id="kobo.1260.1">, </span><em class="italic"><span class="koboSpan" id="kobo.1261.1">Replicating Properties </span></em><em class="italic"><span class="koboSpan" id="kobo.1262.1">O</span></em><em class="italic"><span class="koboSpan" id="kobo.1263.1">ver </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1264.1">the Network</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1265.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1266.1">Next, you must get a count of the used skins. </span><span class="koboSpan" id="kobo.1266.2">Then, every time a new connection is created, you will assign the next available skin to the character. </span><span class="koboSpan" id="kobo.1266.3">To achieve this, you’ll be using an event named </span><em class="italic"><span class="koboSpan" id="kobo.1267.1">OnRestartPlayer</span></em><span class="koboSpan" id="kobo.1268.1"> that is executed every time a player is restarted (including when it is spawned for the </span><span class="No-Break"><span class="koboSpan" id="kobo.1269.1">first time):</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1270.1">In the Event Graph, add an </span><strong class="bold"><span class="koboSpan" id="kobo.1271.1">Event </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1272.1">OnRestartPlayer</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1273.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.1274.1">From </span><strong class="bold"><span class="koboSpan" id="kobo.1275.1">New Player</span></strong><span class="koboSpan" id="kobo.1276.1">, connect a </span><strong class="bold"><span class="koboSpan" id="kobo.1277.1">Get Controlled </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1278.1">Pawn</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1279.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.1280.1">Cast its outgoing pin to a </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1281.1">BP_TopDownCharacter </span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1282.1">node.</span></span></li>
<li><span class="koboSpan" id="kobo.1283.1">Connect the event execution pin to the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1284.1">Cast</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1285.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.1286.1">Connect the outgoing </span><strong class="bold"><span class="koboSpan" id="kobo.1287.1">As BP Top Down Character</span></strong><span class="koboSpan" id="kobo.1288.1"> to a </span><strong class="bold"><span class="koboSpan" id="kobo.1289.1">Set Skin Material</span></strong><span class="koboSpan" id="kobo.1290.1"> node (note the </span><strong class="bold"><span class="koboSpan" id="kobo.1291.1">w/Notify</span></strong><span class="koboSpan" id="kobo.1292.1"> label that was added to indicate the notification call when the value </span><span class="No-Break"><span class="koboSpan" id="kobo.1293.1">is changed).</span></span></li>
<li><span class="koboSpan" id="kobo.1294.1">Connect the successful execution pin of the cast node to the </span><strong class="bold"><span class="koboSpan" id="kobo.1295.1">Set Skin </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1296.1">Material</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1297.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.1298.1">Add a </span><strong class="bold"><span class="koboSpan" id="kobo.1299.1">Get</span></strong><span class="koboSpan" id="kobo.1300.1"> node for the </span><strong class="bold"><span class="koboSpan" id="kobo.1301.1">SkinMaterials</span></strong><span class="koboSpan" id="kobo.1302.1"> array and a </span><strong class="bold"><span class="koboSpan" id="kobo.1303.1">Get</span></strong><span class="koboSpan" id="kobo.1304.1"> node for the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1305.1">SkinCount</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1306.1"> variable.</span></span></li>
<li><span class="koboSpan" id="kobo.1307.1">Connect the outgoing </span><strong class="bold"><span class="koboSpan" id="kobo.1308.1">Skin Materials</span></strong><span class="koboSpan" id="kobo.1309.1"> pin to the </span><strong class="bold"><span class="koboSpan" id="kobo.1310.1">Get (a </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1311.1">copy)</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1312.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.1313.1">Connect the </span><strong class="bold"><span class="koboSpan" id="kobo.1314.1">Skin Count</span></strong><span class="koboSpan" id="kobo.1315.1"> pin to the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1316.1">Get</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1317.1"> index.</span></span></li>
<li><span class="koboSpan" id="kobo.1318.1">Connect the outgoing pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.1319.1">Get</span></strong><span class="koboSpan" id="kobo.1320.1"> node to the </span><strong class="bold"><span class="koboSpan" id="kobo.1321.1">Skin Material</span></strong><span class="koboSpan" id="kobo.1322.1"> pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.1323.1">Set Skin </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1324.1">Material</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1325.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.1326.1">Finally, connect the </span><a id="_idIndexMarker189"/><span class="koboSpan" id="kobo.1327.1">outgoing execution pin of </span><strong class="bold"><span class="koboSpan" id="kobo.1328.1">Set Skin Material</span></strong><span class="koboSpan" id="kobo.1329.1"> to an </span><strong class="bold"><span class="koboSpan" id="kobo.1330.1">Increment (++)</span></strong><span class="koboSpan" id="kobo.1331.1"> node. </span><span class="koboSpan" id="kobo.1331.2">The </span><strong class="bold"><span class="koboSpan" id="kobo.1332.1">Skin Count x</span></strong><span class="koboSpan" id="kobo.1333.1"> variable should be incremented; this will keep track of the selected skin in </span><span class="No-Break"><span class="koboSpan" id="kobo.1334.1">the array.</span></span></li>
</ol>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1335.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.1336.1">.23</span></em><span class="koboSpan" id="kobo.1337.1"> depicts the Game </span><span class="No-Break"><span class="koboSpan" id="kobo.1338.1">Mode graph:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer051">
<span class="koboSpan" id="kobo.1339.1"><img alt="Figure 3.23 – The Game Mode graph" src="image/Figure_03_23_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1340.1">Figure 3.23 – The Game Mode graph</span></p>
<p><span class="koboSpan" id="kobo.1341.1">Now that the prototype </span><a id="_idIndexMarker190"/><span class="koboSpan" id="kobo.1342.1">has been created, it’s time to test (and </span><span class="No-Break"><span class="koboSpan" id="kobo.1343.1">play) it!</span></span></p>
<h2 id="_idParaDest-82"><a id="_idTextAnchor083"/><span class="koboSpan" id="kobo.1344.1">Testing the game</span></h2>
<p><span class="koboSpan" id="kobo.1345.1">Run the game as a listen server – each character should have its colorized skin synchronized </span><a id="_idIndexMarker191"/><span class="koboSpan" id="kobo.1346.1">across the network and the points gained for each player should be correctly displayed on the character itself. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1347.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.1348.1">.24</span></em><span class="koboSpan" id="kobo.1349.1"> shows the game prototype </span><span class="No-Break"><span class="koboSpan" id="kobo.1350.1">in action:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer052">
<span class="koboSpan" id="kobo.1351.1"><img alt="Figure 3.24 – Testing the game prototype" src="image/Figure_03.24_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1352.1">Figure 3.24 – Testing the game prototype</span></p>
<p><span class="koboSpan" id="kobo.1353.1">So, you’ve finally tested your multiplayer game prototype: players can run around and get the falling </span><a id="_idIndexMarker192"/><span class="koboSpan" id="kobo.1354.1">pickups, ready to gain points. </span><span class="koboSpan" id="kobo.1354.2">As funny as it seems, this is just the beginning of multiplayer </span><span class="No-Break"><span class="koboSpan" id="kobo.1355.1">game development!</span></span></p>
<h1 id="_idParaDest-83"><a id="_idTextAnchor084"/><span class="koboSpan" id="kobo.1356.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.1357.1">In this chapter, you created a prototype of your first multiplayer game and gained knowledge about synchronizing Actors and variables across the network. </span><span class="koboSpan" id="kobo.1357.2">Moreover, you started testing the prototype through the UE system, which emulates multiple connections concurrently, and achieved all this through the use </span><span class="No-Break"><span class="koboSpan" id="kobo.1358.1">of Blueprints.</span></span></p>
<p><span class="koboSpan" id="kobo.1359.1">However, moving forward, you will transition to using the C++ programming language, which may seem a little daunting, but I assure you that I will strive to make this shift as effortless </span><span class="No-Break"><span class="koboSpan" id="kobo.1360.1">as possible!</span></span></p>
<p><span class="koboSpan" id="kobo.1361.1">It’s time to leave your prototype to its destiny... </span><span class="koboSpan" id="kobo.1361.2">we have more important things to do! </span><span class="koboSpan" id="kobo.1361.3">In the next chapter, you’ll start creating a game from scratch. </span><span class="koboSpan" id="kobo.1361.4">You will develop it in C++ with all the advantages that come with this kind </span><span class="No-Break"><span class="koboSpan" id="kobo.1362.1">of development.</span></span></p>
</div>


<div class="Content" id="_idContainer054">
<h1 id="_idParaDest-84" lang="en-US" xml:lang="en-US"><a id="_idTextAnchor085"/><span class="koboSpan" id="kobo.1.1">Part 2:Networking and Multiplayer Games in Unreal Engine</span></h1>
<p><span class="koboSpan" id="kobo.2.1">In the second part of this book, you will lay the foundation for a complete multiplayer project using Unreal Engine. </span><span class="koboSpan" id="kobo.2.2">From there, you will delve into the essential features of the Unreal Engine Gameplay Framework, as well as how they are implemented within a </span><span class="No-Break"><span class="koboSpan" id="kobo.3.1">multiplayer context.</span></span></p>
<p><span class="koboSpan" id="kobo.4.1">This part includes the </span><span class="No-Break"><span class="koboSpan" id="kobo.5.1">following chapters:</span></span></p>
<ul>
<li><a href="B18203_04.xhtml#_idTextAnchor086"><em class="italic"><span class="koboSpan" id="kobo.6.1">Chapter 4</span></em></a><span class="koboSpan" id="kobo.7.1">, </span><em class="italic"><span class="koboSpan" id="kobo.8.1">Setting Up Your First Multiplayer Environment</span></em></li>
<li><a href="B18203_05.xhtml#_idTextAnchor107"><em class="italic"><span class="koboSpan" id="kobo.9.1">Chapter 5</span></em></a><span class="koboSpan" id="kobo.10.1">, </span><em class="italic"><span class="koboSpan" id="kobo.11.1">Managing Actors in a Multiplayer Environment</span></em></li>
<li><a href="B18203_06.xhtml#_idTextAnchor125"><em class="italic"><span class="koboSpan" id="kobo.12.1">Chapter 6</span></em></a><span class="koboSpan" id="kobo.13.1">, </span><em class="italic"><span class="koboSpan" id="kobo.14.1">Replicating Properties </span></em><em class="italic"><span class="koboSpan" id="kobo.15.1">O</span></em><em class="italic"><span class="koboSpan" id="kobo.16.1">ver the Network</span></em></li>
<li><a href="B18203_07.xhtml#_idTextAnchor147"><em class="italic"><span class="koboSpan" id="kobo.17.1">Chapter 7</span></em></a><span class="koboSpan" id="kobo.18.1">, </span><em class="italic"><span class="koboSpan" id="kobo.19.1">Using Remote Procedure Calls (RPCs)</span></em></li>
</ul>
</div>
<div>
<div id="_idContainer055">
</div>
</div>
<div>
<div id="_idContainer056">
</div>
</div>
<div>
<div id="_idContainer057">
</div>
</div>
<div>
<div id="_idContainer058">
</div>
</div>
<div>
<div id="_idContainer059">
</div>
</div>
<div>
<div class="Basic-Graphics-Frame" id="_idContainer060">
</div>
</div>
<div>
<div class="Basic-Graphics-Frame" id="_idContainer061">
</div>
</div>
<div>
<div id="_idContainer062">
</div>
</div>
<div>
<div id="_idContainer063">
</div>
</div>
<div>
<div class="Basic-Graphics-Frame" id="_idContainer064">
</div>
</div>
</body></html>