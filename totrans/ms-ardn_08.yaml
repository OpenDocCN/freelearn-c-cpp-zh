- en: Motion Sensor
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we will look at how to use the HC-SR501 motion sensor. It is
    a very easy sensor to connected to the Arduino and program, which is why it is
    usually one of the first sensors that people experiment with when they start working
    with microcontrollers. It is also very inexpensive and often comes with most starter
    kits.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter you will learn:'
  prefs: []
  type: TYPE_NORMAL
- en: How to connect an HC-SR501 motion sensor to the Arduino
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to read the output of the HC-SR501 motion sensor
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Read the Fritzing diagram of the motion sensor project
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**PIR sensors**, also known as **Passive Infrared sensors**, are used by a
    microcontroller to sense motion usually by a human being, but they will detect
    any motion within the range of the sensor. These sensors are small, inexpensive,
    low-power and easy to use, which makes them perfect for beginners to experiment
    with, but industrial versions of these sensors can also be found in many consumer
    and military products as well.'
  prefs: []
  type: TYPE_NORMAL
- en: PIR sensors are made of pyroelectric sensors that can detect infrared radiation
    levels. Every object that has a temperature above absolute zero emits some low-level
    infrared radiation that the pyroelectric sensor can detect. The passive part of
    the name means that the sensor does not generate or radiate energy that can be
    detected by other devices. Instead, it works by detecting the infrared radiation
    emitted by other objects.
  prefs: []
  type: TYPE_NORMAL
- en: The pyroelectric sensor in a motion sensor is usually split into two sides,
    which enables the motion sensor to detect changes in the infrared levels. When
    the sensor is not detecting any motion, both sides detect the same amount of infrared
    radiation and cancel each other out. When something starts to move within range
    of the sensor, one half of the sensor detects more of the infrared radiation than
    the other half, causing the sensor to trigger a motion alert.
  prefs: []
  type: TYPE_NORMAL
- en: PIR sensors come in many sizes and strengths. These sensors are used in numerous
    commercial products like burglar alarms, automatic lights and holiday decorations
    that talk or light up when someone approaches it.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will be using the HC-SR501 motion sensor, which is shown
    in the following photograph with a stand that I designed and printed out for it.
    The downloadable code for this book includes an `STL` file that you can use to
    print out a stand for your own use:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/bddf2213-14fd-479e-abfa-aa46db99e225.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The following image shows the connectors and adjustment screws on the bottom
    of the HC-SR501 motion sensor:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/e89cb327-0204-42a4-9509-86a6347af33e.png)'
  prefs: []
  type: TYPE_IMG
- en: The **Sensitivity** adjustment screw adjusts the detection range of the sensor.
    The detection range can be set from 3 meters to 7 meters. Turning the sensitivity
    screw clockwise decreases the sensitivity of the sensor.
  prefs: []
  type: TYPE_NORMAL
- en: The **Output Timing** adjustment screw sets how long the output will remain
    high once motion is detected. The output timing can range from 5 seconds to 5
    minutes. Turning the output timing adjustment screw clockwise will increase the
    time delay.
  prefs: []
  type: TYPE_NORMAL
- en: The **Ground** pin should be connected to the ground rail on the breadboard
    or directly to the ground pin on the Arduino. The **5V** pin should be connected
    to the power rail on the breadboard or directly to the 5V out on the Arduino.
    Finally, the middle pin is the **Output** pin for the sensor. If the sensor detects
    motion this pin will go high for the amount of time defined with the output timing
    adjustment screw.
  prefs: []
  type: TYPE_NORMAL
- en: '**NOTE**: Some compatible sensors may have a different pin configuration than
    the ones shown in this book; please verify the pin configuration for your sensor
    before doing any wiring.'
  prefs: []
  type: TYPE_NORMAL
- en: Before you look at the circuit diagram section of this chapter, think about
    how you would connect the HC-SR5012 motion sensor to an Arduino. One hint, you
    will not need anything but the motion sensor, an Arduino and jumper wire. Using
    a breadboard in this particular project is optional.
  prefs: []
  type: TYPE_NORMAL
- en: Now let's look at the components needed for this chapter's project.
  prefs: []
  type: TYPE_NORMAL
- en: Components needed
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We will need the following components for this chapter''s project:'
  prefs: []
  type: TYPE_NORMAL
- en: One Arduino Uno or compatible board
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: One HC-SR501 motion sensor
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Jumper wires
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: For the challenge, you will need an LED
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: One breadboard
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The breadboard is optional because you may connect the HC-SR501 motion sensor
    directly to the Arduino. You will need a breadboard to complete the challenge
    section of this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: Circuit diagrams
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following diagram shows the Fritzing diagram for this project:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/b03edb30-1eee-49f7-8ade-d72284b6041a.png)'
  prefs: []
  type: TYPE_IMG
- en: With the diagram, we can see that the ground pin on the HC-SR501 motion sensor
    is connected to the ground rail on the breadboard and the 5V input on the motion
    sensor is connected to the power rail on the breadboard. The power and ground
    rails of the breadboard are connected to the 5V power and ground pins on the Arduino.
  prefs: []
  type: TYPE_NORMAL
- en: The output pin on the motion sensor is a digital output (either HIGH or LOW),
    therefore we can connect the output pin directly to any of the digital pins on
    the Arduino. In this case, we are connecting the output pin from the sensor to
    pin three on the Arduino.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here is the schematic diagram of the same circuit:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/6fa65976-b622-4668-87b0-a4e6c73c2309.png)'
  prefs: []
  type: TYPE_IMG
- en: Let's look at the Arduino code for this project.
  prefs: []
  type: TYPE_NORMAL
- en: Code
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: To use the HC-SR501 motion sensor all we need to do is read the digital output
    from the sensor. If the output is HIGH, then the sensor detected motion and if
    it is LOW, then it did not. The output from the sensor will stay HIGH for the
    length of time defined by the output time adjustment screw. I usually keep the
    output time low, usually a couple oof seconds.
  prefs: []
  type: TYPE_NORMAL
- en: For this project, we will output the status of the sensor to the serial console.
    The output will get a little fancier in the challenge section.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following is the code to read the HC-SR501 motion sensor:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: This code starts off by using the `#define` directive to create the `MOTION_SENSOR`
    macro and setting it to `3`. In the `setup()` function we set the pin mode for
    pin 3 for input because we will be reading the digital output pin from the motion
    sensor. We are also initiating the serial console in the `setup()` function as
    well.
  prefs: []
  type: TYPE_NORMAL
- en: The `loop()` function begins by calling the `digitalRead()` function to read
    the output from the motion sensor and assigning the value to the `sensorValue`
    variable. If the `sensorValue` variable is equal to `HIGH`, we send the message
    `Motion Detected` to the serial console. If no motion is detected, we do not print
    anything. At the end of the `loop()` function, there is a half-second delay before
    looping back.
  prefs: []
  type: TYPE_NORMAL
- en: Now let's upload and run the code.
  prefs: []
  type: TYPE_NORMAL
- en: Running the project
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We will need to have the serial console open when we run the code to see the
    output.
  prefs: []
  type: TYPE_NORMAL
- en: 'Once the code is uploaded and running, wave your hand near the sensor, and
    you should see the `Motion Detected` message is printed to the console, as shown
    in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/196f4d32-2bba-4938-9801-51a601a37e55.png)'
  prefs: []
  type: TYPE_IMG
- en: Now on to the challenge section of this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: Challenge
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The challenge, if you choose to accept it, is to add an LED to this project
    and have the LED light up when the motion sensor detects motion. In the first
    few chapters, we will give either the code or circuit diagram for the challenges
    to make it easier to troubleshoot any issues if the project does not work when
    first built.
  prefs: []
  type: TYPE_NORMAL
- en: For this challenge, we will give the code and let you figure out how to connect
    the LED to the project. One hint, do not forget about the resistor for the LED.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following is the code that will light up an LED connected to pin 5 of the
    Arduino when the motion sensor detects nearby motion:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Now it is up to you to complete this challenge.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we learned about the HC-SR501 motion sensor and how it works.
    We saw how we could wire it to an Arduino where the Arduino provided power for
    the sensor and also read the output pin of the sensor.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will see how we can sense the weather around us.
  prefs: []
  type: TYPE_NORMAL
