- en: Motion Sensor
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 运动传感器
- en: In this chapter, we will look at how to use the HC-SR501 motion sensor. It is
    a very easy sensor to connected to the Arduino and program, which is why it is
    usually one of the first sensors that people experiment with when they start working
    with microcontrollers. It is also very inexpensive and often comes with most starter
    kits.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将探讨如何使用HC-SR501运动传感器。这是一个非常容易连接到Arduino并编程的传感器，这也是为什么当人们开始使用微控制器时，它通常是他们实验的第一批传感器之一。它也非常便宜，通常包含大多数入门套件中。
- en: 'In this chapter you will learn:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您将学习：
- en: How to connect an HC-SR501 motion sensor to the Arduino
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何将HC-SR501运动传感器连接到Arduino
- en: How to read the output of the HC-SR501 motion sensor
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何读取HC-SR501运动传感器的输出
- en: Read the Fritzing diagram of the motion sensor project
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 阅读运动传感器项目的Fritzing图
- en: Introduction
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简介
- en: '**PIR sensors**, also known as **Passive Infrared sensors**, are used by a
    microcontroller to sense motion usually by a human being, but they will detect
    any motion within the range of the sensor. These sensors are small, inexpensive,
    low-power and easy to use, which makes them perfect for beginners to experiment
    with, but industrial versions of these sensors can also be found in many consumer
    and military products as well.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '**PIR传感器**，也称为**被动红外传感器**，由微控制器用于检测运动，通常是人，但它们可以检测传感器范围内的任何运动。这些传感器体积小、价格低、功耗低且易于使用，这使得它们非常适合初学者进行实验，但工业版本的这些传感器也出现在许多消费和军事产品中。'
- en: PIR sensors are made of pyroelectric sensors that can detect infrared radiation
    levels. Every object that has a temperature above absolute zero emits some low-level
    infrared radiation that the pyroelectric sensor can detect. The passive part of
    the name means that the sensor does not generate or radiate energy that can be
    detected by other devices. Instead, it works by detecting the infrared radiation
    emitted by other objects.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: PIR传感器由热释电传感器组成，可以检测红外辐射水平。任何温度高于绝对零度的物体都会发出一些低水平红外辐射，热释电传感器可以检测到。名称中的“被动”部分意味着传感器不会产生或辐射其他设备可以检测到的能量。相反，它通过检测其他物体发出的红外辐射来工作。
- en: The pyroelectric sensor in a motion sensor is usually split into two sides,
    which enables the motion sensor to detect changes in the infrared levels. When
    the sensor is not detecting any motion, both sides detect the same amount of infrared
    radiation and cancel each other out. When something starts to move within range
    of the sensor, one half of the sensor detects more of the infrared radiation than
    the other half, causing the sensor to trigger a motion alert.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 运动传感器中的热释电传感器通常分为两侧，这使得运动传感器能够检测红外水平的改变。当传感器没有检测到任何运动时，两侧检测到相同数量的红外辐射并相互抵消。当传感器范围内有物体开始移动时，传感器的一半检测到的红外辐射比另一半多，导致传感器触发运动警报。
- en: PIR sensors come in many sizes and strengths. These sensors are used in numerous
    commercial products like burglar alarms, automatic lights and holiday decorations
    that talk or light up when someone approaches it.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: PIR传感器有多种尺寸和强度。这些传感器用于众多商业产品中，如防盗报警器、自动灯光和节日装饰，当有人靠近时，它们会说话或发光。
- en: 'In this chapter, we will be using the HC-SR501 motion sensor, which is shown
    in the following photograph with a stand that I designed and printed out for it.
    The downloadable code for this book includes an `STL` file that you can use to
    print out a stand for your own use:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将使用HC-SR501运动传感器，如下照片所示，它配有一个我设计和打印的支架。本书提供的可下载代码包括一个`STL`文件，您可以使用它来打印自己的支架：
- en: '![](img/bddf2213-14fd-479e-abfa-aa46db99e225.png)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/bddf2213-14fd-479e-abfa-aa46db99e225.png)'
- en: 'The following image shows the connectors and adjustment screws on the bottom
    of the HC-SR501 motion sensor:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图片显示了HC-SR501运动传感器底部的连接器和调整螺丝：
- en: '![](img/e89cb327-0204-42a4-9509-86a6347af33e.png)'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/e89cb327-0204-42a4-9509-86a6347af33e.png)'
- en: The **Sensitivity** adjustment screw adjusts the detection range of the sensor.
    The detection range can be set from 3 meters to 7 meters. Turning the sensitivity
    screw clockwise decreases the sensitivity of the sensor.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '**灵敏度**调整螺丝用于调整传感器的检测范围。检测范围可设置为3米至7米。顺时针旋转灵敏度螺丝会降低传感器的灵敏度。'
- en: The **Output Timing** adjustment screw sets how long the output will remain
    high once motion is detected. The output timing can range from 5 seconds to 5
    minutes. Turning the output timing adjustment screw clockwise will increase the
    time delay.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '**输出时间**调整螺钉设置检测到运动后输出保持高电平的时间。输出时间可以从5秒到5分钟不等。顺时针旋转输出时间调整螺钉将增加延迟时间。'
- en: The **Ground** pin should be connected to the ground rail on the breadboard
    or directly to the ground pin on the Arduino. The **5V** pin should be connected
    to the power rail on the breadboard or directly to the 5V out on the Arduino.
    Finally, the middle pin is the **Output** pin for the sensor. If the sensor detects
    motion this pin will go high for the amount of time defined with the output timing
    adjustment screw.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '**地**引脚应连接到面包板上的地轨或直接连接到Arduino的地引脚。**5V**引脚应连接到面包板上的电源轨或直接连接到Arduino的5V输出。最后，中间引脚是传感器的**输出**引脚。如果传感器检测到运动，此引脚将根据输出时间调整螺钉定义的时间变高。'
- en: '**NOTE**: Some compatible sensors may have a different pin configuration than
    the ones shown in this book; please verify the pin configuration for your sensor
    before doing any wiring.'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**：一些兼容的传感器可能具有与本书中显示的不同引脚配置；在进行任何布线之前，请验证您的传感器引脚配置。'
- en: Before you look at the circuit diagram section of this chapter, think about
    how you would connect the HC-SR5012 motion sensor to an Arduino. One hint, you
    will not need anything but the motion sensor, an Arduino and jumper wire. Using
    a breadboard in this particular project is optional.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在您查看本章电路图部分之前，考虑一下您会如何将HC-SR5012运动传感器连接到Arduino。一个提示，您不需要除了运动传感器、Arduino和跳线之外的东西。在这个特定项目中使用面包板是可选的。
- en: Now let's look at the components needed for this chapter's project.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们看看本章项目所需的组件。
- en: Components needed
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 需要的组件
- en: 'We will need the following components for this chapter''s project:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 为了完成本章的项目，我们需要以下组件：
- en: One Arduino Uno or compatible board
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一块Arduino Uno或兼容板
- en: One HC-SR501 motion sensor
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一块HC-SR501运动传感器
- en: Jumper wires
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 跳线
- en: For the challenge, you will need an LED
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于挑战，您需要一个LED
- en: One breadboard
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一块面包板
- en: The breadboard is optional because you may connect the HC-SR501 motion sensor
    directly to the Arduino. You will need a breadboard to complete the challenge
    section of this chapter.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 面包板是可选的，因为您可以直接将HC-SR501运动传感器连接到Arduino。要完成本章的挑战部分，您将需要一个面包板。
- en: Circuit diagrams
  id: totrans-29
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 电路图
- en: 'The following diagram shows the Fritzing diagram for this project:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图显示了本项目Fritzing图：
- en: '![](img/b03edb30-1eee-49f7-8ade-d72284b6041a.png)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b03edb30-1eee-49f7-8ade-d72284b6041a.png)'
- en: With the diagram, we can see that the ground pin on the HC-SR501 motion sensor
    is connected to the ground rail on the breadboard and the 5V input on the motion
    sensor is connected to the power rail on the breadboard. The power and ground
    rails of the breadboard are connected to the 5V power and ground pins on the Arduino.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 通过图示，我们可以看到HC-SR501运动传感器的地引脚连接到面包板的地轨，运动传感器的5V输入连接到面包板的电源轨。面包板的电源和地轨连接到Arduino的5V电源和地引脚。
- en: The output pin on the motion sensor is a digital output (either HIGH or LOW),
    therefore we can connect the output pin directly to any of the digital pins on
    the Arduino. In this case, we are connecting the output pin from the sensor to
    pin three on the Arduino.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 运动传感器的输出引脚是数字输出（要么是HIGH，要么是LOW），因此我们可以将其直接连接到Arduino的任何数字引脚上。在这种情况下，我们将传感器的输出引脚连接到Arduino的3号引脚。
- en: 'Here is the schematic diagram of the same circuit:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是相同电路的原理图：
- en: '![](img/6fa65976-b622-4668-87b0-a4e6c73c2309.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6fa65976-b622-4668-87b0-a4e6c73c2309.png)'
- en: Let's look at the Arduino code for this project.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看本项目Arduino代码。
- en: Code
  id: totrans-37
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 代码
- en: To use the HC-SR501 motion sensor all we need to do is read the digital output
    from the sensor. If the output is HIGH, then the sensor detected motion and if
    it is LOW, then it did not. The output from the sensor will stay HIGH for the
    length of time defined by the output time adjustment screw. I usually keep the
    output time low, usually a couple oof seconds.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用HC-SR501运动传感器，我们只需要读取传感器的数字输出。如果输出是HIGH，则传感器检测到运动；如果是LOW，则没有检测到运动。传感器的输出将保持HIGH状态，持续时间由输出时间调整螺钉定义。我通常将输出时间设置得较低，通常是一两秒钟。
- en: For this project, we will output the status of the sensor to the serial console.
    The output will get a little fancier in the challenge section.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个项目，我们将把传感器的状态输出到串行控制台。在挑战部分，输出将变得更加复杂。
- en: 'The following is the code to read the HC-SR501 motion sensor:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是如何读取HC-SR501运动传感器的代码：
- en: '[PRE0]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: This code starts off by using the `#define` directive to create the `MOTION_SENSOR`
    macro and setting it to `3`. In the `setup()` function we set the pin mode for
    pin 3 for input because we will be reading the digital output pin from the motion
    sensor. We are also initiating the serial console in the `setup()` function as
    well.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 此代码首先使用 `#define` 指令创建 `MOTION_SENSOR` 宏并将其设置为 `3`。在 `setup()` 函数中，我们将3号引脚的引脚模式设置为输入，因为我们将从运动传感器读取数字输出引脚。我们还在
    `setup()` 函数中初始化串行控制台。
- en: The `loop()` function begins by calling the `digitalRead()` function to read
    the output from the motion sensor and assigning the value to the `sensorValue`
    variable. If the `sensorValue` variable is equal to `HIGH`, we send the message
    `Motion Detected` to the serial console. If no motion is detected, we do not print
    anything. At the end of the `loop()` function, there is a half-second delay before
    looping back.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: '`loop()` 函数首先调用 `digitalRead()` 函数来读取运动传感器的输出并将其赋值给 `sensorValue` 变量。如果 `sensorValue`
    变量等于 `HIGH`，我们将消息 `Motion Detected` 发送到串行控制台。如果没有检测到运动，我们不打印任何内容。在 `loop()` 函数的末尾，在循环回之前有一个半秒的延迟。'
- en: Now let's upload and run the code.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们来上传并运行代码。
- en: Running the project
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 运行项目
- en: We will need to have the serial console open when we run the code to see the
    output.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们运行代码时，需要打开串行控制台以查看输出。
- en: 'Once the code is uploaded and running, wave your hand near the sensor, and
    you should see the `Motion Detected` message is printed to the console, as shown
    in the following screenshot:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦代码上传并运行，将手在传感器附近挥动，你应该会看到控制台打印出 `Motion Detected` 消息，如下面的截图所示：
- en: '![](img/196f4d32-2bba-4938-9801-51a601a37e55.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/196f4d32-2bba-4938-9801-51a601a37e55.png)'
- en: Now on to the challenge section of this chapter.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 现在进入本章的挑战部分。
- en: Challenge
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 挑战
- en: The challenge, if you choose to accept it, is to add an LED to this project
    and have the LED light up when the motion sensor detects motion. In the first
    few chapters, we will give either the code or circuit diagram for the challenges
    to make it easier to troubleshoot any issues if the project does not work when
    first built.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你选择接受这个挑战，就是给这个项目添加一个LED灯，当运动传感器检测到运动时，LED灯会亮起。在前几章中，我们将提供代码或电路图，以便在项目初次构建时如果出现问题更容易进行故障排除。
- en: For this challenge, we will give the code and let you figure out how to connect
    the LED to the project. One hint, do not forget about the resistor for the LED.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个挑战，我们将提供代码，并让你自己找出如何将LED连接到项目上。一个提示，不要忘记为LED添加电阻。
- en: 'The following is the code that will light up an LED connected to pin 5 of the
    Arduino when the motion sensor detects nearby motion:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是在运动传感器检测到附近运动时，将连接到Arduino 5号引脚的LED灯点亮的代码：
- en: '[PRE1]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Now it is up to you to complete this challenge.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 现在轮到你来完成这个挑战了。
- en: Summary
  id: totrans-56
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 概述
- en: In this chapter, we learned about the HC-SR501 motion sensor and how it works.
    We saw how we could wire it to an Arduino where the Arduino provided power for
    the sensor and also read the output pin of the sensor.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了HC-SR501运动传感器及其工作原理。我们看到了如何将其连接到Arduino，Arduino为传感器提供电源并读取传感器的输出引脚。
- en: In the next chapter, we will see how we can sense the weather around us.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将看到我们如何感知周围的天气。
