<html><head></head><body>
<div id="_idContainer159">
<h1 class="chapter-number" id="_idParaDest-195"><a id="_idTextAnchor196"/><span class="koboSpan" id="kobo.1.1">10</span></h1>
<h1 id="_idParaDest-196"><a id="_idTextAnchor197"/><span class="koboSpan" id="kobo.2.1">Enhancing the Player Experience</span></h1>
<p><span class="koboSpan" id="kobo.3.1">One of the best ways to improve a video game is to add a good look and feel to it. </span><span class="koboSpan" id="kobo.3.2">A great-looking game will create an immersive experience that will engage players and make them want to keep coming back </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">for more.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">For this reason, it’s important for developers to focus on tweaking visual and audio feedback until everything looks just right! </span><span class="koboSpan" id="kobo.5.2">It might take some time, but getting these last touches right will make sure your video game has an awesome look and feel – something that players won’t forget </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">anytime soon!</span></span></p>
<p><span class="koboSpan" id="kobo.7.1">Keeping this in mind, the following chapter will concentrate on improving certain aspects, such as </span><a id="_idIndexMarker546"/><span class="koboSpan" id="kobo.8.1">using different animations together and synchronizing them over the network, or adding </span><strong class="bold"><span class="koboSpan" id="kobo.9.1">non-player characters</span></strong><span class="koboSpan" id="kobo.10.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.11.1">NPCs</span></strong><span class="koboSpan" id="kobo.12.1">) to interact with – features that your protagonist has longed for a considerable amount </span><span class="No-Break"><span class="koboSpan" id="kobo.13.1">of time.</span></span></p>
<p><span class="koboSpan" id="kobo.14.1">Additionally, you’ll be providing a purpose for your players to fight for: the daring rescue of some </span><span class="No-Break"><span class="koboSpan" id="kobo.15.1">imprisoned comrades!</span></span></p>
<p><span class="koboSpan" id="kobo.16.1">Finally, I’ll share some additional ideas to help guide you in completing your multiplayer game. </span><span class="koboSpan" id="kobo.16.2">This book may not have enough pages to cover every detail, but that shouldn’t stop your creativity and imagination from </span><span class="No-Break"><span class="koboSpan" id="kobo.17.1">taking flight!</span></span></p>
<p><span class="koboSpan" id="kobo.18.1">By the end of this chapter, you will possess a sleek and robust prototype for your multiplayer game and be well equipped and prepared to embark on the next phase – learning how to </span><span class="No-Break"><span class="koboSpan" id="kobo.19.1">optimize it.</span></span></p>
<p><span class="koboSpan" id="kobo.20.1">In this chapter, I will guide you through the </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">following sections:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.22.1">Animating </span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">the character</span></span></li>
<li><span class="koboSpan" id="kobo.24.1">Adding </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">NPC Actors</span></span></li>
<li><span class="koboSpan" id="kobo.26.1">Making further improvements to </span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">the game</span></span></li>
</ul>
<h1 id="_idParaDest-197"><a id="_idTextAnchor198"/><span class="koboSpan" id="kobo.28.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.29.1">To follow the topics presented in this chapter, you should have completed the previous ones and understood </span><span class="No-Break"><span class="koboSpan" id="kobo.30.1">their content.</span></span></p>
<p><span class="koboSpan" id="kobo.31.1">Additionally, if you would prefer to begin with code from the companion repository for this book, you can download the </span><strong class="source-inline"><span class="koboSpan" id="kobo.32.1">.zip</span></strong><span class="koboSpan" id="kobo.33.1"> project </span><span class="No-Break"><span class="koboSpan" id="kobo.34.1">files provided:</span></span></p>
<p><a href="https://github.com/PacktPublishing/Multiplayer-Game-Development-with-Unreal-Engine-5"><span class="No-Break"><span class="koboSpan" id="kobo.35.1">https://github.com/PacktPublishing/Multiplayer-Game-Development-with-Unreal-Engine-5</span></span></a></p>
<p><span class="koboSpan" id="kobo.36.1">You can download the files that are up to date with the end of the last chapter by clicking the </span><strong class="source-inline"><span class="koboSpan" id="kobo.37.1">Unreal Shadows – </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.38.1">Chapter 09</span></strong></span><strong class="source-inline"> </strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.39.1">End</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.40.1"> link.</span></span></p>
<h1 id="_idParaDest-198"><a id="_idTextAnchor199"/><span class="koboSpan" id="kobo.41.1">Animating the character</span></h1>
<p><span class="koboSpan" id="kobo.42.1">So far, your hero has been exploring the dungeon and searching for hidden treasures while avoiding </span><a id="_idIndexMarker547"/><span class="koboSpan" id="kobo.43.1">enemies, but there’s something missing that will really bring it to life – a proper </span><span class="No-Break"><span class="koboSpan" id="kobo.44.1">animation system.</span></span></p>
<p><span class="koboSpan" id="kobo.45.1">In this section, I’ll guide you through the creation of simple animations that will work on the networked environment of your project. </span><span class="koboSpan" id="kobo.45.2">This will involve creating Blueprints specifically designed for the animation system and establishing their connection to your character class – you will be creating the needed animation assets and then adding the needed code to make everything </span><span class="No-Break"><span class="koboSpan" id="kobo.46.1">work properly.</span></span></p>
<h2 id="_idParaDest-199"><a id="_idTextAnchor200"/><span class="koboSpan" id="kobo.47.1">Creating the animation assets</span></h2>
<p><span class="koboSpan" id="kobo.48.1">Animating characters in </span><a id="_idIndexMarker548"/><span class="koboSpan" id="kobo.49.1">Unreal Engine involves creating </span><strong class="bold"><span class="koboSpan" id="kobo.50.1">Animation Blueprints</span></strong><span class="koboSpan" id="kobo.51.1"> that handle the motion and logic of character movement and actions. </span><span class="koboSpan" id="kobo.51.2">This </span><a id="_idIndexMarker549"/><span class="koboSpan" id="kobo.52.1">book doesn’t prioritize this topic – in fact, it’s not usually the main focus for game programmers! </span><span class="koboSpan" id="kobo.52.2">However, having some </span><a id="_idIndexMarker550"/><span class="koboSpan" id="kobo.53.1">basic knowledge of how things work under the hood will be a good addition to your game </span><span class="No-Break"><span class="koboSpan" id="kobo.54.1">development arsenal.</span></span></p>
<p><span class="koboSpan" id="kobo.55.1">To create a simple but fully functional animation system for the player character, we will need </span><span class="No-Break"><span class="koboSpan" id="kobo.56.1">three assets:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.57.1">An asset to control the movement transitions from idle to walk to run, and </span><span class="No-Break"><span class="koboSpan" id="kobo.58.1">vice versa</span></span></li>
<li><span class="koboSpan" id="kobo.59.1">An asset used to play the </span><span class="No-Break"><span class="koboSpan" id="kobo.60.1">throw animation</span></span></li>
<li><span class="koboSpan" id="kobo.61.1">A Blueprint to control the two </span><span class="No-Break"><span class="koboSpan" id="kobo.62.1">aforementioned assets</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.63.1">To get started, we first </span><a id="_idIndexMarker551"/><span class="koboSpan" id="kobo.64.1">need a folder to put all the assets in. </span><span class="koboSpan" id="kobo.64.2">So, open the Unreal Editor and, in </span><strong class="bold"><span class="koboSpan" id="kobo.65.1">Content Drawer</span></strong><span class="koboSpan" id="kobo.66.1">, create a new folder called </span><strong class="source-inline"><span class="koboSpan" id="kobo.67.1">Animations</span></strong><span class="koboSpan" id="kobo.68.1">. </span><span class="koboSpan" id="kobo.68.2">Once it is created, you will be ready to add the </span><span class="No-Break"><span class="koboSpan" id="kobo.69.1">first asset.</span></span></p>
<h3><span class="koboSpan" id="kobo.70.1">Creating the movement Blend Space</span></h3>
<p><span class="koboSpan" id="kobo.71.1">In Unreal Engine, a </span><strong class="bold"><span class="koboSpan" id="kobo.72.1">Blend Space</span></strong><span class="koboSpan" id="kobo.73.1"> is a special </span><a id="_idIndexMarker552"/><span class="koboSpan" id="kobo.74.1">asset that allows for the blending of animations based on the values of two inputs. </span><span class="koboSpan" id="kobo.74.2">It allows multiple animations </span><a id="_idIndexMarker553"/><span class="koboSpan" id="kobo.75.1">to be blended by plotting them onto a one- or two-dimensional graph. </span><span class="koboSpan" id="kobo.75.2">Animators and game developers often use blend </span><a id="_idIndexMarker554"/><span class="koboSpan" id="kobo.76.1">spaces to create smooth and realistic transitions between different animations for characters </span><span class="No-Break"><span class="koboSpan" id="kobo.77.1">in games.</span></span></p>
<p><span class="koboSpan" id="kobo.78.1">In our case, we will need to blend three animations – the idle, walk, and sprint ones – that will be managed depending on the </span><span class="No-Break"><span class="koboSpan" id="kobo.79.1">character’s speed.</span></span></p>
<p><span class="koboSpan" id="kobo.80.1">To create this Blend Space, complete the </span><span class="No-Break"><span class="koboSpan" id="kobo.81.1">following steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.82.1">Inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.83.1">Animations</span></strong><span class="koboSpan" id="kobo.84.1"> folder, right-click and select </span><strong class="bold"><span class="koboSpan" id="kobo.85.1">Animation | Blend Space</span></strong><span class="koboSpan" id="kobo.86.1">. </span><span class="koboSpan" id="kobo.86.2">Then, from the </span><strong class="bold"><span class="koboSpan" id="kobo.87.1">Pick Skeleton</span></strong><span class="koboSpan" id="kobo.88.1"> window that will pop up, select </span><strong class="bold"><span class="koboSpan" id="kobo.89.1">rogue_Skeleton</span></strong><span class="koboSpan" id="kobo.90.1">, as depicted in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.91.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.92.1">.1</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.93.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer145">
<span class="koboSpan" id="kobo.94.1"><img alt="Figure 10.1 – Blend Space creation" src="image/Figure_10_01_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.95.1">Figure 10.1 – Blend Space creation</span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.96.1">Name the </span><a id="_idIndexMarker555"/><span class="koboSpan" id="kobo.97.1">newly-created </span><a id="_idIndexMarker556"/><span class="koboSpan" id="kobo.98.1">asset </span><strong class="source-inline"><span class="koboSpan" id="kobo.99.1">BS_WalkRun</span></strong><span class="koboSpan" id="kobo.100.1"> and double-click it to open the </span><strong class="bold"><span class="koboSpan" id="kobo.101.1">Blend Space </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.102.1">Editor</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.103.1"> window.</span></span></li>
<li><span class="koboSpan" id="kobo.104.1">In </span><strong class="bold"><span class="koboSpan" id="kobo.105.1">Asset Details</span></strong><span class="koboSpan" id="kobo.106.1">, locate the </span><strong class="bold"><span class="koboSpan" id="kobo.107.1">Axis Settings</span></strong><span class="koboSpan" id="kobo.108.1"> category. </span><span class="koboSpan" id="kobo.108.2">Then, in the </span><strong class="bold"><span class="koboSpan" id="kobo.109.1">Horizontal Axis</span></strong><span class="koboSpan" id="kobo.110.1"> section, do </span><span class="No-Break"><span class="koboSpan" id="kobo.111.1">the following:</span></span><ul><li><span class="koboSpan" id="kobo.112.1">Set the </span><strong class="bold"><span class="koboSpan" id="kobo.113.1">Name</span></strong><span class="koboSpan" id="kobo.114.1"> value </span><span class="No-Break"><span class="koboSpan" id="kobo.115.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.116.1">Speed</span></strong></span></li><li><span class="koboSpan" id="kobo.117.1">Set the </span><strong class="bold"><span class="koboSpan" id="kobo.118.1">Maximum Axis</span></strong><span class="koboSpan" id="kobo.119.1"> value </span><span class="No-Break"><span class="koboSpan" id="kobo.120.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.121.1">500</span></strong></span></li></ul></li>
<li><span class="koboSpan" id="kobo.122.1">Leave the </span><strong class="bold"><span class="koboSpan" id="kobo.123.1">Vertical Axis</span></strong><span class="koboSpan" id="kobo.124.1"> section as it is (i.e., set to </span><strong class="bold"><span class="koboSpan" id="kobo.125.1">None</span></strong><span class="koboSpan" id="kobo.126.1">), as we won’t </span><span class="No-Break"><span class="koboSpan" id="kobo.127.1">use it.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.128.1">What we have done here is initialize the main setting values for the animation blend, exposing the </span><strong class="bold"><span class="koboSpan" id="kobo.129.1">Speed</span></strong><span class="koboSpan" id="kobo.130.1"> property that will be used by the controlling Blueprint we will be </span><span class="No-Break"><span class="koboSpan" id="kobo.131.1">adding later.</span></span></p>
<p><span class="koboSpan" id="kobo.132.1">Now, you will be adding the animation assets that will be </span><span class="No-Break"><span class="koboSpan" id="kobo.133.1">blended together.</span></span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.134.1">Locate the </span><strong class="bold"><span class="koboSpan" id="kobo.135.1">rogue_Idle</span></strong><span class="koboSpan" id="kobo.136.1"> animation in the </span><strong class="bold"><span class="koboSpan" id="kobo.137.1">Asset Browser</span></strong><span class="koboSpan" id="kobo.138.1"> and drag it into the graph at the center of the editor. </span><span class="koboSpan" id="kobo.138.2">This will create a point in the coordinate system of </span><span class="No-Break"><span class="koboSpan" id="kobo.139.1">the diagram.</span></span></li>
<li><span class="koboSpan" id="kobo.140.1">Select the </span><a id="_idIndexMarker557"/><span class="koboSpan" id="kobo.141.1">point and set its </span><strong class="bold"><span class="koboSpan" id="kobo.142.1">Speed</span></strong><span class="koboSpan" id="kobo.143.1"> property to </span><strong class="source-inline"><span class="koboSpan" id="kobo.144.1">0</span></strong><span class="koboSpan" id="kobo.145.1"> and its </span><strong class="bold"><span class="koboSpan" id="kobo.146.1">None</span></strong><span class="koboSpan" id="kobo.147.1"> property </span><span class="No-Break"><span class="koboSpan" id="kobo.148.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.149.1">0</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.150.1">.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.151.1">You should </span><a id="_idIndexMarker558"/><span class="koboSpan" id="kobo.152.1">get a graph that looks like the one depicted in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.153.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.154.1">.2</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.155.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer146">
<span class="koboSpan" id="kobo.156.1"><img alt="Figure 10.2 – Idle animation settings" src="image/Figure_10_02_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.157.1">Figure 10.2 – Idle animation settings</span></p>
<p><span class="koboSpan" id="kobo.158.1">Now, we will add two more assets to the graph – one for the walk animation and one for the </span><span class="No-Break"><span class="koboSpan" id="kobo.159.1">run animation.</span></span></p>
<ol>
<li value="7"><span class="koboSpan" id="kobo.160.1">Drag the </span><strong class="bold"><span class="koboSpan" id="kobo.161.1">rogue_Walk</span></strong><span class="koboSpan" id="kobo.162.1"> asset into the graph and set its </span><strong class="bold"><span class="koboSpan" id="kobo.163.1">Speed</span></strong><span class="koboSpan" id="kobo.164.1"> property to </span><strong class="source-inline"><span class="koboSpan" id="kobo.165.1">45</span></strong><span class="koboSpan" id="kobo.166.1"> and its </span><strong class="bold"><span class="koboSpan" id="kobo.167.1">None</span></strong><span class="koboSpan" id="kobo.168.1"> property </span><span class="No-Break"><span class="koboSpan" id="kobo.169.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.170.1">0</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.171.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.172.1">Again, drag the </span><strong class="bold"><span class="koboSpan" id="kobo.173.1">rogue_Walk</span></strong><span class="koboSpan" id="kobo.174.1"> asset into the graph and set its </span><strong class="bold"><span class="koboSpan" id="kobo.175.1">Speed</span></strong><span class="koboSpan" id="kobo.176.1"> property to </span><strong class="source-inline"><span class="koboSpan" id="kobo.177.1">100</span></strong><span class="koboSpan" id="kobo.178.1"> and its </span><strong class="bold"><span class="koboSpan" id="kobo.179.1">None</span></strong><span class="koboSpan" id="kobo.180.1"> property </span><span class="No-Break"><span class="koboSpan" id="kobo.181.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.182.1">0</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.183.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.184.1">Drag the </span><strong class="bold"><span class="koboSpan" id="kobo.185.1">rogue_Run</span></strong><span class="koboSpan" id="kobo.186.1"> asset into the graph and set its </span><strong class="bold"><span class="koboSpan" id="kobo.187.1">Speed</span></strong><span class="koboSpan" id="kobo.188.1"> property to </span><strong class="source-inline"><span class="koboSpan" id="kobo.189.1">500</span></strong><span class="koboSpan" id="kobo.190.1"> and its </span><strong class="bold"><span class="koboSpan" id="kobo.191.1">None</span></strong><span class="koboSpan" id="kobo.192.1"> property </span><span class="No-Break"><span class="koboSpan" id="kobo.193.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.194.1">0</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.195.1">.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.196.1">The complete Blend Space asset can be seen in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.197.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.198.1">.3</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.199.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer147">
<span class="koboSpan" id="kobo.200.1"><img alt="Figure 10.3 – Complete blend space" src="image/Figure_10_03_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.201.1">Figure 10.3 – Complete blend space</span></p>
<p><span class="koboSpan" id="kobo.202.1">To test the </span><a id="_idIndexMarker559"/><span class="koboSpan" id="kobo.203.1">animation blends on the character, you can simply press the </span><em class="italic"><span class="koboSpan" id="kobo.204.1">Ctrl</span></em><span class="koboSpan" id="kobo.205.1"> key and hover the mouse on the zone of the graph </span><a id="_idIndexMarker560"/><span class="koboSpan" id="kobo.206.1">you want to check – you will see the character start a walk-and-move cycle, the animation assets blending seamlessly. </span><span class="koboSpan" id="kobo.206.2">The Blend Space is complete, so we can now start creating the asset that will handle the </span><span class="No-Break"><span class="koboSpan" id="kobo.207.1">throw animation.</span></span></p>
<h3><span class="koboSpan" id="kobo.208.1">Creating the throw Animation Montage</span></h3>
<p><span class="koboSpan" id="kobo.209.1">An </span><strong class="bold"><span class="koboSpan" id="kobo.210.1">Animation Montage</span></strong><span class="koboSpan" id="kobo.211.1"> is a type </span><a id="_idIndexMarker561"/><span class="koboSpan" id="kobo.212.1">of asset that enables the combination </span><a id="_idIndexMarker562"/><span class="koboSpan" id="kobo.213.1">of multiple animations and their selective play from a Blueprint. </span><span class="koboSpan" id="kobo.213.2">Animation Montages are commonly used </span><a id="_idIndexMarker563"/><span class="koboSpan" id="kobo.214.1">for creating complex animation sequences such as attack combos, cutscenes, and other interactive gameplay elements. </span><span class="koboSpan" id="kobo.214.2">In our project, we will use one to play the single-throw animation from the </span><span class="No-Break"><span class="koboSpan" id="kobo.215.1">controlling Blueprint.</span></span></p>
<p><span class="koboSpan" id="kobo.216.1">To create the Animation Montage, complete the </span><span class="No-Break"><span class="koboSpan" id="kobo.217.1">following steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.218.1">Inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.219.1">Animations</span></strong><span class="koboSpan" id="kobo.220.1"> folder, right-click and select </span><strong class="bold"><span class="koboSpan" id="kobo.221.1">Animation | Animation Montage</span></strong><span class="koboSpan" id="kobo.222.1">. </span><span class="koboSpan" id="kobo.222.2">Then, from the </span><strong class="bold"><span class="koboSpan" id="kobo.223.1">Pick Skeleton</span></strong><span class="koboSpan" id="kobo.224.1"> window that will pop up, </span><span class="No-Break"><span class="koboSpan" id="kobo.225.1">select </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.226.1">rogue_Skeleton</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.227.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.228.1">Name the newly created asset </span><strong class="source-inline"><span class="koboSpan" id="kobo.229.1">AM_Throw</span></strong><span class="koboSpan" id="kobo.230.1"> and double-click it to open the </span><strong class="bold"><span class="koboSpan" id="kobo.231.1">Animation Montage </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.232.1">Editor</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.233.1"> window.</span></span></li>
<li><span class="koboSpan" id="kobo.234.1">From the </span><strong class="bold"><span class="koboSpan" id="kobo.235.1">Asset Browser</span></strong><span class="koboSpan" id="kobo.236.1">, drag the </span><strong class="bold"><span class="koboSpan" id="kobo.237.1">rogue_Throw</span></strong><span class="koboSpan" id="kobo.238.1"> asset – in the </span><strong class="bold"><span class="koboSpan" id="kobo.239.1">DefaultGroup.DefaultSlot</span></strong><span class="koboSpan" id="kobo.240.1"> line – onto the timeline at the center of </span><span class="No-Break"><span class="koboSpan" id="kobo.241.1">the editor.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.242.1">The final </span><a id="_idIndexMarker564"/><span class="koboSpan" id="kobo.243.1">result for the Animation Montage </span><a id="_idIndexMarker565"/><span class="koboSpan" id="kobo.244.1">is shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.245.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.246.1">.4</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.247.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer148">
<span class="koboSpan" id="kobo.248.1"><img alt="Figure 10.4 – Throw Animation Montage" src="image/Figure_10_04_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.249.1">Figure 10.4 – Throw Animation Montage</span></p>
<p><span class="koboSpan" id="kobo.250.1">This Montage and the previous </span><strong class="bold"><span class="koboSpan" id="kobo.251.1">Blend Space</span></strong><span class="koboSpan" id="kobo.252.1"> asset will be controlled by a dedicated Blueprint that we are going to add to the project in the </span><span class="No-Break"><span class="koboSpan" id="kobo.253.1">next steps.</span></span></p>
<h3><span class="koboSpan" id="kobo.254.1">Creating the character Animation Blueprint</span></h3>
<p><span class="koboSpan" id="kobo.255.1">An </span><strong class="bold"><span class="koboSpan" id="kobo.256.1">Animation Blueprint</span></strong><span class="koboSpan" id="kobo.257.1"> is a </span><a id="_idIndexMarker566"/><span class="koboSpan" id="kobo.258.1">specialized type of Blueprint that </span><a id="_idIndexMarker567"/><span class="koboSpan" id="kobo.259.1">is used to create and control complex </span><a id="_idIndexMarker568"/><span class="koboSpan" id="kobo.260.1">animation behaviors for Actors in the game. </span><span class="koboSpan" id="kobo.260.2">It defines how animations should be processed and blended together, as well as how animation inputs should </span><span class="No-Break"><span class="koboSpan" id="kobo.261.1">be mapped.</span></span></p>
<p><span class="koboSpan" id="kobo.262.1">In our case, we need to control the Blend Space </span><strong class="bold"><span class="koboSpan" id="kobo.263.1">Speed</span></strong><span class="koboSpan" id="kobo.264.1"> parameter in order to let the character walk and run when needed, and start the throw Animation Montage when the character </span><span class="No-Break"><span class="koboSpan" id="kobo.265.1">is attacking.</span></span></p>
<p><span class="koboSpan" id="kobo.266.1">To create </span><a id="_idIndexMarker569"/><span class="koboSpan" id="kobo.267.1">the Animation Blueprint, complete </span><a id="_idIndexMarker570"/><span class="koboSpan" id="kobo.268.1">the </span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">following steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.270.1">Inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.271.1">Animations</span></strong><span class="koboSpan" id="kobo.272.1"> folder, right-click and select </span><strong class="bold"><span class="koboSpan" id="kobo.273.1">Animation | Animation Blueprint</span></strong><span class="koboSpan" id="kobo.274.1">. </span><span class="koboSpan" id="kobo.274.2">Then, from the </span><strong class="bold"><span class="koboSpan" id="kobo.275.1">Create Animation Blueprint</span></strong><span class="koboSpan" id="kobo.276.1"> window that will pop up, select </span><strong class="bold"><span class="koboSpan" id="kobo.277.1">rogue_Skeleton</span></strong><span class="koboSpan" id="kobo.278.1">, as depicted in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.279.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.280.1">.5</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.281.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer149">
<span class="koboSpan" id="kobo.282.1"><img alt="Figure 10.5 – Animation Blueprint creation" src="image/Figure_10_05_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.283.1">Figure 10.5 – Animation Blueprint creation</span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.284.1">Name the newly-created asset </span><strong class="source-inline"><span class="koboSpan" id="kobo.285.1">AB_Character</span></strong><span class="koboSpan" id="kobo.286.1"> and double-click it to open the </span><span class="No-Break"><span class="koboSpan" id="kobo.287.1">editor window.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.288.1">If you are not already familiar with Animation Blueprints, you will notice some similarities to a regular Blueprint class, such as the </span><strong class="bold"><span class="koboSpan" id="kobo.289.1">My Blueprints</span></strong><span class="koboSpan" id="kobo.290.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.291.1">Event Graph</span></strong><span class="koboSpan" id="kobo.292.1"> tabs. </span><span class="koboSpan" id="kobo.292.2">If it is not already selected, open </span><strong class="bold"><span class="koboSpan" id="kobo.293.1">Event Graph</span></strong><span class="koboSpan" id="kobo.294.1"> to start some Visual Scripting code and then continue with the </span><span class="No-Break"><span class="koboSpan" id="kobo.295.1">following steps.</span></span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.296.1">Add an </span><strong class="bold"><span class="koboSpan" id="kobo.297.1">Event Blueprint Initialize </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.298.1">Animation</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.299.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.300.1">Click and </span><a id="_idIndexMarker571"/><span class="koboSpan" id="kobo.301.1">drag from the </span><strong class="bold"><span class="koboSpan" id="kobo.302.1">Return Value</span></strong><span class="koboSpan" id="kobo.303.1"> outgoing pin of </span><strong class="bold"><span class="koboSpan" id="kobo.304.1">Try Get Pawn Owner</span></strong><span class="koboSpan" id="kobo.305.1"> (which will already be present in the graph) and add a </span><strong class="bold"><span class="koboSpan" id="kobo.306.1">Cast To </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.307.1">US_Character</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.308.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.309.1"> Connect </span><a id="_idIndexMarker572"/><span class="koboSpan" id="kobo.310.1">the event execution pin to the cast node incoming </span><span class="No-Break"><span class="koboSpan" id="kobo.311.1">execution pin.</span></span></li>
<li><span class="koboSpan" id="kobo.312.1">From the </span><strong class="bold"><span class="koboSpan" id="kobo.313.1">As US Character</span></strong><span class="koboSpan" id="kobo.314.1"> outgoing pin of the cast node, click and drag, selecting the </span><strong class="bold"><span class="koboSpan" id="kobo.315.1">Promote to Variable</span></strong><span class="koboSpan" id="kobo.316.1"> option – this will create a variable and add a corresponding </span><strong class="bold"><span class="koboSpan" id="kobo.317.1">Set</span></strong><span class="koboSpan" id="kobo.318.1"> node to the graph that will be automatically connected to the cast node. </span><span class="koboSpan" id="kobo.318.2">Name the </span><span class="No-Break"><span class="koboSpan" id="kobo.319.1">variable </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.320.1">Character</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.321.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.322.1">From the outgoing pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.323.1">Set Character</span></strong><span class="koboSpan" id="kobo.324.1"> node, click and drag to add a </span><strong class="bold"><span class="koboSpan" id="kobo.325.1">Character Movement</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.326.1">getter node.</span></span></li>
<li><span class="koboSpan" id="kobo.327.1">From this getter node outgoing pin, click and drag and select </span><strong class="bold"><span class="koboSpan" id="kobo.328.1">Promote to Variable</span></strong><span class="koboSpan" id="kobo.329.1">. </span><span class="koboSpan" id="kobo.329.2">Name the variable </span><strong class="source-inline"><span class="koboSpan" id="kobo.330.1">Movement Component</span></strong><span class="koboSpan" id="kobo.331.1"> and connect the </span><strong class="bold"><span class="koboSpan" id="kobo.332.1">Set Movement Component</span></strong><span class="koboSpan" id="kobo.333.1"> node that will be automatically added to the graph to the execution pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.334.1">Set </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.335.1">Character</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.336.1"> node.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.337.1">The final graph is shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.338.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.339.1">.6</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.340.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer150">
<span class="koboSpan" id="kobo.341.1"><img alt="Figure 10.6 – Event Blueprint Initialize Animation graph" src="image/Figure_10_06_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.342.1">Figure 10.6 – Event Blueprint Initialize Animation graph</span></p>
<p><span class="koboSpan" id="kobo.343.1">This visual script is executed when the Blueprint is initialized and basically sets the variables you will need later on, </span><span class="No-Break"><span class="koboSpan" id="kobo.344.1">during gameplay.</span></span></p>
<p><span class="koboSpan" id="kobo.345.1">Now, locate the </span><strong class="bold"><span class="koboSpan" id="kobo.346.1">Event Blueprint Update</span></strong><span class="koboSpan" id="kobo.347.1"> animation node that should be already present in </span><span class="No-Break"><span class="koboSpan" id="kobo.348.1">the graph.</span></span></p>
<ol>
<li value="9"><span class="koboSpan" id="kobo.349.1">From the </span><strong class="bold"><span class="koboSpan" id="kobo.350.1">Variables</span></strong><span class="koboSpan" id="kobo.351.1"> section, drag a getter node for the </span><strong class="bold"><span class="koboSpan" id="kobo.352.1">Character</span></strong><span class="koboSpan" id="kobo.353.1"> property. </span><span class="koboSpan" id="kobo.353.2">Right-click it </span><a id="_idIndexMarker573"/><span class="koboSpan" id="kobo.354.1">and select the </span><strong class="bold"><span class="koboSpan" id="kobo.355.1">Convert to Validated Get</span></strong><span class="koboSpan" id="kobo.356.1"> option; this will change the node into an executable </span><a id="_idIndexMarker574"/><span class="koboSpan" id="kobo.357.1">one that will check whether the </span><strong class="bold"><span class="koboSpan" id="kobo.358.1">Character</span></strong><span class="koboSpan" id="kobo.359.1"> variable </span><span class="No-Break"><span class="koboSpan" id="kobo.360.1">is valid.</span></span></li>
<li><span class="koboSpan" id="kobo.361.1">Connect the </span><strong class="bold"><span class="koboSpan" id="kobo.362.1">Event Blueprint Update Animation</span></strong><span class="koboSpan" id="kobo.363.1"> execution pin to the incoming execution pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.364.1">Get Validated </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.365.1">Character</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.366.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.367.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.368.1">Variables</span></strong><span class="koboSpan" id="kobo.369.1"> section, create a new variable of type </span><strong class="bold"><span class="koboSpan" id="kobo.370.1">float</span></strong><span class="koboSpan" id="kobo.371.1"> and call it </span><strong class="source-inline"><span class="koboSpan" id="kobo.372.1">CharacterSpeed</span></strong><span class="koboSpan" id="kobo.373.1">. </span><span class="koboSpan" id="kobo.373.2">Drag a </span><strong class="bold"><span class="koboSpan" id="kobo.374.1">Set</span></strong><span class="koboSpan" id="kobo.375.1"> node for this variable into </span><span class="No-Break"><span class="koboSpan" id="kobo.376.1">the graph.</span></span></li>
<li><span class="koboSpan" id="kobo.377.1">From the </span><strong class="bold"><span class="koboSpan" id="kobo.378.1">Variables</span></strong><span class="koboSpan" id="kobo.379.1"> section, drag a </span><strong class="bold"><span class="koboSpan" id="kobo.380.1">Get</span></strong><span class="koboSpan" id="kobo.381.1"> node for the </span><strong class="bold"><span class="koboSpan" id="kobo.382.1">Movement </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.383.1">Component</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.384.1"> variable.</span></span></li>
<li><span class="koboSpan" id="kobo.385.1">Click and drag from the outgoing pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.386.1">Movement Component</span></strong><span class="koboSpan" id="kobo.387.1"> node and create a </span><strong class="bold"><span class="koboSpan" id="kobo.388.1">Get Velocity</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.389.1">property node.</span></span></li>
<li><span class="koboSpan" id="kobo.390.1">Click and drag from the outgoing pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.391.1">Get Velocity</span></strong><span class="koboSpan" id="kobo.392.1"> node and create a </span><strong class="bold"><span class="koboSpan" id="kobo.393.1">Vector Length </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.394.1">XY</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.395.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.396.1">Connect the </span><a id="_idIndexMarker575"/><span class="koboSpan" id="kobo.397.1">outgoing pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.398.1">Vector Length XY</span></strong><span class="koboSpan" id="kobo.399.1"> node to the incoming pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.400.1">Set Character </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.401.1">Speed</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.402.1"> node.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.403.1">The final </span><a id="_idIndexMarker576"/><span class="koboSpan" id="kobo.404.1">result of the graph is shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.405.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.406.1">.7</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.407.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer151">
<span class="koboSpan" id="kobo.408.1"><img alt="Figure 10.7 – Event Blueprint Update graph" src="image/Figure_10_07_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.409.1">Figure 10.7 – Event Blueprint Update graph</span></p>
<p><span class="koboSpan" id="kobo.410.1">This Visual Scripting code basically tracks the velocity magnitude of the character and stores it in the </span><strong class="bold"><span class="koboSpan" id="kobo.411.1">Character Speed</span></strong><span class="koboSpan" id="kobo.412.1"> variable, which will be used in the following steps to blend the </span><span class="No-Break"><span class="koboSpan" id="kobo.413.1">movement animation.</span></span></p>
<p><span class="koboSpan" id="kobo.414.1">Next, select the </span><strong class="bold"><span class="koboSpan" id="kobo.415.1">AnimGraph</span></strong><span class="koboSpan" id="kobo.416.1"> tab of the editor, which will display a single </span><strong class="bold"><span class="koboSpan" id="kobo.417.1">Output Pose</span></strong><span class="koboSpan" id="kobo.418.1"> – this node represents the final animation pose of the character. </span><span class="koboSpan" id="kobo.418.2">We now need to tell the graph how to animate </span><span class="No-Break"><span class="koboSpan" id="kobo.419.1">the character.</span></span></p>
<ol>
<li value="16"><span class="koboSpan" id="kobo.420.1">Drag the </span><strong class="bold"><span class="koboSpan" id="kobo.421.1">Character Speed</span></strong><span class="koboSpan" id="kobo.422.1"> property from the </span><strong class="bold"><span class="koboSpan" id="kobo.423.1">Variables</span></strong><span class="koboSpan" id="kobo.424.1"> section to create a </span><span class="No-Break"><span class="koboSpan" id="kobo.425.1">getter node.</span></span></li>
<li><span class="koboSpan" id="kobo.426.1">Click and drag from the </span><strong class="bold"><span class="koboSpan" id="kobo.427.1">Character Speed</span></strong><span class="koboSpan" id="kobo.428.1"> outgoing pin and create a </span><strong class="bold"><span class="koboSpan" id="kobo.429.1">Blendspace Player ‘</span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.430.1">BS_WalkRun’</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.431.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.432.1">Click and drag the outgoing pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.433.1">Blendspace Player ‘BS_WalkRun’</span></strong><span class="koboSpan" id="kobo.434.1"> node and </span><a id="_idIndexMarker577"/><span class="koboSpan" id="kobo.435.1">create a </span><strong class="bold"><span class="koboSpan" id="kobo.436.1">Slot ‘Default Slot’</span></strong><span class="koboSpan" id="kobo.437.1"> node – we will use this node from the C++ code to execute the throw </span><span class="No-Break"><span class="koboSpan" id="kobo.438.1">Animation Montage.</span></span></li>
<li><span class="koboSpan" id="kobo.439.1">Connect the </span><a id="_idIndexMarker578"/><span class="koboSpan" id="kobo.440.1">outgoing pin of </span><strong class="bold"><span class="koboSpan" id="kobo.441.1">Slot ‘Default Slot’</span></strong><span class="koboSpan" id="kobo.442.1"> to the incoming pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.443.1">Output </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.444.1">Pose</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.445.1"> node.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.446.1">The final result of the AnimGraph is depicted in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.447.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.448.1">.8</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.449.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer152">
<span class="koboSpan" id="kobo.450.1"><img alt="Figure 10.8 – AnimGraph" src="image/Figure_10_08_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.451.1">Figure 10.8 – AnimGraph</span></p>
<p><span class="koboSpan" id="kobo.452.1">With this final step, the Animation Blueprint is complete; now, you just need to connect it to the character Blueprint to make </span><span class="No-Break"><span class="koboSpan" id="kobo.453.1">it work.</span></span></p>
<h2 id="_idParaDest-200"><a id="_idTextAnchor201"/><span class="koboSpan" id="kobo.454.1">Adding the Animation System to the character</span></h2>
<p><span class="koboSpan" id="kobo.455.1">To add the animation system to the character, you just have to declare the Animation Blueprint inside </span><a id="_idIndexMarker579"/><span class="koboSpan" id="kobo.456.1">the Blueprint class. </span><span class="koboSpan" id="kobo.456.2">To do so, open the </span><strong class="bold"><span class="koboSpan" id="kobo.457.1">BP_Character</span></strong><span class="koboSpan" id="kobo.458.1"> Blueprint and select the </span><strong class="bold"><span class="koboSpan" id="kobo.459.1">Mesh</span></strong><span class="koboSpan" id="kobo.460.1"> property. </span><span class="koboSpan" id="kobo.460.2">Then, in the </span><strong class="bold"><span class="koboSpan" id="kobo.461.1">Details</span></strong><span class="koboSpan" id="kobo.462.1"> panel, locate the </span><strong class="bold"><span class="koboSpan" id="kobo.463.1">Anim Class</span></strong><span class="koboSpan" id="kobo.464.1"> property. </span><span class="koboSpan" id="kobo.464.2">From the drop-down menu next to it, select </span><strong class="bold"><span class="koboSpan" id="kobo.465.1">AB_Character</span></strong><span class="koboSpan" id="kobo.466.1"> as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.467.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.468.1">.9</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.469.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer153">
<span class="koboSpan" id="kobo.470.1"><img alt="Figure 10.9 – Animation Blueprint assigned to the Blueprint class" src="image/Figure_10_09_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.471.1">Figure 10.9 – Animation Blueprint assigned to the Blueprint class</span></p>
<p><span class="koboSpan" id="kobo.472.1">If you test the game right now, you should see the character starting the animation loop and reacting to the player input when walking and running. </span><span class="koboSpan" id="kobo.472.2">However, the run animation will be weirdly jumpy and buggy – this is happening because these animations are not replicated and are just checking the character speed </span><span class="No-Break"><span class="koboSpan" id="kobo.473.1">to update.</span></span></p>
<p><span class="koboSpan" id="kobo.474.1">From a technical point of view, the speed value (i.e., </span><strong class="source-inline"><span class="koboSpan" id="kobo.475.1">MaxWalkSpeed</span></strong><span class="koboSpan" id="kobo.476.1">) is just stored in the server instance of the character, but the client will have its own </span><strong class="source-inline"><span class="koboSpan" id="kobo.477.1">MaxWalkSpeed</span></strong><span class="koboSpan" id="kobo.478.1"> value. </span><span class="koboSpan" id="kobo.478.2">While this may be acceptable if you are just moving an Actor around, as the server will be constantly updating the Actor position, animating a Skeletal Mesh component based on its speed is a totally different beast. </span><span class="koboSpan" id="kobo.478.3">In fact, the Animation System is using the local value (i.e., the client one) and the system will continuously conflict between server and client data, resulting in a </span><span class="No-Break"><span class="koboSpan" id="kobo.479.1">broken animation.</span></span></p>
<p><span class="koboSpan" id="kobo.480.1">That’s why we need to move the start-and-stop sprint logic we implemented in </span><a href="B18203_07.xhtml#_idTextAnchor147"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.481.1">Chapter 7</span></em></span></a><em class="italic"><span class="koboSpan" id="kobo.482.1">, Using Remote Procedure Calls (RPCs),</span></em><span class="koboSpan" id="kobo.483.1"> from the server to the client and call the corresponding methods as multicast ones so that all the clients will be aware of </span><span class="No-Break"><span class="koboSpan" id="kobo.484.1">this change.</span></span></p>
<p><span class="koboSpan" id="kobo.485.1">To do so, open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.486.1">US_Character.h</span></strong><span class="koboSpan" id="kobo.487.1"> header file and add the following </span><span class="No-Break"><span class="koboSpan" id="kobo.488.1">client declarations:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.489.1">
UFUNCTION(NetMulticast, Reliable)
void SprintStart_Client();
UFUNCTION(NetMulticast, Reliable)
void SprintEnd_Client();</span></pre>
<p><span class="koboSpan" id="kobo.490.1">As you can see, we used the </span><strong class="source-inline"><span class="koboSpan" id="kobo.491.1">NetMulticast</span></strong><span class="koboSpan" id="kobo.492.1"> specifier in order to let all the clients know that the character has started sprinting. </span><span class="koboSpan" id="kobo.492.2">Additionally, this call needs to be a </span><strong class="source-inline"><span class="koboSpan" id="kobo.493.1">Reliable</span></strong><span class="koboSpan" id="kobo.494.1"> one so you are guaranteed to send all the data to the recipients without any </span><span class="No-Break"><span class="koboSpan" id="kobo.495.1">packet loss.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.496.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.497.1">For a refresher on RPCs and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.498.1">NetMulticast</span></strong><span class="koboSpan" id="kobo.499.1"> specifier, please refer to </span><a href="B18203_07.xhtml#_idTextAnchor147"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.500.1">Chapter 7</span></em></span></a><em class="italic"><span class="koboSpan" id="kobo.501.1">, Using Remote Procedure </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.502.1">Calls (RPCs)</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.503.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.504.1">Now, open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.505.1">US_Character.cpp</span></strong><span class="koboSpan" id="kobo.506.1"> file and locate </span><strong class="source-inline"><span class="koboSpan" id="kobo.507.1">SprintStart_Server_Implementation()</span></strong><span class="koboSpan" id="kobo.508.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.509.1">SprintEnd_Server_Implementation()</span></strong><span class="koboSpan" id="kobo.510.1">. </span><span class="koboSpan" id="kobo.510.2">You are going to move all the content of both methods </span><a id="_idIndexMarker580"/><span class="koboSpan" id="kobo.511.1">to the corresponding client-side calls. </span><span class="koboSpan" id="kobo.511.2">To do so, remove all the content (i.e., the code in between the brackets) and, in </span><strong class="source-inline"><span class="koboSpan" id="kobo.512.1">SprintStart_Server_Implementation()</span></strong><span class="koboSpan" id="kobo.513.1">, add the </span><span class="No-Break"><span class="koboSpan" id="kobo.514.1">client-side call:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.515.1">
SprintStart_Client();</span></pre>
<p><span class="koboSpan" id="kobo.516.1">For the </span><strong class="source-inline"><span class="koboSpan" id="kobo.517.1">SprintEnd_Server_Implementation()</span></strong><span class="koboSpan" id="kobo.518.1"> method, add </span><span class="No-Break"><span class="koboSpan" id="kobo.519.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.520.1">
SprintEnd_Client();</span></pre>
<p><span class="koboSpan" id="kobo.521.1">After that, move the previously removed code to the </span><span class="No-Break"><span class="koboSpan" id="kobo.522.1">client-side implementations:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.523.1">
void AUS_Character::SprintStart_Client_Implementation()
{
 if (GetCharacterStats())
 {
  GetCharacterMovement()-&gt;MaxWalkSpeed = GetCharacterStats()-&gt;SprintSpeed;
 }
}
void AUS_Character::SprintEnd_Client_Implementation()
{
 if (GetCharacterStats())
 {
  GetCharacterMovement()-&gt;MaxWalkSpeed = GetCharacterStats()-&gt;WalkSpeed;
 }
}</span></pre>
<p><span class="koboSpan" id="kobo.524.1">The overall behavior will then be </span><span class="No-Break"><span class="koboSpan" id="kobo.525.1">as follows:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.526.1">The client controlled by the player receives the movement inputs and sends this data to </span><span class="No-Break"><span class="koboSpan" id="kobo.527.1">the server</span></span></li>
<li><span class="koboSpan" id="kobo.528.1">The server handles this input and sends the update request to </span><span class="No-Break"><span class="koboSpan" id="kobo.529.1">all clients</span></span></li>
<li><span class="koboSpan" id="kobo.530.1">All the clients update the </span><strong class="source-inline"><span class="koboSpan" id="kobo.531.1">MaxWalkSpeed</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.532.1">value accordingly</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.533.1">Once you have </span><a id="_idIndexMarker581"/><span class="koboSpan" id="kobo.534.1">compiled the project, try testing the game – our character can now move and sprint like a pro, and you’ll get to see their animations shine in all </span><span class="No-Break"><span class="koboSpan" id="kobo.535.1">their glory!</span></span></p>
<p><span class="koboSpan" id="kobo.536.1">For some extra practice, try working on the minion character and implementing the same animation logic. </span><span class="koboSpan" id="kobo.536.2">This is the true meaning of summoning a bunch of bones to a fully-fledged, reanimated minion, and who knows? </span><span class="koboSpan" id="kobo.536.3">The Lichlord might just reward you with a surprise or two for a job </span><span class="No-Break"><span class="koboSpan" id="kobo.537.1">well done!</span></span></p>
<h2 id="_idParaDest-201"><a id="_idTextAnchor202"/><span class="koboSpan" id="kobo.538.1">Adding the throw animation</span></h2>
<p><span class="koboSpan" id="kobo.539.1">What’s missing </span><a id="_idIndexMarker582"/><span class="koboSpan" id="kobo.540.1">at the moment is the throw animation and, in this </span><a id="_idIndexMarker583"/><span class="koboSpan" id="kobo.541.1">case, network synchronization is something we really want – every connected player in the game will need to see the character animation whenever it is throwing the dagger in the dungeon, and this animation should be played at the same time for </span><span class="No-Break"><span class="koboSpan" id="kobo.542.1">all clients.</span></span></p>
<p><span class="koboSpan" id="kobo.543.1">The first thing to do is to ensure that the WeaponProjectile component will be properly replicated. </span><span class="koboSpan" id="kobo.543.2">To do so, open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.544.1">US_Character.cpp</span></strong><span class="koboSpan" id="kobo.545.1"> file. </span><span class="koboSpan" id="kobo.545.2">Then, in the constructor, locate the </span><strong class="source-inline"><span class="koboSpan" id="kobo.546.1">Weapon</span></strong><span class="koboSpan" id="kobo.547.1"> component initialization, and add the following line </span><span class="No-Break"><span class="koboSpan" id="kobo.548.1">of code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.549.1">
Weapon-&gt;SetIsReplicated(true);</span></pre>
<p><span class="koboSpan" id="kobo.550.1">Next, open </span><strong class="source-inline"><span class="koboSpan" id="kobo.551.1">US_WeaponProjectileComponent.h</span></strong><span class="koboSpan" id="kobo.552.1"> and, in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.553.1">private</span></strong><span class="koboSpan" id="kobo.554.1"> section, add the following Animation </span><span class="No-Break"><span class="koboSpan" id="kobo.555.1">Montage reference:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.556.1">
UPROPERTY(EditDefaultsOnly, BlueprintReadOnly, Category="Projectile", meta=(AllowPrivateAccess = "true"))
UAnimMontage* ThrowAnimation;</span></pre>
<p><span class="koboSpan" id="kobo.557.1">After that, in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.558.1">protected</span></strong><span class="koboSpan" id="kobo.559.1"> section, add the </span><span class="No-Break"><span class="koboSpan" id="kobo.560.1">following declaration:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.561.1">
UFUNCTION(NetMulticast, Unreliable)
void Throw_Client();</span></pre>
<p><span class="koboSpan" id="kobo.562.1">This is the </span><a id="_idIndexMarker584"/><span class="koboSpan" id="kobo.563.1">throw method that will be executed from the client side. </span><span class="koboSpan" id="kobo.563.2">Notice that we are RPC multicasting to all clients with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.564.1">Unreliable</span></strong><span class="koboSpan" id="kobo.565.1"> property specifier – even though we want this animation synchronized over the network, it is just </span><a id="_idIndexMarker585"/><span class="koboSpan" id="kobo.566.1">an aesthetic add-on, so we can afford to lose the data over the network. </span><span class="koboSpan" id="kobo.566.2">The other clients won’t see the animation, but the dagger will be </span><span class="No-Break"><span class="koboSpan" id="kobo.567.1">spawned anyway.</span></span></p>
<p><span class="koboSpan" id="kobo.568.1">With the header declarations complete, open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.569.1">US_WeaponProjectileComponent.cpp</span></strong><span class="koboSpan" id="kobo.570.1"> file and add the client-side </span><span class="No-Break"><span class="koboSpan" id="kobo.571.1">throw method:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.572.1">
void UUS_WeaponProjectileComponent::Throw_Client_Implementation()
{
 const auto Character = Cast&lt;AUS_Character&gt;(GetOwner());
 if (ThrowAnimation != nullptr)
 {
  if (const auto AnimInstance = Character-&gt;GetMesh()-&gt;GetAnimInstance(); AnimInstance != nullptr)
  {
   AnimInstance-&gt;Montage_Play(ThrowAnimation, 1.f);
  }
 }
}</span></pre>
<p><span class="koboSpan" id="kobo.573.1">As you can see, the code will get the owner of this component and, if it is of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.574.1">US_Character</span></strong><span class="koboSpan" id="kobo.575.1"> type, will play the </span><span class="No-Break"><span class="koboSpan" id="kobo.576.1">Animation Montage</span></span><span class="No-Break"><span class="koboSpan" id="kobo.577.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.578.1">This method will be called from its server-side counterpart, so locate the </span><strong class="source-inline"><span class="koboSpan" id="kobo.579.1">Throw_Server_Implementation()</span></strong><span class="koboSpan" id="kobo.580.1"> method. </span><span class="koboSpan" id="kobo.580.2">We could just execute the method call, but we need to give a slight delay to the spawn logic because the throw animation will take some </span><a id="_idIndexMarker586"/><span class="koboSpan" id="kobo.581.1">time to complete, and spawning the dagger ahead of time would return ugly visual feedback to the player. </span><span class="koboSpan" id="kobo.581.2">To do so, remove all the content </span><a id="_idIndexMarker587"/><span class="koboSpan" id="kobo.582.1">of the function and replace it with the </span><span class="No-Break"><span class="koboSpan" id="kobo.583.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.584.1">
if (ProjectileClass)
{
 Throw_Client();
 FTimerHandle TimerHandle;
 GetWorld()-&gt;GetTimerManager().SetTimer(TimerHandle, [&amp;]()
 {
  const auto Character = Cast&lt;AUS_Character&gt;(GetOwner());
  const auto ProjectileSpawnLocation = GetComponentLocation();
  const auto ProjectileSpawnRotation = GetComponentRotation();
  auto ProjectileSpawnParams = FActorSpawnParameters();
  ProjectileSpawnParams.Owner = GetOwner();
  ProjectileSpawnParams.Instigator = Character;
  GetWorld()-&gt;SpawnActor&lt;AUS_BaseWeaponProjectile&gt;(ProjectileClass, ProjectileSpawnLocation, ProjectileSpawnRotation, ProjectileSpawnParams);
 }, .4f, false);
}</span></pre>
<p><span class="koboSpan" id="kobo.585.1">Here, we have </span><a id="_idIndexMarker588"/><span class="koboSpan" id="kobo.586.1">just moved the spawn logic inside a timer handle to </span><a id="_idIndexMarker589"/><span class="koboSpan" id="kobo.587.1">delay the spawn process while calling the client-side throw logic, in order to start the </span><span class="No-Break"><span class="koboSpan" id="kobo.588.1">animation immediately.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.589.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.590.1">Unreal Engine </span><a id="_idIndexMarker590"/><span class="koboSpan" id="kobo.591.1">provides more advanced methods for synchronizing animations beyond simply delaying method calls, such as </span><strong class="bold"><span class="koboSpan" id="kobo.592.1">Animation Notifies</span></strong><span class="koboSpan" id="kobo.593.1"> (</span><a href="https://docs.unrealengine.com/5.1/en-US/animation-notifies-in-unreal-engine/"><span class="koboSpan" id="kobo.594.1">https://docs.unrealengine.com/5.1/en-US/animation-notifies-in-unreal-engine/</span></a><span class="koboSpan" id="kobo.595.1">). </span><span class="koboSpan" id="kobo.595.2">However, for the purpose of this book, the delay method is a quick and dirty solution that will suffice for </span><span class="No-Break"><span class="koboSpan" id="kobo.596.1">our needs.</span></span></p>
<p><span class="koboSpan" id="kobo.597.1">As the last step, open the </span><strong class="bold"><span class="koboSpan" id="kobo.598.1">BP_Character</span></strong><span class="koboSpan" id="kobo.599.1"> Blueprint, select the </span><strong class="bold"><span class="koboSpan" id="kobo.600.1">Weapon</span></strong><span class="koboSpan" id="kobo.601.1"> component and, in the </span><strong class="bold"><span class="koboSpan" id="kobo.602.1">Details</span></strong><span class="koboSpan" id="kobo.603.1"> panel, look for the </span><strong class="bold"><span class="koboSpan" id="kobo.604.1">Throw Animation</span></strong><span class="koboSpan" id="kobo.605.1"> property and assign the </span><strong class="bold"><span class="koboSpan" id="kobo.606.1">AM_Throw</span></strong><span class="koboSpan" id="kobo.607.1"> montage you have </span><span class="No-Break"><span class="koboSpan" id="kobo.608.1">already created.</span></span></p>
<p><span class="koboSpan" id="kobo.609.1">You can now test the game and the character should throw the dagger and synchronize correctly with the </span><span class="No-Break"><span class="koboSpan" id="kobo.610.1">throw animation.</span></span></p>
<p><span class="koboSpan" id="kobo.611.1">In this section, you have dipped your toes into the mystical realm of animation (although you’re not quite ready to battle the Lichlord just yet) and conjured up a basic animation system that networked players will appreciate. </span><span class="koboSpan" id="kobo.611.2">In the next section, you’re about to bring some friendly characters to life and add even more fun to your game by giving players someone </span><span class="No-Break"><span class="koboSpan" id="kobo.612.1">to rescue.</span></span></p>
<h1 id="_idParaDest-202"><a id="_idTextAnchor203"/><span class="koboSpan" id="kobo.613.1">Adding NPC Actors</span></h1>
<p><span class="koboSpan" id="kobo.614.1">While taking </span><a id="_idIndexMarker591"/><span class="koboSpan" id="kobo.615.1">a leisurely stroll in the underground and dodging or stabbing zombies can be amusing, let’s not forget the big bucks the king’s shelling out for us. </span><span class="koboSpan" id="kobo.615.2">We’ve got a rescue mission on our hands – liberate his knights from the Lichlord’s dungeons before they’re turned into undead abominations. </span><span class="koboSpan" id="kobo.615.3">Time to get down to business, my </span><span class="No-Break"><span class="koboSpan" id="kobo.616.1">fearless developer!</span></span></p>
<p><span class="koboSpan" id="kobo.617.1">In this section, you’ll create an Actor Blueprint that will serve as a prisoner your beloved thief </span><a id="_idIndexMarker592"/><span class="koboSpan" id="kobo.618.1">needs to rescue (in order to get more experience points). </span><span class="koboSpan" id="kobo.618.2">To implement such a system, you will make good use of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.619.1">Interactable</span></strong><span class="koboSpan" id="kobo.620.1"> interface you implemented in </span><a href="B18203_07.xhtml#_idTextAnchor147"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.621.1">Chapter 7</span></em></span></a><em class="italic"><span class="koboSpan" id="kobo.622.1">, Using Remote Procedure </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.623.1">Calls (RPCs)</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.624.1">.</span></span></p>
<h2 id="_idParaDest-203"><a id="_idTextAnchor204"/><span class="koboSpan" id="kobo.625.1">Creating the NPC character</span></h2>
<p><span class="koboSpan" id="kobo.626.1">The NPC</span><strong class="bold"> </strong><span class="koboSpan" id="kobo.627.1">you </span><a id="_idIndexMarker593"/><span class="koboSpan" id="kobo.628.1">will be creating is a simple, replicated Actor that will cheer when the player has interacted with it and will </span><a id="_idIndexMarker594"/><span class="koboSpan" id="kobo.629.1">grant some experience points. </span><span class="koboSpan" id="kobo.629.2">The first things we </span><a id="_idIndexMarker595"/><span class="koboSpan" id="kobo.630.1">need are the Animation Montages that will play the idle and cheer animations. </span><span class="koboSpan" id="kobo.630.2">To do so, complete the </span><span class="No-Break"><span class="koboSpan" id="kobo.631.1">following steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.632.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.633.1">Animations</span></strong><span class="koboSpan" id="kobo.634.1"> folder, add a new </span><strong class="bold"><span class="koboSpan" id="kobo.635.1">Animation Montage</span></strong><span class="koboSpan" id="kobo.636.1"> asset based on the </span><strong class="bold"><span class="koboSpan" id="kobo.637.1">knight_Skeleton</span></strong><span class="koboSpan" id="kobo.638.1"> asset and call </span><span class="No-Break"><span class="koboSpan" id="kobo.639.1">it </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.640.1">AM_KnightIdle</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.641.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.642.1">Add the </span><strong class="bold"><span class="koboSpan" id="kobo.643.1">knight_Idle</span></strong><span class="koboSpan" id="kobo.644.1"> animation to the </span><strong class="bold"><span class="koboSpan" id="kobo.645.1">DefaultGroup.DefaultSlot</span></strong><span class="koboSpan" id="kobo.646.1"> section of </span><span class="No-Break"><span class="koboSpan" id="kobo.647.1">the montage.</span></span></li>
<li><span class="koboSpan" id="kobo.648.1">Add another </span><strong class="bold"><span class="koboSpan" id="kobo.649.1">Animation Montage</span></strong><span class="koboSpan" id="kobo.650.1"> asset based on the </span><strong class="bold"><span class="koboSpan" id="kobo.651.1">knight_Skeleton</span></strong><span class="koboSpan" id="kobo.652.1"> asset and call </span><span class="No-Break"><span class="koboSpan" id="kobo.653.1">it </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.654.1">AM_KnightCheer</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.655.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.656.1">Add the </span><strong class="bold"><span class="koboSpan" id="kobo.657.1">knight_cheer</span></strong><span class="koboSpan" id="kobo.658.1"> animation to </span><span class="No-Break"><span class="koboSpan" id="kobo.659.1">the montage.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.660.1">With these two animation assets ready, you can start creating the prisoner Blueprint. </span><span class="koboSpan" id="kobo.660.2">Open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.661.1">Blueprints</span></strong><span class="koboSpan" id="kobo.662.1"> folder and complete the </span><span class="No-Break"><span class="koboSpan" id="kobo.663.1">following steps.</span></span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.664.1">Create a new Blueprint based on the </span><strong class="bold"><span class="koboSpan" id="kobo.665.1">Actor</span></strong><span class="koboSpan" id="kobo.666.1"> class and name it </span><strong class="source-inline"><span class="koboSpan" id="kobo.667.1">BP_KnightPrisoner</span></strong><span class="koboSpan" id="kobo.668.1">. </span><span class="koboSpan" id="kobo.668.2">Double-click it to </span><span class="No-Break"><span class="koboSpan" id="kobo.669.1">open it.</span></span></li>
<li><span class="koboSpan" id="kobo.670.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.671.1">Components</span></strong><span class="koboSpan" id="kobo.672.1"> panel, add a </span><strong class="bold"><span class="koboSpan" id="kobo.673.1">Skeletal </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.674.1">Mesh</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.675.1"> component.</span></span></li>
<li><span class="koboSpan" id="kobo.676.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.677.1">Details</span></strong><span class="koboSpan" id="kobo.678.1"> panel, tick the </span><strong class="bold"><span class="koboSpan" id="kobo.679.1">Replicates</span></strong><span class="koboSpan" id="kobo.680.1"> property in order to replicate the Actor over </span><span class="No-Break"><span class="koboSpan" id="kobo.681.1">the network.</span></span></li>
<li><span class="koboSpan" id="kobo.682.1">Create an </span><strong class="bold"><span class="koboSpan" id="kobo.683.1">Integer</span></strong><span class="koboSpan" id="kobo.684.1"> variable and call it </span><strong class="source-inline"><span class="koboSpan" id="kobo.685.1">EarnedXp</span></strong><span class="koboSpan" id="kobo.686.1">. </span><span class="koboSpan" id="kobo.686.2">Set its </span><strong class="bold"><span class="koboSpan" id="kobo.687.1">Default Value</span></strong><span class="koboSpan" id="kobo.688.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.689.1">20</span></strong><span class="koboSpan" id="kobo.690.1">. </span><span class="koboSpan" id="kobo.690.2">Tick the </span><strong class="bold"><span class="koboSpan" id="kobo.691.1">Instance Editable</span></strong><span class="koboSpan" id="kobo.692.1"> property to make the </span><span class="No-Break"><span class="koboSpan" id="kobo.693.1">variable public.</span></span></li>
<li><span class="koboSpan" id="kobo.694.1">Create an </span><strong class="bold"><span class="koboSpan" id="kobo.695.1">Anim Montage Object Reference</span></strong><span class="koboSpan" id="kobo.696.1"> variable and call it </span><strong class="source-inline"><span class="koboSpan" id="kobo.697.1">MontageIdle</span></strong><span class="koboSpan" id="kobo.698.1">. </span><span class="koboSpan" id="kobo.698.2">Set its </span><strong class="bold"><span class="koboSpan" id="kobo.699.1">Default Value</span></strong><span class="koboSpan" id="kobo.700.1"> to </span><strong class="bold"><span class="koboSpan" id="kobo.701.1">AM_KnightIdle</span></strong><span class="koboSpan" id="kobo.702.1">. </span><span class="koboSpan" id="kobo.702.2">Tick the </span><strong class="bold"><span class="koboSpan" id="kobo.703.1">Instance </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.704.1">Editable</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.705.1"> property.</span></span></li>
<li><span class="koboSpan" id="kobo.706.1">Create another </span><strong class="bold"><span class="koboSpan" id="kobo.707.1">Anim Montage Object Reference</span></strong><span class="koboSpan" id="kobo.708.1"> variable and call it </span><strong class="source-inline"><span class="koboSpan" id="kobo.709.1">MontageCheer</span></strong><span class="koboSpan" id="kobo.710.1">. </span><span class="koboSpan" id="kobo.710.2">Set its default value to </span><strong class="bold"><span class="koboSpan" id="kobo.711.1">AM_KnightCheer</span></strong><span class="koboSpan" id="kobo.712.1">. </span><span class="koboSpan" id="kobo.712.2">Tick the </span><strong class="bold"><span class="koboSpan" id="kobo.713.1">Instance </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.714.1">Editable</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.715.1"> property.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.716.1">With these </span><a id="_idIndexMarker596"/><span class="koboSpan" id="kobo.717.1">base settings available, you can start adding some </span><a id="_idIndexMarker597"/><span class="koboSpan" id="kobo.718.1">Visual Scripting to the Event Graph in order to make the Actor fully functional. </span><span class="koboSpan" id="kobo.718.2">You will start from the </span><strong class="bold"><span class="koboSpan" id="kobo.719.1">Begin Play</span></strong><span class="koboSpan" id="kobo.720.1"> event to start the idle animation. </span><span class="koboSpan" id="kobo.720.2">To do so, complete the </span><span class="No-Break"><span class="koboSpan" id="kobo.721.1">following steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.722.1">Add an </span><strong class="bold"><span class="koboSpan" id="kobo.723.1">Event BeginPlay</span></strong><span class="koboSpan" id="kobo.724.1"> node to </span><span class="No-Break"><span class="koboSpan" id="kobo.725.1">the graph.</span></span></li>
<li><span class="koboSpan" id="kobo.726.1">From the </span><strong class="bold"><span class="koboSpan" id="kobo.727.1">Components</span></strong><span class="koboSpan" id="kobo.728.1"> panel, drag into the graph a reference of the </span><strong class="bold"><span class="koboSpan" id="kobo.729.1">Skeletal </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.730.1">Mesh</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.731.1"> component.</span></span></li>
<li><span class="koboSpan" id="kobo.732.1">From the </span><strong class="bold"><span class="koboSpan" id="kobo.733.1">Variables</span></strong><span class="koboSpan" id="kobo.734.1"> panel, drag a getter node for the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.735.1">MontageIdle</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.736.1"> variable.</span></span></li>
<li><span class="koboSpan" id="kobo.737.1">From the </span><strong class="bold"><span class="koboSpan" id="kobo.738.1">Event BeginPlay</span></strong><span class="koboSpan" id="kobo.739.1"> execution pin, create a </span><strong class="bold"><span class="koboSpan" id="kobo.740.1">Play </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.741.1">Animation</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.742.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.743.1">Connect the </span><strong class="bold"><span class="koboSpan" id="kobo.744.1">Skeletal Mesh</span></strong><span class="koboSpan" id="kobo.745.1"> pin to the </span><strong class="bold"><span class="koboSpan" id="kobo.746.1">Target</span></strong><span class="koboSpan" id="kobo.747.1"> pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.748.1">Play </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.749.1">Animation</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.750.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.751.1">Connect the </span><strong class="bold"><span class="koboSpan" id="kobo.752.1">Montage Idle</span></strong><span class="koboSpan" id="kobo.753.1"> pin to the </span><strong class="bold"><span class="koboSpan" id="kobo.754.1">New Anim to Play</span></strong><span class="koboSpan" id="kobo.755.1"> pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.756.1">Play </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.757.1">Animation</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.758.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.759.1">Tick the </span><strong class="bold"><span class="koboSpan" id="kobo.760.1">Looping</span></strong><span class="koboSpan" id="kobo.761.1"> property of the </span><strong class="bold"><span class="koboSpan" id="kobo.762.1">Play </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.763.1">Animation</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.764.1"> node.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.765.1">The final result for this part of the graph is shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.766.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.767.1">.10</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.768.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer154">
<span class="koboSpan" id="kobo.769.1"><img alt="Figure 10.10 – Event BeginPlay graph" src="image/Figure_10_10_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.770.1">Figure 10.10 – Event BeginPlay graph</span></p>
<p><span class="koboSpan" id="kobo.771.1">Then, create a </span><a id="_idIndexMarker598"/><span class="koboSpan" id="kobo.772.1">custom event that will start the cheer animation </span><a id="_idIndexMarker599"/><span class="koboSpan" id="kobo.773.1">when the prisoner is rescued by the player character. </span><span class="koboSpan" id="kobo.773.2">This event needs to be executed as a </span><strong class="bold"><span class="koboSpan" id="kobo.774.1">Multicast</span></strong><span class="koboSpan" id="kobo.775.1"> event in order to start the animation on all clients. </span><span class="koboSpan" id="kobo.775.2">To do so, complete the </span><span class="No-Break"><span class="koboSpan" id="kobo.776.1">following steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.777.1">Right-click on the graph and create a </span><strong class="bold"><span class="koboSpan" id="kobo.778.1">Custom Event</span></strong><span class="koboSpan" id="kobo.779.1"> node, naming it </span><strong class="source-inline"><span class="koboSpan" id="kobo.780.1">CharacterCheer</span></strong><span class="koboSpan" id="kobo.781.1">. </span><span class="koboSpan" id="kobo.781.2">With the event selected, locate the </span><strong class="bold"><span class="koboSpan" id="kobo.782.1">Replicates</span></strong><span class="koboSpan" id="kobo.783.1"> property in the </span><strong class="bold"><span class="koboSpan" id="kobo.784.1">Details</span></strong><span class="koboSpan" id="kobo.785.1"> panel and, from its drop-down menu, select </span><strong class="bold"><span class="koboSpan" id="kobo.786.1">Multicast</span></strong><span class="koboSpan" id="kobo.787.1">, leaving the </span><strong class="bold"><span class="koboSpan" id="kobo.788.1">Reliable</span></strong><span class="koboSpan" id="kobo.789.1"> checkmark unticked, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.790.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.791.1">.11</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.792.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer155">
<span class="koboSpan" id="kobo.793.1"><img alt="Figure 10.11 – Custom Event replication" src="image/Figure_10_11_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.794.1">Figure 10.11 – Custom Event replication</span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.795.1">From </span><a id="_idIndexMarker600"/><span class="koboSpan" id="kobo.796.1">the </span><strong class="bold"><span class="koboSpan" id="kobo.797.1">Components</span></strong><span class="koboSpan" id="kobo.798.1"> panel, drag into the graph a </span><a id="_idIndexMarker601"/><span class="koboSpan" id="kobo.799.1">reference to the </span><strong class="bold"><span class="koboSpan" id="kobo.800.1">Skeletal </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.801.1">Mesh</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.802.1"> component.</span></span></li>
<li><span class="koboSpan" id="kobo.803.1">From the </span><strong class="bold"><span class="koboSpan" id="kobo.804.1">Variables</span></strong><span class="koboSpan" id="kobo.805.1"> panel, drag a getter node for the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.806.1">MontageCheer</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.807.1"> variable.</span></span></li>
<li><span class="koboSpan" id="kobo.808.1">From the </span><strong class="bold"><span class="koboSpan" id="kobo.809.1">Event BeginPlay</span></strong><span class="koboSpan" id="kobo.810.1"> execution pin, create a </span><strong class="bold"><span class="koboSpan" id="kobo.811.1">Play </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.812.1">Animation</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.813.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.814.1">Connect the </span><strong class="bold"><span class="koboSpan" id="kobo.815.1">Skeletal Mesh</span></strong><span class="koboSpan" id="kobo.816.1"> pin to the </span><strong class="bold"><span class="koboSpan" id="kobo.817.1">Target</span></strong><span class="koboSpan" id="kobo.818.1"> pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.819.1">Play </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.820.1">Animation</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.821.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.822.1">Connect the </span><strong class="bold"><span class="koboSpan" id="kobo.823.1">Montage Idle</span></strong><span class="koboSpan" id="kobo.824.1"> pin to the </span><strong class="bold"><span class="koboSpan" id="kobo.825.1">New Anim to Play</span></strong><span class="koboSpan" id="kobo.826.1"> pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.827.1">Play </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.828.1">Animation</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.829.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.830.1">Tick the </span><strong class="bold"><span class="koboSpan" id="kobo.831.1">Looping</span></strong><span class="koboSpan" id="kobo.832.1"> property of the </span><strong class="bold"><span class="koboSpan" id="kobo.833.1">Play </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.834.1">Animation</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.835.1"> node.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.836.1">The final result for this part of the graph is shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.837.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.838.1">.12</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.839.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer156">
<span class="koboSpan" id="kobo.840.1"><img alt="Figure 10.12 – CharacterCheer Custom Event" src="image/Figure_10_12_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.841.1">Figure 10.12 – CharacterCheer Custom Event</span></p>
<p><span class="koboSpan" id="kobo.842.1">The last step </span><a id="_idIndexMarker602"/><span class="koboSpan" id="kobo.843.1">needed to make the Actor work properly is to make </span><a id="_idIndexMarker603"/><span class="koboSpan" id="kobo.844.1">it interactable with the player character by implementing the </span><strong class="source-inline"><span class="koboSpan" id="kobo.845.1">US_Interactable</span></strong><span class="koboSpan" id="kobo.846.1"> interface. </span><span class="koboSpan" id="kobo.846.2">To do so, complete the </span><span class="No-Break"><span class="koboSpan" id="kobo.847.1">following steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.848.1">Open the </span><strong class="bold"><span class="koboSpan" id="kobo.849.1">Class Settings</span></strong><span class="koboSpan" id="kobo.850.1"> panel and locate the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.851.1">Interfaces</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.852.1"> category.</span></span></li>
<li><span class="koboSpan" id="kobo.853.1">In </span><strong class="bold"><span class="koboSpan" id="kobo.854.1">Implemented Interfaces</span></strong><span class="koboSpan" id="kobo.855.1">, add the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.856.1">US_Interactable</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.857.1"> interface.</span></span></li>
<li><span class="koboSpan" id="kobo.858.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.859.1">My Blueprint</span></strong><span class="koboSpan" id="kobo.860.1"> panel, locate the </span><strong class="bold"><span class="koboSpan" id="kobo.861.1">Interfaces</span></strong><span class="koboSpan" id="kobo.862.1"> category and right-click the </span><strong class="bold"><span class="koboSpan" id="kobo.863.1">Interact</span></strong><span class="koboSpan" id="kobo.864.1"> method, selecting </span><strong class="bold"><span class="koboSpan" id="kobo.865.1">Implement event</span></strong><span class="koboSpan" id="kobo.866.1">. </span><span class="koboSpan" id="kobo.866.2">An </span><strong class="bold"><span class="koboSpan" id="kobo.867.1">Event Interact</span></strong><span class="koboSpan" id="kobo.868.1"> node will be added to the </span><span class="No-Break"><span class="koboSpan" id="kobo.869.1">Event Graph.</span></span></li>
<li><span class="koboSpan" id="kobo.870.1">Click and drag from the event </span><strong class="bold"><span class="koboSpan" id="kobo.871.1">Character Instigator</span></strong><span class="koboSpan" id="kobo.872.1"> pin to add a </span><strong class="bold"><span class="koboSpan" id="kobo.873.1">PlayerState</span></strong><span class="koboSpan" id="kobo.874.1"> node and connect its </span><strong class="bold"><span class="koboSpan" id="kobo.875.1">Target</span></strong><span class="koboSpan" id="kobo.876.1"> pin to the </span><strong class="bold"><span class="koboSpan" id="kobo.877.1">Character Instigator</span></strong><span class="koboSpan" id="kobo.878.1"> pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.879.1">Event </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.880.1">Interact</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.881.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.882.1">Click and drag from the outgoing pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.883.1">PlayerState</span></strong><span class="koboSpan" id="kobo.884.1"> node and create a </span><strong class="bold"><span class="koboSpan" id="kobo.885.1">Cast To US_PlayerState</span></strong><span class="koboSpan" id="kobo.886.1"> node. </span><span class="koboSpan" id="kobo.886.2">Connect its incoming execution pin to the outgoing execution pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.887.1">Event </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.888.1">Interact</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.889.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.890.1">Click and </span><a id="_idIndexMarker604"/><span class="koboSpan" id="kobo.891.1">drag from the </span><strong class="bold"><span class="koboSpan" id="kobo.892.1">As US PlayerState</span></strong><span class="koboSpan" id="kobo.893.1"> of the cast </span><a id="_idIndexMarker605"/><span class="koboSpan" id="kobo.894.1">node and create an </span><strong class="bold"><span class="koboSpan" id="kobo.895.1">Add Xp</span></strong><span class="koboSpan" id="kobo.896.1"> node. </span><span class="koboSpan" id="kobo.896.2">Connect its incoming execution pin to the </span><strong class="bold"><span class="koboSpan" id="kobo.897.1">Success</span></strong><span class="koboSpan" id="kobo.898.1"> execution pin of the </span><span class="No-Break"><span class="koboSpan" id="kobo.899.1">cast node.</span></span></li>
<li><span class="koboSpan" id="kobo.900.1">From the </span><strong class="bold"><span class="koboSpan" id="kobo.901.1">Variables</span></strong><span class="koboSpan" id="kobo.902.1"> panel, drag a getter node for the </span><strong class="bold"><span class="koboSpan" id="kobo.903.1">EarnedXp</span></strong><span class="koboSpan" id="kobo.904.1"> variable. </span><span class="koboSpan" id="kobo.904.2">Connect its outgoing pin to the </span><strong class="bold"><span class="koboSpan" id="kobo.905.1">Value</span></strong><span class="koboSpan" id="kobo.906.1"> pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.907.1">Add </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.908.1">Xp</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.909.1"> node.</span></span></li>
<li><span class="koboSpan" id="kobo.910.1">Click and drag from the outgoing pin of the </span><strong class="bold"><span class="koboSpan" id="kobo.911.1">Add Xp</span></strong><span class="koboSpan" id="kobo.912.1"> node and create a </span><strong class="bold"><span class="koboSpan" id="kobo.913.1">Character Cheer</span></strong><span class="koboSpan" id="kobo.914.1"> node to complete the graph, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.915.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.916.1">.13</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.917.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer157">
<span class="koboSpan" id="kobo.918.1"><img alt="Figure 10.13 – Interaction graph" src="image/Figure_10_13_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.919.1">Figure 10.13 – Interaction graph</span></p>
<p><span class="koboSpan" id="kobo.920.1">You may have noticed that we didn’t use any authority checks in the previous graph; this is because we know that this event will only be called on </span><span class="No-Break"><span class="koboSpan" id="kobo.921.1">the server.</span></span></p>
<p><span class="koboSpan" id="kobo.922.1">The Blueprint is now complete, so it’s time to do </span><span class="No-Break"><span class="koboSpan" id="kobo.923.1">some testing.</span></span></p>
<h2 id="_idParaDest-204"><a id="_idTextAnchor205"/><span class="koboSpan" id="kobo.924.1">Testing the NPC Actor</span></h2>
<p><span class="koboSpan" id="kobo.925.1">To test the </span><a id="_idIndexMarker606"/><span class="koboSpan" id="kobo.926.1">Blueprint, you can drag an instance of it into the level and start a gameplay session. </span><span class="koboSpan" id="kobo.926.2">The thief character should be able to reach the NPC and, if we use the interaction button, the animation should show them cheering. </span><span class="koboSpan" id="kobo.926.3">The hero who liberates the NPC characters will receive a well-deserved pool of experience points as a reward. </span><span class="koboSpan" id="kobo.926.4">Time to level up and become an even </span><span class="No-Break"><span class="koboSpan" id="kobo.927.1">greater hero!</span></span></p>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.928.1">Figure 10</span></em></span><em class="italic"><span class="koboSpan" id="kobo.929.1">.14</span></em><span class="koboSpan" id="kobo.930.1"> shows the final result of the NPC Actor, once it has been liberated by the </span><span class="No-Break"><span class="koboSpan" id="kobo.931.1">thief hero:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer158">
<span class="koboSpan" id="kobo.932.1"><img alt="Figure 10.14 – A ﻿liberated Actor during gameplay" src="image/Figure_10_14_B18203.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.933.1">Figure 10.14 – A liberated Actor during gameplay</span></p>
<p><span class="koboSpan" id="kobo.934.1">Well, it seems we </span><a id="_idIndexMarker607"/><span class="koboSpan" id="kobo.935.1">now have a new prisoner to play with! </span><span class="koboSpan" id="kobo.935.2">But why settle for one when we can have variations? </span><span class="koboSpan" id="kobo.935.3">Feel free to get creative and give our captive some fresh looks to keep things interesting. </span><span class="koboSpan" id="kobo.935.4">By creating child Blueprints and changing the Actor’s Skeletal Mesh component and Animation Montages, you will be able to make good use of the barbarian and mage models available in the project. </span><span class="koboSpan" id="kobo.935.5">You may even create a rogue prisoner variation – who says we can’t go off-script a little? </span><span class="koboSpan" id="kobo.935.6">The king may have paid us to rescue his knights and warriors, but hey, a skilled hero or two in the Thief Guild never </span><span class="No-Break"><span class="koboSpan" id="kobo.936.1">hurt anyone!</span></span></p>
<p><span class="koboSpan" id="kobo.937.1">Congratulations – you’ve completed this part of the adventure. </span><span class="koboSpan" id="kobo.937.2">Now it’s time to let your imagination run wild and add your own game logic! </span><span class="koboSpan" id="kobo.937.3">In the next section, I won’t be teaching you any new techniques, but I’ll provide you with some fresh ideas to enhance the gameplay and make it </span><span class="No-Break"><span class="koboSpan" id="kobo.938.1">more exciting.</span></span></p>
<h1 id="_idParaDest-205"><a id="_idTextAnchor206"/><span class="koboSpan" id="kobo.939.1">Making further improvements to the game</span></h1>
<p><span class="koboSpan" id="kobo.940.1">Now that you have solid knowledge of how the Unreal multiplayer system works, it’s time to unleash </span><a id="_idIndexMarker608"/><span class="koboSpan" id="kobo.941.1">your creativity and bring your own ideas to life, making your game truly unique and personalized. </span><span class="koboSpan" id="kobo.941.2">In this section, I will give you some hints on how to spice up your project, but don’t hesitate to add your own twist to make it </span><span class="No-Break"><span class="koboSpan" id="kobo.942.1">uniquely yours.</span></span></p>
<h2 id="_idParaDest-206"><a id="_idTextAnchor207"/><span class="koboSpan" id="kobo.943.1">Let’s make some noise!</span></h2>
<p><span class="koboSpan" id="kobo.944.1">Currently, the minions’ hearing senses are only utilized to detect when a character is running. </span><span class="koboSpan" id="kobo.944.2">Why not tweak the system and let other elements in the game alert the </span><span class="No-Break"><span class="koboSpan" id="kobo.945.1">Lichlord’s minions?</span></span></p>
<p><span class="koboSpan" id="kobo.946.1">Unfortunately, </span><strong class="source-inline"><span class="koboSpan" id="kobo.947.1">PawnNoiseEmitterComponent</span></strong><span class="koboSpan" id="kobo.948.1"> can only be used on, well... </span><span class="koboSpan" id="kobo.948.2">pawns, so you cannot attach it to other Actors (it simply won’t work); however, in </span><a href="B18203_09.xhtml#_idTextAnchor174"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.949.1">Chapter 9</span></em></span></a><em class="italic"><span class="koboSpan" id="kobo.950.1">, Extending AI Behaviors</span></em><span class="koboSpan" id="kobo.951.1">, you built a strong system to alert enemy minions that makes use of the Game Mode. </span><span class="koboSpan" id="kobo.951.2">As the Game Mode can be reached by any Actor in the level, you can exploit the </span><strong class="source-inline"><span class="koboSpan" id="kobo.952.1">AlertMinions()</span></strong><span class="koboSpan" id="kobo.953.1"> function and send messages that will call for help </span><span class="No-Break"><span class="koboSpan" id="kobo.954.1">when activated.</span></span></p>
<p><span class="koboSpan" id="kobo.955.1">One of the best ways to use this method is through traps – whenever the player character steps into one such device, all the minions around will be alerted. </span><span class="koboSpan" id="kobo.955.2">Some examples of this kind of game feature include </span><span class="No-Break"><span class="koboSpan" id="kobo.956.1">the following:</span></span></p>
<ul>
<li><em class="italic"><span class="koboSpan" id="kobo.957.1">Creaking doors</span></em><span class="koboSpan" id="kobo.958.1">: Whenever the character opens a door, it will make a creaking or squeaking sound that will alert the Lichlord’s servants to </span><span class="No-Break"><span class="koboSpan" id="kobo.959.1">the intruders.</span></span></li>
<li><em class="italic"><span class="koboSpan" id="kobo.960.1">Traps</span></em><span class="koboSpan" id="kobo.961.1">: Some dungeon areas will be more protected than others – set some mechanical devices that will rally all nearby enemies. </span><span class="koboSpan" id="kobo.961.2">After all, this is just a matter of creating a collision area and calling a method in the </span><span class="No-Break"><span class="koboSpan" id="kobo.962.1">Game Mode!</span></span></li>
<li><em class="italic"><span class="koboSpan" id="kobo.963.1">Magical items</span></em><span class="koboSpan" id="kobo.964.1">: Create some magical artifact that can be interacted with by the player. </span><span class="koboSpan" id="kobo.964.2">The Lichlord is a sneaky one: he cast an alert spell, which condemned the hapless thief hero to their inevitable fate. </span><span class="koboSpan" id="kobo.964.3">Whenever the character tries to use that juicy item, an alarm will be sent to nearby minions, alerting them. </span><span class="koboSpan" id="kobo.964.4">Think of the possibilities! </span><span class="koboSpan" id="kobo.964.5">You can even use the floating book we created at the beginning of </span><span class="No-Break"><span class="koboSpan" id="kobo.965.1">the project.</span></span></li>
</ul>
<h2 id="_idParaDest-207"><a id="_idTextAnchor208"/><span class="koboSpan" id="kobo.966.1">I need a key!</span></h2>
<p><span class="koboSpan" id="kobo.967.1">Opening doors in a dungeon can be a fun game, but things can get even more interesting when you come across a locked door. </span><span class="koboSpan" id="kobo.967.2">Why not give it a try and see what other surprises lie </span><span class="No-Break"><span class="koboSpan" id="kobo.968.1">in wait?</span></span></p>
<p><span class="koboSpan" id="kobo.969.1">In </span><a href="B18203_07.xhtml#_idTextAnchor147"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.970.1">Chapter 7</span></em></span></a><em class="italic"><span class="koboSpan" id="kobo.971.1">, Using Remote Procedure Calls (RPCs)</span></em><span class="koboSpan" id="kobo.972.1">, you created the </span><strong class="source-inline"><span class="koboSpan" id="kobo.973.1">US_Interactable</span></strong><span class="koboSpan" id="kobo.974.1"> interface and made use of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.975.1">Interact()</span></strong><span class="koboSpan" id="kobo.976.1"> method. </span><span class="koboSpan" id="kobo.976.2">However, the interface also exposes the </span><strong class="source-inline"><span class="koboSpan" id="kobo.977.1">CanInteract()</span></strong><span class="koboSpan" id="kobo.978.1"> method, which can be used to check whether the Actor can be </span><span class="No-Break"><span class="koboSpan" id="kobo.979.1">interacted with.</span></span></p>
<p><span class="koboSpan" id="kobo.980.1">A door may </span><a id="_idIndexMarker609"/><span class="koboSpan" id="kobo.981.1">implement a system that will only return </span><strong class="source-inline"><span class="koboSpan" id="kobo.982.1">true</span></strong><span class="koboSpan" id="kobo.983.1"> to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.984.1">CanInteract()</span></strong><span class="koboSpan" id="kobo.985.1"> method if the player character has a key – this means creating a key pickup item and adding the </span><strong class="source-inline"><span class="koboSpan" id="kobo.986.1">US_Character</span></strong><span class="koboSpan" id="kobo.987.1"> system to track whether they have one or more keys to use. </span><span class="koboSpan" id="kobo.987.2">These locked doors can be used to keep the NPCs locked in some cellars and only able to be freed if the corresponding key is found somewhere in </span><span class="No-Break"><span class="koboSpan" id="kobo.988.1">the level.</span></span></p>
<p><span class="koboSpan" id="kobo.989.1">Watch out for the Lichlord! </span><span class="koboSpan" id="kobo.989.2">His prisoners are double-locked up tighter than a merchant’s coin purse in the deepest and most heavily guarded cells of </span><span class="No-Break"><span class="koboSpan" id="kobo.990.1">his dungeon!</span></span></p>
<h2 id="_idParaDest-208"><a id="_idTextAnchor209"/><span class="koboSpan" id="kobo.991.1">Improve your arsenal, my hero!</span></h2>
<p><span class="koboSpan" id="kobo.992.1">While it’s nice to have a pointy dagger to throw at your hated opponents, it’s even nicer to have a magical one that will inflict more damage, or even defeat enemies with a single hit. </span><span class="koboSpan" id="kobo.992.2">You can implement a pickup Blueprint that will make good use of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.993.1">SetProjectileClass()</span></strong><span class="koboSpan" id="kobo.994.1"> function you implemented in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.995.1">US_WeaponProjectileComponent</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.996.1"> class.</span></span></p>
<p><span class="koboSpan" id="kobo.997.1">Upon picking up the item, the character will be granted a variant of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.998.1">US_BaseWeaponProjectile</span></strong><span class="koboSpan" id="kobo.999.1"> class with augmented damage. </span><span class="koboSpan" id="kobo.999.2">You can even think about letting defeated enemies drop weapon pickups instead </span><span class="No-Break"><span class="koboSpan" id="kobo.1000.1">of coins!</span></span></p>
<p><span class="koboSpan" id="kobo.1001.1">As an additional feature, you may even think to create throwing rocks that will send alert messages upon hitting the ground – just remember to enable gravity for the projectile. </span><span class="koboSpan" id="kobo.1001.2">Having items that can be thrown and that will make noise to alert minions and direct them far away from the player characters will add some fresh gameplay logic that will improve the overall </span><span class="No-Break"><span class="koboSpan" id="kobo.1002.1">game experience.</span></span></p>
<p><span class="koboSpan" id="kobo.1003.1">Get ready for a wickedly clever twist, and use your quick wit to dazzle the Lichlord’s mindless servants! </span><span class="koboSpan" id="kobo.1003.2">With brains like yours, who </span><span class="No-Break"><span class="koboSpan" id="kobo.1004.1">needs brawn?</span></span></p>
<h2 id="_idParaDest-209"><a id="_idTextAnchor210"/><span class="koboSpan" id="kobo.1005.1">You are not a machine gun</span></h2>
<p><span class="koboSpan" id="kobo.1006.1">Currently, players have the ability to throw an unlimited number of daggers during gameplay. </span><span class="koboSpan" id="kobo.1006.2">While this may be enjoyable initially, it will ultimately disrupt the balance of the game and result in a monotonous experience </span><span class="No-Break"><span class="koboSpan" id="kobo.1007.1">over time.</span></span></p>
<p><span class="koboSpan" id="kobo.1008.1">To make things more interesting (and in favor of the Lichlord’s shadowy plans), limit the players to just one </span><a id="_idIndexMarker610"/><span class="koboSpan" id="kobo.1009.1">throwing dagger projectile at a time. </span><span class="koboSpan" id="kobo.1009.2">Once the character has thrown the weapon, it won’t be able to throw it again until the dagger has </span><span class="No-Break"><span class="koboSpan" id="kobo.1010.1">been recovered.</span></span></p>
<p><span class="koboSpan" id="kobo.1011.1">Implementing this feature is quite straightforward – once the character throws the projectile, set the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1012.1">ProjectileClass</span></strong><span class="koboSpan" id="kobo.1013.1"> weapon component to a </span><strong class="source-inline"><span class="koboSpan" id="kobo.1014.1">null</span></strong><span class="koboSpan" id="kobo.1015.1"> value so that the character won’t be able to spawn any more objects. </span><span class="koboSpan" id="kobo.1015.2">Upon hitting something, the thrown weapon will spawn a dagger pickup (see the previous subsection) before destroying itself. </span><span class="koboSpan" id="kobo.1015.3">This will force the character to get to the dropped weapon and pick it up in order to </span><span class="No-Break"><span class="koboSpan" id="kobo.1016.1">attack again.</span></span></p>
<p><span class="koboSpan" id="kobo.1017.1">As an alternative feature, you may give your character a limited number of knives and use a count variable to check whether the character has any knives available every time the player tries to </span><span class="No-Break"><span class="koboSpan" id="kobo.1018.1">throw one.</span></span></p>
<p><span class="koboSpan" id="kobo.1019.1">Whoever said life in the dungeon would be a walk in the park obviously never encountered a horde of undead monsters while armed with a simple (and </span><span class="No-Break"><span class="koboSpan" id="kobo.1020.1">single!) weapon.</span></span></p>
<h2 id="_idParaDest-210"><a id="_idTextAnchor211"/><span class="koboSpan" id="kobo.1021.1">No time to waste</span></h2>
<p><span class="koboSpan" id="kobo.1022.1">At the moment, your characters can walk around calmly and take their time in rescuing the prisoners. </span><span class="koboSpan" id="kobo.1022.2">Why not spice things up by adding a time counter? </span><span class="koboSpan" id="kobo.1022.3">The Lichlord is hosting a grand celebration with the intention of transforming the king’s knight into a loyal member of his undead army! </span><span class="koboSpan" id="kobo.1022.4">Your hero must hurry up before it is </span><span class="No-Break"><span class="koboSpan" id="kobo.1023.1">too late!</span></span></p>
<p><span class="koboSpan" id="kobo.1024.1">You can make good use of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1025.1">US_GameMode</span></strong><span class="koboSpan" id="kobo.1026.1"> class and create a time manager that will start as soon as the first player enters the dungeon – if the players can’t free every captive from the dungeon, they’ll be royally out of luck and the game will be a total flop. </span><span class="koboSpan" id="kobo.1026.2">It looks like it’s all or nothing for </span><span class="No-Break"><span class="koboSpan" id="kobo.1027.1">this quest!</span></span></p>
<h2 id="_idParaDest-211"><a id="_idTextAnchor212"/><span class="koboSpan" id="kobo.1028.1">Tables, tables everywhere!</span></h2>
<p><span class="koboSpan" id="kobo.1029.1">As your project progresses, it will become increasingly difficult to keep track of all the variations in enemies and weapons. </span><span class="koboSpan" id="kobo.1029.2">To ease the pain, you can use the struct and data table system introduced in </span><a href="B18203_06.xhtml#_idTextAnchor125"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1030.1">Chapter 6</span></em></span></a><em class="italic"><span class="koboSpan" id="kobo.1031.1">, Replicating Properties </span></em><em class="italic"><span class="koboSpan" id="kobo.1032.1">Over</span></em><em class="italic"><span class="koboSpan" id="kobo.1033.1"> the Network,</span></em><span class="koboSpan" id="kobo.1034.1"> to create dedicated structures for the throwing weapons and </span><span class="No-Break"><span class="koboSpan" id="kobo.1035.1">AI opponents.</span></span></p>
<p><span class="koboSpan" id="kobo.1036.1">Let your creative </span><a id="_idIndexMarker611"/><span class="koboSpan" id="kobo.1037.1">side run wild and come up with a ton of amazing Blueprint options based on the stats you like best – get ready for your hero adventurers to embark on thrilling journeys full of surprises in </span><span class="No-Break"><span class="koboSpan" id="kobo.1038.1">your game!</span></span></p>
<h2 id="_idParaDest-212"><a id="_idTextAnchor213"/><span class="koboSpan" id="kobo.1039.1">Need some help?</span></h2>
<p><span class="koboSpan" id="kobo.1040.1">As you may have noticed from the previous subsections, once you become familiar with your game, the potential outcomes become limitless. </span><span class="koboSpan" id="kobo.1040.2">You can add any new gameplay logic and test it until you </span><span class="No-Break"><span class="koboSpan" id="kobo.1041.1">are happy.</span></span></p>
<p><span class="koboSpan" id="kobo.1042.1">On my end, I’ll be working on creating exciting new features for the game and storing them in my own GitHub repository. </span><span class="koboSpan" id="kobo.1042.2">Feel free to check in from time to time to see what wild and crazy ideas I’ve come up with! </span><span class="koboSpan" id="kobo.1042.3">The link to the repository </span><span class="No-Break"><span class="koboSpan" id="kobo.1043.1">is </span></span><a href="https://github.com/marcosecchi/unrealshadows-ltol"><span class="No-Break"><span class="koboSpan" id="kobo.1044.1">https://github.com/marcosecchi/unrealshadows-ltol</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.1045.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1046.1">And if you come up with a clever idea, feel free to contact me and tell me about it – if time permits, I will try to implement it and upload it to the repository in order to make this </span><span class="No-Break"><span class="koboSpan" id="kobo.1047.1">project grow!</span></span></p>
<h1 id="_idParaDest-213"><a id="_idTextAnchor214"/><span class="koboSpan" id="kobo.1048.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.1049.1">Throughout this chapter, you fine-tuned the gameplay logic and added the finishing touches. </span><span class="koboSpan" id="kobo.1049.2">You began by incorporating some nice animations for character movements and attacks, elevating the game’s </span><span class="No-Break"><span class="koboSpan" id="kobo.1050.1">overall appeal.</span></span></p>
<p><span class="koboSpan" id="kobo.1051.1">Additionally, you created someone for the players to rescue: a prisoner Actor that can be interacted with and that will grant the thief hero some well-deserved </span><span class="No-Break"><span class="koboSpan" id="kobo.1052.1">experience points.</span></span></p>
<p><span class="koboSpan" id="kobo.1053.1">Last but not least, I shared a few fresh ideas to take your gameplay to the next level. </span><span class="koboSpan" id="kobo.1053.2">By incorporating these ideas, you can make the game truly your own and one of a kind. </span><span class="koboSpan" id="kobo.1053.3">So, get creative and </span><span class="No-Break"><span class="koboSpan" id="kobo.1054.1">have fun!</span></span></p>
<p><span class="koboSpan" id="kobo.1055.1">Get ready for the next chapter, where you’ll dive into debugging and testing a networked game. </span><span class="koboSpan" id="kobo.1055.2">This will take your development skills to the next level, something that’s necessary if you want to become a top-notch </span><span class="No-Break"><span class="koboSpan" id="kobo.1056.1">multiplayer programmer!</span></span></p>
</div>
</body></html>