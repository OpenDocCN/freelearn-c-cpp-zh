<html><head></head><body>
<div><h1 class="chapter-number" id="_idParaDest-268"><a id="_idTextAnchor268"/>13</h1>
<h1 id="_idParaDest-269"><a id="_idTextAnchor269"/>Scripting the Arduino IoT Cloud with Cloud CLI</h1>
<p>The Arduino Cloud <strong class="bold">Command-Line Interface</strong> (<strong class="bold">CLI</strong>) is an automation tool that is useful for scripting<a id="_idIndexMarker1004"/> and creating devices, Things, and dashboards. It also provides the option to perform mass uploads (<strong class="bold">OTA</strong>), enabling the fleet management of deployed IoT<a id="_idIndexMarker1005"/> nodes. This chapter will explore the advanced functionalities of the tool and propose some scenarios for its usage.</p>
<p>The Arduino Cloud CLI is a cross-platform tool that lets you perform bulk management and operations via the command line, which helps you to increase your productivity, and provides the option to automate Things via command-line scripts. In this chapter, we will explore all the commands and observe their context.</p>
<p>By the end of this chapter, you will understand how to interact with the Arduino IoT Cloud platform via a CLI to create, delete, or extract templates from devices, Things, and dashboards and send OTA updates to devices via the command line. This chapter will show you how to perform all the operations via the command line to boost your productivity. The commands you will learn will help you write custom scripts for use in mass deployments and bulk management operations.</p>
<p>In this chapter, we will cover the following main topics:</p>
<ul>
<li>What is the Arduino Cloud CLI?</li>
<li>Securing access – unveiling API keys and authentication</li>
<li>Installing the Arduino Cloud CLI</li>
<li>Interacting with devices</li>
<li>Engaging with Things</li>
<li>Crafting dashboards – unleashing potential via the command line</li>
<li>OTA management</li>
<li>What’s next?</li>
</ul>
<h1 id="_idParaDest-270"><a id="_idTextAnchor270"/>Technical requirements</h1>
<p>There are no specific hardware requirements for this chapter as we will focus on the Arduino Cloud CLI and work through different command exercises to perform operations on the Arduino IoT Cloud platform using a CLI. However, before we proceed, we will need the following software to complete the different exercises in this chapter:</p>
<ul>
<li>The Arduino Cloud CLI</li>
<li>The Arduino IDE</li>
<li>An Arduino IoT Cloud account</li>
</ul>
<p>For the commands, we need the Arduino Cloud CLI and an active Arduino IoT Cloud account. This chapter only contains commands, so there is no folder for it on GitHub.</p>
<h1 id="_idParaDest-271"><a id="_idTextAnchor271"/>What is the Arduino Cloud CLI?</h1>
<p>The Arduino Cloud CLI<a id="_idIndexMarker1006"/> is a powerful tool to manage and interact with your Arduino projects on the cloud. It allows you to perform various operations, such as deploying and managing devices and generating a dashboard and Things template for bulk creations, all from the comfort of your command line.</p>
<p>The benefits of using the Arduino Cloud CLI are numerous. Firstly, it provides a convenient and efficient way to manage your projects without the need for a graphical user interface. This can be particularly useful if you prefer working with command-line tools, or if you integrate Arduino into an automated workflow.</p>
<p>The Arduino Cloud CLI serves as a command-line utility, enabling you to interact with the key functionalities of the Arduino IoT Cloud through a terminal. It provides the capability to accomplish the following tasks:</p>
<ul>
<li>Duplicate existing Things and dashboards by extracting their templates</li>
<li>Execute mass OTA uploads</li>
<li>Generate devices, Things, and dashboards directly through the CLI</li>
</ul>
<p>Here are some of the benefits of using<a id="_idIndexMarker1007"/> the Arduino Cloud CLI:</p>
<ul>
<li><strong class="bold">Automation</strong>: The Arduino Cloud CLI can be used to automate tasks that you would otherwise have to do manually. For example, you could use it to create a script that clones a Thing and then performs a mass OTA upload to all of the devices that are associated with that Thing.</li>
<li><strong class="bold">Efficient device management</strong>: The Arduino Cloud CLI can help you manage a large number of devices more efficiently. For example, you could use it to list all of the devices that are associated with a particular tag or to get the status of a particular device.</li>
<li><strong class="bold">Access to advanced features</strong>: The Arduino Cloud CLI can be used to access features of the Arduino IoT Cloud that are not available in a web interface. For example, you could use it to create a script that checks the status of a device every minute and then sends an email alert if the status changes.</li>
<li><strong class="bold">Customization</strong>: Being open source, users have the flexibility to customize the Arduino Cloud CLI to suit their specific needs and integrate it into their workflows.</li>
<li><strong class="bold">Active development and community support</strong>: The tool is actively developed, meaning it continually receives updates, new features, and bug fixes. Additionally, the presence of a large community can provide assistance and support for users.</li>
<li><strong class="bold">Time and effort savings</strong>: The Arduino Cloud CLI can save time and effort in managing IoT projects, making it a valuable resource for developers working with Arduino devices.</li>
</ul>
<p>Overall, the Arduino Cloud CLI is a powerful tool that can be used to automate tasks, manage a large number of devices, and access features of the Arduino IoT Cloud that are not available<a id="_idIndexMarker1008"/> in a web interface.</p>
<p>In this section, we have discussed what the Arduino Cloud CLI is and what the benefits of the Arduino Cloud CLI are. In the next section, we will explore how to set up API keys and how to use API keys to authenticate the Arduino Cloud CLI with the Arduino IoT Cloud.</p>
<h1 id="_idParaDest-272"><a id="_idTextAnchor272"/>Securing access – unveiling API keys and authentication</h1>
<p>Before getting<a id="_idIndexMarker1009"/> into the meat of the chapter, we first need to talk about the authentication <a id="_idIndexMarker1010"/>mechanism of the platform. The Arduino IoT Cloud uses a <strong class="bold">token authentication mechanism</strong> to validate Arduino Cloud CLI requests.</p>
<p>Before we start to install and test the Arduino Cloud CLI, we need to set up<a id="_idIndexMarker1011"/> the API keys in Arduino Cloud that will provide us with the client ID and secret. In older versions<a id="_idIndexMarker1012"/> of the interface, the API options were under the <strong class="bold">Integrations</strong> tab, but they have now moved to Arduino Cloud, which is available at <a href="https://cloud.arduino.cc/home/">https://cloud.arduino.cc/home/</a>.</p>
<p>After visiting the <strong class="bold">Integration</strong> page, click on <strong class="bold">API Keys</strong>, and then you will be taken to the API page. Click on <strong class="bold">CREATE API KEY</strong>. A popup will appear; provide a name for the API, and click on the <strong class="bold">CONTINUE</strong> button. The wizard that appears will take a few seconds to generate the keys, and then a new popup will appear displaying the keys, as shown in <em class="italic">Figure 13</em><em class="italic">.1</em>.</p>
<div><div><img alt="Figure 13.1 – The API keys" src="img/B19752_13_01.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.1 – The API keys</p>
<p>Copy the <strong class="bold">Client ID</strong> and <strong class="bold">Client Secret</strong> values by clicking<a id="_idIndexMarker1013"/> on the copy icons – never try to copy by manual<a id="_idIndexMarker1014"/> selection, as the client secret is very long, so clicking on the copy<a id="_idIndexMarker1015"/> icon is the best option. Save both the <strong class="bold">Client ID</strong> and <strong class="bold">Client Secret</strong> values in a secure location, and then click the checkbox, confirming that you have saved your keys. Lastly, click on <strong class="bold">DONE</strong>, and you will see your API key in the panel – it’s now ready for use.</p>
<p class="callout-heading">Important note</p>
<p class="callout">A single API key is used to give access to all the Things and their variables. Having access to all the infrastructure with just one API key is handy, instead of having to create separate API keys for each Thing, but you must take care of your key! This is a big security risk as, if you were to lose the key, a hacker could gain access to your whole account.</p>
<p>In this section, we created<a id="_idIndexMarker1016"/> API authentication keys, which consist of a client ID and a client secret. This section is most important, as without these keys, we can’t execute any command<a id="_idIndexMarker1017"/> via the Arduino Cloud CLI. In the following section, we will install the Arduino Cloud CLI.</p>
<h1 id="_idParaDest-273"><a id="_idTextAnchor273"/>Installing the Arduino Cloud CLI</h1>
<p>In this section, we will install<a id="_idIndexMarker1018"/> the Arduino Cloud CLI tool. The Arduino team developed the CLI tool for all three major operating systems: macOS, Windows, and Linux. You can download the Arduino Cloud CLI tool for your operating system from <a href="https://github.com/arduino/arduino-cloud-cli/releases">https://github.com/arduino/arduino-cloud-cli/releases</a>. The official Arduino Cloud CLI page can be found at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli</a>; here, you can get updated information regarding commands and their usage.</p>
<p>Always try to download the latest and most stable release of the Arduino Cloud CLI. After downloading the ZIP file according to your operating system, extract the files from it. You will find one executable file named <code>arduino-cloud-cli</code> and another called <code>LICENSE.txt</code>, and can set up Environmental variables for an <code>arduino-cloud-cli</code> executable file in your operating system, which will help you to execute <code>arduino-cloud-cli</code> in the terminal without specifying the location of the <code>arduino-cloud-cli</code> folder.</p>
<p>Just open up the terminal and enter the following command:</p>
<pre class="console">
arduino-cloud-cli</pre> <p>Then, you will see the following output on your terminal (<em class="italic">Figure 13</em><em class="italic">.2</em>).</p>
<div><div><img alt="Figure 13.2 – The Arduino Cloud CLI terminal" src="img/B19752_13_02.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.2 – The Arduino Cloud CLI terminal</p>
<p>This simply shows you how to use the Arduino Cloud CLI<a id="_idIndexMarker1019"/> with different parameters, as we didn’t specify any parameters during the command execution.</p>
<p>Now, it’s time to initiate the Arduino Cloud CLI authentication with Arduino Cloud, using the API keys that we generated in the previous section. Type the following command into the terminal:</p>
<pre class="console">
arduino-cloud-cli credentials init</pre> <p>After executing the preceding command, you will be asked for your client ID and client secret, respectively. Finally, you will be asked for your organization ID, which is not mandatory, and you can leave this empty, as shown in <em class="italic">Figure 13</em><em class="italic">.3</em>.</p>
<div><div><img alt="Figure 13.3 – The Arduino Cloud CLI authentication process with Arduino Cloud" src="img/B19752_13_03.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.3 – The Arduino Cloud CLI authentication process with Arduino Cloud</p>
<p>After successful authentication, you will see a success message on the terminal, as shown in <em class="italic">Figure 13</em><em class="italic">.3</em>. Congratulations! You are now ready to execute the commands on the terminal and able to perform operations on the Arduino IoT Cloud via commands.</p>
<p>In this section, we downloaded the <code>arduino-cloud-cli</code> file and installed it on our operating system, and we also initialized the authentication<a id="_idIndexMarker1020"/> process for the <code>arduino-cloud-cli</code> tool with the Arduino IoT Cloud. In the next section, we will start playing with devices using the command line.</p>
<h1 id="_idParaDest-274"><a id="_idTextAnchor274"/>Interacting with devices</h1>
<p>In this section, we will get hands-on<a id="_idIndexMarker1021"/> and practical with devices. We will perform create, list, delete, tag, and untag operations on a device, as well as list all the devices and show all the parameters of specific devices. Open up the command terminal, and then we’ll execute the commands in the following sections.</p>
<h2 id="_idParaDest-275"><a id="_idTextAnchor275"/>Creating a device</h2>
<p>Firstly, we will start<a id="_idIndexMarker1022"/> by creating a device. The documentation on device creation can be found at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#device">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#device</a>. Before you execute the command, connect your development board to your computer and find out the port number and FQBN for your device from the documentation page. The following is the syntax of the <code>device </code><code>create</code> command:</p>
<pre class="console">
arduino-cloud-cli device create --name &lt;deviceName&gt; --port &lt;port&gt; --fqbn &lt;deviceFqbn&gt;</pre> <p>I attached the MKR Wi-Fi 1010 to my computer, which is available on port <code>/dev/cu.usbmodem101</code>, and its FQBN is <code>arduino:samd:mkrwifi1010</code>. Therefore, the following will be my command:</p>
<pre class="console">
arduino-cloud-cli device create -n ArduinoDevBoardByCLI  -p /dev/cu.usbmodem101 -b arduino:samd:mkrwifi1010</pre> <p>After executing the preceding command, you will get the following output, which shows the device has been successfully created (<em class="italic">Figure 13</em><em class="italic">.4</em>).</p>
<div><div><img alt="Figure 13.4 – Device creation using arduino-cloud-cli" src="img/B19752_13_04.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.4 – Device creation using arduino-cloud-cli</p>
<p>After creating the device, the terminal will show the device name, ID, board, serial number, and FQBN. Just imagine how easy it would be to attach dozens of development boards to the Arduino IoT Cloud using <a id="_idIndexMarker1023"/>the command line, compared to a graphical user interface. The Arduino Cloud CLI is also able to create <strong class="bold">LoRaWAN</strong> devices as well as ESP32/ESP8266 devices via the CLI.</p>
<p>In this subsection, we created a device in the Arduino IoT Cloud using the command line. In the following subsection, we will explore how to list the device.</p>
<h2 id="_idParaDest-276"><a id="_idTextAnchor276"/>Listing devices</h2>
<p>In this section, we will<a id="_idIndexMarker1024"/> list all the devices. <em class="italic">Listing</em> devices means displaying all the devices with their properties. The documentation on listing devices is available at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#list-devices">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#list-devices</a>. The following is a very simple command to list all the devices:</p>
<pre class="console">
arduino-cloud-cli device list</pre> <p>After executing the preceding command, we will see a complete list of devices, as shown in the following figure.</p>
<div><div><img alt="Figure 13.5 – The device list command" src="img/B19752_13_05.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.5 – The device list command</p>
<p>In the output, we can see the device name, ID, board, FQBN, serial number, and tags. Here, the ID is very important, as it will be used in the following commands for device deletion, as well as for tag creation and deletion. In this subsection, we have seen how to list the devices, and in the next subsection, we will explore how to delete a device using its ID.</p>
<h2 id="_idParaDest-277"><a id="_idTextAnchor277"/>Deleting a device</h2>
<p>In this section, we will explore<a id="_idIndexMarker1025"/> how we can delete a device using the device ID. The documentation for deleting devices is available at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#delete-a-device">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#delete-a-device</a>. The following is the command syntax for device deletion:</p>
<pre class="console">
arduino-cloud-cli device delete --id &lt;deviceID&gt;</pre> <p>According to the preceding command syntax, we need a device ID for deletion. You can retrieve the device ID by using the <code>device </code><code>list</code> command:</p>
<pre class="console">
arduino-cloud-cli device delete -i ca711f68-6de9-497a-ac45-780219ad2bb8</pre> <p>After successfully deleting the device, you will not see any error message; otherwise, you will see a <code>401 error</code> on the screen.</p>
<div><div><img alt="Figure 13.6 – The device delete command" src="img/B19752_13_06.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.6 – The device delete command</p>
<p><em class="italic">Figure 13</em><em class="italic">.6</em> shows the completed command for device deletion, and there is no error on the screen, which means the device has been deleted <a id="_idIndexMarker1026"/>successfully. In this subsection, we discussed the <code>delete</code> command. In the upcoming subsection, we will tag and untag a device.</p>
<h2 id="_idParaDest-278"><a id="_idTextAnchor278"/>Tagging and untagging a device</h2>
<p>In this section, we will explore<a id="_idIndexMarker1027"/> how we can tag and untag a device<a id="_idIndexMarker1028"/> using the device ID. The documentation for tagging a device is available at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#tag-device">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#tag-device</a>, and the documentation for untagging a device is available at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#untag-device">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#untag-device</a>. The following is the command syntax to tag a device:</p>
<pre class="console">
arduino-cloud-cli device create-tags --id &lt;deviceID&gt; --tags &lt;key0&gt;=&lt;value0&gt;,&lt;key1&gt;=&lt;value1&gt;</pre> <p>The following is the command syntax to untag a device:</p>
<pre class="console">
arduino-cloud-cli device delete-tags --id &lt;deviceID&gt; --keys &lt;key0&gt;,&lt;key1&gt;</pre> <p>You might ask the question, why do we need a tag for a device? Let’s say you have a generic product for warehouse monitoring, and you have deployed this product in different organizations and different rooms. Now, the issue is that it’s very difficult to assign the organization name and location in the <strong class="bold">Device Name</strong> field. So, an optimal solution is tagging. You can use tags as many times as you want. A tag has two options – one is a key and the other is a value.</p>
<p>In the following example, we will attach two tags – one for the organization name and another for the location. Pick a device ID by using the <code>device list</code> command to attach the tags. The following is the command to attach tags to a device:</p>
<pre class="console">
arduino-cloud-cli device create-tags -i cda148e4-b011-459a-95fd-a7510c9601c2  --tags Org=ASNAGroup,Location=Warehouse1</pre> <p>According to the following command syntax, we need a device ID to remove the tag from the device. You can fetch the device ID by using the <code>device list</code> command. The following command is used to remove the tag from the device:</p>
<pre class="console">
arduino-cloud-cli device delete-tags -i cda148e4-b011-459a-95fd-a7510c9601c2 -k Location</pre> <p>Here, the command is a little different, as we have used <code>delete-tags</code> and <code>-k</code> to specify the tag key. If you want to remove multiple tags, then use a comma to separate the keys.</p>
<p>In this and the preceding subsections, we performed<a id="_idIndexMarker1029"/> various operations on devices<a id="_idIndexMarker1030"/> using commands, including ones for device creation, listing devices, device deletion, tagging, and untagging. In the next section, we will explore how to practically perform operations on Things.</p>
<p>Engaging with Things</p>
<p>A Thing is one of the most important<a id="_idIndexMarker1031"/> elements in the Arduino IoT Cloud, which acts as a separate container holding all of its ingredients, such as cloud variables, the device, a sketch for the device, and the device’s network configuration. In this section, we will try a range of different operations via commands, such as extracting a template from a Thing, creating a Thing from a template, making a clone of a Thing, and deleting a Thing.</p>
<h2 id="_idParaDest-279"><a id="_idTextAnchor279"/>Extracting a template from a Thing</h2>
<p>In the Arduino Cloud CLI, we deal<a id="_idIndexMarker1032"/> with commands and <a id="_idIndexMarker1033"/>provide different parameters to perform different types of operations. Therefore, it is difficult to create a new Thing via the command line, as it will make it more complex to pass different parameters, such as cloud variables and network configurations.</p>
<p>To solve this issue, the Arduino team introduced the concept of template extraction from a Thing. For example, say you want to deploy hundreds of environmental monitoring nodes. It’s difficult to create hundreds of Things via the Arduino graphical user interface and to create a long command for Thing creation that includes all the information regarding the Thing. Therefore, Arduino introduced the template extraction technique. Firstly, we will create a Thing via the Arduino graphical user interface, and then we will extract its template via the command line. Then, using the template, we will create the Thing in the Arduino IoT Cloud via the command line, as the Arduino Cloud CLI does not allow you to create a Thing from scratch. You can find out more about Thing template extraction in the official documentation at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#extract-thing-template">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#extract-thing-template</a>.</p>
<p>The following is the command<a id="_idIndexMarker1034"/> syntax for template <a id="_idIndexMarker1035"/>extraction. With this command, we need to provide a Thing ID, with which the command will fetch the template of the Thing. Then, we need to provide the format for the template file – either JSON or YAML:</p>
<pre class="console">
arduino-cloud-cli thing extract --id &lt;thingID&gt; --format &lt;json|yaml&gt;</pre> <p>For the Thing ID, either visit the Arduino IoT Cloud to find it or refer to the upcoming subsections, in which we will show you how to list Things, which provides the Thing name, ID, and so on, so you can also retrieve the Thing ID from the output. Now, we will assign the format; we want the template output in JSON format, so I used JSON here:</p>
<pre class="console">
arduino-cloud-cli thing  extract -i 91c90962-56b6-4094-abe0-1b5ad4828721 --format json</pre> <p>After executing the command, we will get the template output on the screen in JSON format, as shown in <em class="italic">Figure 13</em><em class="italic">.7</em>.</p>
<div><div><img alt="Figure 13.7 – Extracting the Thing template" src="img/B19752_13_07.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.7 – Extracting the Thing template</p>
<p>Our Thing template shows <a id="_idIndexMarker1036"/>all the information regarding<a id="_idIndexMarker1037"/> cloud variables. Copy the text and save it in a file, which will be used in the following section for Thing creation.</p>
<h2 id="_idParaDest-280"><a id="_idTextAnchor280"/>Creating a Thing</h2>
<p>After extracting the Thing<a id="_idIndexMarker1038"/> template, we will now start to create the Thing. The documentation on Thing creation can be found at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#create-things">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#create-things</a>. The following is the syntax of the Thing creation command, which takes two parameters. Firstly, it will take the name, and secondly, it will take the template filename for the Thing creation, which contains the Thing template in JSON format that we saved in the previous section:</p>
<pre class="console">
arduino-cloud-cli thing create --name &lt;thingName&gt; --template &lt;template.(json|yaml)&gt;</pre> <p>Here, I have provided a Thing name, <code>EnvSense101</code>, and in the previous section, I saved the JSON template in the file named <code>EnvSenseTemplate.json</code>. Then, we provide the name with the <code>-n</code> parameter and the template file with the <code>-</code><code>t</code> parameter:</p>
<pre class="console">
arduino-cloud-cli thing create -n EnvSense101 -t EnvSenseTemplate.json</pre> <p>After executing the preceding command, you will get the following output for successful Thing creation (<em class="italic">Figure 13</em><em class="italic">.8</em>).</p>
<div><div><img alt="Figure 13.8 – Thing creation using arduino-cloud-cli" src="img/B19752_13_08.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.8 – Thing creation using arduino-cloud-cli</p>
<p>After creating the Thing, the terminal will show the Thing name, ID, device ID (which is empty right now, but in the upcoming sections, we will associate the device with this Thing), and variable name.</p>
<p>In this subsection, we created<a id="_idIndexMarker1039"/> a Thing in the Arduino IoT Cloud using the command line. In the following section, we will explore how to clone the Thing for bulk creations.</p>
<h2 id="_idParaDest-281"><a id="_idTextAnchor281"/>Cloning a Thing</h2>
<p>After creating a Thing <a id="_idIndexMarker1040"/>from a template, we will now explore how we can use the clone operation for large-scale deployments. The documentation on the Thing clone can be found at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#clone-things">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#clone-things</a>. The following is the syntax of the <code>thing clone</code> command, which will take two parameters. Firstly, it will take a name, and secondly, it will take a Thing ID:</p>
<pre class="console">
arduino-cloud-cli thing clone --name &lt;thingName&gt; --clone-id &lt;thingToCloneID&gt;</pre> <p>Here, I have provided a Thing name, <code>EnvSense102</code>, and in the previous section, we created the Thing, so I can get its ID from the terminal, as shown in <em class="italic">Figure 13</em><em class="italic">.8</em> (use your own Thing ID in the command line). Then, provide the name with an <code>-n</code> parameter and the Thing ID with a <code>-</code><code>c</code> parameter:</p>
<pre class="console">
arduino-cloud-cli thing clone -n EnvSense102 -c 131f2498-2067-468c-bd68-2f52a0233de5</pre> <p>After executing the preceding command, you will get the following output for a successful Thing clone (<em class="italic">Figure 13</em><em class="italic">.9</em>).</p>
<div><div><img alt="Figure 13.9 – A Thing clone using arduino-cloud-cli" src="img/B19752_13_09.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.9 – A Thing clone using arduino-cloud-cli</p>
<p>This is the output of a successful Thing clone by the Arduino Cloud CLI. After cloning the Thing, the terminal will show the Thing name, ID, device ID (which is empty right now, but in the upcoming section, we will associate the device with this Thing), and variable name. You can see how easy it is to create hundreds of Things with just the <code>clone</code> command. Here, you can just create a batch script, which will only change the name of the Thing by using the <code>for</code> loop and create hundreds of Things in just a few minutes.</p>
<p>In this subsection, we learned<a id="_idIndexMarker1041"/> how to clone a Thing in the Arduino IoT Cloud using the command line. In the following section, we will explore how to list Things.</p>
<h2 id="_idParaDest-282"><a id="_idTextAnchor282"/>Listing Things</h2>
<p>In this section, we will list<a id="_idIndexMarker1042"/> all the Things. The documentation on listing Things is available at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#list-things">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#list-things</a>. The following is a very simple command to list all the Things:</p>
<pre class="console">
arduino-cloud-cli thing list</pre> <p>After executing the preceding command, we will see a complete list of Things, as shown in the following figure.</p>
<div><div><img alt="Figure 13.10 – The thing list command" src="img/B19752_13_10.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.10 – The thing list command</p>
<p>In the output, we can see the Thing name, ID, device, and tags. Again, the ID is very important, as it will be used in the following commands for Thing deletion, as well as for tag creation and deletion. In the preceding sections, we also used the ID for Thing template extraction and creation, as well as Thing cloning.</p>
<p>The Arduino Cloud CLI also provides different<a id="_idIndexMarker1043"/> parameters to get more detailed output on the terminal, such as a variable list along with a list of Things. We can attach the <code>-s</code> parameter to the Thing, and we can also list a Thing by providing a device ID as well as list a series of Things by providing a Thing ID. Here, I want to explore how we can get a variable list along with Things. The following is a simple command to list cloud variables:</p>
<pre class="console">
arduino-cloud-cli thing list -s</pre> <p>After executing the preceding command, you will see the output shown in <em class="italic">Figure 13</em><em class="italic">.11</em>.</p>
<div><div><img alt="Figure 13.11 – The thing list command with variables" src="img/B19752_13_11.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.11 – The thing list command with variables</p>
<p>Here, you can see all the cloud variables<a id="_idIndexMarker1044"/> along with the Thing names, but it looks a little bit complicated. Now, we will try to list a single Thing with cloud variables. The following is the command syntax to list a Thing with cloud variables. It will take two parameters as input – one Thing ID and an <code>-</code><code>s</code> parameter:</p>
<pre class="console">
arduino-cloud-cli thing list -i eee6e2ff-7e88-4240-9671-1b79736618ea -s</pre> <p>Execute the preceding command, and you will see the complete and readable output shown in <em class="italic">Figure 13</em><em class="italic">.12</em>.</p>
<div><div><img alt="Figure 13.12 – Displaying a single Thing with cloud variables" src="img/B19752_13_12.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.12 – Displaying a single Thing with cloud variables</p>
<p>Now, it’s time to explore how we can find a Thing by using a device ID. The following is a simple command to retrieve a Thing based on a device ID:</p>
<pre class="console">
arduino-cloud-cli thing list -d ef63111f-72bb-4826-84bb-02093d4d85f1 -s</pre> <p>After executing the preceding command, we will get specific Thing data using the device ID, as well as its cloud variables, as we used the <code>-s</code> parameter in the command (as shown in <em class="italic">Figure 13</em><em class="italic">.13</em>).</p>
<div><div><img alt="Figure 13.13 – Displaying a single Thing based on a device ID, with cloud variables" src="img/B19752_13_13.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.13 – Displaying a single Thing based on a device ID, with cloud variables</p>
<p>In this subsection, we explored<a id="_idIndexMarker1045"/> how to list Things by using different parameters. In the next subsection, we will explore how to delete a Thing.</p>
<h2 id="_idParaDest-283"><a id="_idTextAnchor283"/>Deleting a Thing</h2>
<p>In this section, we will explore<a id="_idIndexMarker1046"/> how to delete a Thing using a Thing ID. The documentation for deleting a Thing is available at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#delete-things">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#delete-things</a>. The following is the command syntax for Thing deletion:</p>
<pre class="console">
arduino-cloud-cli device delete --id &lt;deviceID&gt;</pre> <p>According to the command syntax, we need a Thing ID for deletion. You can fetch the Thing ID by using the <code>thing </code><code>list</code> command:</p>
<pre class="console">
arduino-cloud-cli thing delete -i eee6e2ff-7e88-4240-9671-1b79736618ea</pre> <p>After the successful deletion of the device, you will not see an error message; otherwise, you will get a <code>401 error</code> message on the screen.</p>
<div><div><img alt="Figure 13.14 – The Thing delet﻿e command" src="img/B19752_13_14.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.14 – The Thing delete command</p>
<p><em class="italic">Figure 13</em><em class="italic">.14</em> shows the complete command for Thing deletion, and there is no error on the screen, which means the Thing has been deleted successfully. In this subsection, we discussed the <code>delete</code> command, and in the upcoming<a id="_idIndexMarker1047"/> subsection, we will explore how to associate the device with a Thing.</p>
<h2 id="_idParaDest-284"><a id="_idTextAnchor284"/>Associating a device with a Thing</h2>
<p>In the previous Thing subsections, we extracted<a id="_idIndexMarker1048"/> the Thing template, created the Thing from that template, and also performed Thing cloning operations. However, throughout all the processes, we didn’t associate a device with a Thing, and without a device, a Thing is just an empty JAR that is not capable of performing any operation.</p>
<p>In this subsection, we will explore how to attach the device with a Thing by using a device ID and a Thing ID. The documentation for associating a device with a Thing is available at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#bind-thing-to-device">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#bind-thing-to-device</a>. The following is the simple command syntax to bind a device with a Thing in the Arduino IoT Cloud:</p>
<pre class="console">
arduino-cloud-cli thing bind --id &lt;thingID&gt; --device-id &lt;deviceID&gt;</pre> <p>Here, you can get a specific device ID by using the <code>arduino-cloud-cli device list</code> command and a Thing ID with <code>arduino-cloud-cli </code><code>thing list</code>:</p>
<pre class="console">
arduino-cloud-cli thing bind -i 131f2498-2067-468c-bd68-2f52a0233de5 -d cda148e4-b011-459a-95fd-a7510c9601c2</pre> <p>In the preceding command, we have assigned a Thing ID by using <code>-i</code> and a device ID with the <code>-d</code> parameter. Execute the preceding command, and you will see the output shown in <em class="italic">Figure 13</em><em class="italic">.15</em>.</p>
<div><div><img alt="Figure 13.15 – Device binding with Thing" src="img/B19752_13_15.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.15 – Device binding with Thing</p>
<p><em class="italic">Figure 13</em><em class="italic">.15</em> shows a device successfully binding with a Thing. To confirm, we used the <code>thing list</code> command with the <code>-i</code> parameter to verify the device ID. In both the command as well as in the <code>thing list</code> output, the device ID is the same.</p>
<p>In this subsection, we explored<a id="_idIndexMarker1049"/> how to bind/associate a device with a Thing. In the next subsection, we will discuss how to assign and remove tags from a Thing.</p>
<h2 id="_idParaDest-285"><a id="_idTextAnchor285"/>Tagging and untagging a Thing</h2>
<p>In this section, we will explore<a id="_idIndexMarker1050"/> how we can tag and untag a Thing using<a id="_idIndexMarker1051"/> the Thing ID. The documentation for tagging a Thing is available at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#tag-a-thing">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#tag-a-thing</a>, and for untagging a Thing, documentation is available at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#untag-a-thing">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#untag-a-thing</a>. The following is the command syntax to tag a Thing:</p>
<pre class="console">
arduino-cloud-cli thing create-tags --id &lt;thingID&gt; --tags &lt;key0&gt;=&lt;value0&gt;,&lt;key1&gt;=&lt;value1&gt;</pre> <p>The following is the command syntax to untag a Thing:</p>
<pre class="console">
arduino-cloud-cli thing delete-tags --id &lt;thingID&gt; --keys &lt;key0&gt;,&lt;key1&gt;</pre> <p>You might question the necessity of assigning a tag to a Thing. Consider this scenario. You have a versatile product designed for monitoring warehouses, and you’ve deployed this product in various organizations and different rooms within those organizations. The challenge arises when attempting to incorporate the organization’s name and location directly into the <strong class="bold">Device Name</strong> field, which can be quite cumbersome. In this context, a more efficient solution presents itself through the use of tags. Tags can be applied without limitations, much like when we previously established tags for devices. Each tag consists of two components: a key and a corresponding value.</p>
<p>So, in the following example, we will attach two tags – one for the organization name and another for the location. Pick the Thing ID by using the <code>thing list</code> command to attach tags. The following is the command to attach tags to a Thing:</p>
<pre class="console">
arduino-cloud-cli thing create-tags -i 131f2498-2067-468c-bd68-2f52a0233de5 --tags Org=ASNAGroup,Location=MainUnit</pre> <p>After executing the preceding command, you can verify the tags by using the <code>thing list</code> command, as shown in <em class="italic">Figure 13</em><em class="italic">.16</em>.</p>
<div><div><img alt="Figure 13.16 – Assigning tags to a Thing" src="img/B19752_13_16.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.16 – Assigning tags to a Thing</p>
<p><em class="italic">Figure 13</em><em class="italic">.16</em> shows the full command that is used to assign tags to a Thing, and it also clearly shows the <code>thing list</code> command we used to verify the tags.</p>
<p>Now, it’s time to explore<a id="_idIndexMarker1052"/> how we can remove a tag from a Thing. Previously, we saw<a id="_idIndexMarker1053"/> the syntax to untag a tag from a Thing. The following is the complete command that will remove the location tag from a specific Thing:</p>
<pre class="console">
arduino-cloud-cli thing delete-tags -i 131f2498-2067-468c-bd68-2f52a0233de5 -k Location</pre> <p>After executing the preceding command, you can verify the tags by using the <code>thing list</code> command, as shown in <em class="italic">Figure 13</em><em class="italic">.17</em>.</p>
<div><div><img alt="Figure 13.17 – Deleting a tag from a Thing" src="img/B19752_13_17.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.17 – Deleting a tag from a Thing</p>
<p><em class="italic">Figure 13</em><em class="italic">.17</em> shows the full command that is used to delete a tag from a Thing, and it also clearly shows the <code>thing list</code> command we used to verify the tags.</p>
<p>Here, the command is a little different, as we have used <code>delete-tags</code> and <code>-k</code> to specify the tag key. If you want<a id="_idIndexMarker1054"/> to remove multiple tags, then use a comma<a id="_idIndexMarker1055"/> to separate the keys. In the following section, we will explore how to work with dashboards using the Arduino Cloud CLI.</p>
<h1 id="_idParaDest-286"><a id="_idTextAnchor286"/>Crafting dashboards – unleashing potential via the command line</h1>
<p>Dashboards are the most important<a id="_idIndexMarker1056"/> ingredient in the Arduino IoT Cloud pertaining to <strong class="bold">data visualization</strong>. In the Arduino Cloud CLI, we have dashboard-specific commands<a id="_idIndexMarker1057"/> to perform operations on dashboards, such as extracting a template from an existing dashboard, viewing a list of dashboards, deleting the dashboard, and creating a dashboard from an extracted template. Firstly, we will start with dashboard template extraction.</p>
<h2 id="_idParaDest-287"><a id="_idTextAnchor287"/>Extracting a template from a dashboard</h2>
<p>In the Arduino Cloud CLI, we deal with commands<a id="_idIndexMarker1058"/> and provide different<a id="_idIndexMarker1059"/> parameters to perform various operations. Therefore, it is difficult to create a new dashboard via the command line, as it will make it more complex to guide the Arduino IoT Cloud about widgets and attach these widgets with cloud variables via commands.</p>
<p>To solve this issue, the Arduino team introduced the concept of template extraction from a dashboard. For example, if you want to deploy hundreds of environmental monitoring nodes, it’s difficult to create hundreds of dashboards via the Arduino graphical user interface. It’s also difficult to create long commands for dashboard creation, which includes all the information regarding the dashboard. So, Arduino introduced the template extraction technique. Firstly, we will create the dashboard via the Arduino graphical user interface, and then we will extract its template via the command line. Then, using a template, we will create dashboards in the Arduino IoT Cloud via the command line, as the Arduino Cloud CLI does not allow you to create a dashboard from scratch. The official documentation for dashboard template extraction is available at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#extract-dashboard-template">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#extract-dashboard-template</a>.</p>
<p>The following shows the command syntax for template extraction. With this command, we need to provide a dashboard ID with which the command will fetch the template of the dashboard. Then, we need to provide the format for the template file – either JSON or YAML:</p>
<pre class="console">
arduino-cloud-cli dashboard extract --id &lt;dashboardID&gt; --format &lt;json|yaml&gt;</pre> <p>For the dashboard ID, either visit the Arduino IoT<a id="_idIndexMarker1060"/> Cloud to find it or refer to the upcoming subsections, in which we will<a id="_idIndexMarker1061"/> show you how to list dashboards, which will provide their name, ID, and so on. Now, we will assign the format; we want the template output in JSON format, so I used JSON here:</p>
<pre class="console">
arduino-cloud-cli dashboard  extract -i f00aaaab-7faa-4ba6-bdd7-814377f296ba --format json</pre> <p>After executing the command, we will get the template output on the screen in JSON format, as shown in <em class="italic">Figure 13</em><em class="italic">.18</em>.</p>
<div><div><img alt="Figure 13.18 – Extracting a dashboard template" src="img/B19752_13_18.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.18 – Extracting a dashboard template</p>
<p><em class="italic">Figure 13</em><em class="italic">.18</em> shows partial output on the screen. We have our dashboard template in JSON format, which shows all the information regarding widgets and their configuration, including <code>thing_id</code> and <code>variable_id</code>. Copy the JSON format output and save it in a file, which will be used in the following section for dashboard creation.</p>
<p class="callout-heading">Important note</p>
<p class="callout">There is a bug in the Arduino Cloud CLI for dashboard extraction, as it shows the Thing name instead of the Thing ID in the <code>thing_id</code> value. Therefore, you need to replace the text with the Thing ID; otherwise, an error will occur during the execution of the dashboard creation command.</p>
<p>In this subsection, we explored<a id="_idIndexMarker1062"/> how to extract a template<a id="_idIndexMarker1063"/> from an existing dashboard. In the following subsection, we will explore how to list dashboards.</p>
<h2 id="_idParaDest-288"><a id="_idTextAnchor288"/>Listing dashboards</h2>
<p>In this section, we will list<a id="_idIndexMarker1064"/> all the dashboards. The documentation on listing dashboards is available at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#list-dashboards">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#list-dashboards</a>. The following is a very simple command to list all the dashboards:</p>
<pre class="console">
arduino-cloud-cli dashboard list</pre> <p>After executing the preceding command, we will see a complete list of dashboards, as shown in the following figure.</p>
<div><div><img alt="Figure 13.19 – The dashboard list command" src="img/B19752_13_19.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.19 – The dashboard list command</p>
<p>In the output shown in <em class="italic">Figure 13</em><em class="italic">.19</em>, we can see the dashboard <strong class="bold">Name</strong>, <strong class="bold">ID</strong>, and <strong class="bold">UpdatedAt</strong> details. Here, <strong class="bold">ID</strong> is very important, as it will be used in the following commands for dashboard deletion. It also helps you in dashboard template extraction, as we used the dashboard ID in the preceding subsection to extract the template.</p>
<p>In this subsection, we explored how<a id="_idIndexMarker1065"/> to list dashboards by using a very simple command. In the next subsection, we will explore how to delete a dashboard using the dashboard ID.</p>
<h2 id="_idParaDest-289"><a id="_idTextAnchor289"/>Deleting a dashboard</h2>
<p>In this subsection, we will explore<a id="_idIndexMarker1066"/> how to delete a dashboard using the dashboard ID. The documentation for deleting dashboards is available at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#delete-dashboards">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#delete-dashboards</a>. The following is the command syntax for dashboard deletion:</p>
<pre class="console">
arduino-cloud-cli dashboard delete --id &lt;dashboardID&gt;</pre> <p>According to the preceding command syntax, we need to provide a dashboard ID for deletion. You can fetch the dashboard ID by using the <code>dashboard </code><code>list</code> command:</p>
<pre class="console">
arduino-cloud-cli dashboard delete -i 5e658ff8-2519-4d00-b556-41bad8b15571</pre> <p>After the successful deletion of the device, you will not see an error message; otherwise, you will get a <code>401 error</code> message on the screen.</p>
<div><div><img alt="Figure 13.20 – The dashboard delete command" src="img/B19752_13_20.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.20 – The dashboard delete command</p>
<p><em class="italic">Figure 13</em><em class="italic">.20</em> shows the complete command for dashboard deletion, and there is no error on the screen, which means the dashboard has been deleted successfully. In this subsection, we discussed the <code>delete</code> command. In the upcoming subsection, we will explore how to create a dashboard<a id="_idIndexMarker1067"/> using a template, which we extracted in the first subsection of this section.</p>
<h2 id="_idParaDest-290"><a id="_idTextAnchor290"/>Creating a dashboard</h2>
<p>After extracting<a id="_idIndexMarker1068"/> a dashboard template, we can start to create a dashboard. The documentation on dashboard creation can be found at <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#create-dashboard">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#create-dashboard</a>. The following is the syntax of the dashboard creation command, which takes two parameters. Firstly, it takes the name of the dashboard, and secondly, it takes the template filename for dashboard creation, which contains the dashboard template in JSON format that we saved in the previous section:</p>
<pre class="console">
arduino-cloud-cli dashboard create --name &lt;dashboardName&gt; --template &lt;template.(json|yaml)&gt; --override &lt;thing-0&gt;=&lt;actualThingID&gt;,&lt;thing-1&gt;=&lt;otherActualThingID&gt;</pre> <p>Here, I have provided the Thing name, <code>EnvSense101</code>, and in the previous section, I saved the JSON template in a file named <code>EnvSenseTemplate.json</code>. Then, we provide the name with the <code>-n</code> parameter and the template file with the <code>-</code><code>t</code> parameter:</p>
<pre class="console">
arduino-cloud-cli dashboard create -n EnvSensedashboard101 -t EnvSensedashboard.json</pre> <p>After executing the preceding command, you will get the following output for successful dashboard creation (<em class="italic">Figure 13</em><em class="italic">.21</em>):</p>
<div><div><img alt="Figure 13.21 – Dashboard creation using arduino-cloud-cli" src="img/B19752_13_21.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.21 – Dashboard creation using arduino-cloud-cli</p>
<p><em class="italic">Figure 13</em><em class="italic">.21</em> shows the command and the output of successful dashboard creation by the Arduino Cloud CLI. After creating the dashboard, the terminal shows the dashboard <strong class="bold">name</strong>, <strong class="bold">id</strong>, <strong class="bold">updated_at</strong>, and <strong class="bold">widgets</strong> details.</p>
<p class="callout-heading">Important note</p>
<p class="callout">There is a bug in the Arduino Cloud CLI for dashboard extraction, as it shows the Thing name instead of the Thing ID in the <code>thing_id</code> value. Therefore, you need to replace the text with the Thing ID; otherwise, an error will occur during the execution of the dashboard creation command.</p>
<p>In this subsection, we created<a id="_idIndexMarker1069"/> a dashboard in the Arduino IoT Cloud using the command line. In the following section, we will explore how OTA updates work via a CLI.</p>
<h1 id="_idParaDest-291"><a id="_idTextAnchor291"/>OTA management</h1>
<p>In <a href="B19752_11.xhtml#_idTextAnchor229"><em class="italic">Chapter 11</em></a>, we explored what OTA<a id="_idIndexMarker1070"/> is and how we can easily use this feature to send updates to remote devices. In that chapter, we used a graphical user interface, which is a good option for a single device. However, when we have bulk Things to send OTA, then the situation becomes complex, as we need to go through different things one at a time to send OTA updates, which is very time consuming and a difficult operation at the enterprise level.</p>
<p>That’s why the Arduino team created commands for the Arduino Cloud CLI to send OTA updates to single or multiple devices automatically, to minimize the complexity and operation time. So, firstly, we will explore how to export the compiled binary by using the Arduino IDE, and then<a id="_idIndexMarker1071"/> we will send an OTA update to a device using its ID. For official documentation and updates, visit <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#ota-over-the-air">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#ota-over-the-air</a>.</p>
<h2 id="_idParaDest-292"><a id="_idTextAnchor292"/>Exporting a binary using the Arduino IDE</h2>
<p>In this section, we will use<a id="_idIndexMarker1072"/> the Arduino IDE to generate the complied binaries<a id="_idIndexMarker1073"/> of our program for a device OTA. Firstly, download your Thing code from the Arduino IoT Cloud. Then, extract your downloaded code and open it up in the Arduino IDE. Select the development board in the Arduino IDE, and then click on <strong class="bold">Sketch</strong> | <strong class="bold">Export Compiled Binary</strong>, as shown in <em class="italic">Figure 13</em><em class="italic">.22</em>.</p>
<div><div><img alt="Figure 13.22 – Export Compiled Binary in the Arduino IDE" src="img/B19752_13_22.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.22 – Export Compiled Binary in the Arduino IDE</p>
<p>Clicking on <code>build</code> directory under your <code>sketch</code> directory, where you will find lots of files generated by the Arduino compiler. You need to select the file that ends with the <code>ino.bin</code> extension, as shown in <em class="italic">Figure 13</em><em class="italic">.23</em>.</p>
<div><div><img alt="Figure 13.23 – The sketch build files" src="img/B19752_13_23.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.23 – The sketch build files</p>
<p>In this section, we<a id="_idIndexMarker1074"/> explored how<a id="_idIndexMarker1075"/> to generate the build files of a sketch using the Arduino IDE. In the next subsection, we will send this build file to a device OTA via the command line.</p>
<h2 id="_idParaDest-293"><a id="_idTextAnchor293"/>Uploading a sketch to a device</h2>
<p>The Arduino Cloud CLI provides<a id="_idIndexMarker1076"/> a single upload option as well as a mass deployment option. This is the official documentation link: <a href="https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#upload">https://docs.arduino.cc/arduino-cloud/getting-started/arduino-cloud-cli#upload</a>. You can visit the page for the latest updates and news. Firstly, we will explore how to send an update to a single device. The following is a simple command syntax for a single-device OTA operation:</p>
<pre class="console">
arduino-cloud-cli ota upload --device-id &lt;deviceID&gt; --file &lt;sketch-file.ino.bin&gt;</pre> <p>Here, we need to specify the device ID and the filename, including its path, which is done with the following command:</p>
<pre class="console">
arduino-cloud-cli ota upload -d cda148e4-b011-459a-95fd-a7510c9601c2  --file EnvSense101_sep15a.ino.bin</pre> <p>After the successful execution of the command, you will see an empty terminal without any errors, as shown in <em class="italic">Figure 13</em><em class="italic">.24</em>. However, if the device is unavailable or any other issue arises, then the details will be printed on the terminal.</p>
<div><div><img alt="Figure 13.24 – A successful command execution of the OTA upload" src="img/B19752_13_24.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.24 – A successful command execution of the OTA upload</p>
<p><em class="italic">Figure 13</em><em class="italic">.24</em> shows that our upload<a id="_idIndexMarker1077"/> has been completed successfully without any errors. It will take some time on the terminal to upload the file, depending on your internet speed as well as your sketch size, but you need to wait till the final output. Never interrupt the upload procedure.</p>
<p>Then, we have the mass deployment option in OTA, where you can upload firmware to multiple devices by using FQBN, as well as tags. The following is a simple command for mass deployment that uses FQBN, and you can also assign specific device IDs:</p>
<pre class="console">
arduino-cloud-cli ota mass-upload --fqbn &lt;deviceFQBN&gt; --device-ids &lt;deviceIDs&gt; --file &lt;sketch-file.ino.bin&gt;</pre> <p>However, with this specific command, I will only use <code>fqbn</code> to send the update to all the same device types:</p>
<pre class="console">
arduino-cloud-cli ota mass-upload -b arduino:samd:mkrwifi1010 --file EnvSense101_sep15a.ino.bin</pre> <p>You can also explore the OTA mass upload by adding tags, to send an update to specific groups of devices. In this section, we explored how to build binaries of a sketch using the Arduino IDE<a id="_idIndexMarker1078"/> and how to upload an update using the OTA command.</p>
<h1 id="_idParaDest-294"><a id="_idTextAnchor294"/>What next?</h1>
<p>After playing around with some commands, it’s now time to do some more experiments so that you can apply your learning to new scenarios and learn new stuff. We explored the complete list of commands available on the Arduino Cloud CLI. However, you can check out Arduino’s official page for the latest updates and news to keep yourself up to date with the latest features. Now, it’s your turn to create batch scripts using the Arduino Cloud CLI to automate your operations, such as bulk device addition in the Arduino IoT Cloud, bulk Thing creation using templates, binding devices with Things, and creating a dashboard for every Thing from dashboard templates.</p>
<h1 id="_idParaDest-295"><a id="_idTextAnchor295"/>Summary</h1>
<p>In this chapter, we covered all the types of commands that are officially available to us on the Arduino Cloud CLI. Firstly, we explored device-related commands, which include device creation, listing devices, deletion, tagging, and untagging. Then, we explored how to work with Things; in that section, we started with template extraction and then created a Thing using a template. We also explored how to clone a Thing, how to bind a device with a Thing, and so on. In the penultimate section, we played around with dashboard commands, and in the last section, we explored how OTA commands can benefit us by sending updates to devices via the command line in different ways.</p>
<p>This chapter was specially designed for backend developers and administrators who want to use the Arduino Cloud CLI to optimize their daily tasks, by using terminal commands instead of a graphical user interface. This chapter will have helped them interact with the Arduino IoT Cloud using a CLI. It will also have helped them to create custom scripts, automating their daily tasks.</p>
<p>The following chapter is the last chapter of this book, and in this chapter, we will explore different Arduino IoT Cloud plans for educational and enterprise organizations. We will also explore industrial IoT hardware devices and different types of Arduino IoT Cloud services that are especially available to enterprise organizations. This chapter will give you a complete overview of how to scale your product from a smaller scale to an enterprise level.</p>
</div>
</body></html>