<html><head></head><body>
<div id="_idContainer072">
<h1 class="chapter-number" id="_idParaDest-85"><a id="_idTextAnchor085"/><span class="koboSpan" id="kobo.1.1">4</span></h1>
<h1 id="_idParaDest-86"><a id="_idTextAnchor086"/><span class="koboSpan" id="kobo.2.1">Project #1 – a Smarter Setup for Sensing the Environment</span></h1>
<p><span class="koboSpan" id="kobo.3.1">This chapter guides you through the reasons why a clean environment is necessary for human beings and how to implement air quality, temperature, and humidity monitoring by using </span><a id="_idIndexMarker342"/><span class="koboSpan" id="kobo.4.1">low-cost </span><strong class="bold"><span class="koboSpan" id="kobo.5.1">ESP-series boards</span></strong><span class="koboSpan" id="kobo.6.1">, with different open source sensors and</span><a id="_idIndexMarker343"/><span class="koboSpan" id="kobo.7.1"> the </span><strong class="bold"><span class="koboSpan" id="kobo.8.1">Arduino IoT Cloud</span></strong><span class="koboSpan" id="kobo.9.1">. </span><span class="koboSpan" id="kobo.9.2">Moreover, you will learn how to visualize the relevant data and use the Arduino IoT Cloud features to expand the functionalities of </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">your applications/projects.</span></span></p>
<p><span class="koboSpan" id="kobo.11.1">In this chapter, you will </span><a id="_idIndexMarker344"/><span class="koboSpan" id="kobo.12.1">gain confidence in how to build real-world solutions as we demonstrate </span><strong class="bold"><span class="koboSpan" id="kobo.13.1">Printed Circuit Board</span></strong><span class="koboSpan" id="kobo.14.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.15.1">PCB</span></strong><span class="koboSpan" id="kobo.16.1">) design, its implementation, and its deployment in the real world. </span><span class="koboSpan" id="kobo.16.2">We will cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.17.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.18.1">Why is air quality </span><span class="No-Break"><span class="koboSpan" id="kobo.19.1">monitoring necessary?</span></span></li>
<li><span class="koboSpan" id="kobo.20.1">Hardware components – sensors and </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">development boards</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.22.1">Project architecture</span></span></li>
<li><span class="koboSpan" id="kobo.23.1">Setting up the </span><strong class="bold"><span class="koboSpan" id="kobo.24.1">Thing</span></strong><span class="koboSpan" id="kobo.25.1">, network credentials, cloud variables, </span><span class="No-Break"><span class="koboSpan" id="kobo.26.1">and code</span></span></li>
<li><span class="koboSpan" id="kobo.27.1">Setting up a dashboard for web </span><span class="No-Break"><span class="koboSpan" id="kobo.28.1">and mobile</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.29.1">What’s next?</span></span></li>
</ul>
<h1 id="_idParaDest-87"><a id="_idTextAnchor087"/><span class="koboSpan" id="kobo.30.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.31.1">The following hardware</span><a id="_idIndexMarker345"/><span class="koboSpan" id="kobo.32.1"> components are required to understand </span><span class="No-Break"><span class="koboSpan" id="kobo.33.1">this chapter:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.34.1">WeMos D1 </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.35.1">MINI ESP8266</span></strong></span></li>
<li><span class="koboSpan" id="kobo.36.1">A </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.37.1">DHT11</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.38.1">/</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.39.1">DHT22</span></strong></span><span class="No-Break"> </span><span class="No-Break"><a id="_idIndexMarker346"/></span><span class="No-Break"><span class="koboSpan" id="kobo.40.1">sensor/module</span></span></li>
<li><span class="koboSpan" id="kobo.41.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.42.1">MQ-135</span></strong><span class="koboSpan" id="kobo.43.1"> air </span><span class="No-Break"><span class="koboSpan" id="kobo.44.1">quality</span></span><span class="No-Break"><a id="_idIndexMarker347"/></span><span class="No-Break"><span class="koboSpan" id="kobo.45.1"> module</span></span></li>
<li><span class="koboSpan" id="kobo.46.1">A PCB (a link is available in the </span><em class="italic"><span class="koboSpan" id="kobo.47.1">PCB design and assembling hardware </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.48.1">components</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.49.1"> section)</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.50.1">Female headers</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.51.1">Jumper cables</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.52.1">For coding, we will </span><a id="_idIndexMarker348"/><span class="koboSpan" id="kobo.53.1">use the </span><strong class="bold"><span class="koboSpan" id="kobo.54.1">Arduino Web Editor</span></strong><span class="koboSpan" id="kobo.55.1">, which includes a large collection of development boards and sensor libraries, and the </span><strong class="bold"><span class="koboSpan" id="kobo.56.1">Arduino IoT Cloud</span></strong><span class="koboSpan" id="kobo.57.1"> for </span><a id="_idIndexMarker349"/><span class="koboSpan" id="kobo.58.1">Thing and dashboard setup. </span><span class="koboSpan" id="kobo.58.2">To develop hardware and sensor designs, we </span><a id="_idIndexMarker350"/><span class="koboSpan" id="kobo.59.1">will need </span><strong class="bold"><span class="koboSpan" id="kobo.60.1">Fritzing</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.61.1">desktop software.</span></span></p>
<p><span class="koboSpan" id="kobo.62.1">The code for this chapter is available at the book’s official GitHub repository, or you can directly download the code by following this </span><span class="No-Break"><span class="koboSpan" id="kobo.63.1">link: </span></span><a href="https://github.com/PacktPublishing/Arduino-IoT-Cloud-for-Developers/tree/main/Chapter%234%20Project%231%20Sensing%20and%20Monitoring%20the%20Air%20for%20Clean%20Environment"><span class="No-Break"><span class="koboSpan" id="kobo.64.1">https://github.com/PacktPublishing/Arduino-IoT-Cloud-for-Developers/tree/main/Chapter%234%20Project%231%20Sensing%20and%20Monitoring%20the%20Air%20for%20Clean%20Environment</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.65.1">.</span></span></p>
<h1 id="_idParaDest-88"><a id="_idTextAnchor088"/><span class="koboSpan" id="kobo.66.1">Why is air quality monitoring necessary?</span></h1>
<p><span class="koboSpan" id="kobo.67.1">Air quality monitoring</span><a id="_idIndexMarker351"/><span class="koboSpan" id="kobo.68.1"> is necessary for human beings because air pollution can have significant negative effects on our health and well-being. </span><span class="koboSpan" id="kobo.68.2">Poor air quality can cause a variety of respiratory and cardiovascular problems, such as asthma, chronic bronchitis, lung cancer, and heart disease. </span><span class="koboSpan" id="kobo.68.3">It can also exacerbate existing health conditions and reduce our ability to fight off infections </span><span class="No-Break"><span class="koboSpan" id="kobo.69.1">and illnesses.</span></span></p>
<p><span class="koboSpan" id="kobo.70.1">Air pollution can also impact the environment, including ecosystems, wildlife, and plants. </span><span class="koboSpan" id="kobo.70.2">Polluted air can lead to </span><strong class="bold"><span class="koboSpan" id="kobo.71.1">acid rain</span></strong><span class="koboSpan" id="kobo.72.1">, which can</span><a id="_idIndexMarker352"/><span class="koboSpan" id="kobo.73.1"> damage crops, forests, and bodies of water and harm wildlife. </span><span class="koboSpan" id="kobo.73.2">It can also lead to the depletion of the ozone layer, which protects us from harmful </span><span class="No-Break"><span class="koboSpan" id="kobo.74.1">UV radiation.</span></span></p>
<p><span class="koboSpan" id="kobo.75.1">By monitoring air quality, we can identify areas where pollution levels are high and take steps to reduce exposure. </span><span class="koboSpan" id="kobo.75.2">This can include reducing emissions from factories, power plants, and transportation, as well as encouraging the use of clean energy and transportation alternatives. </span><span class="koboSpan" id="kobo.75.3">By improving air quality, we can help to protect our health, support the environment, and promote </span><span class="No-Break"><span class="koboSpan" id="kobo.76.1">sustainable development.</span></span></p>
<p><span class="koboSpan" id="kobo.77.1">Air quality monitoring is </span><a id="_idIndexMarker353"/><span class="koboSpan" id="kobo.78.1">necessary to assess the level of pollutants present in the air we breathe. </span><span class="koboSpan" id="kobo.78.2">It helps to identify the sources of pollution and to track changes in air quality over time. </span><span class="koboSpan" id="kobo.78.3">There are several reasons why air quality monitoring </span><span class="No-Break"><span class="koboSpan" id="kobo.79.1">is important:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.80.1">Regulatory compliance</span></strong><span class="koboSpan" id="kobo.81.1">: Many countries have regulations in place to limit the amount of pollutants that can be released into the air. </span><span class="koboSpan" id="kobo.81.2">Air quality monitoring is necessary to ensure that these regulations are followed and to identify areas where additional regulations may </span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">be necessary.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.83.1">Economic concerns</span></strong><span class="koboSpan" id="kobo.84.1">: Poor air quality can have a negative impact on economic activity, including reduced productivity, increased healthcare costs, and decreased tourism. </span><span class="koboSpan" id="kobo.84.2">Monitoring air quality can help to identify areas where pollution levels are high and take steps to improve air quality and support </span><span class="No-Break"><span class="koboSpan" id="kobo.85.1">economic growth.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.86.1">Overall, air quality monitoring is </span><a id="_idIndexMarker354"/><span class="koboSpan" id="kobo.87.1">an essential tool to protect public health, preserve the environment, and promote sustainable economic development. </span><span class="koboSpan" id="kobo.87.2">Now we’ve had a theoretical review of air quality monitoring, it’s time to explore the project practically. </span><span class="koboSpan" id="kobo.87.3">Firstly, we will start with the hardware, where we will explore all the required components such as development boards, sensors, design diagrams, and PCB design for implementation. </span><span class="koboSpan" id="kobo.87.4">Later, we will set up the Thing and cloud variables, upload code to the development board, and set up the dashboard for </span><span class="No-Break"><span class="koboSpan" id="kobo.88.1">data visualization.</span></span></p>
<h1 id="_idParaDest-89"><a id="_idTextAnchor089"/><span class="koboSpan" id="kobo.89.1">Exploring the hardware requirements</span></h1>
<p><span class="koboSpan" id="kobo.90.1">Before </span><a id="_idIndexMarker355"/><span class="koboSpan" id="kobo.91.1">moving forward, we will first look at what types of development boards and sensors are required to accomplish the project. </span><span class="koboSpan" id="kobo.91.2">We aim to use a board that provides Wi-Fi connectivity, is small in size, and is low in cost. </span><span class="koboSpan" id="kobo.91.3">If we talk about Wi-Fi-enabled development</span><a id="_idIndexMarker356"/><span class="koboSpan" id="kobo.92.1"> boards, then </span><a id="_idIndexMarker357"/><span class="koboSpan" id="kobo.93.1">there are </span><a id="_idIndexMarker358"/><span class="koboSpan" id="kobo.94.1">a lot of organizations providing them, such as </span><strong class="bold"><span class="koboSpan" id="kobo.95.1">Arduino</span></strong><span class="koboSpan" id="kobo.96.1">, the </span><strong class="bold"><span class="koboSpan" id="kobo.97.1">ESP32 series</span></strong><span class="koboSpan" id="kobo.98.1">, and the </span><strong class="bold"><span class="koboSpan" id="kobo.99.1">ESP8266</span></strong><span class="koboSpan" id="kobo.100.1"> series. </span><span class="koboSpan" id="kobo.100.2">Arduino development boards such</span><a id="_idIndexMarker359"/><span class="koboSpan" id="kobo.101.1"> as </span><strong class="bold"><span class="koboSpan" id="kobo.102.1">MKR Wi-Fi 1010</span></strong><span class="koboSpan" id="kobo.103.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.104.1">MKR Wi-Fi 1000</span></strong><span class="koboSpan" id="kobo.105.1"> are expensive</span><a id="_idIndexMarker360"/><span class="koboSpan" id="kobo.106.1"> compared to ESP32 and ESP8266. </span><span class="koboSpan" id="kobo.106.2">Now, we have two options: we either go with ESP32 or ESP8266 and leave the Arduino development boards. </span><span class="koboSpan" id="kobo.106.3">In this project, we will be using the WeMos D1 Mini, which is part of the ESP8266 series. </span><span class="koboSpan" id="kobo.106.4">Although the ESP32 series offers similar features, it is equipped </span><a id="_idIndexMarker361"/><span class="koboSpan" id="kobo.107.1">with </span><strong class="bold"><span class="koboSpan" id="kobo.108.1">Bluetooth Low Energy</span></strong><span class="koboSpan" id="kobo.109.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.110.1">BLE</span></strong><span class="koboSpan" id="kobo.111.1">) connectivity, which is not currently compatible with this project. </span><span class="koboSpan" id="kobo.111.2">Thus, we have opted for the ESP8266 series development boards, which are not only compact in size but also </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">more affordable.</span></span></p>
<p><span class="koboSpan" id="kobo.113.1">Among the sensors, there is a diverse range of options for measuring temperature, humidity, and air quality. </span><span class="koboSpan" id="kobo.113.2">However, our primary goal is to provide sensors that are affordable and readily available to users worldwide. </span><span class="koboSpan" id="kobo.113.3">For temperature and humidity measurements, we rely on the widely available and reasonably priced DHT11/DHT22 sensors. </span><span class="koboSpan" id="kobo.113.4">The MQ-135 sensor provides a wide detecting scope, fast response, and high sensitivity. </span><span class="koboSpan" id="kobo.113.5">It is a stable and long-life, simple drive circuit application. </span><span class="koboSpan" id="kobo.113.6">These sensors are used in air quality control equipment and are suitable for detecting NH</span><span class="subscript"><span class="koboSpan" id="kobo.114.1">3</span></span><span class="koboSpan" id="kobo.115.1">, NOx, alcohol, benzene, smoke, CO</span><span class="subscript"><span class="koboSpan" id="kobo.116.1">2</span></span><span class="koboSpan" id="kobo.117.1">, and more. </span><span class="koboSpan" id="kobo.117.2">They are easily obtainable on the market and well-suited for </span><span class="No-Break"><span class="koboSpan" id="kobo.118.1">small-scale projects.</span></span></p>
<p><span class="koboSpan" id="kobo.119.1">The ESP8266 </span><a id="_idIndexMarker362"/><span class="koboSpan" id="kobo.120.1">series</span><a id="_idIndexMarker363"/><span class="koboSpan" id="kobo.121.1"> has a wide collection of development boards that vary in size and pins. </span><span class="koboSpan" id="kobo.121.2">In this chapter, I’m using the WeMos D1 Mini development board, as it’s very compact compared to other boards and, of course, cheaper in cost, and it provides 5V as well as 3.3V pins. </span><span class="koboSpan" id="kobo.121.3">The following figure is the complete overview of the WeMos D1 Mini board, and demonstrates all the digital/analog Arduino-based pin numbers, ground and power pins, and </span><span class="No-Break"><span class="koboSpan" id="kobo.122.1">so on:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer062">
<span class="koboSpan" id="kobo.123.1"><img alt="Figure 4.1 – WeMos D1 Mini ESP8266" src="image/B19752_04_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.124.1">Figure 4.1 – WeMos D1 Mini ESP8266</span></p>
<p><span class="koboSpan" id="kobo.125.1">WeMos </span><a id="_idIndexMarker364"/><span class="koboSpan" id="kobo.126.1">provides multiple pins for digital input/output, but there is only one analog pin for input/output operations. </span><span class="koboSpan" id="kobo.126.2">If you want to use multiple analog sensors, then </span><strong class="bold"><span class="koboSpan" id="kobo.127.1">analog-to-digital converters</span></strong><span class="koboSpan" id="kobo.128.1"> are </span><a id="_idIndexMarker365"/><span class="koboSpan" id="kobo.129.1">available. </span><span class="koboSpan" id="kobo.129.2">One of the most famous analog-to-digital converters </span><a id="_idIndexMarker366"/><span class="koboSpan" id="kobo.130.1">is the </span><strong class="bold"><span class="koboSpan" id="kobo.131.1">ADS1115</span></strong><span class="koboSpan" id="kobo.132.1">/</span><strong class="bold"><span class="koboSpan" id="kobo.133.1">ADS1015 module</span></strong><span class="koboSpan" id="kobo.134.1">, which provides four analog pins that help cater to the requirement of using </span><span class="No-Break"><span class="koboSpan" id="kobo.135.1">multiple sensors.</span></span></p>
<p><span class="koboSpan" id="kobo.136.1">However, for the current project, we need one digital pin for the </span><strong class="bold"><span class="koboSpan" id="kobo.137.1">DHT11</span></strong><span class="koboSpan" id="kobo.138.1">/</span><strong class="bold"><span class="koboSpan" id="kobo.139.1">DHT22 sensor</span></strong><span class="koboSpan" id="kobo.140.1"> and one </span><a id="_idIndexMarker367"/><span class="koboSpan" id="kobo.141.1">analog pin for the </span><strong class="bold"><span class="koboSpan" id="kobo.142.1">MQ-135 air quality sensor</span></strong><span class="koboSpan" id="kobo.143.1">. </span><span class="koboSpan" id="kobo.143.2">One of the </span><a id="_idIndexMarker368"/><span class="koboSpan" id="kobo.144.1">best features of the WeMos D1 Mini development board is the 5V power pin, which is not available on most ESP8266 series </span><span class="No-Break"><span class="koboSpan" id="kobo.145.1">development boards.</span></span></p>
<p><span class="koboSpan" id="kobo.146.1">Next, we will use the DHT11 sensor to sense temperature and humidity, but you can also use the DHT22 sensor, depending on your requirements. </span><span class="koboSpan" id="kobo.146.2">With regard to features, the DHT22 provides a broader range of sensing compared to the DHT11, but its cost is higher. </span><span class="koboSpan" id="kobo.146.3">The following diagram shows the pinout layout of </span><span class="No-Break"><span class="koboSpan" id="kobo.147.1">both sensors:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer063">
<span class="koboSpan" id="kobo.148.1"><img alt="Figure 4.2 – The DHT22 and DHT11 pinout layouts" src="image/B19752_04_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.149.1">Figure 4.2 – The DHT22 and DHT11 pinout layouts</span></p>
<p><span class="koboSpan" id="kobo.150.1">Pin #1</span><a id="_idIndexMarker369"/><span class="koboSpan" id="kobo.151.1"> is the </span><strong class="bold"><span class="koboSpan" id="kobo.152.1">voltage common collector</span></strong><span class="koboSpan" id="kobo.153.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.154.1">VCC</span></strong><span class="koboSpan" id="kobo.155.1">) and</span><a id="_idIndexMarker370"/><span class="koboSpan" id="kobo.156.1"> works with both 3.3V and 5V. </span><span class="koboSpan" id="kobo.156.2">Pin #2 is a </span><strong class="bold"><span class="koboSpan" id="kobo.157.1">data</span></strong><span class="koboSpan" id="kobo.158.1"> pin</span><a id="_idIndexMarker371"/><span class="koboSpan" id="kobo.159.1"> that connects with any digital pin of a development board, and Pin #4 is a </span><strong class="bold"><span class="koboSpan" id="kobo.160.1">ground</span></strong><span class="koboSpan" id="kobo.161.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.162.1">GND</span></strong><span class="koboSpan" id="kobo.163.1">) pin</span><a id="_idIndexMarker372"/><span class="koboSpan" id="kobo.164.1"> that connects with the GND pin of a development board. </span><span class="koboSpan" id="kobo.164.2">There is another pin in the sensor, Pin #3, which</span><a id="_idIndexMarker373"/><span class="koboSpan" id="kobo.165.1"> is </span><strong class="bold"><span class="koboSpan" id="kobo.166.1">Not Connected</span></strong><span class="koboSpan" id="kobo.167.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.168.1">NC</span></strong><span class="koboSpan" id="kobo.169.1">) – this pin is not used by us </span><span class="No-Break"><span class="koboSpan" id="kobo.170.1">during development.</span></span></p>
<p><span class="koboSpan" id="kobo.171.1">The following table explains all the specification differences between DHT22 and DHT11; the most notable</span><a id="_idIndexMarker374"/><span class="koboSpan" id="kobo.172.1"> things are </span><a id="_idIndexMarker375"/><span class="koboSpan" id="kobo.173.1">the </span><strong class="bold"><span class="koboSpan" id="kobo.174.1">sensing range</span></strong><span class="koboSpan" id="kobo.175.1"> and the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.176.1">sensing period</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.177.1">:</span></span></p>
<table class="No-Table-Style _idGenTablePara-1" id="table001-1">
<colgroup>
<col/>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.178.1">Model</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.179.1">DHT22</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.180.1">DHT11</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.181.1">Power supply</span></span></p>
</td>
<td class="No-Table-Style" colspan="2">
<p><span class="No-Break"><span class="koboSpan" id="kobo.182.1">3.3–5V</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.183.1">Output signal</span></span></p>
</td>
<td class="No-Table-Style" colspan="2">
<p><span class="koboSpan" id="kobo.184.1">A digital signal via a </span><span class="No-Break"><span class="koboSpan" id="kobo.185.1">single bus</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.186.1">Sensing element</span></span></p>
</td>
<td class="No-Table-Style" colspan="2">
<p><span class="No-Break"><span class="koboSpan" id="kobo.187.1">Polymer capacitor</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.188.1">Sensing range</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.189.1">Humidity: </span><span class="No-Break"><span class="koboSpan" id="kobo.190.1">0–100% RH</span></span></p>
<p><span class="koboSpan" id="kobo.191.1">Temperature: </span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">40~80 Celsius</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.193.1">Humidity: </span><span class="No-Break"><span class="koboSpan" id="kobo.194.1">20–90% RH</span></span></p>
<p><span class="koboSpan" id="kobo.195.1">Temperature: </span><span class="No-Break"><span class="koboSpan" id="kobo.196.1">0~50 Celsius</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.197.1">Accuracy</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.198.1">Humidity: </span><span lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.199.1">±</span></span><span class="koboSpan" id="kobo.200.1"> 2% RH (Max </span><span lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.201.1">±</span></span><span class="No-Break"><span class="koboSpan" id="kobo.202.1">5% RH)</span></span></p>
<p><span class="koboSpan" id="kobo.203.1">Temperature: &lt;</span><span lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.204.1">±</span></span><span class="No-Break"><span class="koboSpan" id="kobo.205.1">0.5 Celsius</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.206.1">Humidity: </span><span lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.207.1">±</span></span><span class="koboSpan" id="kobo.208.1">1% RH (Max </span><span lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.209.1">±</span></span> <span class="No-Break"><span class="koboSpan" id="kobo.210.1">5% RH)</span></span></p>
<p><span class="koboSpan" id="kobo.211.1">Temperature: &lt;</span><span lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.212.1">±</span></span><span class="No-Break"><span class="koboSpan" id="kobo.213.1">2 Celsius</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.214.1">Sensing period</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.215.1">Average 2s</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.216.1">Average 1s</span></span></p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.217.1">Table 4.1 – DHT11 vs DHT22 comparison</span></p>
<p><span class="koboSpan" id="kobo.218.1">Finally, we </span><a id="_idIndexMarker376"/><span class="koboSpan" id="kobo.219.1">will look at the main sensor for our project. </span><span class="koboSpan" id="kobo.219.2">The MQ-135 sensor is used to monitor the air quality of a specific area. </span><span class="koboSpan" id="kobo.219.3">It is a low-cost environment-monitoring sensor, and it monitors a wide range of parameters, such as smoke, carbon dioxide, ammonia, benzene, nitrogen oxides, and alcohol. </span><span class="koboSpan" id="kobo.219.4">The MQ-135 senses all these parameters and provides the value of air</span><a id="_idIndexMarker377"/><span class="koboSpan" id="kobo.220.1"> quality in </span><strong class="bold"><span class="koboSpan" id="kobo.221.1">parts per million</span></strong><span class="koboSpan" id="kobo.222.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.223.1">ppm</span></strong><span class="koboSpan" id="kobo.224.1">). </span><span class="koboSpan" id="kobo.224.2">The following figure shows the MQ-135’s shape and its pin layout diagram as well as indicators for the LED </span><span class="No-Break"><span class="koboSpan" id="kobo.225.1">and regulator:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer064">
<span class="koboSpan" id="kobo.226.1"><img alt="Figure 4.3 – MQ-135 sensor and pinout" src="image/B19752_04_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.227.1">Figure 4.3 – MQ-135 sensor and pinout</span></p>
<p><span class="koboSpan" id="kobo.228.1">The </span><a id="_idIndexMarker378"/><span class="koboSpan" id="kobo.229.1">MQ-135 sensor </span><a id="_idIndexMarker379"/><span class="koboSpan" id="kobo.230.1">module consists of four</span><a id="_idIndexMarker380"/><span class="koboSpan" id="kobo.231.1"> pins, and each pin is marked with a code: </span><strong class="bold"><span class="koboSpan" id="kobo.232.1">Analog Output</span></strong><span class="koboSpan" id="kobo.233.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.234.1">AO</span></strong><span class="koboSpan" id="kobo.235.1">), </span><strong class="bold"><span class="koboSpan" id="kobo.236.1">Digital Output</span></strong><span class="koboSpan" id="kobo.237.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.238.1">DO</span></strong><span class="koboSpan" id="kobo.239.1">), GND, and VCC. </span><span class="koboSpan" id="kobo.239.2">The module provides readings on both analog and digital modes, but analog mode is best to get values in PPM. </span><span class="koboSpan" id="kobo.239.3">The sensor operates better with 5V power, but you can still use 3.3V, although I recommend the former. </span><span class="koboSpan" id="kobo.239.4">The MQ-135 requires 20 seconds of preheating to provide better readings, so make sure to get readings after an interval of every 20 seconds, or at least wait 20 seconds for the first-time boot of the </span><span class="No-Break"><span class="koboSpan" id="kobo.240.1">development board.</span></span></p>
<p><span class="koboSpan" id="kobo.241.1">The module also contains a regulator to control the sensitivity of sensors, which could be adjusted according to the environment. </span><span class="koboSpan" id="kobo.241.2">Different indicator </span><strong class="bold"><span class="koboSpan" id="kobo.242.1">Surface Mount Device</span></strong><span class="koboSpan" id="kobo.243.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.244.1">SMD</span></strong><span class="koboSpan" id="kobo.245.1">) LEDs</span><a id="_idIndexMarker381"/><span class="koboSpan" id="kobo.246.1"> are available</span><a id="_idIndexMarker382"/><span class="koboSpan" id="kobo.247.1"> to verify the module</span><a id="_idIndexMarker383"/><span class="koboSpan" id="kobo.248.1"> status, which</span><a id="_idIndexMarker384"/><span class="koboSpan" id="kobo.249.1"> includes </span><strong class="bold"><span class="koboSpan" id="kobo.250.1">Logic Out LED</span></strong><span class="koboSpan" id="kobo.251.1"> and </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.252.1">Power LED</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.253.1">.</span></span></p>
<h1 id="_idParaDest-90"><a id="_idTextAnchor090"/><span class="koboSpan" id="kobo.254.1">Understanding the project architecture</span></h1>
<p><span class="koboSpan" id="kobo.255.1">In the preceding</span><a id="_idIndexMarker385"/><span class="koboSpan" id="kobo.256.1"> sections, we discussed the sensors and development board in detail. </span><span class="koboSpan" id="kobo.256.2">Now, it’s time to cook the recipe. </span><span class="koboSpan" id="kobo.256.3">In hardware development, before getting to work with sensors and development boards, we need to develop design concepts to get a better understanding of how things will be connected. </span><span class="koboSpan" id="kobo.256.4">There is a lot of software available to design and develop design concepts regarding electronics projects, but we will opt </span><span class="No-Break"><span class="koboSpan" id="kobo.257.1">for Fritzing.</span></span></p>
<p><span class="koboSpan" id="kobo.258.1">In the next subsection, we will talk about the schematics and the design of the project, which explains how to connect the pins to the development board. </span><span class="koboSpan" id="kobo.258.2">In the subsection after that, we will talk about the PCB design and its implementation to make a product ready for deployment in </span><span class="No-Break"><span class="koboSpan" id="kobo.259.1">the field.</span></span></p>
<h2 id="_idParaDest-91"><a id="_idTextAnchor091"/><span class="koboSpan" id="kobo.260.1">Schematics and design</span></h2>
<p><span class="koboSpan" id="kobo.261.1">The </span><a id="_idIndexMarker386"/><span class="koboSpan" id="kobo.262.1">purpose of our design is to get a clear understanding of how sensors will connect with the development board. </span><span class="koboSpan" id="kobo.262.2">It helps engineers develop a prototype on </span><a id="_idIndexMarker387"/><span class="koboSpan" id="kobo.263.1">a </span><strong class="bold"><span class="koboSpan" id="kobo.264.1">breadboard</span></strong><span class="koboSpan" id="kobo.265.1"> or </span><strong class="bold"><span class="koboSpan" id="kobo.266.1">Veroboard</span></strong><span class="koboSpan" id="kobo.267.1"> by using our design files. </span><span class="koboSpan" id="kobo.267.2">The other major benefit of</span><a id="_idIndexMarker388"/><span class="koboSpan" id="kobo.268.1"> designing is that Fritzing builds hardware schematics and the PCB design in the background according to your design, which can be adjusted by designers according to system requirements. </span><span class="koboSpan" id="kobo.268.2">The following design provides a full overview of how you can connect sensors to a </span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">development board:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer065">
<span class="koboSpan" id="kobo.270.1"><img alt="Figure 4.4 – An air quality-monitoring system design" src="image/B19752_04_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.271.1">Figure 4.4 – An air quality-monitoring system design</span></p>
<p><span class="koboSpan" id="kobo.272.1">For better </span><a id="_idIndexMarker389"/><span class="koboSpan" id="kobo.273.1">understanding we have developed the schematics diagram shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.274.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.275.1">.4</span></em><span class="koboSpan" id="kobo.276.1"> as well </span><em class="italic"><span class="koboSpan" id="kobo.277.1">Table 4.2</span></em><span class="koboSpan" id="kobo.278.1"> for easy understanding. </span><span class="koboSpan" id="kobo.278.2">The pin configuration will be discussed in detail in </span><span class="No-Break"><span class="koboSpan" id="kobo.279.1">proceeding paragraph.</span></span></p>
<table class="No-Table-Style _idGenTablePara-1" id="table002">
<colgroup>
<col/>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="bold"><span class="koboSpan" id="kobo.280.1">We Mos </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.281.1">D1 mini</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.282.1">MQ-135</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.283.1">DHT22</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.284.1">5V</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.285.1">VCC</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.286.1">VCC</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.287.1">GND</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.288.1">GND</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.289.1">GND</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.290.1">A0</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.291.1">A0</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.292.1">-</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.293.1">D1</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.294.1">-</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.295.1">Data</span></span></p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.296.1">Table 4.2 – Pin configuration table for sensors</span></p>
<p><span class="koboSpan" id="kobo.297.1">According to the design (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.298.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.299.1">.4</span></em><span class="koboSpan" id="kobo.300.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.301.1">Table 4.2</span></em><span class="koboSpan" id="kobo.302.1">), we have a common 5V output and GND from the development board to both sensors. </span><span class="koboSpan" id="kobo.302.2">The MQ-135 sensor is an analog sensor, so we connected its AO pin to the AO pin of the WeMos development board, while DHT11/DHT22 are digital sensors, and their Pin 2 is connected to the D1 pin of the </span><span class="No-Break"><span class="koboSpan" id="kobo.303.1">development board.</span></span></p>
<h2 id="_idParaDest-92"><a id="_idTextAnchor092"/><span class="koboSpan" id="kobo.304.1">PCB design and the assembly of hardware components</span></h2>
<p><span class="koboSpan" id="kobo.305.1">In the preceding subsection, we </span><a id="_idIndexMarker390"/><span class="koboSpan" id="kobo.306.1">looked at a design that is ideal for creating a </span><a id="_idIndexMarker391"/><span class="koboSpan" id="kobo.307.1">prototype using a breadboard or Veroboard, but what if we want to deploy that solution in the field? </span><strong class="bold"><span class="koboSpan" id="kobo.308.1">Fritzing</span></strong><span class="koboSpan" id="kobo.309.1"> is a great</span><a id="_idIndexMarker392"/><span class="koboSpan" id="kobo.310.1"> tool that provides the option to design the PCB, but when you develop the design, it automatically creates the PCB design in the backend, which is accessible via the </span><strong class="bold"><span class="koboSpan" id="kobo.311.1">PCB Design</span></strong><span class="koboSpan" id="kobo.312.1"> tab. </span><span class="koboSpan" id="kobo.312.2">Automatic PCB design is just a basic footprint and not suitable for direct production, so it’s mandatory to review and rearrange the design according to professional practices. </span><span class="koboSpan" id="kobo.312.3">The following diagram demonstrates the final PCB design of </span><span class="No-Break"><span class="koboSpan" id="kobo.313.1">the project:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer066">
<span class="koboSpan" id="kobo.314.1"><img alt="Figure 4.5 – An air quality-monitoring system PCB design" src="image/B19752_04_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.315.1">Figure 4.5 – An air quality-monitoring system PCB design</span></p>
<p><span class="koboSpan" id="kobo.316.1">It’s easy to </span><a id="_idIndexMarker393"/><span class="koboSpan" id="kobo.317.1">develop the PCB; just make sure that the connection</span><a id="_idIndexMarker394"/><span class="koboSpan" id="kobo.318.1"> line doesn’t intersect with other connection lines. </span><span class="koboSpan" id="kobo.318.2">There are many different tools available for PCB design, such as EasyEDA, CircuitMaker, and Altium, but it is thanks to Fritzing that I could create that design </span><span class="No-Break"><span class="koboSpan" id="kobo.319.1">so easily.</span></span></p>
<p><span class="koboSpan" id="kobo.320.1">After the PCB design, you have two options. </span><span class="koboSpan" id="kobo.320.2">First, you can develop the PCB by yourself using a DIY method, which is good for learning purposes but not suitable for a large-scale product. </span><span class="koboSpan" id="kobo.320.3">The second method is to choose a professional organization that manufactures the PCB professionally. </span><span class="koboSpan" id="kobo.320.4">Many</span><a id="_idIndexMarker395"/><span class="koboSpan" id="kobo.321.1"> organizations in China provide PCB manufacturing and</span><a id="_idIndexMarker396"/><span class="koboSpan" id="kobo.322.1"> fabrication services, such as </span><strong class="bold"><span class="koboSpan" id="kobo.323.1">Seeed Studio</span></strong><span class="koboSpan" id="kobo.324.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.325.1">JLCPCB</span></strong><span class="koboSpan" id="kobo.326.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.327.1">PCBWay</span></strong><span class="koboSpan" id="kobo.328.1">. </span><span class="koboSpan" id="kobo.328.2">I have tried PCBWay</span><a id="_idIndexMarker397"/><span class="koboSpan" id="kobo.329.1"> and was impressed with their manufacturing and shipment delivery time. </span><span class="koboSpan" id="kobo.329.2">I have uploaded the PCB design to the PCBWay project repository; from there, you can select and order it </span><span class="No-Break"><span class="koboSpan" id="kobo.330.1">easily: </span></span><a href="https://www.pcbway.com/project/shareproject/Low_cost_Outdoor_Air_Quality_Monitoring_System_0157f1af.html"><span class="No-Break"><span class="koboSpan" id="kobo.331.1">https://www.pcbway.com/project/shareproject/Low_cost_Outdoor_Air_Quality_Monitoring_System_0157f1af.html</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.332.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.333.1">After getting the PCB board, it’s time to solder the female headers for the development boards and sensors. </span><span class="koboSpan" id="kobo.333.2">Never solder the development board and sensors directly on the PCB, as if anything stops working, then it’s easy to detach and replace. </span><span class="koboSpan" id="kobo.333.3">So finally, here we have a product ready</span><a id="_idIndexMarker398"/><span class="koboSpan" id="kobo.334.1"> where the sensors and development board are soldered on the PCB for </span><span class="No-Break"><span class="koboSpan" id="kobo.335.1">final</span></span><span class="No-Break"><a id="_idIndexMarker399"/></span><span class="No-Break"><span class="koboSpan" id="kobo.336.1"> deployment.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer067">
<span class="koboSpan" id="kobo.337.1"><img alt="Figure 4.6 – An air-quality monitoring system on the PCB" src="image/B19752_04_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.338.1">Figure 4.6 – An air-quality monitoring system on the PCB</span></p>
<p><span class="koboSpan" id="kobo.339.1">After the female headers are soldered onto the PCB, WeMos and the other sensors are plugged into the headers, as shown in the preceding diagram. </span><span class="koboSpan" id="kobo.339.2">In this section and the previous section, we explored what types of sensors and development boards will be used in our project, and the latter part of this section discussed design, which demonstrates the wiring system for connectivity between sensors and the WeMos D1 Mini. </span><span class="koboSpan" id="kobo.339.3">Finally, we explored PCB design and assembled all the components of the PCB. </span><span class="koboSpan" id="kobo.339.4">Next, we need to set up the Thing, code, and dashboard in the Arduino IoT Cloud to get ready for the </span><span class="No-Break"><span class="koboSpan" id="kobo.340.1">final product.</span></span></p>
<h1 id="_idParaDest-93"><a id="_idTextAnchor093"/><span class="koboSpan" id="kobo.341.1">Setting up the Thing, network credentials, cloud variables, and code</span></h1>
<p><span class="koboSpan" id="kobo.342.1">After setting up the</span><a id="_idIndexMarker400"/><span class="koboSpan" id="kobo.343.1"> hardware, it’s time to set up the Thing in the Arduino IoT Cloud. </span><span class="koboSpan" id="kobo.343.2">For this project, we need three cloud variables to fetch the monitoring parameters from the device, and the Wi-Fi network settings will be different as compared to Arduino development boards, due to the ESP series-based development board. </span><span class="koboSpan" id="kobo.343.3">The following figure provides an overview of the Thing, including </span><strong class="bold"><span class="koboSpan" id="kobo.344.1">Cloud Variables</span></strong><span class="koboSpan" id="kobo.345.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.346.1">Associating a device</span></strong><span class="koboSpan" id="kobo.347.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.348.1">Network</span></strong><span class="koboSpan" id="kobo.349.1"> settings with numbers, which will be discussed next step </span><span class="No-Break"><span class="koboSpan" id="kobo.350.1">by step:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer068">
<span class="koboSpan" id="kobo.351.1"><img alt="Figure 4.7 – The air quality-monitoring system Thing setup" src="image/B19752_04_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.352.1">Figure 4.7 – The air quality-monitoring system Thing setup</span></p>
<p><span class="koboSpan" id="kobo.353.1">Set up a new Thing with the name </span><strong class="source-inline"><span class="koboSpan" id="kobo.354.1">Sense the Environment</span></strong><span class="koboSpan" id="kobo.355.1">. </span><span class="koboSpan" id="kobo.355.2">Follow the next steps to create variables, the associated device, the network configuration, and finally, </span><span class="No-Break"><span class="koboSpan" id="kobo.356.1">the code:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.357.1">Firstly, we need to set up three cloud variables regarding air quality, humidity, and temperature. </span><span class="koboSpan" id="kobo.357.2">The complete details regarding cloud variables are available in the </span><span class="No-Break"><span class="koboSpan" id="kobo.358.1">next subsection.</span></span></li>
<li><span class="koboSpan" id="kobo.359.1">After that, we need to associate the device with the Thing. </span><span class="koboSpan" id="kobo.359.2">In the current project, we will use the WeMos D1 Mini so the wizard will be different from the Arduino boards. </span><span class="koboSpan" id="kobo.359.3">The complete details are available in the </span><em class="italic"><span class="koboSpan" id="kobo.360.1">Associating a </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.361.1">device</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.362.1"> subsection.</span></span></li>
<li><span class="koboSpan" id="kobo.363.1">Finally, we need to set up the network configuration for the device, but this time, we need to provide a security key for ESP series boards to make the connection secure. </span><span class="koboSpan" id="kobo.363.2">The Arduino-compatible boards are configured by the Arduino IoT Cloud automatically during the device </span><span class="No-Break"><span class="koboSpan" id="kobo.364.1">setup wizard.</span></span></li>
<li><span class="koboSpan" id="kobo.365.1">After the</span><a id="_idIndexMarker401"/><span class="koboSpan" id="kobo.366.1"> setup of cloud variables, device, and network settings, we will go through </span><span class="No-Break"><span class="koboSpan" id="kobo.367.1">the code.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.368.1">Here, we have given an overview of the Thing and we also discussed the required steps that will be carried out to complete the </span><span class="No-Break"><span class="koboSpan" id="kobo.369.1">Thing setup.</span></span></p>
<h2 id="_idParaDest-94"><a id="_idTextAnchor094"/><span class="koboSpan" id="kobo.370.1">Cloud variables</span></h2>
<p><span class="koboSpan" id="kobo.371.1">The </span><a id="_idIndexMarker402"/><span class="koboSpan" id="kobo.372.1">following table explains all the properties of the variable that we need to use when we create the cloud variable. </span><span class="koboSpan" id="kobo.372.2">An integer is a very famous data type, but we will use two new variable types for humidity (</span><strong class="source-inline"><span class="koboSpan" id="kobo.373.1">CloudRelativeHumidity</span></strong><span class="koboSpan" id="kobo.374.1">) and temperature (</span><strong class="source-inline"><span class="koboSpan" id="kobo.375.1">CloudTemperatureSensor</span></strong><span class="koboSpan" id="kobo.376.1">), which measure data in percentage and Celsius, respectively. </span><span class="koboSpan" id="kobo.376.2">Next, make sure to declare the variables exactly as stated in the given table, including case-sensitive names and variable types. </span><span class="koboSpan" id="kobo.376.3">If the example code does not match your naming, you will need to modify </span><span class="No-Break"><span class="koboSpan" id="kobo.377.1">it accordingly.</span></span></p>
<table class="No-Table-Style _idGenTablePara-1" id="table003">
<colgroup>
<col/>
<col/>
<col/>
<col/>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.378.1">S#</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.379.1">Variable name</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.380.1">Variable type</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.381.1">Declaration</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.382.1">Permission</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.383.1">Update policy</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.384.1">1</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.385.1">AirQuality</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.386.1">int</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.387.1">airQuality</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.388.1">Read-only</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.389.1">On change</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.390.1">2</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.391.1">Humidity</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.392.1">CloudRelative Humidity</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.393.1">humidity</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.394.1">Read-only</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.395.1">On change</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.396.1">3</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.397.1">Temperature</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.398.1">CloudTemperature Sensor</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.399.1">temperature</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.400.1">Read-only</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.401.1">On change</span></strong></span></p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.402.1">Table 4.3 – Cloud variables details</span></p>
<p><span class="koboSpan" id="kobo.403.1">Here, we made the </span><strong class="bold"><span class="koboSpan" id="kobo.404.1">permission</span></strong><span class="koboSpan" id="kobo.405.1"> read-only; although</span><a id="_idIndexMarker403"/><span class="koboSpan" id="kobo.406.1"> we have a read/write option, in our project, we only want to receive data from the device instead of a dashboard modification. </span><span class="koboSpan" id="kobo.406.2">That’s why read-only mode is used to prevent issues in data consistency. </span><strong class="bold"><span class="koboSpan" id="kobo.407.1">Update policy</span></strong><span class="koboSpan" id="kobo.408.1"> is set to </span><strong class="bold"><span class="koboSpan" id="kobo.409.1">On change</span></strong><span class="koboSpan" id="kobo.410.1">, as the device will send the data after five minutes, and this option is more appropriate compared to </span><span class="No-Break"><span class="koboSpan" id="kobo.411.1">periodic updates.</span></span></p>
<h2 id="_idParaDest-95"><a id="_idTextAnchor095"/><span class="koboSpan" id="kobo.412.1">Associating a device</span></h2>
<p><span class="koboSpan" id="kobo.413.1">After creating</span><a id="_idIndexMarker404"/><span class="koboSpan" id="kobo.414.1"> the variables, it’s time to add a device and associate it with the Thing. </span><span class="koboSpan" id="kobo.414.2">Before adding the device, connect the development board to the computer and </span><a id="_idIndexMarker405"/><span class="koboSpan" id="kobo.415.1">open the </span><strong class="bold"><span class="koboSpan" id="kobo.416.1">Arduino Create Agent</span></strong><span class="koboSpan" id="kobo.417.1"> application. </span><span class="koboSpan" id="kobo.417.2">The following figure shows the different types of third-party boards that are supported by the Arduino IOT Cloud, and in that step, we will select the </span><strong class="bold"><span class="koboSpan" id="kobo.418.1">ESP8266</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.419.1">series board.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer069">
<span class="koboSpan" id="kobo.420.1"><img alt="Figure 4.8 – The device selection wizard" src="image/B19752_04_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.421.1">Figure 4.8 – The device selection wizard</span></p>
<p><span class="koboSpan" id="kobo.422.1">Please follow</span><a id="_idIndexMarker406"/><span class="koboSpan" id="kobo.423.1"> these steps to add the device to the Arduino </span><span class="No-Break"><span class="koboSpan" id="kobo.424.1">IoT Cloud:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.425.1">Click on the </span><strong class="bold"><span class="koboSpan" id="kobo.426.1">Select Device</span></strong><span class="koboSpan" id="kobo.427.1"> button under the </span><strong class="bold"><span class="koboSpan" id="kobo.428.1">Associating a device</span></strong><span class="koboSpan" id="kobo.429.1"> section on the </span><span class="No-Break"><span class="koboSpan" id="kobo.430.1">Thing page.</span></span></li>
<li><span class="koboSpan" id="kobo.431.1">A popup will appear, where you can see all the devices that are already available. </span><span class="koboSpan" id="kobo.431.2">If you have already added your WeMos D1 Mini, select it. </span><span class="koboSpan" id="kobo.431.3">Otherwise, click on </span><strong class="bold"><span class="koboSpan" id="kobo.432.1">SET UP </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.433.1">NEW DEVICE</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.434.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.435.1">Next, click on the </span><strong class="bold"><span class="koboSpan" id="kobo.436.1">Third party </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.437.1">device</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.438.1"> option.</span></span></li>
<li><span class="koboSpan" id="kobo.439.1">Select </span><strong class="bold"><span class="koboSpan" id="kobo.440.1">ESP8266</span></strong><span class="koboSpan" id="kobo.441.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.442.1">LOLIN(WEMOS) D1 R2 mini</span></strong><span class="koboSpan" id="kobo.443.1"> from the dropdown, and click on the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.444.1">CONTINUE</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.445.1"> button.</span></span></li>
<li><span class="koboSpan" id="kobo.446.1">Provide the device name and click on the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.447.1">Next</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.448.1"> button.</span></span></li>
<li><span class="koboSpan" id="kobo.449.1">In the final wizard, the device ID and secret key will be displayed. </span><span class="koboSpan" id="kobo.449.2">Copy the secret</span><a id="_idIndexMarker407"/><span class="koboSpan" id="kobo.450.1"> key to a safe place, as it will be used during the </span><span class="No-Break"><span class="koboSpan" id="kobo.451.1">network configuration.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.452.1">After setting up the device and associating it with the Thing, it’s time to configure the device network settings. </span><span class="koboSpan" id="kobo.452.2">The following sections will cover all the steps to configure your device for a </span><span class="No-Break"><span class="koboSpan" id="kobo.453.1">Wi-Fi network.</span></span></p>
<h2 id="_idParaDest-96"><a id="_idTextAnchor096"/><span class="koboSpan" id="kobo.454.1">Network</span></h2>
<p><span class="koboSpan" id="kobo.455.1">After associating the</span><a id="_idIndexMarker408"/><span class="koboSpan" id="kobo.456.1"> device with the Thing, it is time to configure the Wi-Fi settings for device communication. </span><span class="koboSpan" id="kobo.456.2">Fill in the form with </span><strong class="bold"><span class="koboSpan" id="kobo.457.1">Wi-Fi Name</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.458.1">and </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.459.1">Password</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.460.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer070">
<span class="koboSpan" id="kobo.461.1"><img alt="Figure 4.9 – The network configuration for the Thing" src="image/B19752_04_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.462.1">Figure 4.9 – The network configuration for the Thing</span></p>
<p><span class="koboSpan" id="kobo.463.1">In </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.464.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.465.1">.9</span></em><span class="koboSpan" id="kobo.466.1">, you will find a new field for </span><strong class="bold"><span class="koboSpan" id="kobo.467.1">Secret Key</span></strong><span class="koboSpan" id="kobo.468.1">. </span><span class="koboSpan" id="kobo.468.2">Paste the secret key that we received from the system during the device association process, which is explained in </span><em class="italic"><span class="koboSpan" id="kobo.469.1">step 6</span></em><span class="koboSpan" id="kobo.470.1"> in the </span><a id="_idIndexMarker409"/><span class="No-Break"><span class="koboSpan" id="kobo.471.1">preceding subsection.</span></span></p>
<p><span class="koboSpan" id="kobo.472.1">Now, we are done with the device association to the Thing as well as with network settings. </span><span class="koboSpan" id="kobo.472.2">The next step is to understand and upload the code. </span><span class="koboSpan" id="kobo.472.3">The following section will guide you through </span><span class="No-Break"><span class="koboSpan" id="kobo.473.1">the code.</span></span></p>
<h2 id="_idParaDest-97"><a id="_idTextAnchor097"/><span class="koboSpan" id="kobo.474.1">Coding</span></h2>
<p><span class="koboSpan" id="kobo.475.1">The chapter’s code </span><a id="_idIndexMarker410"/><span class="koboSpan" id="kobo.476.1">is available at the book’s official GitHub repository, or you can directly download the code by following this </span><span class="No-Break"><span class="koboSpan" id="kobo.477.1">link: </span></span><a href="https://github.com/PacktPublishing/Arduino-IoT-Cloud-for-Developers/tree/main/Chapter%234%20Project%231%20Sensing%20and%20Monitoring%20the%20Air%20for%20Clean%20Environment/Sense_the_Environment_feb24a"><span class="No-Break"><span class="koboSpan" id="kobo.478.1">https://github.com/PacktPublishing/Arduino-IoT-Cloud-for-Developers/tree/main/Chapter%234%20Project%231%20Sensing%20and%20Monitoring%20the%20Air%20for%20Clean%20Environment/Sense_the_Environment_feb24a</span></span></a></p>
<p><span class="koboSpan" id="kobo.479.1">You can download the code and put it into your Thing by navigating to the </span><strong class="bold"><span class="koboSpan" id="kobo.480.1">Sketch</span></strong><span class="koboSpan" id="kobo.481.1"> tab. </span><span class="koboSpan" id="kobo.481.2">We will not discuss the code any further, as you will get an idea of how it works after reading it. </span><span class="koboSpan" id="kobo.481.3">Instead, we will explain the main workflow, which involves initializing all the things in the setup method and using milliseconds to calculate the delay time. </span><span class="koboSpan" id="kobo.481.4">Remember to never try using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.482.1">delay</span></strong><span class="koboSpan" id="kobo.483.1"> method, as it will block the </span><strong class="source-inline"><span class="koboSpan" id="kobo.484.1">ArduinoCloud.update()</span></strong><span class="koboSpan" id="kobo.485.1"> method and then call the </span><strong class="source-inline"><span class="koboSpan" id="kobo.486.1">STHAM</span></strong><span class="koboSpan" id="kobo.487.1"> method every five minutes. </span><span class="koboSpan" id="kobo.487.2">The following code is demonstrating how to fetch Temperature and Humidity values from </span><strong class="source-inline"><span class="koboSpan" id="kobo.488.1">dht</span></strong><span class="koboSpan" id="kobo.489.1"> object, and for </span><strong class="source-inline"><span class="koboSpan" id="kobo.490.1">airQuality</span></strong><span class="koboSpan" id="kobo.491.1"> we are simply using </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.492.1">analogRead()</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.493.1"> method.</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.494.1">
  dht.temperature().getEvent(&amp;event);
  if (isnan(event.temperature)) {
    temperature=0;
  }
  else {
    //Send Temperature to Cloud
    temperature=event.temperature;
  }
  // Get humidity event and print its value.
</span><span class="koboSpan" id="kobo.494.2">  dht.humidity().getEvent(&amp;event);
  if (isnan(event.relative_humidity)) {
    humidity=0;
  }
  else {
    //Send Humidity to Cloud
    humidity=event.relative_humidity;
  }
  //Send Air Quality to Cloud
  airQuality=analogRead(A0);</span></pre> <p><span class="koboSpan" id="kobo.495.1">The preceding code snippet was taken from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.496.1">STHAM</span></strong><span class="koboSpan" id="kobo.497.1"> method; here, we just modified the code to show you how we send values to the Arduino IoT Cloud after taking values from </span><span class="No-Break"><span class="koboSpan" id="kobo.498.1">the sensors.</span></span></p>
<p><span class="koboSpan" id="kobo.499.1">In a previous section, we created the cloud variables. </span><span class="koboSpan" id="kobo.499.2">Just recall the cloud variable declaration and assign the sensor readings to those variables. </span><span class="koboSpan" id="kobo.499.3">This cloud variable declaration is available in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.500.1">thingProperties.h</span></strong><span class="koboSpan" id="kobo.501.1"> file. </span><span class="koboSpan" id="kobo.501.2">So, when you assign the values to these variables, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.502.1">ArduinoCloud.update()</span></strong><span class="koboSpan" id="kobo.503.1"> method in the loop will automatically send data to </span><span class="No-Break"><span class="koboSpan" id="kobo.504.1">the cloud.</span></span></p>
<p><span class="koboSpan" id="kobo.505.1">Upload the code </span><a id="_idIndexMarker411"/><span class="koboSpan" id="kobo.506.1">to the device and verify the connectivity and readings. </span><span class="koboSpan" id="kobo.506.2">If you want to change the reading time, then just modify the </span><strong class="source-inline"><span class="koboSpan" id="kobo.507.1">interval</span></strong><span class="koboSpan" id="kobo.508.1"> variable value. </span><span class="koboSpan" id="kobo.508.2">Make sure you provide the time in milliseconds, where 1 second equals </span><span class="No-Break"><span class="koboSpan" id="kobo.509.1">1,000 milliseconds.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.510.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.511.1">If you used different naming in the variable declaration, then update the code according to your naming scheme. </span><span class="koboSpan" id="kobo.511.2">However, it’s better that you first follow all the steps according to the book and later change the cloud variable names and modify your code, in </span><span class="No-Break"><span class="koboSpan" id="kobo.512.1">that order.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.513.1">Never try to use </span><strong class="source-inline"><span class="koboSpan" id="kobo.514.1">delay</span></strong><span class="koboSpan" id="kobo.515.1"> method, which will create a block for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.516.1">ArduinoCloud.update()</span></strong><span class="koboSpan" id="kobo.517.1"> method. </span><span class="koboSpan" id="kobo.517.2">Always use milliseconds to calculate the waiting time. </span><span class="koboSpan" id="kobo.517.3">Review the </span><strong class="source-inline"><span class="koboSpan" id="kobo.518.1">loop()</span></strong><span class="koboSpan" id="kobo.519.1"> method to understand how we call the method after </span><span class="No-Break"><span class="koboSpan" id="kobo.520.1">5 minutes.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.521.1">The Arduino IoT Cloud only updates the value on the dashboard whenever a variable value is changed. </span><span class="koboSpan" id="kobo.521.2">For example, if the temperature is 30 and is still the same after 5 minutes, then the Arduino IoT Cloud will not record the value, so don’t get confused if values don’t change on a graph. </span><span class="koboSpan" id="kobo.521.3">This is another benefit of the Arduino IoT Cloud: you will not get duplicated data when you export </span><span class="No-Break"><span class="koboSpan" id="kobo.522.1">the content.</span></span></p>
<p><span class="koboSpan" id="kobo.523.1">We have successfully set up the Thing, which includes cloud variables, device association, network configuration, and code, and uploaded it to the development board. </span><span class="koboSpan" id="kobo.523.2">Now, it’s time to explore the dashboard and sensor values visualization in the </span><span class="No-Break"><span class="koboSpan" id="kobo.524.1">following section.</span></span></p>
<h1 id="_idParaDest-98"><a id="_idTextAnchor098"/><span class="koboSpan" id="kobo.525.1">Setting up a dashboard for web and mobile</span></h1>
<p><span class="koboSpan" id="kobo.526.1">After </span><a id="_idIndexMarker412"/><span class="koboSpan" id="kobo.527.1">uploading the code to the device, it’s time to set up a dashboard for web and mobile to visualize the data with different widgets. </span><span class="koboSpan" id="kobo.527.2">Complete details about widgets and their usage are available in </span><a href="B19752_03.xhtml#_idTextAnchor056"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.528.1">Chapter 3</span></em></span></a><span class="koboSpan" id="kobo.529.1">. </span><span class="koboSpan" id="kobo.529.2">If you have directly skipped to this chapter, I recommend going back to </span><a href="B19752_03.xhtml#_idTextAnchor056"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.530.1">Chapter 3</span></em></span></a><span class="koboSpan" id="kobo.531.1"> to get a detailed overview of widgets and their usage as this will help you to understand how widgets work and their usage for different use cases. </span><span class="koboSpan" id="kobo.531.2">The following figure demonstrates the visualization of readings with </span><span class="No-Break"><span class="koboSpan" id="kobo.532.1">different widgets:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer071">
<span class="koboSpan" id="kobo.533.1"><img alt="Figure 4.10 – The Thing dashboard" src="image/B19752_04_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.534.1">Figure 4.10 – The Thing dashboard</span></p>
<p><span class="koboSpan" id="kobo.535.1">We have three</span><a id="_idIndexMarker413"/><span class="koboSpan" id="kobo.536.1"> different readings, </span><strong class="bold"><span class="koboSpan" id="kobo.537.1">Temperature</span></strong><span class="koboSpan" id="kobo.538.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.539.1">Humidity</span></strong><span class="koboSpan" id="kobo.540.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.541.1">Air Quality</span></strong><span class="koboSpan" id="kobo.542.1">. </span><span class="koboSpan" id="kobo.542.2">For each reading, we use different widget controls to demonstrate how they all work, but for historical data, graphs are the </span><span class="No-Break"><span class="koboSpan" id="kobo.543.1">best widgets.</span></span></p>
<p><span class="koboSpan" id="kobo.544.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.545.1">Temperature</span></strong><span class="koboSpan" id="kobo.546.1"> reading is visualized by </span><strong class="bold"><span class="koboSpan" id="kobo.547.1">Gauge</span></strong><span class="koboSpan" id="kobo.548.1">, the </span><strong class="bold"><span class="koboSpan" id="kobo.549.1">Humidity</span></strong><span class="koboSpan" id="kobo.550.1"> reading is connected to the </span><strong class="bold"><span class="koboSpan" id="kobo.551.1">Percentage</span></strong><span class="koboSpan" id="kobo.552.1"> widget, and the </span><strong class="bold"><span class="koboSpan" id="kobo.553.1">Air Quality</span></strong><span class="koboSpan" id="kobo.554.1"> reading is connected to the </span><strong class="bold"><span class="koboSpan" id="kobo.555.1">Value</span></strong><span class="koboSpan" id="kobo.556.1"> widget. </span><span class="koboSpan" id="kobo.556.2">These widgets are only capable of displaying current readings of sensors. </span><span class="koboSpan" id="kobo.556.3">However, we also want to monitor the historical data, and graphs are the best widgets to display live as well as older data. </span><span class="koboSpan" id="kobo.556.4">Here, we have used three graphs, and each one is connected to a specific </span><span class="No-Break"><span class="koboSpan" id="kobo.557.1">cloud variable.</span></span></p>
<h1 id="_idParaDest-99"><a id="_idTextAnchor099"/><span class="koboSpan" id="kobo.558.1">What’s next?</span></h1>
<p><span class="koboSpan" id="kobo.559.1">We still have a lot of options available to explore, but now it’s your turn to use different sensors and development boards to do some more experiments and learn from them. </span><span class="koboSpan" id="kobo.559.2">In this chapter, we have only used two sensors, which only offer three parameters, but there are a lot of sensors on the market that provide a wide variety of functionalities, such as air pressure and measurements for </span><span class="No-Break"><span class="koboSpan" id="kobo.560.1">different gases.</span></span></p>
<p><span class="koboSpan" id="kobo.561.1">Try out the following sensors to enhance your practical knowledge and compare them with other sensors in terms of features, range, </span><span class="No-Break"><span class="koboSpan" id="kobo.562.1">and cost:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.563.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.564.1">BMP280</span></strong><span class="koboSpan" id="kobo.565.1"> (pressure and</span><a id="_idIndexMarker414"/> <span class="No-Break"><span class="koboSpan" id="kobo.566.1">temperature) sensor</span></span></li>
<li><span class="koboSpan" id="kobo.567.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.568.1">MH-Z19C/D/E series</span></strong><span class="koboSpan" id="kobo.569.1"> sensors</span><a id="_idIndexMarker415"/><span class="koboSpan" id="kobo.570.1"> for carbon </span><span class="No-Break"><span class="koboSpan" id="kobo.571.1">dioxide monitoring</span></span></li>
<li><span class="koboSpan" id="kobo.572.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.573.1">MQ series</span></strong><span class="koboSpan" id="kobo.574.1"> sensors, which</span><a id="_idIndexMarker416"/><span class="koboSpan" id="kobo.575.1"> are designed to sense different specific gases, including MQ-2, MQ-3, MQ-4, MQ-5, MQ-7, MQ-8, </span><span class="No-Break"><span class="koboSpan" id="kobo.576.1">and MQ-9</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.577.1">Seeed Studio SCD30</span></strong><span class="koboSpan" id="kobo.578.1"> (temperature, humidity, </span><span class="No-Break"><span class="koboSpan" id="kobo.579.1">and </span></span><span class="No-Break"><a id="_idIndexMarker417"/></span><span class="No-Break"><span class="koboSpan" id="kobo.580.1">CO</span></span><span class="No-Break"><span class="subscript"><span class="koboSpan" id="kobo.581.1">2</span></span></span><span class="No-Break"><span class="koboSpan" id="kobo.582.1">)</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.583.1">Gravity</span></strong><span class="koboSpan" id="kobo.584.1">: </span><strong class="bold"><span class="koboSpan" id="kobo.585.1">Analog Electrochemical Carbon Dioxide Sensor</span></strong><span class="koboSpan" id="kobo.586.1"> (</span><span class="No-Break"><span class="koboSpan" id="kobo.587.1">0–10,000 </span></span><span class="No-Break"><a id="_idIndexMarker418"/></span><span class="No-Break"><span class="koboSpan" id="kobo.588.1">PPM)</span></span></li>
</ul>
<h1 id="_idParaDest-100"><a id="_idTextAnchor100"/><span class="koboSpan" id="kobo.589.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.590.1">In this chapter, we explored how to develop a low-cost air quality monitoring system using DHT11, MQ-135, and the WeMos D1 Mini development board. </span><span class="koboSpan" id="kobo.590.2">We set up the Thing, which involved creating cloud variables, associating the device, configuring the network, and coding the development board. </span><span class="koboSpan" id="kobo.590.3">Later, we created a dashboard to visualize the Thing’s sensor readings with different types of widgets, displaying the current readings as well as historical data with the help of graphs. </span><span class="koboSpan" id="kobo.590.4">Through this project, you will get the confidence to set up the Thing practically and deploy it in the field using a PCB. </span><span class="koboSpan" id="kobo.590.5">You have learned about new types of cloud variables for sensor readings and storage, as well as dealing with different types of </span><span class="No-Break"><span class="koboSpan" id="kobo.591.1">dashboard widgets.</span></span></p>
<p><span class="koboSpan" id="kobo.592.1">In the next chapter, we will study GSM technology for IoT. </span><span class="koboSpan" id="kobo.592.2">We will learn about different types of global IoT SIM cards and their usage. </span><span class="koboSpan" id="kobo.592.3">This project will also demonstrate a Smart Assets tracing example, where we will track the asset with a GPS module and send the data to the Arduino IoT Cloud via global IoT SIM cards. </span><span class="koboSpan" id="kobo.592.4">In the end, you will also learn about new widgets in the Arduino IoT Cloud to visualize the location of your assets on the basis of </span><span class="No-Break"><span class="koboSpan" id="kobo.593.1">GPS coordinates.</span></span></p>
</div>
</body></html>