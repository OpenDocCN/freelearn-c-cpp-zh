<html><head></head><body>
        

                            
                    <h1 class="header-title">Servo Motors</h1>
                
            
            
                
<p>When power is supplied to a brushed DC motor, it will begin to continuously spin until the power is cut off. This makes brushed DC motors very good for such items as turning the wheels on a robot or the blades on a fan. There are times when we need more precise control over how much the motor turns. For example, to control a robotic arm, we would need the motors to turn at a precise amount to put the arm where it needs to be. For applications like this, we can use a servo motor.</p>
<p>In this chapter, you will learn:</p>
<ul>
<li>How to control a servo motor</li>
<li>How to use the Arduino servo library</li>
<li>How to power a servo motor</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Introduction</h1>
                
            
            
                
<p>The types of servo motors that we will use with the Arduino are pretty small, but most have fairly high torque and are very energy efficient. This allows us to use these motors for industrial-grade applications such as robotic arms, conveyor belts, autofocus lenses in cameras and even solar-tracking systems for solar panels.</p>
<p class="mce-root"/>
<p>A servo motor is made up of a DC motor, which does the actual work; a potentiometer, which controls the amount of power going to the motor; control circuitry, which controls the movement of the motor and gears. The following photograph shows a servo motor connected to a robotic claw:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/13c29d50-863c-4366-8b5c-c06f6c40962e.png" style="width:23.92em;height:23.25em;"/></p>
<p>A servo motor contains three wires for the control signal, power and ground. The signal wire is usually orange or yellow. The power is the usual red, and the ground wire is usually brown or black.</p>
<p>Some smaller servo motors can use the 5V out on the Arduino; however, in this chapter, I will be using the <strong>MG996R high torque motor</strong>, which can handle up to 7.2V and has a running current of 500mA to 900mA. Therefore, we will be connecting it to an external 6V battery pack that contains 4 AA batteries. I would recommend referring to the datasheet for your servo motor to determine the correct power input for your servo motor.</p>
<div><strong>NOTE</strong>: While some of the smaller motors can be powered by the 5V out, I would recommend using an external power source anytime you are powering motors.</div>
<p>The ground wire should be connected to a common ground that is shared with the battery pack and also the Arduino ground. The signal wire should be connected to a PWM out pin on the Arduino.</p>
<p>The duty cycle from the PWM pin determines the position of the servo shaft. When the shaft of the servo motor is at the desired position, the power supplied to the motor is cut off. The speed that the motor will spin at is proportional to the difference in the actual position and the desired position, which means the further the desired position is from the actual position, the faster the motor will spin. This makes the servo motor very efficient because it only works as hard as it needs to.</p>
<p>Different servo motors have different maximum turn radiuses. The turn radius of most servo motors is either 120 degrees (60 degrees each direction) or 180 degrees (90 degrees each direction). The MG996R servo motor that I will be using in this chapter has a maximum turn radius of 120 degrees. Once a servo motor rotates to the desired position, it will attempt to hold that position and will resist any attempt to push it out of position.</p>
<p>Let's look at the components we will need for this chapter's project.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Components needed</h1>
                
            
            
                
<p>In this chapter, you will need the following components:</p>
<ul>
<li>One Arduino Uno or compatible board</li>
<li>One servo motor (the code has been tested with the MG996R servo. However, any standard servo should work)</li>
<li>One potentiometer</li>
<li>One 4 AA battery holder with batteries to power the servo motor</li>
<li>Jumper wires</li>
<li>One breadboard</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Circuit diagrams</h1>
                
            
            
                
<p>The following diagram shows how to connect the servo motor with the Arduino:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/a45ffdce-bc90-4771-9221-c2fcb039a3fa.png" style="width:34.92em;height:31.75em;"/></p>
<p>In this project, we will use the potentiometer to control the position of the servo motor. Notice that the potentiometer uses the 5V power source from the Arduino while the servo motor uses 6V (4 × 1.5V) from the batteries; however, the two power sources share a common ground. Now let's look at the code to control the servo motor.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Code</h1>
                
            
            
                
<p>Both the Arduino IDE and Web Editor come with a servo library that we can use simply by including the header file. The following code will do this:</p>
<pre>#include &lt;Servo.h&gt;</pre>
<p>Next, we need to define the pin that the servo motor and the potentiometer are connected to. The following code will connect the signal wire to the digital <kbd>3</kbd> pin and the potentiometer to the analog <kbd>0</kbd> pin on the Arduino:</p>
<pre>#define SERVO0_POT 0
#define SERVO0_OUT 3 </pre>
<p>Now we need to define an instance of the <kbd>Servo</kbd> type as shown in the following line:</p>
<pre>Servo servo0;</pre>
<p>Within the <kbd>setup</kbd> function, we need to call the <kbd>attach()</kbd> method from the <kbd>servo</kbd> instance to initialize the instance and to tell it what pin the servo is attached to. The following code shows this:</p>
<pre>void setup() {
  servo0.attach(SERVO0_OUT);
}</pre>
<p>We will want to define a function that will read the potentiometer and set the position of the servo position based on how much the potentiometer is turned.</p>
<pre>void setServo(int pot, Servo out) {
  int servo = analogRead(pot);   
  long int servo_val = map(servo, 0, 1023, 0, 120);
  out.write(servo_val);
}</pre>
<p>This function will accept an integer, which is the pin that the potentiometer is connected to. The <kbd>analogRead()</kbd> function is called to read the pin that the potentiometer is connected to. We use the <kbd>map()</kbd> function to map the value that was read from the analog pin (values from 0-1023) with the 120 degrees that the servo motor can move. The <kbd>write()</kbd> function from the servo type is then used to write that value to the servo, causing the servo to adjust its position.</p>
<p>The <kbd>setServo()</kbd> function is then called from the <kbd>loop()</kbd> function to read the potentiometer and set the servo as shown in the following code:</p>
<pre>setServo(SERVO0_POT, servo0);
delay(15); </pre>
<p>The reason we created the <kbd>setServo()</kbd> function, rather than putting that code directly in the <kbd>loop()</kbd> function, is it makes it a lot easier to add multiple servo motors. For example, if we want to create a robotic arm with five servos, we could very easily do it by setting up the servos as we did with the first one and then using the following code in the <kbd>setup()</kbd> function:</p>
<pre>setServo(SERVO0_POT, servo0);
setServo(SERVO1_POT, servo1);
setServo(SERVO2_POT, servo2);
setServo(SERVO3_POT, servo3);
setServo(SERVO4_POT, servo4);
delay(15);</pre>
<p>If we have the code, like the code in the <kbd>setServo()</kbd> function that may be used multiple times, it is always a good idea to put that code in a separate function like this.</p>
<p>If this project is run, the position of the servo will change as the potentiometer is turned.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Challenge</h1>
                
            
            
                
<p>For the challenge in this chapter, you will need a 6 <strong>DOF</strong> (<strong>Degree of Freedom</strong>) robotic arm. The following image show what a 6 DOF robotic arm looks like:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/642aec12-9453-4157-8add-abfbe9e9fe7b.png" style="width:29.50em;height:22.17em;"/></p>
<p>For this challenge, you will need to figure out how to wire the remaining servo motors to the Arduino and the correct power configuration. You can order 6 DOF robotic arm kits from Amazon or eBay. Go to their site and do a search for <kbd>6 DOF robotic arm</kbd>. Prices for these kits varies greatly depending on the size and power of the arm/claw. You can get the robotic arms prebuilt, or as a kit that you need to build yourself.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Summary</h1>
                
            
            
                
<p>In this chapter, we learned how a servo motor works and how we can control them with an Arduino. We also saw what components make up a servo motor. In the next chapter, we will see how to use a relay board.</p>


            

            
        
    </body></html>