<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Using MySQL Database</h1>
                </header>
            
            <article>
                
<p><span>MySQL is one of the most popular database management systems in recent times</span>. Databases, as we all know,<span> </span>are<span> used for storing data that's going to be used in </span>the future<span> when required. The data in a </span>database<span> can be secured through encryption and can be indexed for faster access. Where the </span>volume<span> of data is too high, a </span>database<span> management system is preferred over a traditional sequential and random file handling system. Storing data in a database is a very important task in any application.</span></p>
<p>This chapter is focused on understanding how table rows are managed in the database tables. In this chapter, you will learn about the following recipes:</p>
<ul>
<li>Displaying all the built-in tables in a default MySQL database</li>
<li>Storing information into MySQL database</li>
<li>Searching desired information in the database</li>
<li>Updating information in the database</li>
<li>Deleting data from the database using C</li>
</ul>
<p class="mce-root">We will review the most commonly used functions in MySQL before we move on to the recipes. Also, ensure that you read <em>Appendix B</em> and <em>Appendix C</em> to install Cygwin and MySQL Server before implementing the recipes in this chapter.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Functions in MySQL</h1>
                </header>
            
            <article>
                
<p>While accessing and working with MySQL database in C programming, we will have to use several functions. Let's go through them.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">mysql_init()</h1>
                </header>
            
            <article>
                
<p>This initializes a <kbd>MYSQL</kbd> object that can be used in the <kbd>mysql_real_connect()</kbd> method. Here is its syntax:</p>
<pre>MYSQL *mysql_init(MYSQL *object)</pre>
<p>If the object parameter that's passed is <kbd>NULL</kbd>, then the function initializes and returns a new object; otherwise, the supplied object is initialized and the address of the object is returned.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">mysql_real_connect()</h1>
                </header>
            
            <article>
                
<p>This establishes a connection to a MySQL database engine running on the specified host. <span>Here is its syntax</span>:</p>
<pre>MYSQL *mysql_real_connect(MYSQL *mysqlObject, const char *hostName, const char *userid, const char *password, const char *dbase, unsigned int port, const char *socket, unsigned long flag)</pre>
<p>Here:</p>
<ul>
<li><kbd>mysqlObject</kbd> represents the address of an existing <kbd>MYSQL</kbd> object.</li>
<li><kbd>hostName</kbd> is where the hostname or IP address of the host is provided. To connect to a local host, either <kbd>NULL</kbd> or the string <em>localhost</em> is provided.</li>
<li><kbd>userid</kbd> represents a valid MySQL login ID.</li>
<li><kbd>password</kbd> represents the password of the user.</li>
<li><kbd>dbase</kbd> represents the database name to which the connection has to be established.</li>
<li><kbd>port</kbd> is where either value <span><kbd>0</kbd>  </span>is specified or the port number for the TCP/IP connection is supplied.</li>
<li><kbd>socket</kbd>is where either <kbd>NULL</kbd> is specified or the socket or named pipe is supplied.</li>
<li><kbd>flag</kbd> can be used to enable certain features, such as handling expired passwords and applying compression in the client/server protocol, but <span>its value is usually kept at <kbd>0</kbd>.</span></li>
</ul>
<p>The function returns a <kbd>MYSQL</kbd> connection handler if the connection is established; otherwise, it returns <kbd>NULL</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">mysql_query()</h1>
                </header>
            
            <article>
                
<p>This function executes the supplied SQL query. Here is its syntax:</p>
<pre>int mysql_query(MYSQL *mysqlObject, const char *sqlstmt)</pre>
<p>Here:</p>
<ul>
<li><kbd>mysqlObject</kbd> represents the <kbd>MYSQL</kbd> object</li>
<li><kbd>sqlstmt</kbd> represents the null-terminated string that contains the SQL statement to be executed</li>
</ul>
<p>The function returns <kbd>0</kbd> if the SQL statement executes successfully; otherwise, it returns a non-zero value.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">mysql_use_result()</h1>
                </header>
            
            <article>
                
<p>After successful execution of an SQL statement, this method is used to save the result set. This means that the result set is retrieved and returned. <span>Here is its syntax</span>:</p>
<pre>MYSQL_RES *mysql_use_result(MYSQL *mysqlObject)</pre>
<p>Here,  <kbd>mysqlObject</kbd> represents the connection handler.</p>
<p>If no error occurs, the function returns a <kbd>MYSQL_RES</kbd> result structure. In case of any error, the function returns <kbd>NULL</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">mysql_fetch_row()</h1>
                </header>
            
            <article>
                
<p>This function fetches the next row from a result set. The function returns <kbd>NULL</kbd> if there are no more rows in the result set to retrieve or if an error occurs. <span>Here is its syntax</span>:</p>
<pre>MYSQL_ROW mysql_fetch_row(MYSQL_RES *resultset)</pre>
<p>Here, the <kbd>resultset</kbd> <span>parameter </span>is the set from which the next row has to be fetched. You can access values in the column of the row by using the subscript <kbd>row[0]</kbd>, <kbd>row[1]</kbd>, and so on, where <kbd>row[0]</kbd> represents the data in the first column, <kbd>row[1]</kbd> represents the data in the second column, and so on.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">mysql_num_fields()</h1>
                </header>
            
            <article>
                
<p>This returns the number of values; that is, columns in the supplied row. <span>Here is its syntax</span>:</p>
<pre>unsigned int mysql_num_fields(MYSQL_ROW row)</pre>
<p>Here, the parameter row represents the individual row that is accessed from the <kbd>resultset</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">mysql_free_result()</h1>
                </header>
            
            <article>
                
<p>This frees the memory allocated to a result set. <span>Here is its syntax</span>:</p>
<pre>void mysql_free_result(MYSQL_RES *resultset)</pre>
<p>Here, <kbd>resultset</kbd> represents the set whose memory we want to free up.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">mysql_close()</h1>
                </header>
            
            <article>
                
<p>This function closes the previously opened MySQL connection. <span>Here is its syntax</span>:</p>
<pre>void mysql_close(MYSQL *mysqlObject)</pre>
<p>It de-allocates the connection handler that's represented by the <kbd>mysqlObject</kbd> parameter. The function returns no value.</p>
<p>This covers the functions that we need to know for using the MySQL database for our recipes. From the second recipe onward, we will be working on a database table. So, let's get started and create a database and a table inside it.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a MySQL database and tables</h1>
                </header>
            
            <article>
                
<p>Open the Cygwin Terminal and open the MySQL command line by giving the following command. Through this command, we want to open MySQL through the user ID root and try to connect with the MySQL server running at the localhost (<kbd>127.0.0.1</kbd>):</p>
<pre><strong>$ mysql -u root -p -h 127.0.0.1   </strong><br/><strong>Enter password: </strong><br/><strong>Welcome to the MariaDB monitor.  Commands end with ; or \g.</strong><br/><strong>Your MySQL connection id is 12</strong><br/><strong>Server version: 5.7.14-log MySQL Community Server (GPL)</strong><br/><strong>Copyright (c) 2000, 2017, Oracle, MariaDB Corporation Ab and others.</strong><br/><strong>Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.  </strong><br/><strong>MySQL [(none)]&gt;  </strong>                                                  </pre>
<p>The preceding MySQL prompt that appears confirms that the <kbd>userid</kbd> and <kbd>password</kbd> have been entered correctly and that you are successfully connected to a running MySQL server. Now, we can go ahead and run SQL commands.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Create database</h1>
                </header>
            
            <article>
                
<p>The <kbd>create database</kbd> statement creates the database with the specified name. Here is the syntax:</p>
<pre><strong>Create database database_name;</strong></pre>
<p>Here, <kbd>database_name</kbd> is the name of the new database to be created.</p>
<p>Let's create a database by the name <kbd>ecommerce</kbd> for our recipes:</p>
<pre><strong>MySQL [(none)]&gt; create database ecommerce; </strong><br/><strong>Query OK, 1 row affected (0.01 sec)         </strong>                                   </pre>
<p>To confirm that our <kbd>ecommerce</kbd> database has been successfully created, we will use the <kbd>show databases</kbd> statement to see the list of existing databases on the MySQL server:</p>
<pre><strong>MySQL [(none)]&gt; show databases; </strong><br/><strong>+--------------------+</strong><br/><strong>| Database           | </strong><br/><strong>+--------------------+</strong><br/><strong>| information_schema |     </strong><br/><strong>| ecommerce          |  </strong><br/><strong>| mysql              |  </strong><br/><strong>| performance_schema | </strong><br/><strong>| sakila             |</strong><br/><strong>| sys                | </strong><br/><strong>| world              |</strong><br/><strong>+--------------------+</strong><br/><strong>8 rows in set (0.00 sec)   </strong>                      </pre>
<p>In the preceding database listing, we can see the name <kbd>ecommerce</kbd>, which confirms that our database has been successfully created. Now, we will apply the <kbd>use</kbd> statement to access the <kbd>ecommerce</kbd> database, as shown here:                          </p>
<pre><strong>MySQL [(none)]&gt; use ecommerce;</strong><br/><strong>Database changed      </strong>  </pre>
<p>Now, the <kbd>ecommerce</kbd> database is in use, so whatever SQL commands we will give will be applied to the <kbd>ecommerce</kbd> database only. Next, we need to create a table in our <kbd>ecommerce</kbd> database. For creating a database table, the <kbd>Create table</kbd> command is used. Let's discuss it next.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Create table</h1>
                </header>
            
            <article>
                
<p>This creates a database table with the specified name. Here is its syntax:</p>
<pre><strong>CREATE TABLE table_name (column_name column_type,</strong><strong>column_name column_type,.....</strong><strong>);</strong></pre>
<p>Here:</p>
<ul>
<li><kbd>table_name</kbd> represents the name of the table that we want to create.</li>
<li><kbd>column_ name</kbd> represents the column names that we want in the table.</li>
<li><kbd>column_type</kbd> represents the data type of the column. Depending on the type of data<span> we want to store in the column, the <kbd>column_type</kbd> can</span> be <kbd>int</kbd>, <kbd><span>varchar</span></kbd><span>, <kbd>date</kbd>, <kbd>text</kbd>, and so on.</span></li>
</ul>
<p>The <kbd>create table</kbd> statement creates a <kbd>users</kbd> table with three columns: <kbd>email_address</kbd>, <kbd>password</kbd>, and <kbd>address_of_delivery</kbd>. Assuming that this table will contain information of the users who have placed orders online, we will be storing their email address, password, and the location where the order has to be delivered:</p>
<pre><strong>MySQL [ecommerce]&gt; create table users(email_address varchar(30), password varchar(30), address_of_delivery text);</strong><br/><strong>Query OK, 0 rows affected (0.38 sec)   </strong>                                        </pre>
<p>To confirm that the table has been successfully created, we will use the <kbd>show tables</kbd> command to display the list of existing tables in the currently opened database, as shown here:</p>
<pre><strong>MySQL [ecommerce]&gt; show tables;</strong><br/><strong>+---------------------+ </strong><br/><strong>| Tables_in_ecommerce | </strong><br/><strong>+---------------------+   </strong><br/><strong>| users               |  </strong><br/><strong>+---------------------+ </strong><br/><strong>1 row in set (0.00 sec)     </strong>    </pre>
<p>The output of the <kbd>show tables</kbd> command displays the <kbd>users</kbd> table, thus confirming that the table has indeed been created successfully. To see the table structure (that is, its column names, column types, and column width), we will use the <kbd>describe</kbd> statement. The following statement displays the structure of the <kbd>users</kbd> table:</p>
<pre><strong>MySQL [ecommerce]&gt; describe users;</strong><br/><strong>+---------------------+-------------+------+-----+---------+-------+</strong><br/><strong>| Field | Type | Null | Key | Default | Extra |</strong><br/><strong>+---------------------+-------------+------+-----+---------+-------+</strong><br/><strong>| email_address | varchar(30) | YES | | NULL | |</strong><br/><strong>| password | varchar(30) | YES | | NULL | |</strong><br/><strong>| address_of_delivery | text | YES | | NULL | |</strong><br/><strong>+---------------------+-------------+------+-----+---------+-------+</strong><br/><strong>3 rows in set (0.04 sec) </strong> </pre>
<p>So, now that we have learned about some basic commands to work with our database, we can begin with the first recipe of this chapter.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Displaying all the built-in tables in a default mysql database</h1>
                </header>
            
            <article>
                
<p>The MySQL server, when installed, comes with certain default databases. One of those databases is <kbd>mysql</kbd>. In this recipe, we will learn to display all the table names that are available in the <kbd>mysql</kbd> database.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Create a MySQL object:</li>
</ol>
<pre style="padding-left: 60px">mysql_init(NULL);</pre>
<ol start="2">
<li>Establish a connection to the MySQL server running at the specified host. Also, connect to the desired database:</li>
</ol>
<pre style="padding-left: 60px">mysql_real_connect(conn, server, user, password, database, 0, NULL, 0)</pre>
<ol start="3">
<li>Create an execute SQL statement, comprised of <kbd>show tables</kbd>:</li>
</ol>
<pre style="padding-left: 60px">mysql_query(conn, "show tables")</pre>
<ol start="4">
<li>Save the result of the executing SQL query (that is, the table information of the <kbd>mysql</kbd> database) into a <kbd>resultset</kbd>:</li>
</ol>
<pre style="padding-left: 60px">res = mysql_use_result(conn);</pre>
<ol start="5">
<li>Fetch one row at a time from the <kbd>resultset</kbd> in a <kbd>while</kbd> loop and display only the table name from that row:</li>
</ol>
<pre style="padding-left: 60px">while ((row = mysql_fetch_row(res)) != NULL)<br/>     printf("%s \n", row[0]);</pre>
<ol start="6">
<li>Free up the memory that is allocated to the <kbd>resultset</kbd>:</li>
</ol>
<pre style="padding-left: 60px">mysql_free_result(res);</pre>
<ol start="7">
<li>Close the opened connection handler:</li>
</ol>
<pre style="padding-left: 60px">mysql_close(conn);</pre>
<p>The <kbd><span>mysql1.c</span></kbd> program for displaying all the tables in the built-in <kbd>mysql</kbd> database is as follows:</p>
<pre>#include &lt;mysql/mysql.h&gt;<br/>#include &lt;stdio.h&gt;<br/>#include &lt;stdlib.h&gt;<br/><br/>void main() {<br/>     MYSQL *conn;<br/>     MYSQL_RES *res;<br/>     MYSQL_ROW row;<br/>     char *server = "127.0.0.1";<br/>     char *user = "root";<br/>     char *password = "Bintu2018$";<br/>     char *database = "mysql";<br/>     conn = mysql_init(NULL);<br/>     if (!mysql_real_connect(conn, server,<br/>         user, password, database, 0, NULL, 0)) {<br/>        fprintf(stderr, "%s\n", mysql_error(conn));<br/>        exit(1);<br/>    }<br/>    if (mysql_query(conn, "show tables")) {<br/>        fprintf(stderr, "%s\n", mysql_error(conn));<br/>        exit(1);<br/>    }<br/>    res = mysql_use_result(conn);<br/>    printf("MySQL Tables in mysql database:\n");<br/>    while ((row = mysql_fetch_row(res)) != NULL)<br/>        printf("%s \n", row[0]);<br/>    mysql_free_result(res);<br/>    mysql_close(conn);<br/>}</pre>
<p>Now, let's go behind the scenes to understand the code better.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>We will start by establishing a connection with the MySQL server and for that, we need to invoke the <kbd>mysql_real_connect</kbd> function. But we have to pass a <kbd>MYSQL</kbd> object to the <kbd>mysql_real_connect</kbd> function and we have to invoke the <span><kbd>mysql_init</kbd> function </span>to create the <kbd>MYSQL</kbd> object. Hence, the <kbd>mysql_init</kbd> function is first invoked to initialize a <kbd>MYSQL</kbd> object by the name <kbd>conn</kbd>.</p>
<p>We will then supply the <kbd>MYSQL</kbd> object <kbd>conn</kbd> to the <kbd>mysql_real_connect</kbd> function, along with the valid user ID, password, and the host details. The <kbd>mysql_real_connect</kbd> function will establish a connection to the MySQL server running at the specified host. Besides this, the function will link to the supplied <kbd>mysql</kbd> database and will declare <kbd>conn</kbd> as the connection handler. This means that <kbd>conn</kbd> will be used in the rest of the program whenever we want to perform some action to the specified MySQL server and the <kbd>mysql</kbd> database.</p>
<p>If any error occurs in establishing the connection to the MySQL database engine, the program will terminate after displaying an error message. If the connection to the MySQL database engine is established successfully, the <kbd>mysql_query</kbd> function is invoked and the SQL statement <kbd>show tables</kbd> and the connection handler <kbd>conn</kbd> are supplied to it. The <kbd>mysql_query</kbd> function will execute the supplied SQL statement. To save the resulting table information of the <kbd>mysql</kbd> database, the <kbd>mysql_use_result</kbd> function is invoked. The table information that's received from the <kbd>mysql_use_result</kbd> function will be assigned to <kbd>resultset</kbd> <kbd>res</kbd>.</p>
<p>Next, we will invoke the <kbd>mysql _fetch_row</kbd> function in a <kbd>while</kbd> loop that will extract one row at a time from the <kbd>resultset</kbd> <kbd>res</kbd>; that is, one table detail will be fetched at a time from the <kbd>resultset</kbd> and assigned to the array row. The array row will contain complete information of one table at a time. The table name stored in the <kbd>row[0]</kbd> subscript is displayed on the screen. With every iteration of the <kbd>while</kbd> loop, the next piece of table information is extracted from <kbd>resultset</kbd> <kbd>res</kbd> and assigned to the array <span>row</span>. Consequently, all the table names in the <kbd>mysql</kbd> database will be displayed on the screen.</p>
<p>Then, we will invoke the <kbd>mysql_free_result</kbd> function to free up the memory that is allocated to <kbd>resultset</kbd> <kbd>res</kbd> and, finally, we will invoke the <kbd>mysql_close</kbd> function to close the opened connection handler <kbd>conn</kbd>.</p>
<p>Let's use GCC to compile the <kbd>mysql1.c</kbd> program, as shown here:</p>
<pre><strong>$ gcc mysql1.c -o mysql1 -I/usr/local/include/mysql -L/usr/local/lib/mysql -lmysqlclient  </strong>        </pre>
<p>If you get no errors or warnings, that means the <kbd>mysql1.c</kbd> <span>program </span>has compiled into an executable file, <kbd>mysql1.exe</kbd>. Let's run this executable file:</p>
<pre><strong>$ ./mysql1 </strong><br/><strong>MySQL Tables in mysql database:                                                                         columns_priv                                                                      db                                                             </strong><br/><strong>engine_cost                                                                       event</strong><br/><strong>func</strong><br/><strong>general_log</strong><br/><strong>gtid_executed</strong><br/><strong>help_category</strong><br/><strong>help_keyword </strong><br/><strong>help_relation   </strong><br/><strong>help_topic</strong><br/><strong>innodb_index_stats</strong><br/><strong>innodb_table_stats</strong><br/><strong>ndb_binlog_index</strong><br/><strong>plugin</strong><br/><strong>proc</strong><br/><strong>procs_priv</strong><br/><strong>proxies_priv</strong><br/><strong>server_cost</strong><br/><strong><span>servers<br/>slave_master_info<br/>slave_relay_log_info<br/></span>slave_worker_info</strong><br/><strong><span>slow_log<br/>tables_priv<br/>time_zone<br/>time_zone_leap_second<br/>time_zone_name<br/>time_zone_transition <br/></span>time_zone_transition_type </strong><br/><strong>user             </strong></pre>
<p><em>Voila</em>! As you can see, the output shows the list of built-in tables in the <kbd>mysql</kbd> database. Now, let's move on to the next recipe!</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Storing information in MySQL database</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will learn how to insert a new row into the <kbd>users</kbd> table. Recall that at the beginning of this chapter, we created a database called <kbd>ecommerce</kbd>, and in that database, we created a table called <kbd>users</kbd> with the following columns:</p>
<pre>email_address varchar(30)<br/>password varchar(30) <br/>address_of_delivery text  </pre>
<p>We will be inserting rows into this <kbd>users</kbd> table now.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<ol>
<li>Initialize a MYSQL object:</li>
</ol>
<pre style="padding-left: 60px">conn = mysql_init(NULL);</pre>
<ol start="2">
<li>Establish a connection to the MySQL server running at the localhost. Also, connect to the database that you want to work on:</li>
</ol>
<pre style="padding-left: 60px">mysql_real_connect(conn, server, user, password, database, 0, NULL, 0)</pre>
<ol start="3">
<li>Enter the information of the new row that you want to insert into the <kbd>users</kbd> table in the <kbd>ecommerce</kbd> database, which will be for the new user's email address, password, and address of delivery:</li>
</ol>
<pre style="padding-left: 60px">printf("Enter email address: ");<br/>scanf("%s", emailaddress);<br/>printf("Enter password: ");<br/>scanf("%s", upassword);<br/>printf("Enter address of delivery: ");<br/>getchar();<br/>gets(deliveryaddress);</pre>
<ol start="4">
<li>Prepare an SQL <kbd>INSERT</kbd> statement comprising this information; that is, the email address, password, and address of delivery of the new user:</li>
</ol>
<pre style="padding-left: 60px">strcpy(sqlquery,"INSERT INTO users(email_address, password, address_of_delivery)VALUES (\'");<br/>strcat(sqlquery,emailaddress);<br/>strcat(sqlquery,"\', \'");<br/>strcat(sqlquery,upassword);<br/>strcat(sqlquery,"\', \'");<br/>strcat(sqlquery,deliveryaddress);<br/>strcat(sqlquery,"\')");</pre>
<ol start="5">
<li>Execute the SQL <kbd>INSERT</kbd> statement to insert a new row into the <kbd>users</kbd> table in the <kbd>ecommerce</kbd> database:</li>
</ol>
<pre style="padding-left: 60px">mysql_query(conn, sqlquery)</pre>
<ol start="6">
<li>Close the connection handler:</li>
</ol>
<pre style="padding-left: 60px">mysql_close(conn);</pre>
<p>The <span><kbd>adduser.c</kbd> </span>program for inserting a row into a MySQL database table is shown in the following code:</p>
<pre style="padding-left: 30px">#include &lt;mysql/mysql.h&gt;<br/>#include &lt;stdio.h&gt;<br/>#include &lt;stdlib.h&gt;<br/>#include &lt;string.h&gt;<br/><br/>void main() {<br/>    MYSQL *conn;<br/>    char *server = "127.0.0.1";<br/>    char *user = "root";<br/>    char *password = "Bintu2018$";<br/>    char *database = "ecommerce";<br/>    char emailaddress[30], <br/>    upassword[30],deliveryaddress[255],sqlquery[255];<br/>    conn = mysql_init(NULL);<br/>    if (!mysql_real_connect(conn, server, user, password, database, 0, <br/>    NULL, 0)) {<br/>        fprintf(stderr, "%s\n", mysql_error(conn));<br/>        exit(1);<br/>    }<br/>    printf("Enter email address: ");<br/>    scanf("%s", emailaddress);<br/>    printf("Enter password: ");<br/>    scanf("%s", upassword);<br/>    printf("Enter address of delivery: ");<br/>    getchar();<br/>    gets(deliveryaddress);<br/>    strcpy(sqlquery,"INSERT INTO users(email_address, password, <br/>    address_of_delivery)VALUES (\'");<br/>    strcat(sqlquery,emailaddress);<br/>    strcat(sqlquery,"\', \'");<br/>    strcat(sqlquery,upassword);<br/>    strcat(sqlquery,"\', \'");<br/>    strcat(sqlquery,deliveryaddress);<br/>    strcat(sqlquery,"\')");<br/>    if (mysql_query(conn, sqlquery) != 0)               <br/>    { <br/>        fprintf(stderr, "Row could not be inserted into users<br/>    table\n");<br/>        exit(1);<br/>    } <br/>    printf("Row is inserted successfully in users table\n");<br/>    mysql_close(conn);<br/>}</pre>
<p>Now, let's go behind the scenes to understand the code better.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>We start by invoking the <kbd>mysql_init</kbd> function to initialize a <kbd>MYSQL</kbd> object by the name <kbd>conn</kbd>. The initialized <kbd>MYSQL</kbd> object <kbd>conn</kbd> is then supplied for invoking the <kbd>mysql_real_connect</kbd> function, along with the valid user ID and password, which in turn will establish a connection to the MySQL server running on the localhost. In addition, the function will link to our <kbd>ecommerce</kbd> database.</p>
<p>If any error occurs in establishing the connection to the MySQL database engine, an error message will be displayed and the program will terminate. If the connection to the MySQL database engine is established successfully, then <kbd>conn</kbd> will act as a connection handler for the rest of the program.</p>
<p>You will be prompted to enter information for the new row that you want to insert into the <kbd>users</kbd> table in the <kbd>ecommerce</kbd> database. You will be prompted to enter the information for the new row: the email address, password, and address of delivery. We will create an SQL <kbd>INSERT</kbd> statement comprising this information (email address, password, and address of delivery), which is supposed to be entered by users. Thereafter, we will invoke the <kbd>mysql_query</kbd> function and pass the MySQL object <kbd>conn</kbd> and the SQL <kbd>INSERT</kbd> statements to it to execute the SQL statement and insert a new row into the <kbd>users</kbd> table.</p>
<p>If any error occurs while executing the <kbd>mysql_query</kbd> function, an error message will be displayed on the screen and the program will terminate. If the new row is successfully inserted into the <kbd>users</kbd> table, the message <kbd>Row is inserted successfully in users table</kbd> will be displayed on the screen. Finally, we will invoke the <kbd>mysql_close</kbd> function and pass the connection handler <kbd>conn</kbd> to it to close the connection handler.</p>
<p>Let's open the Cygwin Terminal. We will require two Terminal windows; on one window, we will run SQL commands and on the other, we will compile and run C. Open another Terminal window by pressing <em>Alt+F2</em>. In the first Terminal window, invoke the MySQL command line by using the following command:</p>
<pre><strong>$ mysql -u root -p -h 127.0.0.1</strong><br/><strong>Enter password:</strong><br/><strong>Welcome to the MariaDB monitor.  Commands end with ; or \g. </strong><br/><strong>Your MySQL connection id is 27 </strong><br/><strong>Server version: 5.7.14-log MySQL Community Server (GPL)      </strong><br/><strong>Copyright (c) 2000, 2017, Oracle, MariaDB Corporation Ab and others.         </strong><br/><strong>Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</strong> </pre>
<p>To work with our <kbd>ecommerce</kbd> database, we need to make it the current database. So, open the <kbd>ecommerce</kbd> database by using the following command:</p>
<pre><strong>MySQL [(none)]&gt; use ecommerce;</strong><br/><strong>Reading table information for completion of table and column names</strong><br/><strong>You can turn off this feature to get a quicker startup with -A    </strong><br/><strong>Database changed </strong>         </pre>
<p>Now, <kbd>ecommerce</kbd> is our current database; that is, whatever SQL commands we will execute will be applied to the <kbd>ecommerce</kbd> database only. Let's use the following SQL <kbd>SELECT</kbd> command to see the existing rows in the <kbd>users</kbd> database table:</p>
<pre><strong>MySQL [ecommerce]&gt; select * from users;</strong><br/><strong>Empty set (0.00 sec) </strong> </pre>
<p>The given output confirms that the <kbd>users</kbd> table is currently empty. To compile the C program, switch to the second Terminal window. Let's use GCC to compile the <kbd>adduser.c</kbd> program, as shown here:</p>
<pre><strong>$ gcc adduser.c -o adduser -I/usr/local/include/mysql -L/usr/local/lib/mysql -lmysqlclient    </strong>    </pre>
<p>If you get no errors or warnings, that means the <kbd>adduser.c</kbd> <span>program </span>has compiled into an executable file, <kbd>adduser.exe</kbd>. Let's run this executable file:</p>
<pre><strong>$./adduser </strong><br/><strong>Enter email address: bmharwani@yahoo.com </strong><br/><strong>Enter password: gold </strong><br/><strong>Enter address of delivery: 11 Hill View Street, New York, USA</strong><br/><strong>Row is inserted successfully in users table</strong> </pre>
<p>The given C program output confirms that the new row has been successfully added to the <kbd>users</kbd> database table. To confirm this, switch to the Terminal window where the MySQL command line is open and use the following command:</p>
<pre><strong>MySQL [ecommerce]&gt; select * from users;</strong><br/><strong>+---------------------+----------+------------------------------------+</strong><br/><strong>| email_address       | password | address_of_delivery                |</strong><br/><strong>+---------------------+----------+------------------------------------+</strong><br/><strong>| bmharwani@yahoo.com | gold     | 11 Hill View Street, New York, USA | </strong><br/><strong>+---------------------+----------+------------------------------------+  </strong><br/><strong>1 row in set (0.00 sec) </strong>  </pre>
<p><em>Voila</em>! The given output confirms that the new row that was entered through C has been successfully inserted into the <kbd>users</kbd> database table.</p>
<p>Now, let's move on to the next recipe!                                                     </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Searching for the desired information in the database</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will learn how to search for information in a database table. Again, we assume that a <kbd>users</kbd> table comprising three columns, <kbd>email_address</kbd>, <kbd>password</kbd>, and <kbd>address_of_delivery</kbd>, already exists (please see the section, <em>Creating a MySQL database and tables</em>, of this chapter, where we created an <kbd>ecommerce</kbd> database and a <kbd>users</kbd> table in it). On entering an email address, the recipe will search the entire <kbd>users</kbd> database table for it, and if any row is found that matches the supplied email address, that user's password and address of delivery will be displayed on the screen.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<ol>
<li>Initialize a MYSQL object:</li>
</ol>
<pre style="padding-left: 60px">mysql_init(NULL);</pre>
<ol start="2">
<li>Establish a connection to the MySQL server running at the specified host. Also, establish a connection to the <kbd>ecommerce</kbd> database:</li>
</ol>
<pre style="padding-left: 60px">mysql_real_connect(conn, server, user, password, database, 0, NULL, 0)</pre>
<ol start="3">
<li>Enter the email address of the user whose details you want to search for:</li>
</ol>
<pre style="padding-left: 60px">printf("Enter email address to search: ");<br/>scanf("%s", emailaddress);</pre>
<ol start="4">
<li>Create an SQL <kbd>SELECT</kbd> statement that searches the row in the <kbd>users</kbd> table that matches the email address that was entered by the user:</li>
</ol>
<pre style="padding-left: 60px">strcpy(sqlquery,"SELECT * FROM users where email_address like \'");<br/>strcat(sqlquery,emailaddress);<br/>strcat(sqlquery,"\'");</pre>
<ol start="5">
<li>Execute the SQL <kbd>SELECT</kbd> statement. Terminate the program if the SQL query does not execute or some error occurs:</li>
</ol>
<pre style="padding-left: 60px">if (mysql_query(conn, sqlquery) != 0)                                 <br/>{                                                                                                                                fprintf(stderr, "No row found in the users table with this email     address\n");                                                             <br/>    exit(1);                                                                                     }  </pre>
<ol start="6">
<li>If the SQL query executes successfully then the row(s) that matches the specified email address are retrieved and assigned to a <kbd>resultset</kbd>:</li>
</ol>
<pre style="padding-left: 60px">resultset = mysql_use_result(conn);</pre>
<ol start="7">
<li>Use a <kbd>while</kbd> loop to extract one row at a time from the <kbd>resultset</kbd> and assign it to the array row:</li>
</ol>
<pre style="padding-left: 60px">while ((row = mysql_fetch_row(resultset)) != NULL)</pre>
<ol start="8">
<li>The information of the entire row is shown by displaying the subscripts <kbd>row[0]</kbd>, <kbd>row[1]</kbd>, and <kbd>row[2]</kbd>, respectively:</li>
</ol>
<pre style="padding-left: 60px">printf("Email Address: %s \n", row[0]);<br/>printf("Password: %s \n", row[1]);<br/>printf("Address of delivery: %s \n", row[2]);</pre>
<ol start="9">
<li>Memory that's allocated to the <kbd>resultset</kbd> is freed up:</li>
</ol>
<pre style="padding-left: 60px">mysql_free_result(resultset);</pre>
<ol start="10">
<li>The opened connection handler is closed:</li>
</ol>
<pre style="padding-left: 60px">mysql_close(conn);</pre>
<p>The <span><kbd>searchuser.c</kbd> </span>program for searching in a specific row in a MySQL database table is shown in the following code:</p>
<pre>#include &lt;mysql/mysql.h&gt;<br/>#include &lt;stdio.h&gt;<br/>#include &lt;stdlib.h&gt;<br/>#include &lt;string.h&gt;<br/><br/>void main() {<br/>    MYSQL *conn;<br/>    MYSQL_RES *resultset;<br/>    MYSQL_ROW row;<br/>    char *server = "127.0.0.1";<br/>    char *user = "root";<br/>    char *password = "Bintu2018$";<br/>    char *database = "ecommerce";<br/>    char emailaddress[30], sqlquery[255];<br/>    conn = mysql_init(NULL);<br/>    if (!mysql_real_connect(conn, server, user, password, database, 0, <br/>    NULL, 0)) {<br/>        fprintf(stderr, "%s\n", mysql_error(conn));<br/>        exit(1);<br/>    }<br/>    printf("Enter email address to search: ");<br/>    scanf("%s", emailaddress);<br/>    strcpy(sqlquery,"SELECT * FROM users where email_address like \'");<br/>    strcat(sqlquery,emailaddress);<br/>    strcat(sqlquery,"\'");<br/>    if (mysql_query(conn, sqlquery) != 0)                 <br/>    {                  <br/>        fprintf(stderr, "No row found in the users table with this <br/>    email address\n");                  <br/>        exit(1);                                                                     <br/>    }  <br/>    printf("The details of the user with this email address are as <br/>    follows:\n");<br/>    resultset = mysql_use_result(conn);<br/>    while ((row = mysql_fetch_row(resultset)) != NULL)<br/>    {<br/>        printf("Email Address: %s \n", row[0]);<br/>        printf("Password: %s \n", row[1]);<br/>        printf("Address of delivery: %s \n", row[2]);<br/>    }<br/>    mysql_free_result(resultset);<br/>    mysql_close(conn);<br/>}</pre>
<p>Now, let's go behind the scenes to understand the code better.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>We will start by invoking the <kbd>mysql_init</kbd> function to initialize a <kbd>MYSQL</kbd> object by the name <kbd>conn</kbd>. Thereafter, we will invoke the <kbd>mysql_real_connect</kbd> function and pass the <kbd>MYSQL</kbd> object <kbd>conn</kbd> to it along with the valid user ID, password, and the host details. The <kbd>mysql_real_connect</kbd> function will establish a connection to the MySQL server running at the specified host and will also connect to the supplied database, <kbd>ecommerce</kbd>. The <kbd>MYSQL</kbd> object <kbd>conn</kbd> will act as the connection handler for the rest of the program. Wherever a connection to the MySQL server and <kbd>ecommerce</kbd> database is required, referring to <kbd>conn</kbd> will suffice.</p>
<p>If any error occurs in establishing a connection to the MySQL database engine or the <kbd>ecommerce</kbd> database, an error message will be displayed and the program will terminate. If a connection to the MySQL database engine is established successfully, you will be prompted to enter the email address of the user whose details you want to search for.</p>
<p>We will create an SQL <kbd>SELECT</kbd> statement that will search the row in the <kbd>users</kbd> table that matches the email address entered by the user. Then, we will invoke the <kbd>mysql_query</kbd> function and pass the created SQL <kbd>SELECT</kbd> statement to it, along with the connection handler <kbd>conn</kbd>. If the SQL query does not execute or some error occurs, the program will terminate after displaying an error message. If the query is successful, then the resulting row(s) that satisfy the condition (that is, the row(s) that match the supplied email address) will be retrieved by invoking the <kbd>mysql_use_result</kbd> function and will be assigned to the result set, <kbd>resultset</kbd>.</p>
<p>We will then invoke the <kbd>mysql _fetch_row</kbd> function in a <kbd>while</kbd> loop that will extract one row at a time from the <kbd>resultset</kbd>; that is, the first row from the <kbd>resultset</kbd> will be accessed and assigned to the array row.</p>
<p>Recall that the <kbd>users</kbd> table contains the following columns:</p>
<ul>
<li><kbd>email_address varchar(30)</kbd></li>
<li><kbd>password varchar(30)   </kbd>    </li>
<li><kbd>address_of_delivery text</kbd></li>
</ul>
<p>Consequently, the array row will contain complete information of the accessed row, where the subscript <kbd>row[0]</kbd> will contain the data of the <kbd>email_ address</kbd> <span>column</span>, <kbd>row[1]</kbd> will contain the data of the column password, and <kbd>row[2]</kbd> will contain the data of the <kbd>address_of_delivery</kbd> <span>column.</span> The information of the entire row will be displayed by displaying the subscripts <kbd>row[0]</kbd>, <kbd>row[1]</kbd>, and <kbd>row[2]</kbd>, respectively.</p>
<p>At the end, we will invoke the <kbd>mysql_free_result</kbd> function to free up the memory that was allocated to the <kbd>resultset</kbd>. Then, we will invoke the <kbd>mysql_close</kbd> function to close the opened connection handler <kbd>conn</kbd>.</p>
<p><span>Let's open the Cygwin Terminal. We will require two Terminal windows; on one window, we will run SQL commands and on the other, we will compile and run C. Open another Terminal window by pressing <em>Alt+F2</em>. In the first Terminal window, invoke the MySQL command line by using the following command:</span></p>
<pre><strong>$ mysql -u root -p -h 127.0.0.1                                             </strong><br/><strong>Enter password:                                                                </strong><br/><strong>Welcome to the MariaDB monitor.  Commands end with ; or \g.                   </strong><br/><strong>Your MySQL connection id is 27                                                 </strong><br/><strong>Server version: 5.7.14-log MySQL Community Server (GPL)                        </strong><br/><strong>Copyright (c) 2000, 2017, Oracle, MariaDB Corporation Ab and others.           </strong><br/><strong>Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</strong> </pre>
<p><span>To work with our </span><kbd>ecommerce</kbd><span> database, we need to make it the current database. So, open the </span><kbd>ecommerce</kbd><span> database by using the following command:</span></p>
<pre><strong>MySQL [(none)]&gt; use ecommerce;                                                                       </strong><br/><strong>Reading table information for completion of table and column names                                   </strong><br/><strong>You can turn off this feature to get a quicker startup with -A                                       </strong><br/><strong>Database changed     </strong>      </pre>
<p><span>Now, </span><kbd>ecommerce</kbd><span> is our current database; that is, whatever SQL commands we will execute will be applied to the <kbd>ecommerce</kbd> database only. Let's use the following SQL <kbd>SELECT</kbd> command to see the existing rows in the </span><kbd>users</kbd><span> database table:</span></p>
<pre><strong>MySQL [ecommerce]&gt; select * from users;                                                              </strong><br/><strong>+---------------------+----------+------------------------------------+          </strong><br/><strong>| email_address       | password | address_of_delivery  |</strong><br/><strong>+---------------------+----------+------------------------------------+</strong><br/><strong>| bmharwani@yahoo.com | gold     | 11 Hill View Street, New York, USA</strong><br/><br/><strong>| harwanibm@gmail.com | diamond  | House No. xyz, Pqr Apartments, Uvw Lane, Mumbai, Maharashtra                        |                                                                                 | bintu@gmail.com     | platinum | abc Sea View, Ocean Lane, Opposite Mt. Everest, London, UKg       </strong><br/><strong>+---------------------+----------+------------------------------------+</strong><br/><strong>3 rows in set (0.00 sec) </strong>    </pre>
<p>The given output shows that there are three rows in the <kbd>users</kbd> table.</p>
<p>To compile the C program, switch to the second Terminal window. Let's use GCC to compile the <kbd>searchuser.c</kbd> program, as shown here:</p>
<pre><strong>$ gcc searchuser.c -o searchuser -I/usr/local/include/mysql -L/usr/local/lib/mysql -lmysqlclient </strong>        </pre>
<p>If you get no errors or warnings, that means the <kbd>searchuser.c</kbd> program has compiled into an executable file, <kbd>searchuser.exe</kbd>. Let's run this executable file:     </p>
<pre><strong>$ ./searchuser                                                                                             </strong><br/><strong>Enter email address to search: bmharwani@yahoo.com </strong><br/><strong>The details of the user with this email address are as follows: </strong><br/><strong>Email Address:bmharwani@yahoo.com</strong><br/><strong>Password: gold  </strong><br/><strong>Address of delivery: 11 Hill View Street, New York, USA</strong> </pre>
<p><em>Voila</em>! We can see that complete information of the user with their email address, <a href="mailto:bmharwani@yahoo.com">bmharwani@yahoo.com</a>, is displayed on the screen.</p>
<p>Now, let's move on to the next recipe!</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Updating information in the database</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will learn how to update information in a database table. We assume that a <kbd>users</kbd> database table already exists, comprising of three columns—<kbd>email_address</kbd>, <kbd>password</kbd>, and <kbd>address_of_delivery</kbd> (please see the beginning of this chapter, where we learned to create a database and a table in it). On entering an email address, all the current information of the user (that is, their password and address of delivery) will be displayed. Thereafter, the user will be prompted to enter a new password and address of delivery. This new information will be updated against the current information in the table.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<ol>
<li>Initialize a <kbd>MYSQL</kbd> object:</li>
</ol>
<pre style="padding-left: 60px">mysql_init(NULL);</pre>
<ol start="2">
<li>Establish a connection to the MySQL server running at the specified host. Also, generate a connection handler. The program will terminate if some error occurs in establishing the connection to the MySQL server engine or to the <kbd>ecommerce</kbd> database:</li>
</ol>
<pre style="padding-left: 60px"> if (!mysql_real_connect(conn, server, user, password, database, 0, NULL, 0)) <br/> {<br/>      fprintf(stderr, "%s\n", mysql_error(conn));<br/>      exit(1);<br/> }</pre>
<ol start="3">
<li>Enter the email address of the user whose information has to be updated:</li>
</ol>
<pre style="padding-left: 60px">printf("Enter email address of the user to update: ");<br/>scanf("%s", emailaddress);</pre>
<ol start="4">
<li>Create an SQL <kbd>SELECT</kbd> statement that will search the row in the <kbd>users</kbd> table that matches the email address that was entered by the user:</li>
</ol>
<pre style="padding-left: 60px"> strcpy(sqlquery,"SELECT * FROM users where email_address like \'");<br/> strcat(sqlquery,emailaddress);<br/> strcat(sqlquery,"\'");</pre>
<ol start="5">
<li>Execute the SQL <kbd>SELECT</kbd> statement. The program will terminate if the SQL query does not execute successfully or some other error occurs:</li>
</ol>
<pre style="padding-left: 60px">if (mysql_query(conn, sqlquery) != 0) <br/>{ <br/>     fprintf(stderr, "No row found in the users table with this          email address\n"); <br/>     exit(1); <br/> }  </pre>
<ol start="6">
<li>If the SQL query executes successfully, then the row(s) that match the supplied email address will be retrieved and assigned to the <kbd>resultset</kbd>:</li>
</ol>
<pre style="padding-left: 60px"> resultset = mysql_store_result(conn);</pre>
<ol start="7">
<li>Check if there is at least one row in the <kbd>resultset</kbd>:</li>
</ol>
<pre style="padding-left: 60px">if(mysql_num_rows(resultset) &gt;0)</pre>
<ol start="8">
<li>If there is no row in the <kbd>resultset</kbd>, then display the message that no row was found in the <kbd>users</kbd> table with the specified email address and exit from the program:</li>
</ol>
<pre style="padding-left: 60px">printf("No user found with this email address\n");</pre>
<ol start="9">
<li>If there is any row in the <kbd>resultset</kbd>, then access it and assign it to the array row:</li>
</ol>
<pre style="padding-left: 60px">row = mysql_fetch_row(resultset)</pre>
<ol start="10">
<li>Information about the user (that is, the email address, password, and address of delivery, which are assigned to the subscripts <kbd>row[0]</kbd>, <kbd>row[1]</kbd>, and <kbd>row[2]</kbd>, respectively) are displayed on the screen:</li>
</ol>
<pre style="padding-left: 60px">printf("Email Address: %s \n", row[0]);<br/>printf("Password: %s \n", row[1]);<br/>printf("Address of delivery: %s \n", row[2]);</pre>
<ol start="11">
<li>The memory allocated to the <kbd>resultset</kbd> is freed:</li>
</ol>
<pre style="padding-left: 60px">mysql_free_result(resultset);</pre>
<ol start="12">
<li>Enter the new updated information of the user; that is, the new password and the new address of delivery:</li>
</ol>
<pre style="padding-left: 60px">printf("Enter new password: ");<br/>scanf("%s", upassword);<br/>printf("Enter new address of delivery: ");<br/>getchar();<br/>gets(deliveryaddress);</pre>
<ol start="13">
<li>An SQL <kbd>UPDATE</kbd> statement is prepared that contains the information of the newly entered password and address of delivery:</li>
</ol>
<pre style="padding-left: 60px">strcpy(sqlquery,"UPDATE users set password=\'");<br/>strcat(sqlquery,upassword);<br/>strcat(sqlquery,"\', address_of_delivery=\'");<br/>strcat(sqlquery,deliveryaddress);<br/>strcat(sqlquery,"\' where email_address like \'");<br/>strcat(sqlquery,emailaddress);<br/>strcat(sqlquery,"\'");</pre>
<ol start="14">
<li>Execute the SQL <kbd>UPDATE</kbd> statement. If any error occurs in executing the SQL <kbd>UPDATE</kbd> query, the program will terminate:</li>
</ol>
<pre style="padding-left: 60px">if (mysql_query(conn, sqlquery) != 0)                 <br/>{                                                                                                                                                  fprintf(stderr, "The desired row in users table could not be <br/>    updated\n");  <br/>    exit(1);<br/> }  </pre>
<ol start="15">
<li>If the SQL <kbd>UPDATE</kbd> statement executes successfully, display a message <span>on the screen </span>informing that the user's information has been updated successfully:</li>
</ol>
<pre style="padding-left: 60px">printf("The information of user is updated successfully in users table\n");</pre>
<ol start="16">
<li>Close the opened connection handler:</li>
</ol>
<pre style="padding-left: 60px">mysql_close(conn);</pre>
<p>The <kbd><span>updateuser.c</span></kbd> program for updating a specific row of a MySQL database table with new content is shown in the following code:</p>
<pre>#include &lt;mysql/mysql.h&gt;<br/>#include &lt;stdio.h&gt;<br/>#include &lt;stdlib.h&gt;<br/>#include &lt;string.h&gt;<br/><br/>void main() {<br/>    MYSQL *conn;<br/>    MYSQL_RES *resultset;<br/>    MYSQL_ROW row;<br/>    char *server = "127.0.0.1";<br/>    char *user = "root";<br/>    char *password = "Bintu2018$";<br/>    char *database = "ecommerce";<br/>    char emailaddress[30], sqlquery[255],             <br/>    upassword[30],deliveryaddress[255];<br/>    conn = mysql_init(NULL);<br/>    if (!mysql_real_connect(conn, server, user, password, database, 0,     NULL, 0)) {<br/>        fprintf(stderr, "%s\n", mysql_error(conn));<br/>        exit(1);<br/>    }<br/>    printf("Enter email address of the user to update: ");<br/>    scanf("%s", emailaddress);<br/>    strcpy(sqlquery,"SELECT * FROM users where email_address like \'");<br/>    strcat(sqlquery,emailaddress);<br/>    strcat(sqlquery,"\'");<br/>    if (mysql_query(conn, sqlquery) != 0)                 <br/>    {                                                                                 <br/>        fprintf(stderr, "No row found in the users table with this <br/>        email address\n");                                                                                                     <br/>        exit(1);                                                                     <br/>    }  <br/>    resultset = mysql_store_result(conn);<br/>    if(mysql_num_rows(resultset) &gt;0)<br/>    {<br/>        printf("The details of the user with this email address are as <br/>        follows:\n");<br/>        while ((row = mysql_fetch_row(resultset)) != NULL)<br/>        {<br/>            printf("Email Address: %s \n", row[0]);<br/>            printf("Password: %s \n", row[1]);<br/>            printf("Address of delivery: %s \n", row[2]);<br/>        }<br/>        mysql_free_result(resultset);<br/>        printf("Enter new password: ");<br/>        scanf("%s", upassword);<br/>        printf("Enter new address of delivery: ");<br/>        getchar();<br/>        gets(deliveryaddress);<br/>        strcpy(sqlquery,"UPDATE users set password=\'");<br/>        strcat(sqlquery,upassword);<br/>        strcat(sqlquery,"\', address_of_delivery=\'");<br/>        strcat(sqlquery,deliveryaddress);<br/>        strcat(sqlquery,"\' where email_address like \'");<br/>        strcat(sqlquery,emailaddress);<br/>        strcat(sqlquery,"\'");<br/>        if (mysql_query(conn, sqlquery) != 0)                 <br/>        {                                                                                                                                                         <br/>            fprintf(stderr, "The desired row in users table could not <br/>            be updated\n");                                                             <br/>            exit(1);                                                                     <br/>        }  <br/>        printf("The information of user is updated successfully in <br/>        users table\n");<br/>    }<br/>    else<br/>        printf("No user found with this email address\n");<br/>    mysql_close(conn);<br/>}</pre>
<p>Now, let's go behind the scenes to understand the code better.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In this program, we first ask the user<span> to enter the email address they want to update. Then, we search the <kbd>users</kbd> table to see if there is any row with the matching email address. If we find it, we display the current information of the user; that is, the current email address, password, and address of delivery. Thereafter, we ask the user to enter a new password and new address of delivery. The new password and address of deliver will replace the old password and address of delivery, thereby updating the <kbd>users</kbd> table.</span></p>
<p>We will start by invoking the <kbd>mysql_init</kbd> function to initialize a <kbd>MYSQL</kbd> object by the name <kbd>conn</kbd>. Then, we will pass the <kbd>MYSQL</kbd> object <kbd>conn</kbd> to the <kbd>mysql_real_connect</kbd> function that we invoked to establish a connection to the  MySQL server running at the specified host. Several other parameters will also be passed to the <kbd>mysql_real_connection</kbd> function, including a valid user ID, password, host details, and the database with which we want to work. The <kbd>mysql_real_connect</kbd> function will establish the connection to the  MySQL server running at the specified host and will declare the <kbd>MYSQL</kbd> object <kbd>conn</kbd> as the connection handler. This means that <kbd>conn</kbd> can connect to the <kbd>MySQL</kbd> server and the <kbd>ecommerce</kbd> database wherever it is used.</p>
<p>The program will terminate after displaying an error message if some error occurs while establishing the connection to the MySQL server engine or to the <kbd>ecommerce</kbd> database. If the connection to the MySQL database engine is established successfully, you will be prompted to enter the email address of the user whose record you want to update.</p>
<p>As we mentioned earlier, we will first display the current information of the user. So, we will create an SQL <kbd>SELECT</kbd> statement and we will search the row in the <kbd>users</kbd> table that matches the email address that's entered by the user. Then, we will invoke the <kbd>mysql_query</kbd> function and pass the created SQL <kbd>SELECT</kbd> statement to it, along with the connection handler <kbd>conn</kbd>.</p>
<p>Again, the program will terminate after displaying an error message if the SQL query does not execute successfully or some other error occurs. If the query executes successfully, then the resulting row(s) (that is, the row(s) that match the supplied email address), will be retrieved by invoking the <kbd>mysql_use_result</kbd> function and will be assigned to the <kbd>resultset</kbd>.</p>
<p>We will then invoke the <kbd>mysql_num_rows</kbd> function to ensure that there is at least one row in the <kbd>resultset</kbd>. If there is no row in the <kbd>resultset</kbd>, this means that no row was found in the <kbd>users</kbd> table that matches the given email address. In this case, the program will terminate after informing that no row was found in the <kbd>users</kbd> table with the given email address. If there is even a single row in the <kbd>resultset</kbd>, we will invoke the <kbd>mysql _fetch_row</kbd> function on the <kbd>resultset</kbd>, which will extract one row from the <kbd>resultset</kbd> and assign it to the array row.</p>
<p>The <kbd>users</kbd> table contains the following three columns:</p>
<ul>
<li><kbd>email_address varchar(30)</kbd></li>
<li><kbd>password varchar(30)</kbd></li>
<li><kbd>address_of_delivery text</kbd></li>
</ul>
<p>The array row will contain the information of the accessed row, where the subscripts <kbd>row[0]</kbd>, <kbd>row[1]</kbd>, and <kbd>row[2]</kbd> will contain the data of the columns <kbd>email_ address</kbd>, <kbd>password</kbd>, and <kbd>address_of_delivery</kbd>, respectively. The current information of the user is displayed by displaying the information assigned to the aforementioned subscripts. Then, we will invoke the <kbd>mysql_free_result</kbd> function to free up the memory that is allocated to the <kbd>resultset</kbd>.</p>
<p>At this stage, the user will be asked to enter the new password and the new address of delivery. We will prepare an SQL <kbd>UPDATE</kbd> statement that contains the information of the newly entered password and address of delivery. The <kbd>mysql_query</kbd> function will be invoked and the SQL <kbd>UPDATE</kbd> statement will be passed to it, along with the connection handler <kbd>conn</kbd>.</p>
<p>If any error occurs in executing the SQL <kbd>UPDATE</kbd> query, again, an error message will be displayed and the program will terminate. If the SQL <kbd>UPDATE</kbd> statement executes successfully, a message informing that the user's information has been updated successfully will be displayed. Finally, we will invoke the <kbd>mysql_close</kbd> function to close the opened connection handler <kbd>conn</kbd>.</p>
<p><span>Let's open the Cygwin Terminal. We will require two Terminal windows; on one window, we will run SQL commands and on the other, we will compile and run C. Open another Terminal window by pressing <em>Alt+F2</em>. In the first Terminal window, invoke the MySQL command line by using the following command:</span></p>
<pre><strong>$ mysql -u root -p -h 127.0.0.1                                                </strong><br/><strong>Enter password:                                                                </strong><br/><strong>Welcome to the MariaDB monitor.  Commands end with ; or \g.                    </strong><br/><strong>Your MySQL connection id is 27                                                 </strong><br/><strong>Server version: 5.7.14-log MySQL Community Server (GPL)                        </strong><br/><strong>Copyright (c) 2000, 2017, Oracle, MariaDB Corporation Ab and others.           </strong><br/><strong>Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</strong> </pre>
<p><span>To work with our </span><kbd>ecommerce</kbd><span> database, we need to make it the current database. So, open the </span><kbd>ecommerce</kbd><span> database by using the following command:</span></p>
<pre><strong>MySQL [(none)]&gt; use ecommerce;                                                 </strong><br/><strong>Reading table information for completion of table and column names             </strong><br/><strong>You can turn off this feature to get a quicker startup with -A                  </strong><br/><strong>Database changed  </strong>          </pre>
<p><span>Now, </span><kbd>ecommerce</kbd><span> is our current database; that is, whatever SQL commands we will execute will be applied to the </span><kbd>ecommerce</kbd><span> database only. Let's use the following SQL <kbd>SELECT</kbd> command to see the existing rows in the </span><kbd>users</kbd><span> database table:</span></p>
<pre><strong>MySQL [ecommerce]&gt; select * from users;</strong><br/><strong>+---------------------+----------+------------------------------------+</strong><br/><strong>| email_address       | password | address_of_delivery|</strong><br/><strong>+---------------------+----------+------------------------------------+</strong><br/><strong>| bmharwani@yahoo.com | gold     | 11 Hill View Street, New York, USA|</strong><br/><strong>| harwanibm@gmail.com | diamond  | House No. xyz, Pqr Apartments, Uvw Lane, Mumbai, Maharashtra|</strong><br/><strong>| bintu@gmail.com     | platinum | abc Sea View, Ocean Lane, Opposite Mt. Everest, London, UKg</strong><br/><strong>+---------------------+----------+------------------------------------+</strong><br/><strong>3 rows in set (0.00 sec) </strong>     </pre>
<p>We can see from the preceding output that there are three rows in the <kbd>users</kbd> table. To compile the C program, switch to the second Terminal window. Let's use GCC to compile the <kbd>updateuser.c</kbd> program, as shown here:</p>
<pre><strong>$ gcc updateuser.c -o updateuser -I/usr/local/include/mysql -L/usr/local/lib/mysql<span> -</span>lmysqlclient</strong><span>           </span></pre>
<p>If you get no errors or warnings, that means the <kbd>updateuser.c</kbd> program has compiled into an executable file, <kbd>updateuser.exe</kbd>. Let's run this executable file:</p>
<pre><strong>$ ./updateuser                                                                  </strong><br/><strong>Enter email address of the user to update: harwanibintu@gmail.com  </strong><br/><strong>No user found with this email address </strong>                    </pre>
<p>Let's run the program again and enter an email address that already exists:       </p>
<pre><strong>$ ./updateuser                                                                 </strong><br/><strong>Enter email address of the user to update: bmharwani@yahoo.com                 </strong><br/><strong>The details of the user with this email address are as follows:                </strong><br/><strong>Email Address: bmharwani@yahoo.com                                             </strong><br/><strong>Password: gold                                                                 </strong><br/><strong>Address of delivery: 11 Hill View Street, New York, USA                        </strong><br/><strong>Enter new password: coffee                                                     </strong><br/><strong>Enter new address of delivery: 444, Sky Valley, Toronto, Canada                </strong><br/><strong>The information of user is updated successfully in users table</strong>                 </pre>
<p>So, we have updated the row of the user with the email address, <a href="mailto:bmharwani@yahoo.com">bmharwani@yahoo.com</a>. To confirm that the row has been updated in the <kbd>users</kbd> database table too, switch to the Terminal window where the MySQL command line is running and issue the following SQL <kbd>SELECT</kbd> command: </p>
<pre><strong>MySQL [ecommerce]&gt; MySQL [ecommerce]&gt; select * from users;</strong><br/><strong>+---------------------+----------+------------------------------------+ </strong><br/><strong>| email_address       | password | address_of_delivery|</strong><br/><strong>+---------------------+----------+------------------------------------+ </strong><br/><strong>| bmharwani@yahoo.com | coffee   | 444, Sky Valley, Toronto, Canada </strong><br/><strong>| </strong><br/><strong>| harwanibm@gmail.com | diamond  | House No. xyz, Pqr Apartments, Uvw Lane, Mumbai, Maharashtra </strong><br/><strong>|</strong><br/><strong>| bintu@gmail.com     | platinum | abc Sea View, Ocean Lane, Opposite Mt. Everest, London, UKg</strong><br/><strong>+---------------------+----------+------------------------------------+</strong></pre>
<p><em>Voila</em>! We can see that the row of the <kbd>users</kbd> table with the email address <kbd>bmharwani@yahoo.com</kbd> has been updated and is showing the new information.</p>
<p>Now, let's move on to the next recipe!</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Deleting data from the database using C</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will learn how to delete information from a database table. We assume <span>that a <kbd>users</kbd> table comprising three columns,</span> <span><kbd>email_address</kbd>, <kbd>password</kbd>, </span>and<span> <kbd>address_of_delivery</kbd></span><span>, already exists (please see the beginning of this chapter, where we created an </span><kbd>ecommerce</kbd><span> database and a <kbd>users</kbd> table in it).</span> You will be prompted to enter the email address of the user whose row has to be deleted. On entering an email address, all the information of the user will be displayed. Thereafter, you will again be asked to confirm if the displayed row should be deleted or not. After your confirmation, the row will be permanently deleted from the table.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<ol>
<li>Initialize a <kbd>MYSQL</kbd> object:</li>
</ol>
<pre style="padding-left: 60px">mysql_init(NULL);</pre>
<ol start="2">
<li>Establish a connection to the MySQL server running at the specified host. Also, generate a connection handler. If any error occurs in establishing a connection to the MySQL server engine, the program will terminate:</li>
</ol>
<pre style="padding-left: 60px">  if (!mysql_real_connect(conn, server, user, password, database, 0, <br/>    NULL, 0)) {<br/>      fprintf(stderr, "%s\n", mysql_error(conn));<br/>      exit(1);<br/>  }</pre>
<ol start="3">
<li>If the connection to the MySQL database engine is established successfully, you will be prompted to enter the email address of the user whose record you want to delete:</li>
</ol>
<pre style="padding-left: 60px"> printf("Enter email address of the user to delete: ");<br/> scanf("%s", emailaddress);</pre>
<ol start="4">
<li>Create an SQL <kbd>SELECT</kbd> statement that will search the row from the <kbd>users</kbd> table that matches the email address that's entered by the user:</li>
</ol>
<pre style="padding-left: 60px"> strcpy(sqlquery,"SELECT * FROM users where email_address like \'");<br/> strcat(sqlquery,emailaddress);<br/> strcat(sqlquery,"\'");</pre>
<ol start="5">
<li>Execute the SQL <kbd>SELECT</kbd> statement. The program will terminate after displaying an error message if the SQL query does not execute successfully:</li>
</ol>
<pre style="padding-left: 60px"> if (mysql_query(conn, sqlquery) != 0)                 <br/> {                                                                                                                                   <br/>    fprintf(stderr, "No row found in the users table with this email <br/>    address\n");                                                                                                     <br/>    exit(1);                                                                     <br/> }  </pre>
<ol start="6">
<li>If the query executes successfully, then the resulting row(s) that match the supplied email address will be retrieved and assigned to the <kbd>resultset</kbd>:</li>
</ol>
<pre style="padding-left: 60px">resultset = mysql_store_result(conn);</pre>
<ol start="7">
<li>Invoke the <kbd>mysql_num_rows</kbd> function to ensure that there is at least one row in the <kbd>resultset</kbd>:</li>
</ol>
<pre style="padding-left: 60px">if(mysql_num_rows(resultset) &gt;0)</pre>
<ol start="8">
<li>If there is no row in the <kbd>resultset</kbd>, that means no row was found in the <kbd>users</kbd> table that matches the given email address; hence, the program will terminate:</li>
</ol>
<pre style="padding-left: 60px">printf("No user found with this email address\n");</pre>
<ol start="9">
<li>If there is any row in the result set, that row is extracted from the <kbd>resultset</kbd> and will be assigned to the array row:</li>
</ol>
<pre style="padding-left: 60px">row = mysql_fetch_row(resultset)</pre>
<ol start="10">
<li>The information of the user is displayed by displaying the corresponding subscripts in the array row:</li>
</ol>
<pre style="padding-left: 60px">printf("Email Address: %s \n", row[0]);<br/>printf("Password: %s \n", row[1]);<br/>printf("Address of delivery: %s \n", row[2]);</pre>
<ol start="11">
<li>The memory that's allocated to the <kbd>resultset</kbd> is freed up:</li>
</ol>
<pre style="color: black;padding-left: 60px">mysql_free_result(resultset);The user is asked whether he/she really want to delete the shown record.<br/>printf("Are you sure you want to delete this record yes/no: ");<br/>scanf("%s", k);</pre>
<ol start="12">
<li>If the user enters <kbd>yes</kbd>, an SQL <kbd>DELETE</kbd> statement will be created that will delete the row from the <kbd>users</kbd> table that matches the specified email address:</li>
</ol>
<pre style="color: black;padding-left: 60px">if(strcmp(k,"yes")==0)<br/>{<br/>    strcpy(sqlquery, "Delete from users where email_address like <br/>    \'");<br/>    strcat(sqlquery,emailaddress);<br/>    strcat(sqlquery,"\'");</pre>
<ol start="13">
<li>The SQL <kbd>DELETE</kbd> statement is executed. If there are any error occurs in executing the SQL <kbd>DELETE</kbd> query, the program will terminate:</li>
</ol>
<pre style="color: black;padding-left: 60px">if (mysql_query(conn, sqlquery) != 0)                 <br/>{                                                                                   <br/>    fprintf(stderr, "The user account could not be deleted\n");                                                             <br/>    exit(1);                                                                     <br/>}</pre>
<ol start="14">
<li>If the SQL <kbd>DELETE</kbd> statement is executed successfully, a message informing that the user account with the specified email address is deleted successfully is displayed:</li>
</ol>
<pre style="color: black;padding-left: 60px">printf("The user with the given email address is successfully deleted from the users table\n");</pre>
<ol start="15">
<li>The opened connection handler is closed:</li>
</ol>
<pre style="color: black;padding-left: 60px">mysql_close(conn);</pre>
<p>The <span><kbd>deleteuser.c</kbd> </span>program for deleting a specific row from a MySQL database table is shown in the following code:</p>
<pre>#include &lt;mysql/mysql.h&gt;<br/>#include &lt;stdio.h&gt;<br/>#include &lt;stdlib.h&gt;<br/>#include &lt;string.h&gt;<br/><br/>void main() {<br/>MYSQL *conn;<br/>MYSQL_RES *resultset;<br/>MYSQL_ROW row;<br/>char *server = "127.0.0.1";<br/>char *user = "root";<br/>char *password = "Bintu2018$";<br/>char *database = "ecommerce";<br/>char emailaddress[30], sqlquery[255],k[10];<br/>conn = mysql_init(NULL);<br/>if (!mysql_real_connect(conn, server, user, password, database, 0, NULL, 0)) {<br/>    fprintf(stderr, "%s\n", mysql_error(conn));<br/>    exit(1);<br/>}<br/>printf("Enter email address of the user to delete: ");<br/>scanf("%s", emailaddress);<br/>strcpy(sqlquery,"SELECT * FROM users where email_address like \'");<br/>strcat(sqlquery,emailaddress);<br/>strcat(sqlquery,"\'");<br/>if (mysql_query(conn, sqlquery) != 0)                 <br/>{                                                                          <br/>    fprintf(stderr, "No row found in the users table with this email <br/>    address\n");                                                             <br/>    exit(1);                                                                      <br/>}  <br/>resultset = mysql_store_result(conn);<br/>if(mysql_num_rows(resultset) &gt;0)<br/>{<br/>    printf("The details of the user with this email address are as <br/>    follows:\n");<br/>    while ((row = mysql_fetch_row(resultset)) != NULL)<br/>    {<br/>        printf("Email Address: %s \n", row[0]);<br/>        printf("Password: %s \n", row[1]);<br/>        printf("Address of delivery: %s \n", row[2]);<br/>    }<br/>    mysql_free_result(resultset);<br/>    printf("Are you sure you want to delete this record yes/no: ");<br/>    scanf("%s", k);<br/>    if(strcmp(k,"yes")==0)<br/>    {<br/>        strcpy(sqlquery, "Delete from users where email_address like <br/>        \'");<br/>        strcat(sqlquery,emailaddress);<br/>        strcat(sqlquery,"\'");<br/>        if (mysql_query(conn, sqlquery) != 0)                 <br/>        {                                                                                 <br/>            fprintf(stderr, "The user account could not be deleted\n");                                                             <br/>            exit(1);                                                                      <br/>        }  <br/>        printf("The user with the given email address is successfully <br/>        deleted from the users table\n");<br/>    }<br/>}<br/>else<br/>    printf("No user found with this email address\n");<br/>    mysql_close(conn);<br/>}</pre>
<p>Now, let's go behind the scenes to understand the code better.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>We will start by invoking the <kbd>mysql_init</kbd> function to initialize a <kbd>MYSQL</kbd> object by the name <kbd>conn</kbd>. We will then pass the <kbd>MYSQL</kbd> object <kbd>conn</kbd> to the <kbd>mysql_real_connect</kbd> function that we invoked to establish a connection to the  MySQL server running at the specified host. Several other parameters will also be passed to the <kbd>mysql_real_connection</kbd> function, including a valid user ID, password, host details, and the database with which we want to work. The <kbd>mysql_real_connect</kbd> function will establish a connection to the  MySQL server running at the specified host and will declare a <kbd>MYSQL</kbd> object <kbd>conn</kbd> as the connection handler. This means thar <kbd>conn</kbd> can connect to the MySQL server and the commerce database wherever it is used.</p>
<p>The program will terminate after displaying an error message if some error occurs while establishing a connection to the MySQL server engine or to the <kbd>ecommerce</kbd> database. If the connection to the MySQL database engine is established successfully, you will be prompted to enter the email address of the user whose record you want to delete.</p>
<p>We will first display the information of the user and thereafter will seek permission from the user as to whether they really want to delete that row or not. So, we will create an SQL <kbd>SELECT</kbd> statement that will search the row from the <kbd>users</kbd> table that matches the email address that was entered by the user. Then, we will invoke the <kbd>mysql_query</kbd> function and pass the created SQL <kbd>SELECT</kbd> statement to it, along with the connection handler <kbd>conn</kbd>.</p>
<p>Again, the program will terminate after displaying an error message if the SQL query does not execute successfully or some other error occurs. If the query executes successfully, then the resulting row(s) (<span>that is</span>, the row(s) that match the supplied email address) will be retrieved by invoking the <kbd>mysql_use_result</kbd> function and will be assigned to the <kbd>resultset</kbd>.</p>
<p>We will invoke the <kbd>mysql_num_rows</kbd> function to ensure that there is at least one row in the <kbd>resultset</kbd>. If there is no row in the <kbd>resultset</kbd>, that means no row was found in the <kbd>users</kbd> table that matches the given email address. In that case, the program will terminate after informing that no row was found in the <kbd>users</kbd> table with the given email address. If there is even a single row in the <kbd>resultset</kbd>, we will invoke the <kbd>mysql _fetch_row</kbd> function on the <kbd>resultset</kbd>, which will extract one row from the <kbd>resultset</kbd> and assign it to the array row.</p>
<p>The <kbd>users</kbd> table contains the following three columns:</p>
<ul>
<li><kbd>email_address varchar(30)</kbd></li>
<li><kbd>password varchar(30)</kbd></li>
<li><kbd>address_of_delivery text</kbd></li>
</ul>
<p>The array row will contain information of the accessed row, where the subscripts <kbd>row[0]</kbd>, <kbd>row[1]</kbd>, and <kbd>row[2]</kbd> will contain the data of the columns <kbd>email_ address</kbd>, <kbd>password</kbd>, and <kbd>address_of_delivery</kbd>, respectively. The current information of the user will be displayed by displaying the current email address, password, and address of delivery that's assigned to the subscripts <kbd>row[0]</kbd>, <kbd>row[1]</kbd>, and <kbd>row[2]</kbd>. Then, we will invoke the <kbd>mysql_free_result</kbd> function to free up the memory that is allocated to the <kbd>resultset</kbd>.</p>
<p>At this stage, the user will be asked to confirm whether they really want to delete the shown record. The user is supposed to enter <kbd>yes</kbd>, all in lowercase, to delete the record. If the user enters <kbd>yes</kbd>, an SQL <kbd>DELETE</kbd> statement will be created that will delete the row from the <kbd>users</kbd> table that matches the specified email address. The <kbd>mysql_query</kbd> function will be invoked and the SQL <kbd>DELETE</kbd> statement will be passed to it, along with the connection handler <kbd>conn</kbd>.</p>
<p>If any error occurs in executing the SQL <kbd>DELETE</kbd> query, again an error message will be displayed and the program will terminate. If the SQL <kbd>DELETE</kbd> statement executes successfully, a message informing that the user account with the specified mail address has been deleted successfully is displayed. Finally, we will invoke the <kbd>mysql_close</kbd> function to close the opened connection handler <kbd>conn</kbd>.</p>
<p><span>Let's open the Cygwin Terminal. We will require two Terminal windows; on one window, we will run MySQL commands and on the other, we will compile and run C. Open another Terminal window by pressing <em>Alt+F2</em>. In the first Terminal window, invoke the MySQL command line by giving the following command:</span></p>
<pre><strong>$ mysql -u root -p -h 127.0.0.1                                                </strong><br/><strong>Enter password:                                                                </strong><br/><strong>Welcome to the MariaDB monitor.  Commands end with ; or \g.                    </strong><br/><strong>Your MySQL connection id is 27                                                 </strong><br/><strong>Server version: 5.7.14-log MySQL Community Server (GPL)                        </strong><br/><strong>Copyright (c) 2000, 2017, Oracle, MariaDB Corporation Ab and others.           </strong><br/><strong>Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</strong> </pre>
<p><span>To work with our </span><kbd>ecommerce</kbd><span> database, we need to make it the current database. So, open the </span><kbd>ecommerce</kbd><span> database by using the following command:</span></p>
<pre><strong>MySQL [(none)]&gt; use ecommerce;                                                 </strong><br/><strong>Reading table information for completion of table and column names             </strong><br/><strong>You can turn off this feature to get a quicker startup with -A                 </strong><br/><strong>Database changed  </strong>          </pre>
<p><span>Now, </span><kbd>ecommerce</kbd><span> is our current database; that is, whatever SQL commands we will execute will be applied to the </span><kbd>ecommerce</kbd><span> database only. Let's use the following SQL <kbd>SELECT</kbd> command to see the existing rows in the </span><kbd>users</kbd><span> </span><span>database table:</span></p>
<pre><strong>MySQL [ecommerce]&gt; select * from users;</strong><br/><strong>+---------------------+----------+------------------------------------+</strong><br/><strong>| email_address | password | address_of_delivery | </strong><br/><strong>+---------------------+----------+------------------------------------+</strong><br/><strong>| bmharwani@yahoo.com | coffee | 444, Sky Valley, Toronto, Canada </strong><br/><strong>|</strong><br/><strong>| harwanibm@gmail.com | diamond | House No. xyz, Pqr Apartments, Uvw Lane, Mumbai, Maharashtra | </strong><br/><strong>| bintu@gmail.com | platinum | abc Sea View, Ocean Lane, Opposite Mt. Everest, London, UKg</strong><br/><strong>+---------------------+----------+------------------------------------+</strong><br/><strong>3 rows in set (0.00 sec)</strong></pre>
<p>From the preceding output, we can see that there are three rows in the <kbd>users</kbd> table. To compile the C program, switch to the second Terminal window. Let's use GCC to compile the <kbd>deleteuser.c</kbd> program, as shown here:</p>
<pre><strong>$ gcc deleteuser.c -o deleteuser -I/usr/local/include/mysql -L/usr/local/lib/mysql -lmysqlclient</strong></pre>
<p>If you get no errors or warnings, that means the <kbd>deleteuser.c</kbd> program has compiled into an executable file, <kbd>deleteuser.exe</kbd>. Let's run this executable file:</p>
<pre><strong>$ ./deleteuser</strong><br/><strong>Enter email address of the user to delete: harwanibintu@gmail.com  </strong><br/><strong>No user found with this email address  </strong>              </pre>
<p>Now, let's run the program again with a valid email address:</p>
<pre><strong>$ ./deleteuser </strong><br/><strong>Enter email address of the user to delete: bmharwani@yahoo.com </strong><br/><strong>The details of the user with this email address are as follows:</strong><br/><strong>Email Address: bmharwani@yahoo.com</strong><br/><strong>Password: coffee</strong><br/><strong>Address of delivery: 444, Sky Valley, Toronto, Canada</strong><br/><strong>Are you sure you want to delete this record yes/no: yes </strong><br/><strong>The user with the given email address is successfully deleted from the users table</strong><strong>              </strong></pre>
<p>So, the row of the user with the email address <kbd>bmharwani@yahoo.com</kbd> will be deleted from the <kbd>users</kbd> table. To confirm that the row has been deleted from the <kbd>users</kbd> database table too, switch to the Terminal window where the MySQL command line is running and issue the following SQL <kbd>SELECT</kbd> command:      </p>
<pre><strong> MySQL [ecommerce]&gt; select * from users;</strong><br/><strong>+---------------------+----------+------------------------------------+</strong><br/><strong>| email_address       | password | address_of_delivery </strong><br/><strong>| </strong><br/><strong>+---------------------+----------+------------------------------------+</strong><br/><strong>| harwanibm@gmail.com | diamond  | House No. xyz, Pqr Apartments, Uvw Lane, Mumbai, Maharashtra </strong><br/><strong>| </strong><br/><strong>| bintu@gmail.com     | platinum | abc Sea View, Ocean Lane, Opposite Mt. Everest, London, UKg </strong><br/><strong>+---------------------+----------+------------------------------------+</strong></pre>
<p><em>Voila</em>! We can see that now there are only two rows left in the <kbd>users</kbd> table, confirming that one row has been deleted from the <kbd>users</kbd> table.    </p>


            </article>

            
        </section>
    </body></html>