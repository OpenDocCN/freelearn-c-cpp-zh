<html><head></head><body>
<div id="_idContainer085">
<h1 class="chapter-number" id="_idParaDest-101"><a id="_idTextAnchor101"/><span class="koboSpan" id="kobo.1.1">5</span></h1>
<h1 id="_idParaDest-102"><a id="_idTextAnchor102"/><span class="koboSpan" id="kobo.2.1">Project #2 – Creating a Portable Thing Tracker Using MKR GSM 1400</span></h1>
<p><span class="koboSpan" id="kobo.3.1">This chapter is dedicated to </span><strong class="bold"><span class="koboSpan" id="kobo.4.1">smart transportation</span></strong><span class="koboSpan" id="kobo.5.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.6.1">smart remote monitoring</span></strong><span class="koboSpan" id="kobo.7.1">. </span><span class="koboSpan" id="kobo.7.2">It shows how cellular communication-enabled devices can be integrated with the </span><strong class="bold"><span class="koboSpan" id="kobo.8.1">Arduino IoT Cloud</span></strong><span class="koboSpan" id="kobo.9.1"> platform, and it also offers an example of using a </span><strong class="bold"><span class="koboSpan" id="kobo.10.1">global IoT SIM card</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.11.1">for communication.</span></span></p>
<p><span class="koboSpan" id="kobo.12.1">Here, we will practically explore </span><strong class="bold"><span class="koboSpan" id="kobo.13.1">Long-Term Evolution</span></strong><span class="koboSpan" id="kobo.14.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.15.1">LTE</span></strong><span class="koboSpan" id="kobo.16.1">) technologies, which are very useful in remote monitoring and control, whether they involve asset tracking or remote operation monitoring. </span><span class="koboSpan" id="kobo.16.2">This project uses the </span><strong class="bold"><span class="koboSpan" id="kobo.17.1">Arduino MKR GSM 1400</span></strong><span class="koboSpan" id="kobo.18.1"> development board, which is equipped with the latest communication bands and was specially designed for </span><strong class="bold"><span class="koboSpan" id="kobo.19.1">Industrial Internet of Things</span></strong><span class="koboSpan" id="kobo.20.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.21.1">IIoT</span></strong><span class="koboSpan" id="kobo.22.1">) and </span><strong class="bold"><span class="koboSpan" id="kobo.23.1">Internet of Things</span></strong><span class="koboSpan" id="kobo.24.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.25.1">IoT</span></strong><span class="koboSpan" id="kobo.26.1">) use cases. </span><span class="koboSpan" id="kobo.26.2">This project practically explains how you can develop a tracking solution based on cellular communications for different use cases. </span><span class="koboSpan" id="kobo.26.3">This chapter will help you to understand cellular communication technology, global IoT SIM cards, and the integration of Arduino IoT Cloud using cellular technology. </span><span class="koboSpan" id="kobo.26.4">By the end of this chapter, you will be able to develop solutions for remote areas using </span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">cellular technology.</span></span></p>
<p><span class="koboSpan" id="kobo.28.1">In this chapter, we’re going to cover the following </span><span class="No-Break"><span class="koboSpan" id="kobo.29.1">main topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.30.1">Enhancing operations with IoT asset tracking and </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">remote control</span></span></li>
<li><span class="koboSpan" id="kobo.32.1">Exploring the advantages of GSM/LTE/NB-IoT </span><span class="No-Break"><span class="koboSpan" id="kobo.33.1">communication technologies</span></span></li>
<li><span class="koboSpan" id="kobo.34.1">Seamless global connectivity with IoT </span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">SIM cards</span></span></li>
<li><span class="koboSpan" id="kobo.36.1">Building blocks – sensors and development boards </span><span class="No-Break"><span class="koboSpan" id="kobo.37.1">for IoT</span></span></li>
<li><span class="koboSpan" id="kobo.38.1">Designing the </span><span class="No-Break"><span class="koboSpan" id="kobo.39.1">project architecture</span></span></li>
<li><span class="koboSpan" id="kobo.40.1">Activating SIM cards for </span><span class="No-Break"><span class="koboSpan" id="kobo.41.1">IoT deployment</span></span></li>
<li><span class="koboSpan" id="kobo.42.1">Configuring the Thing, network credentials, cloud variables, </span><span class="No-Break"><span class="koboSpan" id="kobo.43.1">and code</span></span></li>
<li><span class="koboSpan" id="kobo.44.1">Creating comprehensive web and </span><span class="No-Break"><span class="koboSpan" id="kobo.45.1">mobile dashboards</span></span></li>
</ul>
<h1 id="_idParaDest-103"><a id="_idTextAnchor103"/><span class="koboSpan" id="kobo.46.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.47.1">The following are the hardware components required to complete </span><span class="No-Break"><span class="koboSpan" id="kobo.48.1">this chapter:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.49.1">MKR GSM 1400/MKR </span><span class="No-Break"><span class="koboSpan" id="kobo.50.1">NB 1500</span></span></li>
<li><span class="koboSpan" id="kobo.51.1">A Hologram global IoT </span><span class="No-Break"><span class="koboSpan" id="kobo.52.1">SIM card</span></span></li>
<li><span class="koboSpan" id="kobo.53.1">A NEO-6M </span><span class="No-Break"><span class="koboSpan" id="kobo.54.1">GPS module</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.55.1">A breadboard</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.56.1">Jumper cables</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.57.1">For coding, we will use the </span><strong class="bold"><span class="koboSpan" id="kobo.58.1">Arduino Web Editor</span></strong><span class="koboSpan" id="kobo.59.1">, which includes a large collection of development boards and sensor libraries, as well as Arduino IoT Cloud for Thing and dashboard setup. </span><span class="koboSpan" id="kobo.59.2">To develop hardware and sensor designs, we need the </span><strong class="bold"><span class="koboSpan" id="kobo.60.1">Fritzing </span></strong><span class="koboSpan" id="kobo.61.1">desktop software, and we need </span><strong class="bold"><span class="koboSpan" id="kobo.62.1">Arduino IDE</span></strong><span class="koboSpan" id="kobo.63.1"> for GPS </span><span class="No-Break"><span class="koboSpan" id="kobo.64.1">module testing.</span></span></p>
<p><span class="koboSpan" id="kobo.65.1">In this chapter, we will use the </span><strong class="bold"><span class="koboSpan" id="kobo.66.1">Arduino IoT SIM card</span></strong><span class="koboSpan" id="kobo.67.1"> for communication instead of local SIM providers. </span><span class="koboSpan" id="kobo.67.2">Arduino provides a wide variety of data plans for global IoT sim cards that can be chosen according to requirements. </span><span class="koboSpan" id="kobo.67.3">The code for this chapter is available at the book’s official GitHub repository at this </span><span class="No-Break"><span class="koboSpan" id="kobo.68.1">link: </span></span><span class="No-Break"><span class="koboSpan" id="kobo.69.1">https://github.com/PacktPublishing/Arduino-IoT-Cloud-for-Developers</span></span><span class="No-Break"><span class="koboSpan" id="kobo.70.1">.</span></span></p>
<h1 id="_idParaDest-104"><a id="_idTextAnchor104"/><span class="koboSpan" id="kobo.71.1">Enhancing operations with IoT asset tracking and remote control</span></h1>
<p><strong class="bold"><span class="koboSpan" id="kobo.72.1">IoT</span></strong><span class="koboSpan" id="kobo.73.1"> technology can be very useful for asset tracking and remote controlling and monitoring operations. </span><span class="koboSpan" id="kobo.73.2">By installing sensors on assets and connecting them to a central network, you can track the location and status of your assets in real time. </span><span class="koboSpan" id="kobo.73.3">Here are some ways in which IoT can</span><a id="_idIndexMarker419"/><span class="koboSpan" id="kobo.74.1"> be used for asset tracking and remote controlling</span><a id="_idIndexMarker420"/><span class="koboSpan" id="kobo.75.1"> and </span><span class="No-Break"><span class="koboSpan" id="kobo.76.1">monitoring operations:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.77.1">Asset tracking</span></strong><span class="koboSpan" id="kobo.78.1">: By installing GPS trackers or RFID tags on your assets, you can track their location and movements in real time. </span><span class="koboSpan" id="kobo.78.2">This can be very useful for logistics and supply chain management, as well as </span><span class="No-Break"><span class="koboSpan" id="kobo.79.1">fleet management.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.80.1">Condition monitoring</span></strong><span class="koboSpan" id="kobo.81.1">: By </span><a id="_idIndexMarker421"/><span class="koboSpan" id="kobo.82.1">installing sensors on your assets, you can monitor their condition and performance in real time. </span><span class="koboSpan" id="kobo.82.2">This can help you identify potential problems before they become serious and take corrective action to prevent downtime and reduce </span><span class="No-Break"><span class="koboSpan" id="kobo.83.1">maintenance costs.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.84.1">Predictive maintenance</span></strong><span class="koboSpan" id="kobo.85.1">: By analyzing data from your sensors, you can use machine</span><a id="_idIndexMarker422"/><span class="koboSpan" id="kobo.86.1"> learning algorithms to predict when maintenance is needed on your assets. </span><span class="koboSpan" id="kobo.86.2">This can help you schedule maintenance at the most convenient time and avoid </span><span class="No-Break"><span class="koboSpan" id="kobo.87.1">unplanned downtime.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.88.1">Remote control</span></strong><span class="koboSpan" id="kobo.89.1">: By</span><a id="_idIndexMarker423"/><span class="koboSpan" id="kobo.90.1"> connecting your assets to a central network, you can control them remotely from a central location. </span><span class="koboSpan" id="kobo.90.2">This can be very useful for operations that are located in remote areas or difficult </span><span class="No-Break"><span class="koboSpan" id="kobo.91.1">to access.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.92.1">Remote monitoring</span></strong><span class="koboSpan" id="kobo.93.1">: By</span><a id="_idIndexMarker424"/><span class="koboSpan" id="kobo.94.1"> installing cameras and other sensors on your assets, you can monitor their operations remotely in real time. </span><span class="koboSpan" id="kobo.94.2">This can help you identify potential problems and take corrective </span><span class="No-Break"><span class="koboSpan" id="kobo.95.1">action quickly.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.96.1">Overall, IoT technology can be very useful for asset tracking and remote controlling and monitoring operations. </span><span class="koboSpan" id="kobo.96.2">By leveraging the power of sensors, data analytics, and machine learning, you can improve the efficiency and reliability of your operations while reducing costs and downtime. </span><span class="koboSpan" id="kobo.96.3">In this section, we have discussed IoT for asset tracking and remote monitoring using cellular technology. </span><span class="koboSpan" id="kobo.96.4">Next, we will cover different communication technologies that are available now and coming to market in </span><span class="No-Break"><span class="koboSpan" id="kobo.97.1">the future.</span></span></p>
<h1 id="_idParaDest-105"><a id="_idTextAnchor105"/><span class="koboSpan" id="kobo.98.1">Exploring the advantages of GSM/LTE/NB-IoT communication technologies</span></h1>
<p><strong class="bold"><span class="koboSpan" id="kobo.99.1">Global System for Mobile communication</span></strong><span class="koboSpan" id="kobo.100.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.101.1">GSM</span></strong><span class="koboSpan" id="kobo.102.1">), LTE, and </span><strong class="bold"><span class="koboSpan" id="kobo.103.1">NarrowBand-Internet of Things</span></strong><span class="koboSpan" id="kobo.104.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.105.1">NB-IoT</span></strong><span class="koboSpan" id="kobo.106.1">) are all wireless communication technologies that are widely</span><a id="_idIndexMarker425"/><span class="koboSpan" id="kobo.107.1"> used for mobile communications and IoT devices. </span><span class="koboSpan" id="kobo.107.2">Each technology has its own pros and cons, and the choice of which technology to use depends on the specific requirements and </span><span class="No-Break"><span class="koboSpan" id="kobo.108.1">solution design.</span></span></p>
<p><span class="koboSpan" id="kobo.109.1">Here are some</span><a id="_idIndexMarker426"/><span class="koboSpan" id="kobo.110.1"> of the reasons why GSM, LTE, or NB-IoT are often chosen over other </span><span class="No-Break"><span class="koboSpan" id="kobo.111.1">communication technologies:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.112.1">Wide coverage</span></strong><span class="koboSpan" id="kobo.113.1">: GSM and LTE networks have extensive coverage and are available in most parts of the world, making them ideal for global connectivity. </span><span class="koboSpan" id="kobo.113.2">NB-IoT, on the other hand, has been designed specifically for IoT devices and offers greater coverage in </span><span class="No-Break"><span class="koboSpan" id="kobo.114.1">hard-to-reach areas.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.115.1">High data rates</span></strong><span class="koboSpan" id="kobo.116.1">: LTE offers high data rates, making it suitable for applications that require fast and reliable data transfer. </span><span class="koboSpan" id="kobo.116.2">NB-IoT, although slower, still offers better data rates than</span><a id="_idIndexMarker427"/><span class="koboSpan" id="kobo.117.1"> other </span><strong class="bold"><span class="koboSpan" id="kobo.118.1">Low-Power Wide-Area Network</span></strong><span class="koboSpan" id="kobo.119.1"> (</span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.120.1">LPWAN</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.121.1">) technologies.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.122.1">Security</span></strong><span class="koboSpan" id="kobo.123.1">: GSM and LTE networks offer high levels of security, with features such as encryption and authentication to protect against eavesdropping and other forms of cyberattacks. </span><span class="koboSpan" id="kobo.123.2">NB-IoT also provides end-to-end encryption for </span><span class="No-Break"><span class="koboSpan" id="kobo.124.1">data security.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.125.1">Compatibility</span></strong><span class="koboSpan" id="kobo.126.1">: GSM and LTE networks are backward compatible with previous generations of technology, allowing for seamless integration with existing infrastructure. </span><span class="koboSpan" id="kobo.126.2">NB-IoT is also designed to be compatible with LTE networks, making it easy to add IoT capabilities to existing </span><span class="No-Break"><span class="koboSpan" id="kobo.127.1">LTE networks.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.128.1">Battery life</span></strong><span class="koboSpan" id="kobo.129.1">: NB-IoT and other LPWAN technologies are designed to consume minimal power, resulting in longer battery life for </span><span class="No-Break"><span class="koboSpan" id="kobo.130.1">connected devices.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.131.1">Overall, GSM, LTE, and NB-IoT are widely used communication technologies that offer reliable connectivity, high data rates, security, and compatibility with existing infrastructure. </span><span class="koboSpan" id="kobo.131.2">Here, we have discussed the benefits of GSM/LTE/NB-IoT communication technologies over other wireless communication technologies. </span><span class="koboSpan" id="kobo.131.3">In the next section, we are going to cover global IoT SIM cards, which is the main pillar of </span><span class="No-Break"><span class="koboSpan" id="kobo.132.1">this chapter.</span></span></p>
<h1 id="_idParaDest-106"><a id="_idTextAnchor106"/><span class="koboSpan" id="kobo.133.1">Seamless global connectivity with IoT SIM cards</span></h1>
<p><span class="koboSpan" id="kobo.134.1">Global IoT SIM cards </span><a id="_idIndexMarker428"/><span class="koboSpan" id="kobo.135.1">are specifically designed for IoT devices that require cellular connectivity to communicate with the internet or other connected devices. </span><span class="koboSpan" id="kobo.135.2">These SIM cards provide access to multiple networks, allowing devices to roam across different countries and regions without the need to switch between </span><span class="No-Break"><span class="koboSpan" id="kobo.136.1">SIM cards.</span></span></p>
<p><span class="koboSpan" id="kobo.137.1">Global IoT SIM cards typically </span><a id="_idIndexMarker429"/><span class="koboSpan" id="kobo.138.1">offer features such as </span><span class="No-Break"><span class="koboSpan" id="kobo.139.1">the following:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.140.1">Multi-network coverage</span></strong><span class="koboSpan" id="kobo.141.1">: These SIM cards can connect to multiple cellular networks, including GSM, LTE, and other emerging technologies, such as NB-IoT and </span><strong class="bold"><span class="koboSpan" id="kobo.142.1">Cat-M</span></strong><span class="koboSpan" id="kobo.143.1">, to </span><a id="_idIndexMarker430"/><span class="koboSpan" id="kobo.144.1">provide reliable coverage in </span><span class="No-Break"><span class="koboSpan" id="kobo.145.1">different locations.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.146.1">Over-the-air</span></strong><span class="koboSpan" id="kobo.147.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.148.1">OTA</span></strong><span class="koboSpan" id="kobo.149.1">) </span><strong class="bold"><span class="koboSpan" id="kobo.150.1">updates</span></strong><span class="koboSpan" id="kobo.151.1">: Many global IoT SIM card providers offer OTA updates, enabling devices to receive firmware and software updates without the need for physical intervention, improving efficiency and reducing </span><span class="No-Break"><span class="koboSpan" id="kobo.152.1">maintenance costs.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.153.1">Data plans</span></strong><span class="koboSpan" id="kobo.154.1">: Global IoT SIM card providers offer flexible data plans that can be customized to suit the specific needs of a device or application. </span><span class="koboSpan" id="kobo.154.2">This includes data allowances, data speed, and the ability to add more data </span><span class="No-Break"><span class="koboSpan" id="kobo.155.1">as needed.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.156.1">Security</span></strong><span class="koboSpan" id="kobo.157.1">: Global IoT SIM cards typically come with security features such as encryption and authentication to protect data and prevent </span><span class="No-Break"><span class="koboSpan" id="kobo.158.1">unauthorized access.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.159.1">Management tools</span></strong><span class="koboSpan" id="kobo.160.1">: Many global IoT SIM card providers offer web-based portals or mobile apps that allow users to monitor and manage their SIM cards, including data usage, network performance, and </span><span class="No-Break"><span class="koboSpan" id="kobo.161.1">billing information.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.162.1">Global IoT SIM cards provide a cost-effective and flexible solution for companies, allowing them to deploy IoT devices worldwide. </span><span class="koboSpan" id="kobo.162.2">They allow seamless connectivity, ensuring that devices are always connected to the best available network, regardless </span><span class="No-Break"><span class="koboSpan" id="kobo.163.1">of location.</span></span></p>
<p><span class="koboSpan" id="kobo.164.1">There are many </span><a id="_idIndexMarker431"/><span class="koboSpan" id="kobo.165.1">IoT global SIM service providers. </span><span class="koboSpan" id="kobo.165.2">Here is a list of some </span><span class="No-Break"><span class="koboSpan" id="kobo.166.1">of them:</span></span></p>
<ul>
<li><span class="No-Break"><span class="koboSpan" id="kobo.167.1">Hologram</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.168.1">Soracom</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.169.1">Arduino SIM</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.170.1">Twilio</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.171.1">Emnify</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.172.1">Aeris</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.173.1">KORE Wireless</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.174.1">Sierra Wireless</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.175.1">Teleena</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.176.1">Thales Group</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.177.1">Truphone</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.178.1">UROS</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.179.1">1oT</span></span></li>
</ul>
<p class="callout-heading"><span class="koboSpan" id="kobo.180.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.181.1">Before buying an IoT global SIM card from any service provider, please verify whether it works in your region or not and, if so, what type of services it offers, such as GSM, </span><strong class="bold"><span class="koboSpan" id="kobo.182.1">3G</span></strong><span class="koboSpan" id="kobo.183.1">/</span><strong class="bold"><span class="koboSpan" id="kobo.184.1">4G</span></strong><span class="koboSpan" id="kobo.185.1">, or NB-IoT, as there are many regions where, for example, NB-IoT services are still </span><span class="No-Break"><span class="koboSpan" id="kobo.186.1">not available.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.187.1">Please note</span><a id="_idIndexMarker432"/><span class="koboSpan" id="kobo.188.1"> that this is not a complete list, and there are many other IoT SIM providers available in the market. </span><span class="koboSpan" id="kobo.188.2">It’s important to research and compare different providers based on your specific requirements and needs before making </span><span class="No-Break"><span class="koboSpan" id="kobo.189.1">a decision.</span></span></p>
<p><span class="koboSpan" id="kobo.190.1">Here, we have discussed global IoT SIM cards in detail and listed all the top global IoT SIM card service providers. </span><span class="koboSpan" id="kobo.190.2">Next, we are going to cover what types of hardware and sensors are required to complete the </span><span class="No-Break"><span class="koboSpan" id="kobo.191.1">chapter’s project.</span></span></p>
<h1 id="_idParaDest-107"><a id="_idTextAnchor107"/><span class="koboSpan" id="kobo.192.1">Building blocks – sensors and development boards for IoT</span></h1>
<p><span class="koboSpan" id="kobo.193.1">The Arduino series has a wide collection of development boards that vary in size, pins, and communication </span><a id="_idIndexMarker433"/><span class="koboSpan" id="kobo.194.1">technologies. </span><span class="koboSpan" id="kobo.194.2">In this chapter, I will use an Arduino MKR GSM 1400 development board, as it’s compact, battery-enabled, and </span><a id="_idIndexMarker434"/><span class="koboSpan" id="kobo.195.1">provides the support of GSM/3G/4G. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.196.1">Figure 5</span></em></span><em class="italic"><span class="koboSpan" id="kobo.197.1">.1</span></em><span class="koboSpan" id="kobo.198.1"> shows the pinout diagram for the MKR </span><span class="No-Break"><span class="koboSpan" id="kobo.199.1">GSM 1400.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer073">
<span class="koboSpan" id="kobo.200.1"><img alt="Figure 5.1 – Arduino MKR GSM 1400" src="image/B19752_05_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.201.1">Figure 5.1 – Arduino MKR GSM 1400</span></p>
<p><span class="koboSpan" id="kobo.202.1">Arduino MKR GSM 1400</span><a id="_idIndexMarker435"/><span class="koboSpan" id="kobo.203.1"> provides 7 analog pins and 14 digital input/output pins, with built-in battery charging and a LiPo battery connector for standby power, which helps developers build prototypes and solutions for remote monitoring/operations without worrying about power backups. </span><span class="koboSpan" id="kobo.203.2">For further details, please visit the official website </span><span class="No-Break"><span class="koboSpan" id="kobo.204.1">at </span></span><a href="https://store-usa.arduino.cc/products/arduino-mkr-gsm-1400"><span class="No-Break"><span class="koboSpan" id="kobo.205.1">https://store-usa.arduino.cc/products/arduino-mkr-gsm-1400</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.206.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.207.1">Arduino’s latest development board, MKR NB 1500, only supports NB-IoT, </span><strong class="bold"><span class="koboSpan" id="kobo.208.1">LTE-M</span></strong><span class="koboSpan" id="kobo.209.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.210.1">Enhanced GPRS</span></strong><span class="koboSpan" id="kobo.211.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.212.1">EGPRS</span></strong><span class="koboSpan" id="kobo.213.1">) for </span><a id="_idIndexMarker436"/><span class="koboSpan" id="kobo.214.1">SMS. </span><span class="koboSpan" id="kobo.214.2">NB-IoT and LTE-M are specially designed for IoT devices, and their popularity is spreading very rapidly across different regions. </span><span class="koboSpan" id="kobo.214.3">For complete details and specifications, visit </span><a href="https://store-usa.arduino.cc/products/arduino-mkr-nb-1500"><span class="koboSpan" id="kobo.215.1">https://store-usa.arduino.cc/products/arduino-mkr-nb-1500</span></a><span class="koboSpan" id="kobo.216.1">. </span><span class="koboSpan" id="kobo.216.2">For a list of updated regions where NB-IoT and LTE-M are deployed, </span><span class="No-Break"><span class="koboSpan" id="kobo.217.1">visit </span></span><a href="https://www.gsma.com/iot/deployment-map/"><span class="No-Break"><span class="koboSpan" id="kobo.218.1">https://www.gsma.com/iot/deployment-map/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.219.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.220.1">In this chapter, we will track the assets based on GPS location. </span><span class="koboSpan" id="kobo.220.2">To get the GPS coordinates, we will use</span><a id="_idIndexMarker437"/><span class="koboSpan" id="kobo.221.1"> the </span><strong class="bold"><span class="koboSpan" id="kobo.222.1">GY-GPS6MV2 GPS module</span></strong><span class="koboSpan" id="kobo.223.1">, which is based </span><a id="_idIndexMarker438"/><span class="koboSpan" id="kobo.224.1">on the </span><strong class="bold"><span class="koboSpan" id="kobo.225.1">NEO-6M u-blox</span></strong><span class="koboSpan" id="kobo.226.1"> chip. </span><span class="koboSpan" id="kobo.226.2">The GPS module </span><a id="_idIndexMarker439"/><span class="koboSpan" id="kobo.227.1">communicates on both software serial and hardware serial ports, but MKR GSM 1400 provides a built-in hardware serial, so we will use </span><em class="italic"><span class="koboSpan" id="kobo.228.1">Pins 13</span></em><span class="koboSpan" id="kobo.229.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.230.1">14</span></em><span class="koboSpan" id="kobo.231.1"> to communicate with the </span><span class="No-Break"><span class="koboSpan" id="kobo.232.1">GPS module.</span></span></p>
<p><span class="koboSpan" id="kobo.233.1">The GPS module </span><a id="_idIndexMarker440"/><span class="koboSpan" id="kobo.234.1">provides latitude, longitude, satellite count, altitude feet, and speed per mile data. </span><span class="koboSpan" id="kobo.234.2">We will display these properties on the dashboard for proper asset tracking. </span><span class="koboSpan" id="kobo.234.3">This module was developed in China and is available on the market at affordable prices, but </span><a id="_idIndexMarker441"/><span class="koboSpan" id="kobo.235.1">there are many other organizations that develop GPS modules based on the NEO-6M u-blox chip, such</span><a id="_idIndexMarker442"/><span class="koboSpan" id="kobo.236.1"> as </span><strong class="bold"><span class="koboSpan" id="kobo.237.1">SparkFun</span></strong><span class="koboSpan" id="kobo.238.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.239.1">Seeed Studio</span></strong><span class="koboSpan" id="kobo.240.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.241.1">Adafruit</span></strong><span class="koboSpan" id="kobo.242.1">. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.243.1">Figure 5</span></em></span><em class="italic"><span class="koboSpan" id="kobo.244.1">.2</span></em><span class="koboSpan" id="kobo.245.1"> shows</span><a id="_idIndexMarker443"/><span class="koboSpan" id="kobo.246.1"> the NEO-6M u-blox GPS module and its </span><span class="No-Break"><span class="koboSpan" id="kobo.247.1">pinout diagram:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer074">
<span class="koboSpan" id="kobo.248.1"><img alt="Figure 5.2 – The NEO-6M u-blox GY-GPS6MV2 GPS module and a pinout diagram" src="image/B19752_05_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.249.1">Figure 5.2 – The NEO-6M u-blox GY-GPS6MV2 GPS module and a pinout diagram</span></p>
<p><span class="koboSpan" id="kobo.250.1">The </span><a id="_idIndexMarker444"/><span class="koboSpan" id="kobo.251.1">preceding figure</span><a id="_idIndexMarker445"/><span class="koboSpan" id="kobo.252.1"> illustrates the pinout layout of the GPS module. </span><em class="italic"><span class="koboSpan" id="kobo.253.1">Pin #1</span></em><span class="koboSpan" id="kobo.254.1"> is a </span><strong class="bold"><span class="koboSpan" id="kobo.255.1">ground</span></strong><span class="koboSpan" id="kobo.256.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.257.1">GND</span></strong><span class="koboSpan" id="kobo.258.1">) pin that connects with the onboard GND, while </span><em class="italic"><span class="koboSpan" id="kobo.259.1">Pin #2</span></em><span class="koboSpan" id="kobo.260.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.261.1">Pin #3</span></em><span class="koboSpan" id="kobo.262.1"> are </span><strong class="bold"><span class="koboSpan" id="kobo.263.1">transmit</span></strong><span class="koboSpan" id="kobo.264.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.265.1">TX</span></strong><span class="koboSpan" id="kobo.266.1">) and </span><strong class="bold"><span class="koboSpan" id="kobo.267.1">receive</span></strong><span class="koboSpan" id="kobo.268.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.269.1">RX</span></strong><span class="koboSpan" id="kobo.270.1">) pins, respectively, and connect to </span><em class="italic"><span class="koboSpan" id="kobo.271.1">Pin #13</span></em><span class="koboSpan" id="kobo.272.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.273.1">Pin #14</span></em><span class="koboSpan" id="kobo.274.1"> of MKR GSM 1400, respectively. </span><em class="italic"><span class="koboSpan" id="kobo.275.1">Pin #4</span></em><span class="koboSpan" id="kobo.276.1"> – the </span><strong class="bold"><span class="koboSpan" id="kobo.277.1">voltage common collector</span></strong><span class="koboSpan" id="kobo.278.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.279.1">VCC</span></strong><span class="koboSpan" id="kobo.280.1">) – works with both onboard </span><a id="_idIndexMarker446"/><span class="koboSpan" id="kobo.281.1">VCC and 5V pins. </span><span class="koboSpan" id="kobo.281.2">You can solder the male headers with the GPS module or directly solder the cables without any </span><span class="No-Break"><span class="koboSpan" id="kobo.282.1">header pins.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.283.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.284.1">The GPS module works optimally in an outdoor environment. </span><span class="koboSpan" id="kobo.284.2">Make sure there is no rooftop during testing and deployment to receive a proper signal </span><span class="No-Break"><span class="koboSpan" id="kobo.285.1">from satellites.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.286.1">If you are using the module in a lab, then there will be a chance that the GPS module will not work properly. </span><span class="koboSpan" id="kobo.286.2">Remember that there is a built-in light in the GPS module that blinks when you start receiving signals </span><span class="No-Break"><span class="koboSpan" id="kobo.287.1">from satellites.</span></span></p>
<p><span class="koboSpan" id="kobo.288.1">In this section, we discussed the MKR GSM 1400 development board, which is a SIM-enabled board, and the NEO-6M u-blox GPS module, which will provide the GPS coordinates to the development board. </span><span class="koboSpan" id="kobo.288.2">We also discussed their pin layouts. </span><span class="koboSpan" id="kobo.288.3">Next, we will discuss how to connect the GPS module with the MKR GSM 1400 </span><span class="No-Break"><span class="koboSpan" id="kobo.289.1">development board.</span></span></p>
<h1 id="_idParaDest-108"><a id="_idTextAnchor108"/><span class="koboSpan" id="kobo.290.1">Designing the project architecture</span></h1>
<p><span class="koboSpan" id="kobo.291.1">In the </span><a id="_idIndexMarker447"/><span class="koboSpan" id="kobo.292.1">preceding sections, we discussed the module and development board in detail. </span><span class="koboSpan" id="kobo.292.2">Now, it’s time to cook the recipe. </span><span class="koboSpan" id="kobo.292.3">In hardware development, before starting to work with sensors and development boards, we need to develop the design concepts to get a better understanding of how things will connect. </span><span class="koboSpan" id="kobo.292.4">There is a lot of software that is available to design and develop design concepts for an electronics project, but in this case, we will </span><span class="No-Break"><span class="koboSpan" id="kobo.293.1">use Fritzing.</span></span></p>
<p><span class="koboSpan" id="kobo.294.1">In the following two subsections, we will talk about schematics and designing a project, while explaining how to connect pins with a development board and soldering. </span><span class="koboSpan" id="kobo.294.2">Then, we will do some tests to fetch GPS coordinates, which is very important before sending data to </span><span class="No-Break"><span class="koboSpan" id="kobo.295.1">the cloud.</span></span></p>
<h2 id="_idParaDest-109"><a id="_idTextAnchor109"/><span class="koboSpan" id="kobo.296.1">Schematic design and assembly</span></h2>
<p><span class="koboSpan" id="kobo.297.1">The purpose of your</span><a id="_idIndexMarker448"/><span class="koboSpan" id="kobo.298.1"> schematic design is to get a clear understanding of how sensors will connect with a development board. </span><span class="koboSpan" id="kobo.298.2">Schematic diagram helps you to develop a prototype on a </span><a id="_idIndexMarker449"/><span class="koboSpan" id="kobo.299.1">breadboard or a </span><strong class="bold"><span class="koboSpan" id="kobo.300.1">Veroboard,</span></strong><span class="koboSpan" id="kobo.301.1"> which is shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.302.1">Figure 5</span></em></span><em class="italic"><span class="koboSpan" id="kobo.303.1">.3</span></em><span class="koboSpan" id="kobo.304.1">. </span><span class="koboSpan" id="kobo.304.2">Another major benefit of designing is that Fritzing builds hardware schematics and PCB design in the background according to your design, which can </span><a id="_idIndexMarker450"/><span class="koboSpan" id="kobo.305.1">be adjusted according to system requirements. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.306.1">Figure 5</span></em></span><em class="italic"><span class="koboSpan" id="kobo.307.1">.3</span></em><span class="koboSpan" id="kobo.308.1"> shows the schematic diagram of how to connect MKR GSM 1400 with the NEO-6M u-blox </span><span class="No-Break"><span class="koboSpan" id="kobo.309.1">GPS module:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer075">
<span class="koboSpan" id="kobo.310.1"><img alt="Figure 5.3 – MKR GSM 1400 and the GPS module schematic" src="image/B19752_05_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.311.1">Figure 5.3 – MKR GSM 1400 and the GPS module schematic</span></p>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.312.1">Figure 5</span></em></span><em class="italic"><span class="koboSpan" id="kobo.313.1">.3</span></em><span class="koboSpan" id="kobo.314.1"> is schematic </span><a id="_idIndexMarker451"/><span class="koboSpan" id="kobo.315.1">diagram of project, but for ease I also </span><a id="_idIndexMarker452"/><span class="koboSpan" id="kobo.316.1">created </span><em class="italic"><span class="koboSpan" id="kobo.317.1">Table 5.1,</span></em><span class="koboSpan" id="kobo.318.1"> which demonstrates MKR GSM 1400 to GPS Module pin numbers </span><span class="No-Break"><span class="koboSpan" id="kobo.319.1">and names.</span></span></p>
<table class="No-Table-Style _idGenTablePara-1" id="table001-2">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="bold"><span class="koboSpan" id="kobo.320.1">MKR GSM </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.321.1">1400 Board</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.322.1">GPS Module</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.323.1">5V</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.324.1">VCC</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.325.1">GND</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.326.1">GND</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.327.1">14 TX</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.328.1">RX</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.329.1">13 RX</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.330.1">TX</span></span></p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.331.1">Table 5.1 – MKR GSM 1400 and the GPS module pin connections list</span></p>
<p><span class="koboSpan" id="kobo.332.1">The preceding </span><a id="_idIndexMarker453"/><span class="koboSpan" id="kobo.333.1">design provides a full overview of how you </span><a id="_idIndexMarker454"/><span class="koboSpan" id="kobo.334.1">can connect a module to a development board. </span><span class="koboSpan" id="kobo.334.2">According to our design, we have 5V and GND from the development board to the GPS module. </span><span class="koboSpan" id="kobo.334.3">The GPS module TX is connected to the RX (</span><em class="italic"><span class="koboSpan" id="kobo.335.1">Pin #13</span></em><span class="koboSpan" id="kobo.336.1">) and the GPS module RX pin is connected to the TX (</span><em class="italic"><span class="koboSpan" id="kobo.337.1">Pin #14</span></em><span class="koboSpan" id="kobo.338.1">) of the development board. </span><em class="italic"><span class="koboSpan" id="kobo.339.1">Table 5.1</span></em><span class="koboSpan" id="kobo.340.1"> shows the pin information. </span><span class="koboSpan" id="kobo.340.2">Finally, we have built our prototype by using a breadboard, which is shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.341.1">Figure 5</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.342.1">.4</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.343.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer076">
<span class="koboSpan" id="kobo.344.1"><img alt="Figure 5.4 – The final prototype" src="image/B19752_05_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.345.1">Figure 5.4 – The final prototype</span></p>
<p><span class="koboSpan" id="kobo.346.1">After soldering the male headers to the GPS module, connect the pins according to the schematic diagram. </span><span class="koboSpan" id="kobo.346.2">There is only one sensor, so there is no requirement for the Veroboard. </span><span class="koboSpan" id="kobo.346.3">Next, we are going to test the GPS module using a serial monitor to verify that our GPS module is working properly and getting the values </span><span class="No-Break"><span class="koboSpan" id="kobo.347.1">from GPS.</span></span></p>
<h2 id="_idParaDest-110"><a id="_idTextAnchor110"/><span class="koboSpan" id="kobo.348.1">Testing GPS module data</span></h2>
<p><span class="koboSpan" id="kobo.349.1">For </span><a id="_idIndexMarker455"/><span class="koboSpan" id="kobo.350.1">module testing, we need a </span><strong class="bold"><span class="koboSpan" id="kobo.351.1">serial monitor</span></strong><span class="koboSpan" id="kobo.352.1"> to </span><a id="_idIndexMarker456"/><span class="koboSpan" id="kobo.353.1">verify whether the GPS module works properly or not. </span><span class="koboSpan" id="kobo.353.2">Select the Arduino MKR GSM 1400 board from </span><strong class="bold"><span class="koboSpan" id="kobo.354.1">Tools</span></strong><span class="koboSpan" id="kobo.355.1"> &gt; </span><strong class="bold"><span class="koboSpan" id="kobo.356.1">Board</span></strong><span class="koboSpan" id="kobo.357.1"> &gt; </span><strong class="bold"><span class="koboSpan" id="kobo.358.1">Arduino SAMD</span></strong><span class="koboSpan" id="kobo.359.1"> &gt; </span><strong class="bold"><span class="koboSpan" id="kobo.360.1">Arduino MKR GSM 1400</span></strong><span class="koboSpan" id="kobo.361.1"> in the Arduino IDE. </span><span class="koboSpan" id="kobo.361.2">Select the port of the development board. </span><span class="koboSpan" id="kobo.361.3">Next, we need to install a library for the GPS module. </span><span class="koboSpan" id="kobo.361.4">Navigate to </span><strong class="bold"><span class="koboSpan" id="kobo.362.1">Sketch</span></strong><span class="koboSpan" id="kobo.363.1"> &gt; </span><strong class="bold"><span class="koboSpan" id="kobo.364.1">Include Library</span></strong><span class="koboSpan" id="kobo.365.1"> &gt; </span><strong class="bold"><span class="koboSpan" id="kobo.366.1">Manage Libraries</span></strong><span class="koboSpan" id="kobo.367.1">. </span><span class="koboSpan" id="kobo.367.2">Type </span><strong class="source-inline"><span class="koboSpan" id="kobo.368.1">tinygps</span></strong><span class="koboSpan" id="kobo.369.1"> into the </span><span class="No-Break"><span class="koboSpan" id="kobo.370.1">search bar.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer077">
<span class="koboSpan" id="kobo.371.1"><img alt="Figure 5.5 – The TinyGPSPlus library" src="image/B19752_05_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.372.1">Figure 5.5 – The TinyGPSPlus library</span></p>
<p><span class="koboSpan" id="kobo.373.1">After searching, </span><strong class="bold"><span class="koboSpan" id="kobo.374.1">Library Manager</span></strong><span class="koboSpan" id="kobo.375.1"> shows a lot of libraries. </span><span class="koboSpan" id="kobo.375.2">Select the </span><strong class="bold"><span class="koboSpan" id="kobo.376.1">TinyGPSPlus</span></strong><span class="koboSpan" id="kobo.377.1"> library and install its latest version. </span><span class="koboSpan" id="kobo.377.2">The library comes with a lot of examples, but all are based on software serial. </span><span class="koboSpan" id="kobo.377.3">However, </span><strong class="bold"><span class="koboSpan" id="kobo.378.1">Arduino SAMD</span></strong><span class="koboSpan" id="kobo.379.1"> boards </span><a id="_idIndexMarker457"/><span class="koboSpan" id="kobo.380.1">provide hardware serial, so I modified the code that uses hardware serial to communicate with the </span><span class="No-Break"><span class="koboSpan" id="kobo.381.1">GPS module.</span></span></p>
<p><span class="koboSpan" id="kobo.382.1">Download the code from the book’s official GitHub repository in the chapter folder, open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.383.1">MKR-1400-NEO-6M-GPS-Module</span></strong><span class="koboSpan" id="kobo.384.1"> code, and upload it to the </span><span class="No-Break"><span class="koboSpan" id="kobo.385.1">development board:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.386.1">
while(Serial1.available()&gt;0)//While there are characters to come from the GPS
  {
    gps.encode(Serial1.read());//This feeds the serial NMEA data into the library one char at a time
  }
  if(gps.location.isUpdated())//This will pretty much be fired all the time anyway but will at least reduce it to only after a package of NMEA data comes in
  {
    //Get the latest info from the gps object which it derived from the data sent by the GPS unit
    Serial.println("Satellite Count:");
    Serial.println(gps.satellites.value());
    Serial.println("Latitude:");
    Serial.println(gps.location.lat(), 6);
    Serial.println("Longitude:");
    Serial.println(gps.location.lng(), 6);
    Serial.println("Speed MPH:");
    Serial.println(gps.speed.mph());
    Serial.println("Altitude Feet:");
    Serial.println(gps.altitude.feet());
    Serial.println("");
  }</span></pre> <p><span class="koboSpan" id="kobo.387.1">In the </span><a id="_idIndexMarker458"/><span class="koboSpan" id="kobo.388.1">setup, we have initialized </span><strong class="source-inline"><span class="koboSpan" id="kobo.389.1">Serial</span></strong><span class="koboSpan" id="kobo.390.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.391.1">Serial1</span></strong><span class="koboSpan" id="kobo.392.1">. </span><strong class="source-inline"><span class="koboSpan" id="kobo.393.1">Serial</span></strong><span class="koboSpan" id="kobo.394.1"> is used to display the content on the serial monitor, while </span><strong class="source-inline"><span class="koboSpan" id="kobo.395.1">Serial1</span></strong><span class="koboSpan" id="kobo.396.1"> is the hardware serial that is used to communicate with the GPS module. </span><span class="koboSpan" id="kobo.396.2">The preceding code belongs to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.397.1">loop()</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.398.1"> method.</span></span></p>
<p><span class="koboSpan" id="kobo.399.1">First, the </span><a id="_idIndexMarker459"/><span class="koboSpan" id="kobo.400.1">GPS module will read the data from satellites using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.401.1">Serial1.read()</span></strong><span class="koboSpan" id="kobo.402.1"> method and encode the data via the </span><strong class="source-inline"><span class="koboSpan" id="kobo.403.1">gps.encode()</span></strong><span class="koboSpan" id="kobo.404.1"> method. </span><strong class="source-inline"><span class="koboSpan" id="kobo.405.1">Serial1</span></strong><span class="koboSpan" id="kobo.406.1"> only reads one character at a time, so it will take a little bit of time to update the values. </span><span class="koboSpan" id="kobo.406.2">Next, we will verify whether there is any update in location by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.407.1">gps.location.isUpdated()</span></strong><span class="koboSpan" id="kobo.408.1"> method. </span><span class="koboSpan" id="kobo.408.2">If there is a change, then data will be printed on the </span><span class="No-Break"><span class="koboSpan" id="kobo.409.1">serial monitor.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.410.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.411.1">Make sure that your GPS module is placed in an open environment where you have a clear sky without any obstructions, such as a roof or anything similar, to properly receive signals </span><span class="No-Break"><span class="koboSpan" id="kobo.412.1">from satellites.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.413.1">The GPS module has an onboard built-in LED that starts blinking when it receives data </span><span class="No-Break"><span class="koboSpan" id="kobo.414.1">from GPS.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.415.1">The same code will work with MKR NB 1500 without </span><span class="No-Break"><span class="koboSpan" id="kobo.416.1">any modification.</span></span></p>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.417.1">Figure 5</span></em></span><em class="italic"><span class="koboSpan" id="kobo.418.1">.6</span></em><span class="koboSpan" id="kobo.419.1"> shows the serial monitor with values from the GPS, which includes latitude and longitude, along with </span><span class="No-Break"><span class="koboSpan" id="kobo.420.1">other parameters:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer078">
<span class="koboSpan" id="kobo.421.1"><img alt="Figure 5.6 – GPS module data on the serial monitor" src="image/B19752_05_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.422.1">Figure 5.6 – GPS module data on the serial monitor</span></p>
<p><span class="koboSpan" id="kobo.423.1">The</span><a id="_idIndexMarker460"/><span class="koboSpan" id="kobo.424.1"> preceding figure shows the data that is received by the GPS module from GPS satellites and printed on the serial monitor. </span><span class="koboSpan" id="kobo.424.2">The data includes the satellite count, the latitude and longitude that represent the location coordinates, the speed in </span><strong class="bold"><span class="koboSpan" id="kobo.425.1">miles per hour</span></strong><span class="koboSpan" id="kobo.426.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.427.1">MPH</span></strong><span class="koboSpan" id="kobo.428.1">) based on current and previous GPS coordinates, and the altitude </span><span class="No-Break"><span class="koboSpan" id="kobo.429.1">in feet.</span></span></p>
<p><span class="koboSpan" id="kobo.430.1">In this section, we tested the NEO-6M u-blox GPS module in the Arduino IDE. </span><span class="koboSpan" id="kobo.430.2">First, we installed the TinyGPSPlus library for the module and then we used the preceding code for the development board, which shows the readings on the serial monitor. </span><span class="koboSpan" id="kobo.430.3">In the next section, we are going to start with the global IoT SIM </span><span class="No-Break"><span class="koboSpan" id="kobo.431.1">card activation.</span></span></p>
<h1 id="_idParaDest-111"><a id="_idTextAnchor111"/><span class="koboSpan" id="kobo.432.1">Activating SIM cards for IoT deployment</span></h1>
<p><span class="koboSpan" id="kobo.433.1">After</span><a id="_idIndexMarker461"/><span class="koboSpan" id="kobo.434.1"> assembling the GPS module with MKR GSM 1400 and testing it, it’s time to activate the Hologram global IoT SIM card, which will act as a bridge between the device and the Arduino IoT Cloud. </span><span class="koboSpan" id="kobo.434.2">You can purchase the IoT SIM card from </span><a href="https://store.hologram.io/store/"><span class="koboSpan" id="kobo.435.1">https://store.hologram.io/store/</span></a><span class="koboSpan" id="kobo.436.1">. </span><span class="koboSpan" id="kobo.436.2">It provides different types of SIM cards for industries, such as</span><a id="_idIndexMarker462"/><span class="koboSpan" id="kobo.437.1"> the </span><strong class="bold"><span class="koboSpan" id="kobo.438.1">Hyper EUICC IoT SIM card</span></strong><span class="koboSpan" id="kobo.439.1">, which is an industrial-grade and simple SIM card for learning projects, and these are available in different sizes according to the SIM slots in the development boards. </span><span class="koboSpan" id="kobo.439.2">You can order</span><a id="_idIndexMarker463"/><span class="koboSpan" id="kobo.440.1"> its </span><strong class="bold"><span class="koboSpan" id="kobo.441.1">pilot SIM card</span></strong><span class="koboSpan" id="kobo.442.1"> for free, but you need to pay for </span><span class="No-Break"><span class="koboSpan" id="kobo.443.1">its shipment.</span></span></p>
<p><span class="koboSpan" id="kobo.444.1">After receiving the SIM card, create an account at </span><a href="http://hologram.io"><span class="koboSpan" id="kobo.445.1">hologram.io</span></a><span class="koboSpan" id="kobo.446.1">, where you will be able to activate and manage all your SIM cards. </span><span class="koboSpan" id="kobo.446.2">The Hologram dashboard provides full details regarding the data utilization of devices, packages, billing, and routes. </span><span class="koboSpan" id="kobo.446.3">By setting up routes, you can forward your device data to a different IoT cloud if you directly send it to the Hologram cloud. </span><span class="koboSpan" id="kobo.446.4">However, in our case, we will just use the Hologram SIM card as a carrier to </span><a id="_idIndexMarker464"/><span class="koboSpan" id="kobo.447.1">transfer data from a device directly to the Arduino IoT Cloud, so there will be no requirements to set up a route. </span><span class="koboSpan" id="kobo.447.2">Just activate the SIM card and insert it into the MKR GSM 1400 </span><span class="No-Break"><span class="koboSpan" id="kobo.448.1">development board.</span></span></p>
<p><span class="koboSpan" id="kobo.449.1">In this section, we discussed how we can proceed with Hologram global IoT SIM card activation as well as the different types of SIM cards available at </span><a href="http://hologram.io"><span class="koboSpan" id="kobo.450.1">hologram.io</span></a><span class="koboSpan" id="kobo.451.1"> for researchers as well as industry. </span><span class="koboSpan" id="kobo.451.2">In the next section, we are going to set up the Thing in the Arduino IoT Cloud, which will include cloud variables creation, device association, network configuration, </span><span class="No-Break"><span class="koboSpan" id="kobo.452.1">and code.</span></span></p>
<h1 id="_idParaDest-112"><a id="_idTextAnchor112"/><span class="koboSpan" id="kobo.453.1">Configuring the Thing, network credentials, cloud variables, and code</span></h1>
<p><span class="koboSpan" id="kobo.454.1">After setting</span><a id="_idIndexMarker465"/><span class="koboSpan" id="kobo.455.1"> up the hardware, it’s time to set up the Thing in the Arduino IoT Cloud. </span><span class="koboSpan" id="kobo.455.2">For this project, we need four cloud variables to fetch different properties from the device. </span><span class="koboSpan" id="kobo.455.3">The network settings will be different as we are using a GSM series board instead of Wi-Fi. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.456.1">Figure 5</span></em></span><em class="italic"><span class="koboSpan" id="kobo.457.1">.7</span></em><span class="koboSpan" id="kobo.458.1"> shows the complete overview of </span><span class="No-Break"><span class="koboSpan" id="kobo.459.1">the Thing:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer079">
<span class="koboSpan" id="kobo.460.1"><img alt="Figure 5.7 – A portable Thing tracker using the MKR GSM 1400 Thing setup" src="image/B19752_05_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.461.1">Figure 5.7 – A portable Thing tracker using the MKR GSM 1400 Thing setup</span></p>
<p><span class="koboSpan" id="kobo.462.1">Set up a new Thing</span><a id="_idIndexMarker466"/><span class="koboSpan" id="kobo.463.1"> with the name </span><strong class="source-inline"><span class="koboSpan" id="kobo.464.1">A portable thing tracker using MKR GSM1400</span></strong><span class="koboSpan" id="kobo.465.1">. </span><span class="koboSpan" id="kobo.465.2">Then, follow these steps to create cloud variables, an associate device, a network configuration, and finally, </span><span class="No-Break"><span class="koboSpan" id="kobo.466.1">the code:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.467.1">Firstly, we need to set up four cloud variables for location, altitude feet, satellite count, and speed. </span><span class="koboSpan" id="kobo.467.2">The complete details regarding these cloud variables are available in the </span><span class="No-Break"><span class="koboSpan" id="kobo.468.1">following section.</span></span></li>
<li><span class="koboSpan" id="kobo.469.1">Then, we need to associate the device with the Thing. </span><span class="koboSpan" id="kobo.469.2">In the current project, we will use the MKR GSM 1400, so the wizard will be the same one used for the Arduino boards. </span><span class="koboSpan" id="kobo.469.3">The complete details are available in the </span><em class="italic"><span class="koboSpan" id="kobo.470.1">Associating a </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.471.1">device</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.472.1"> section.</span></span></li>
<li><span class="koboSpan" id="kobo.473.1">Finally, we need to set up a network configuration for the device, but this time, we need to provide</span><a id="_idIndexMarker467"/><span class="koboSpan" id="kobo.474.1"> different settings for the GSM board, which will be covered in the </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.475.1">Network</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.476.1"> subsection.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.477.1">Here, we have discussed what steps will be involved in the Thing creation. </span><span class="koboSpan" id="kobo.477.2">In the following subsections, we will create cloud variables, associate a device to the Thing, and network settings in separate subsections step </span><span class="No-Break"><span class="koboSpan" id="kobo.478.1">by step.</span></span></p>
<h2 id="_idParaDest-113"><a id="_idTextAnchor113"/><span class="koboSpan" id="kobo.479.1">Cloud variables</span></h2>
<p><span class="koboSpan" id="kobo.480.1">The following table </span><a id="_idIndexMarker468"/><span class="koboSpan" id="kobo.481.1">explains all the properties that we need to use during cloud variable creation. </span><span class="koboSpan" id="kobo.481.2">For </span><strong class="source-inline"><span class="koboSpan" id="kobo.482.1">Location</span></strong><span class="koboSpan" id="kobo.483.1">, we need two different variables to store latitude and longitude, but thanks to the Arduino IoT Cloud extended group of variables, we have a </span><strong class="source-inline"><span class="koboSpan" id="kobo.484.1">Location</span></strong><span class="koboSpan" id="kobo.485.1"> type variable. </span><span class="koboSpan" id="kobo.485.2">Next, make sure each variable matches the declaration in the table; otherwise, you need to modify the example code according to </span><span class="No-Break"><span class="koboSpan" id="kobo.486.1">your naming.</span></span></p>
<p><span class="koboSpan" id="kobo.487.1">In </span><em class="italic"><span class="koboSpan" id="kobo.488.1">Table 5.2</span></em><span class="koboSpan" id="kobo.489.1">, during the cloud variables creation, I made the permission </span><em class="italic"><span class="koboSpan" id="kobo.490.1">read-only</span></em><span class="koboSpan" id="kobo.491.1">. </span><span class="koboSpan" id="kobo.491.2">Although we have the read/write option, in this project, we only want to receive data from the device instead of modifying it on the dashboard. </span><span class="koboSpan" id="kobo.491.3">That’s why read-only mode is used – to prevent issues with data consistency. </span><strong class="bold"><span class="koboSpan" id="kobo.492.1">Update Policy</span></strong><span class="koboSpan" id="kobo.493.1"> is set to </span><strong class="bold"><span class="koboSpan" id="kobo.494.1">On change</span></strong><span class="koboSpan" id="kobo.495.1">, as the device will send the data when the GPS module receives new data </span><span class="No-Break"><span class="koboSpan" id="kobo.496.1">from satellites.</span></span></p>
<table class="No-Table-Style _idGenTablePara-1" id="table002-1">
<colgroup>
<col/>
<col/>
<col/>
<col/>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="bold"><span class="koboSpan" id="kobo.497.1">#</span></strong></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.498.1">Variable name</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.499.1">Variable type</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.500.1">Declaration</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.501.1">Permission</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.502.1">Update policy</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.503.1">1</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.504.1">AltitudeFeet</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.505.1">Float</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.506.1">altitudeFeet</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.507.1">Read-only</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.508.1">On change</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.509.1">2</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.510.1">Location</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.511.1">CloudLocation</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.512.1">location</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.513.1">Read-only</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.514.1">On change</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.515.1">3</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.516.1">SatelliteCount</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.517.1">Int</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.518.1">satelliteCount</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.519.1">Read-only</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.520.1">On change</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.521.1">4</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.522.1">Speed</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.523.1">Float</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.524.1">speed</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.525.1">Read-only</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.526.1">On change</span></strong></span></p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.527.1">Table 5.2 – Cloud variables list for the Thing</span></p>
<p><span class="koboSpan" id="kobo.528.1">In this section, we</span><a id="_idIndexMarker469"/><span class="koboSpan" id="kobo.529.1"> have discussed what type of cloud variables are required for this project. </span><span class="koboSpan" id="kobo.529.2">Here, we have listed four cloud variables of different types but in read-only mode, as we only want to take the values from the device. </span><span class="koboSpan" id="kobo.529.3">In the next subsection, we are going to associate the MKR GSM 1400 with </span><span class="No-Break"><span class="koboSpan" id="kobo.530.1">the Thing.</span></span></p>
<h2 id="_idParaDest-114"><a id="_idTextAnchor114"/><span class="koboSpan" id="kobo.531.1">Associating a device</span></h2>
<p><span class="koboSpan" id="kobo.532.1">After creating </span><a id="_idIndexMarker470"/><span class="koboSpan" id="kobo.533.1">the variables, it’s time to add the device and associate it with the Thing. </span><span class="koboSpan" id="kobo.533.2">Before adding the device, connect the development board to the computer and open the </span><strong class="bold"><span class="koboSpan" id="kobo.534.1">Arduino Create Agent</span></strong><span class="koboSpan" id="kobo.535.1"> application. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.536.1">Figure 5</span></em></span><em class="italic"><span class="koboSpan" id="kobo.537.1">.8</span></em><span class="koboSpan" id="kobo.538.1"> shows a popup in which we have options to either select the existing device for association or set up a new device that is not available in </span><span class="No-Break"><span class="koboSpan" id="kobo.539.1">the list:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer080">
<span class="koboSpan" id="kobo.540.1"><img alt="Figure 5.8 – Associate device" src="image/B19752_05_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.541.1">Figure 5.8 – Associate device</span></p>
<p><span class="koboSpan" id="kobo.542.1">In our case, we </span><a id="_idIndexMarker471"/><span class="koboSpan" id="kobo.543.1">already have different devices in the portal, but we want to add a new MKR GSM 1400 device, so just click on </span><strong class="bold"><span class="koboSpan" id="kobo.544.1">SET UP NEW DEVICE</span></strong><span class="koboSpan" id="kobo.545.1"> to configure the new device in </span><span class="No-Break"><span class="koboSpan" id="kobo.546.1">the account.</span></span></p>
<p><span class="koboSpan" id="kobo.547.1">Then, you will see two options in the popup (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.548.1">Figure 5</span></em></span><em class="italic"><span class="koboSpan" id="kobo.549.1">.9</span></em><span class="koboSpan" id="kobo.550.1">). </span><span class="koboSpan" id="kobo.550.2">The first option is to set up an Arduino board, and the second option is to set up a third party device. </span><span class="koboSpan" id="kobo.550.3">Here, you will see a note under both </span><a id="_idIndexMarker472"/><span class="koboSpan" id="kobo.551.1">options, </span><strong class="bold"><span class="koboSpan" id="kobo.552.1">Compatible devices</span></strong><span class="koboSpan" id="kobo.553.1"> (</span><span class="koboSpan" id="kobo.554.1"><img alt="" role="presentation" src="image/Icon.png"/></span><span class="koboSpan" id="kobo.555.1">), which means you can only use certain types of Arduino devices as well as third-party devices in the Arduino </span><span class="No-Break"><span class="koboSpan" id="kobo.556.1">IoT Cloud.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer082">
<span class="koboSpan" id="kobo.557.1"><img alt="Figure 5.9 – Choosing a development device" src="image/B19752_05_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.558.1">Figure 5.9 – Choosing a development device</span></p>
<p><span class="koboSpan" id="kobo.559.1">We can select any one option from the popup, according to the available device. </span><span class="koboSpan" id="kobo.559.2">However, in this case, click on the option to set up an Arduino device, as, in this chapter, we will use the MKR GSM 1400 board. </span><span class="koboSpan" id="kobo.559.3">Before adding the device, make sure that Arduino Create Agent</span><a id="_idIndexMarker473"/><span class="koboSpan" id="kobo.560.1"> runs on </span><span class="No-Break"><span class="koboSpan" id="kobo.561.1">your machine.</span></span></p>
<p><span class="koboSpan" id="kobo.562.1">In this subsection, we have associated the MKR GSM 1400 development board with the Thing. </span><span class="koboSpan" id="kobo.562.2">Next, we will configure the network settings in the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.563.1">Thing</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.564.1"> tab.</span></span></p>
<h2 id="_idParaDest-115"><a id="_idTextAnchor115"/><span class="koboSpan" id="kobo.565.1">Network</span></h2>
<p><span class="koboSpan" id="kobo.566.1">After</span><a id="_idIndexMarker474"/><span class="koboSpan" id="kobo.567.1"> associating the device with the Thing, it is time to configure the network settings for device communication. </span><span class="koboSpan" id="kobo.567.2">These network settings are different from the Wi-Fi network settings. </span><span class="koboSpan" id="kobo.567.3">Both the MKR GSM 1400 and MKR NB 1500 development boards use SIM technology for communication. </span><span class="koboSpan" id="kobo.567.4">For that reason, their network configurations are different and will vary according to the IoT SIM card service provider. </span><span class="koboSpan" id="kobo.567.5">The following figure (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.568.1">Figure 5</span></em></span><em class="italic"><span class="koboSpan" id="kobo.569.1">.10</span></em><span class="koboSpan" id="kobo.570.1">) shows the </span><strong class="bold"><span class="koboSpan" id="kobo.571.1">Configure network</span></strong><span class="koboSpan" id="kobo.572.1"> popup for the MKR GSM 1400, which is totally different to the Wi-Fi configuration due to </span><span class="No-Break"><span class="koboSpan" id="kobo.573.1">cellular communication:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer083">
<span class="koboSpan" id="kobo.574.1"><img alt="Figure 5.10 – The network configuration for the MKR GSM 1400" src="image/B19752_05_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.575.1">Figure 5.10 – The network configuration for the MKR GSM 1400</span></p>
<p><span class="koboSpan" id="kobo.576.1">Currently, we are</span><a id="_idIndexMarker475"/><span class="koboSpan" id="kobo.577.1"> using the Hologram global IoT SIM card, and only need to mention </span><strong class="source-inline"><span class="koboSpan" id="kobo.578.1">hologram</span></strong><span class="koboSpan" id="kobo.579.1"> under </span><strong class="bold"><span class="koboSpan" id="kobo.580.1">APN</span></strong><span class="koboSpan" id="kobo.581.1">; there is no requirement for the </span><strong class="bold"><span class="koboSpan" id="kobo.582.1">PIN</span></strong><span class="koboSpan" id="kobo.583.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.584.1">Username</span></strong><span class="koboSpan" id="kobo.585.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.586.1">Password</span></strong><span class="koboSpan" id="kobo.587.1"> details. </span><span class="koboSpan" id="kobo.587.2">However, if you use the Arduino SIM, then </span><strong class="bold"><span class="koboSpan" id="kobo.588.1">APN</span></strong><span class="koboSpan" id="kobo.589.1"> will be </span><strong class="source-inline"><span class="koboSpan" id="kobo.590.1">prepay.pelion</span></strong><span class="koboSpan" id="kobo.591.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.592.1">PIN</span></strong><span class="koboSpan" id="kobo.593.1"> will be </span><strong class="source-inline"><span class="koboSpan" id="kobo.594.1">0000</span></strong><span class="koboSpan" id="kobo.595.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.596.1">Username</span></strong><span class="koboSpan" id="kobo.597.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.598.1">Password</span></strong><span class="koboSpan" id="kobo.599.1"> will both be </span><strong class="source-inline"><span class="koboSpan" id="kobo.600.1">arduino</span></strong><span class="koboSpan" id="kobo.601.1">. </span><span class="koboSpan" id="kobo.601.2">Before using any other global IoT SIM card, first, take its APN information to set up the </span><span class="No-Break"><span class="koboSpan" id="kobo.602.1">network properly.</span></span></p>
<p><span class="koboSpan" id="kobo.603.1">Here, we have</span><a id="_idIndexMarker476"/><span class="koboSpan" id="kobo.604.1"> discussed the network configuration for the Arduino MKR GSM 1400, which includes the APN, PIN, username, and password. </span><span class="koboSpan" id="kobo.604.2">In the next section, we will cover the code for the </span><span class="No-Break"><span class="koboSpan" id="kobo.605.1">development board.</span></span></p>
<h2 id="_idParaDest-116"><a id="_idTextAnchor116"/><span class="koboSpan" id="kobo.606.1">Coding</span></h2>
<p><span class="koboSpan" id="kobo.607.1">The chapter’s code is</span><a id="_idIndexMarker477"/><span class="koboSpan" id="kobo.608.1"> available at the book’s official GitHub repository. </span><span class="koboSpan" id="kobo.608.2">Download </span><strong class="source-inline"><span class="koboSpan" id="kobo.609.1">A_portable_thing_tracker_using_MKR_GSM1400_apr07a.zip</span></strong><span class="koboSpan" id="kobo.610.1"> and import it into the Arduino </span><span class="No-Break"><span class="koboSpan" id="kobo.611.1">Web Editor.</span></span></p>
<p><span class="koboSpan" id="kobo.612.1">You can download the code and put it into your Thing by navigating to the </span><strong class="bold"><span class="koboSpan" id="kobo.613.1">Sketch</span></strong><span class="koboSpan" id="kobo.614.1"> tab. </span><span class="koboSpan" id="kobo.614.2">Here, I will explain the main workflow instead of all code, we are initializing all the objects and variables in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.615.1">setup()</span></strong><span class="koboSpan" id="kobo.616.1"> method; remember to never try to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.617.1">delay</span></strong><span class="koboSpan" id="kobo.618.1"> method, as it will block the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.619.1">ArduinoCloud.update()</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.620.1"> method:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.621.1">
TinyGPSPlus gps;
unsigned long previousMillis = 0;
const long interval = 30000; //milliseconds</span></pre> <p><span class="koboSpan" id="kobo.622.1">In the preceding code snippet, we declare the </span><strong class="source-inline"><span class="koboSpan" id="kobo.623.1">gps</span></strong><span class="koboSpan" id="kobo.624.1"> instance and two variables, which will be used to wait for 30,000 milliseconds (30 seconds) before taking the next readings without blocking </span><span class="No-Break"><span class="koboSpan" id="kobo.625.1">the code.</span></span></p>
<p><span class="koboSpan" id="kobo.626.1">Next, we will move toward the </span><strong class="source-inline"><span class="koboSpan" id="kobo.627.1">loop</span></strong><span class="koboSpan" id="kobo.628.1"> method. </span><span class="koboSpan" id="kobo.628.2">Here, we call the </span><strong class="source-inline"><span class="koboSpan" id="kobo.629.1">FetchGPS()</span></strong><span class="koboSpan" id="kobo.630.1"> method after every 30 minutes, which is carried out by comparing </span><strong class="source-inline"><span class="koboSpan" id="kobo.631.1">currentMillis</span></strong><span class="koboSpan" id="kobo.632.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.633.1">previousMillis</span></strong><span class="koboSpan" id="kobo.634.1"> without the use </span><span class="No-Break"><span class="koboSpan" id="kobo.635.1">of delay:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.636.1">
  unsigned long currentMillis = millis();
  if (currentMillis - previousMillis &gt;= interval) {
    //speed=currentMillis;
    FetchGPS();
    previousMillis = currentMillis;
  }</span></pre> <p><span class="koboSpan" id="kobo.637.1">In the following snippet, I have just picked a small part of the code from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.638.1">FetchGPS()</span></strong><span class="koboSpan" id="kobo.639.1"> method. </span><span class="koboSpan" id="kobo.639.2">Here, I assign the latest values from the GPS module to the Arduino cloud </span><a id="_idIndexMarker478"/><span class="koboSpan" id="kobo.640.1">variables, which will be used to send data to the cloud as well as print it on the </span><span class="No-Break"><span class="koboSpan" id="kobo.641.1">serial monitor:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.642.1">
if (gps.location.isUpdated())
  {
    altitudeFeet = gps.altitude.feet();
    satelliteCount = gps.satellites.value();
    speed = gps.speed.mph();
    location = Location(gps.location.lat(), gps.location.lng());
    Location cordinates = location.getValue();
 .
 </span><span class="koboSpan" id="kobo.642.2">.
 </span><span class="koboSpan" id="kobo.642.3">.
</span><span class="koboSpan" id="kobo.642.4">}</span></pre> <p><span class="koboSpan" id="kobo.643.1">Upload the code to the device and open up the Arduino Web Editor serial monitor to verify the values. </span><span class="koboSpan" id="kobo.643.2">After successfully uploading the data to the cloud, it’s time to set up a beautiful dashboard for web and mobile for </span><span class="No-Break"><span class="koboSpan" id="kobo.644.1">end users.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.645.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.646.1">If you used different names in the variable declaration, then update the code according to your naming scheme. </span><span class="koboSpan" id="kobo.646.2">However, it’s better to first follow all the steps according to the book and later change the cloud variable names, modifying your </span><span class="No-Break"><span class="koboSpan" id="kobo.647.1">code respectively.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.648.1">Never try to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.649.1">delay</span></strong><span class="koboSpan" id="kobo.650.1"> method, which will create a block for the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.651.1">ArduinoCloud.update()</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.652.1"> method.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.653.1">The Arduino IoT Cloud only updates a value on the dashboard whenever a variable value is changed. </span><span class="koboSpan" id="kobo.653.2">For example, if the GPS location of the device is the same after an interval of time, then it means the device is not moving. </span><span class="koboSpan" id="kobo.653.3">Then, the Arduino IoT Cloud will not record the value, so don’t get confused if values are not changing on the map. </span><span class="koboSpan" id="kobo.653.4">Another benefit of this feature is that you will not get duplicate data when you export </span><span class="No-Break"><span class="koboSpan" id="kobo.654.1">the content.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.655.1">The same code will work with MKR NB 1500 without any modification. </span><span class="koboSpan" id="kobo.655.2">However, here, you need to associate the MKR NB 1500 device with the Thing instead of the MKR </span><span class="No-Break"><span class="koboSpan" id="kobo.656.1">GSM 1400.</span></span></p>
<h1 id="_idParaDest-117"><a id="_idTextAnchor117"/><span class="koboSpan" id="kobo.657.1">Creating comprehensive web and mobile dashboards</span></h1>
<p><span class="koboSpan" id="kobo.658.1">After </span><a id="_idIndexMarker479"/><span class="koboSpan" id="kobo.659.1">uploading the code to the device, it’s time to set up a dashboard for web and mobile to visualize the data with different widgets. </span><span class="koboSpan" id="kobo.659.2">The following figure demonstrates the visualization of readings with </span><span class="No-Break"><span class="koboSpan" id="kobo.660.1">different widgets:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer084">
<span class="koboSpan" id="kobo.661.1"><img alt="Figure 5.11 – The Thing dashboard" src="image/B19752_05_11.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.662.1">Figure 5.11 – The Thing dashboard</span></p>
<p><span class="koboSpan" id="kobo.663.1">We have four readings from the GPS module to visualize; here, I have used three widgets, </span><strong class="bold"><span class="koboSpan" id="kobo.664.1">Gauge</span></strong><span class="koboSpan" id="kobo.665.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.666.1">Value</span></strong><span class="koboSpan" id="kobo.667.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.668.1">Map</span></strong><span class="koboSpan" id="kobo.669.1">, but </span><strong class="bold"><span class="koboSpan" id="kobo.670.1">Map</span></strong><span class="koboSpan" id="kobo.671.1"> is used twice as it takes two values (i.e., latitude and longitude). </span><span class="koboSpan" id="kobo.671.2">The </span><strong class="bold"><span class="koboSpan" id="kobo.672.1">Gauge</span></strong><span class="koboSpan" id="kobo.673.1"> widget shows </span><strong class="bold"><span class="koboSpan" id="kobo.674.1">Speed Per Mile</span></strong><span class="koboSpan" id="kobo.675.1">, while two </span><strong class="bold"><span class="koboSpan" id="kobo.676.1">Value</span></strong><span class="koboSpan" id="kobo.677.1"> widgets have been used to display </span><strong class="bold"><span class="koboSpan" id="kobo.678.1">Altitude Feet</span></strong><span class="koboSpan" id="kobo.679.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.680.1">Satellite Count</span></strong><span class="koboSpan" id="kobo.681.1">. </span><span class="koboSpan" id="kobo.681.2">The </span><strong class="bold"><span class="koboSpan" id="kobo.682.1">Map</span></strong><span class="koboSpan" id="kobo.683.1"> widget has</span><a id="_idIndexMarker480"/><span class="koboSpan" id="kobo.684.1"> been used to display </span><strong class="bold"><span class="koboSpan" id="kobo.685.1">Location</span></strong><span class="koboSpan" id="kobo.686.1"> based on the latitude and longitude coordinates, which are stored in a cloud-based </span><strong class="source-inline"><span class="koboSpan" id="kobo.687.1">location</span></strong><span class="koboSpan" id="kobo.688.1"> variable. </span><span class="koboSpan" id="kobo.688.2">Currently, the Map widget is only capable of displaying the location of the asset device based on coordinates; if you have multiple assets to track, then you need to set up multiple Map widgets according to the number of </span><span class="No-Break"><span class="koboSpan" id="kobo.689.1">tracking devices.</span></span></p>
<p><span class="koboSpan" id="kobo.690.1">Well, this was the last section of our chapter. </span><span class="koboSpan" id="kobo.690.2">Here, we have created a stunning dashboard for GPS tracking that shows the location using the Map widget on the dashboard, the speed per mile, and some </span><span class="No-Break"><span class="koboSpan" id="kobo.691.1">other parameters.</span></span></p>
<h1 id="_idParaDest-118"><a id="_idTextAnchor118"/><span class="koboSpan" id="kobo.692.1">What next?</span></h1>
<p><span class="koboSpan" id="kobo.693.1">We still have a lot of options available to explore, but now it’s your time to use different sensors and development boards to do some more experiments and learn from them. </span><span class="koboSpan" id="kobo.693.2">In the current chapter, we only used one GPS module, which gave us only four parameters but, on the market, there are a lot of GPS modules that provide a wide variety of functionalities; they work under the roof as well as under clear sky, and have several </span><span class="No-Break"><span class="koboSpan" id="kobo.694.1">accuracy features.</span></span></p>
<p><span class="koboSpan" id="kobo.695.1">While monitoring an asset’s location, there are some other parameters that are very important to monitor in different industries, such as temperature and humidity, which are very important in food and medical products. </span><span class="koboSpan" id="kobo.695.2">CO</span><span class="subscript"><span class="koboSpan" id="kobo.696.1">2</span></span><span class="koboSpan" id="kobo.697.1"> and LPG gases are very important to monitor during fuel transportation. </span><span class="koboSpan" id="kobo.697.2">Try different sensors with a GPS module to set up different tracking prototypes for </span><span class="No-Break"><span class="koboSpan" id="kobo.698.1">different industries.</span></span></p>
<h1 id="_idParaDest-119"><a id="_idTextAnchor119"/><span class="koboSpan" id="kobo.699.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.700.1">In this chapter, we explored how to develop a GPS-based tracking system using a global IoT SIM card and GPS module. </span><span class="koboSpan" id="kobo.700.2">We set up the Thing, which included cloud variable creation, device association, GSM network configuration, and coding a development board. </span><span class="koboSpan" id="kobo.700.3">Later, we created a dashboard to visualize the Thing readings with different types of widgets to display current readings, with the most important widget of the chapter being the Map widget. </span><span class="koboSpan" id="kobo.700.4">It is a very interesting and important widget to display the location of IoT devices using </span><span class="No-Break"><span class="koboSpan" id="kobo.701.1">GPS coordinates.</span></span></p>
<p><span class="koboSpan" id="kobo.702.1">GPS tracking is a very important aspect that we covered in this chapter, and it helps us to develop a device for our asset tracking, which will help us in asset tracking and monitoring. </span><span class="koboSpan" id="kobo.702.2">This chapter demonstrated how we can display the location of a device on the dashboard, which gives you the confidence to build more solutions regarding asset tracking. </span><span class="koboSpan" id="kobo.702.3">In the next chapter, we will explore another long-range communication technology, called </span><strong class="bold"><span class="koboSpan" id="kobo.703.1">LoRaWAN</span></strong><span class="koboSpan" id="kobo.704.1">. </span><span class="koboSpan" id="kobo.704.2">We will use this technology to build a solution for remote monitoring distant areas as well as compare this technology with GSM/4G/LTE and NB-IoT technology for </span><span class="No-Break"><span class="koboSpan" id="kobo.705.1">proper guidance.</span></span></p>
</div>
</body></html>