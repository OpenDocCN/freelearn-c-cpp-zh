# 前言

计算机图形学有着非常漫长和有趣的历史。许多用于生成 2D 或 3D 图像的 API 或定制方法已经出现又消失。这一历史中的一个里程碑是 OpenGL 的发明，这是最早的图形库之一，它使我们能够创建实时、高性能的 3D 图形，并且对多个操作系统上的每个人都是可用的。它至今仍在开发和广泛使用。今年，我们可以庆祝它的 25 岁生日！

自从 OpenGL 被创建以来，许多事情都发生了变化。图形硬件行业正在快速发展。最近，为了适应这些变化，提出了 3D 图形渲染的新方法。它采取了低级访问图形硬件的形式。OpenGL 被设计为一个高级 API，它允许用户轻松地在屏幕上渲染图像。但这种高级方法，虽然对用户来说很方便，但对图形驱动程序来说却很难处理。这是限制硬件以展示其全部潜力的主要原因之一。新的方法试图克服这些挑战——它给用户提供了对硬件的更多控制，但也带来了更多的责任。这样，应用程序开发者就可以释放图形硬件的全部潜力，因为驱动程序不再阻止他们。低级访问允许驱动程序变得更小、更薄。但这些好处是以开发者需要做更多工作为代价的。

图形渲染新方法的第一个传道者是 AMD 设计的 Mantle API。当它证明低级访问可以带来相当的性能优势时，其他公司开始着手开发自己的图形库。新趋势中最引人注目的是由苹果设计的 Metal API 和由微软开发的 DirectX 12。

但上述所有库都是针对特定的操作系统和/或硬件开发的。没有像 OpenGL 这样的开放和跨平台标准。直到去年。2016 年，Khronos 联盟开发的 Vulkan API 发布，该联盟维护 OpenGL 库。Vulkan 也代表了新的方法，即对图形硬件的低级访问，但与其它库不同，它对多个操作系统和硬件平台上的每个人都是可用的——从配备 Windows 或 Linux 操作系统的性能强大的桌面计算机，到运行 Android OS 的移动设备。由于它仍然非常新，因此很少有资源教授开发者如何使用它。这本书试图填补这一空白。

# 本书涵盖的内容

第一章，*实例和设备*，展示了如何开始使用 Vulkan API。本章解释了从哪里下载 Vulkan SDK，如何连接到 Vulkan 加载库，如何选择将要执行操作的物理设备，以及如何准备和创建逻辑设备。

第二章，*图像呈现*，描述了如何在屏幕上显示 Vulkan 生成的图像。它解释了什么是交换链以及创建它所需的参数，这样我们就可以用它进行渲染并查看我们的工作结果。

第三章，*命令缓冲区和同步*，涉及将各种操作记录到命令缓冲区并将它们提交到队列中，在那里它们由硬件处理。本章还介绍了各种同步机制。

第四章，*资源和内存*，介绍了两种基本且最重要的资源类型，图像和缓冲区，它们允许我们存储数据。我们解释了如何创建它们，如何为这些资源准备内存，以及如何从我们的应用程序（CPU）将数据上传到它们。

第五章，*描述符集*，解释了如何将创建的资源提供给着色器。我们解释了如何准备资源以便在着色器中使用，以及如何设置描述符集，这些描述符集构成了应用程序和着色器之间的接口。

第六章，*绘制传递和帧缓冲区*，展示了如何将绘制操作组织成称为子传递的单独步骤的集合，这些子传递被组织成绘制传递。在本章中，我们还展示了如何准备绘制过程中使用的附件（渲染目标）的描述，以及如何根据这些描述创建帧缓冲区，这些帧缓冲区根据这些描述绑定特定的资源。

第七章，*着色器*，描述了编程所有可用图形和计算着色器阶段的具体细节。本章展示了如何使用 GLSL 编程语言实现着色器程序，以及如何将它们转换为 SPIR-V 汇编——这是核心 Vulkan API 接受的唯一形式。

第八章，*图形和计算管线*，展示了创建两种可用管线类型的过程。这些类型用于设置图形硬件所需的全部参数，以便正确处理绘制命令或计算工作。

第九章，*命令录制和绘制*，涉及记录成功绘制 3D 模型或调度计算工作所需的所有操作。本章还介绍了各种优化技术，这些技术可以帮助提高应用程序的性能。

第十章，*辅助食谱*，展示了 3D 渲染应用程序不可或缺的便捷工具集。展示了如何从文件中加载纹理和 3D 模型，以及如何在着色器中操作几何体。

第十一章，*光照*，介绍了从简单的漫反射和镜面反射计算到法线贴图和阴影贴图技术的常用光照技术。

第十二章，*高级渲染技术*，解释了如何实现令人印象深刻的图形技术，这些技术可以在许多流行的 3D 应用程序（如游戏和基准测试）中找到。

# 您需要为本书准备什么

本书解释了 Vulkan 图形 API 的各个方面，该 API 是开放和跨平台的。它可在 Microsoft Windows（版本 7 及以上）或 Linux（最好是 Ubuntu 16.04 及以上）系统上使用。（Vulkan 还支持运行 7.0+ / Nougat 版本操作系统的 Android 设备，但本书提供的代码示例并未设计为在 Android OS 上执行。）

要执行示例程序或开发我们自己的应用程序，除了 Windows 7+或 Linux 操作系统外，还需要支持 Vulkan API 的图形硬件和驱动程序。请参考 3D 图形供应商的网站和/或支持，以检查哪些硬件能够运行启用 Vulkan 的软件。

当使用 Windows 操作系统时，可以使用 Visual Studio Community 2015 IDE（或更新版本）编译代码示例，该 IDE 免费且对所有人开放。要为 Visual Studio IDE 生成解决方案，需要 CMAKE 3.0 或更新版本。

在 Linux 系统上，使用 CMAKE 3.0 和 make 工具的组合进行编译。但也可以使用其他工具，如 QtCreator，来编译这些示例。

# 本书面向对象

本书非常适合了解 C/C++语言、对图形编程有一定了解的开发者，他们现在想利用构建下一代计算机图形过程中新的 Vulkan API。对 Vulkan 有一定的了解将有助于理解食谱。希望利用 Vulkan API 的 OpenGL 开发者也会发现本书很有用。

# 部分

在本书中，您会发现一些频繁出现的标题（准备工作、如何操作、工作原理、更多内容、参见）。

为了清楚地说明如何完成食谱，我们使用以下这些部分：

# 准备工作

本节告诉您在食谱中可以期待什么，并描述了如何设置任何软件或任何为食谱所需的初步设置。

# 如何操作...

本节包含遵循食谱所需的步骤。

# 工作原理...

本节通常包含对上一节发生情况的详细解释。

# 更多内容…

本节包含有关食谱的附加信息，以便使读者对食谱有更多的了解。

# 参见

本节提供了指向其他有用信息的链接，这些信息对食谱很有帮助。

# 术语约定

在这本书中，您将找到许多不同的文本样式，用于区分不同类型的信息。以下是一些这些样式的示例及其含义的解释。

文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称如下所示：“将您想要激活的层的名称分配给`VK_INSTANCE_LAYERS`环境变量。”

代码块设置如下：

```cpp
{
 if( (result != VK_SUCCESS) || 
    (extensions_count == 0) ) { 
  std::cout << "Could not enumerate device extensions." << std::endl; 
  return false;
} 

```

任何命令行输入或输出都如下所示：

```cpp
setx VK_INSTANCE_LAYERS VK_LAYER_LUNARG_api_dump;VK_LAYER_LUNARG_core_validation

```

**新术语**和**重要词汇**以粗体显示。您在屏幕上看到的单词，例如在菜单或对话框中，在文本中显示如下：“从管理面板中选择系统信息。”

警告或重要注意事项如下所示。

技巧和窍门如下所示。

# 读者反馈

我们始终欢迎读者的反馈。请告诉我们您对这本书的看法——您喜欢什么或不喜欢什么。读者反馈对我们来说非常重要，因为它帮助我们开发出您真正能从中获得最大收益的标题。

要向我们发送一般反馈，只需发送电子邮件至`feedback@packtpub.com`，并在邮件主题中提及书的标题。

如果您在某个主题上具有专业知识，并且您对撰写或为书籍做出贡献感兴趣，请参阅我们的作者指南[www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

现在，您已经成为 Packt 图书的骄傲拥有者，我们有一些事情可以帮助您从您的购买中获得最大收益。

# 下载示例代码

您可以从[`www.packtpub.com`](http://www.packtpub.com)上的账户下载这本书的示例代码文件。如果您在其他地方购买了这本书，您可以访问[`www.packtpub.com/support`](http://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给您。

您可以通过以下步骤下载代码文件：

1.  使用您的电子邮件地址和密码登录或注册我们的网站。

1.  将鼠标指针悬停在顶部的 SUPPORT 标签上。

1.  点击代码下载与勘误。

1.  在搜索框中输入书的名称。

1.  选择您想要下载代码文件的书籍。

1.  从下拉菜单中选择您购买这本书的地方。

1.  点击代码下载。

您还可以通过点击 Packt Publishing 网站上书籍网页上的代码文件按钮来下载代码文件。您可以通过在搜索框中输入书的名称来访问此页面。请注意，您需要登录到您的 Packt 账户。

文件下载完成后，请确保您使用最新版本的软件解压缩或提取文件夹：

+   WinRAR / 7-Zip for Windows

+   Zipeg / iZip / UnRarX for Mac

+   7-Zip / PeaZip for Linux

本书的相关代码包也托管在 GitHub 上，地址为**[h t t p s ://g i t h u b . c o m /P a c k t P u b l i s h i n g /V u l k a n - C o o k b o o k](https://github.com/PacktPublishing/Vulkan-Cookbook)**。我们还有其他来自我们丰富图书和视频目录的代码包，可在**[h t t p s ://g i t h u b . c o m /P a c k t P u b l i s h i n g /](https://github.com/PacktPublishing/)**找到。查看它们吧！

# 下载本书中的彩色图像

我们还为您提供了一个包含本书中使用的截图/图表的彩色图像的 PDF 文件。彩色图像将帮助您更好地理解输出的变化。您可以从[h t t p s ://w w w . p a c k t p u b . c o m /s i t e s /d e f a u l t /f i l e s /d o w n l o a d s /V u l k a n C o o k b o o k _ C o l o r I m a g e s . p d f](https://www.packtpub.com/sites/default/files/downloads/VulkanCookbook_ColorImages.pdf)下载此文件。

# 勘误

尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在我们的书中发现错误——可能是文本或代码中的错误——如果您能向我们报告这个问题，我们将不胜感激。这样做可以帮助其他读者避免挫败感，并帮助我们改进本书的后续版本。如果您发现任何勘误，请通过访问[h t t p s ://w w w . p a c k t p u b . c o m /s u b m i t - e r r a t a](http://www.packtpub.com/submit-errata)来报告，选择您的书籍，点击勘误提交表单链接，并输入您的勘误详情。一旦您的勘误得到验证，您的提交将被接受，勘误将被上传到我们的网站或添加到该标题的勘误部分下的现有勘误列表中。

要查看之前提交的勘误，请访问[h t t p s ://w w w . p a c k t p u b . c o m /b o o k s /c o n t e n t /s u p p o r t](https://www.packtpub.com/books/content/support)，并在搜索字段中输入书籍名称。所需信息将出现在勘误部分下。

# 侵权

互联网上版权材料的侵权是一个跨所有媒体持续存在的问题。在 Packt，我们非常重视我们版权和许可证的保护。如果您在互联网上遇到任何形式的非法复制我们的作品，请立即提供位置地址或网站名称，以便我们可以寻求补救措施。

请通过`copyright@packtpub.com`与我们联系，并提供疑似侵权材料的链接。

我们感谢您在保护我们作者和我们提供有价值内容的能力方面的帮助。

# 问题

如果您在本书的任何方面遇到问题，您可以通过`questions@packtpub.com`联系我们，我们将尽力解决问题。
