<html><head></head><body>
		<div id="_idContainer108">
			<h1 class="chapter-number" id="_idParaDest-155"><a id="_idTextAnchor411"/>6</h1>
			<h1 id="_idParaDest-156"><a id="_idTextAnchor412"/>Creating a World of Your Own in Godot</h1>
			<p>In <em class="italic">Part 1</em> of this book, you learned the basics of programming! No small feat if you ask me. So, congrats on that milestone! Now, it’s time to tie it all together and start working on <span class="No-Break">our game.</span></p>
			<p>In the early days of game development, everything happened through code. A computer wizard had to program everything, from systems and features to levels and asset placement. In recent times, the tooling for creating games has gotten way better, is free, and is <span class="No-Break">very user-friendly.</span></p>
			<p>Godot, like most modern game engines (Unity, Unreal Engine, Construct, and others), has a graphical interface that makes it <a id="_idIndexMarker332"/>easy to drag and drop elements of our game into levels or other scenes. In this chapter, we’ll learn how to use this graphical interface by creating a rudimentary player character and a little world for them <span class="No-Break">to inhabit.</span></p>
			<p>We’ll also learn some tricks to tie the code and graphical editor together with node references and <span class="No-Break">variable exports.</span></p>
			<p>In this chapter, we will cover the following <span class="No-Break">main topics:</span></p>
			<ul>
				<li>The node-based system <span class="No-Break">of Godot</span></li>
				<li>Creating a <span class="No-Break">player character</span></li>
				<li>Referencing nodes <span class="No-Break">in scripts</span></li>
				<li><span class="No-Break">Exporting variables</span></li>
				<li>Making <span class="No-Break">rudimentary shapes</span><a id="_idTextAnchor413"/></li>
			</ul>
			<h1 id="_idParaDest-157"><a id="_idTextAnchor414"/>Technical requirements</h1>
			<p>Because we will create a game from scratch, I took the liberty of providing you with the base of a project. You can find this base project in the folder for this chapter under <strong class="source-inline">/start</strong>. This project supplies some assets, such as pictures and sounds. Creating these assets is outside the scope of this book. The resulting project files for this chapter can be found under <strong class="source-inline">/result</strong> of this <span class="No-Break">chapter’s folder.</span></p>
			<p>In the subsequent chapters, you’ll find the resulting project in the <strong class="source-inline">root</strong> folder of that chapter. It’s assumed that you use the results from the previous chapter as a <span class="No-Break">starting point.</span></p>
			<p>So, get the starting project, and let’s dive <span class="No-Break">in: </span><a href="https://github.com/PacktPublishing/Learning-GDScript-by-Developing-a-Game-with-Godot-4/tree/main/chapter06/start"><span class="No-Break">https://github.com/PacktPublishing/Learning-GDScript-by-Developing-a-Game-with-Godot-4/tree/main/chapter06/start</span></a><span class="No-Break">.</span><a id="_idTextAnchor415"/></p>
			<h1 id="_idParaDest-158"><a id="_idTextAnchor416"/>Game design</h1>
			<p>Before mindlessly creating a game, let’s plan out what kind of game we want to make. This will structure our thoughts and make sure we work toward the game we want to make without taking unnecessary detours. The best<a id="_idIndexMarker333"/> way to do this is through a <strong class="bold">game design document</strong> (<strong class="bold">GDD</strong>). Though there is no set format for this kind of <a id="_idIndexMarker334"/>document, it should eventually answer some basic questions about <span class="No-Break">the game:</span></p>
			<ul>
				<li>Which genre is <span class="No-Break">the game?</span></li>
				<li>What mechanics will be in <span class="No-Break">the game?</span></li>
				<li>What is <span class="No-Break">the story?</span></li>
			</ul>
			<p>Some game design documents are hundreds of pages long. But as this is not a game design book, let’s define our game regarding these three questions and then work out the details as <span class="No-Break">we g<a id="_idTextAnchor417"/>o.</span></p>
			<h2 id="_idParaDest-159"><a id="_idTextAnchor418"/>Genre</h2>
			<p>Recently, we have witnessed the<a id="_idIndexMarker335"/> birth of a new<a id="_idIndexMarker336"/> genre known as <strong class="bold">vampire survivor-likes</strong>, also known as a <strong class="bold">VS</strong> game. In this type of game, you control a character in a 2D top-down world. The character has to defeat waves of monsters coming after them by shooting them. The player can control the character by moving them around, but shooting happens automatically. It does not <span class="No-Break">require input.</span></p>
			<p>This genre has a huge player base, and the base game is relatively simple to implement and yet satisfying to play. Therefore, it would be the ideal type of game to recreate throughout the <span class="No-Break">following chapt<a id="_idTextAnchor419"/>ers.</span></p>
			<h2 id="_idParaDest-160"><a id="_idTextAnchor420"/>Mechanics</h2>
			<p>The survivor-like genre has some <a id="_idIndexMarker337"/>staple mechanics that are very important to <span class="No-Break">get right:</span></p>
			<ul>
				<li><strong class="bold">2D world</strong>: The playing field is a 2D plane on which we have a top-down view. Some of them are indeed in 3D, but the mechanics still shine <span class="No-Break">in 2D.</span></li>
				<li><strong class="bold">Movement of the character</strong>: We need to be able to move the character around in <span class="No-Break">the world.</span></li>
				<li><strong class="bold">Waves of enemies</strong>: We need enemies that threaten to kill the player and we need to spawn them so that they pose a proper <span class="No-Break">challenge .</span></li>
				<li><strong class="bold">Automatic shooting</strong>: The player character will automatically shoot projectiles aimed at <span class="No-Break">the enemies.</span></li>
			</ul>
			<p>Now that we have sorted out the genre and staple mechanics, let’s work out the story our game will be <span class="No-Break">base<a id="_idTextAnchor421"/>d on.</span></p>
			<h2 id="_idParaDest-161"><a id="_idTextAnchor422"/>Story</h2>
			<p>Let’s not burden ourselves too<a id="_idIndexMarker338"/> much with writing the whole story. In games, the story can also be told through how the game looks and feels. So, we can specify a general setting that binds the whole <span class="No-Break">experience together.</span></p>
			<p>How about this as our setting: You are a medieval knight fighting in the king’s tournament to find the strongest soldier in the whole land. You’ll have to battle multiple enemies, such as orcs and trolls, in multiple rounds, each harder than the last. The only weapon you are given is a bow, with which you can shoot arrows at <span class="No-Break">your adversaries.</span></p>
			<p>Now that we have an idea of the kind of game we are creating, let’s get <span class="No-Break">in<a id="_idTextAnchor423"/>to it!</span></p>
			<h1 id="_idParaDest-162"><a id="_idTextAnchor424"/>Creating a player character</h1>
			<p>We’ll start by creating a<a id="_idIndexMarker339"/> rudimentary player character for <span class="No-Break">our game:</span></p>
			<ol>
				<li>Open the <strong class="source-inline">main.tscn</strong> file I provided in the <span class="No-Break">project base.</span></li>
				<li>Select the <strong class="source-inline">root</strong> node, called <strong class="source-inline">Main</strong>, and press the <strong class="bold">Add Child </strong><span class="No-Break"><strong class="bold">Node</strong></span><span class="No-Break"> button:</span></li>
			</ol>
			<div>
				<div class="IMG---Figure" id="_idContainer075">
					<img alt="Figure 6.1 – The button to add a new child node to the selected node in the tree" src="image/B19358_06_01.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.1 – The button to add a new child node to the selected node in the tree</p>
			<ol>
				<li value="3">Then, find and add a <strong class="bold">Node2D</strong> node. You can use the search bar at the top to make searching for the node easier. This is a node that has a position in <span class="No-Break">2D space:</span></li>
			</ol>
			<div>
				<div class="IMG---Figure" id="_idContainer076">
					<img alt="Figure 6.2 – Finding and selecting the Node2D node" src="image/B19358_06_02.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.2 – Finding and selecting the Node2D node</p>
			<ol>
				<li value="4">Next, rename this Node2D as <strong class="source-inline">Player</strong> by right clicking the node and choosing <strong class="bold">Rename</strong>, just like we did in <a href="B19358_02.xhtml#_idTextAnchor044"><span class="No-Break"><em class="italic">Chapter 2</em></span></a><span class="No-Break">.</span></li>
			</ol>
			<p><strong class="source-inline">Player</strong> will be the base <a id="_idIndexMarker340"/>node for our player character. From here, we will add all the other nodes that comprise the <strong class="source-inline">Player</strong> node. The first of these nodes will be <span class="No-Break">a s<a id="_idTextAnchor425"/>prite.</span></p>
			<h2 id="_idParaDest-163"><a id="_idTextAnchor426"/>Adding a sprite</h2>
			<p>The first thing we can do to flesh<a id="_idIndexMarker341"/> out our player character is to give it a visual, something that the player can relate to as the main character. Follow <em class="italic">Steps 1</em> to <em class="italic">3</em> in the <em class="italic">Creating a player character</em> section again to add a node called <strong class="source-inline">Sprite2D</strong> to the <strong class="source-inline">Player</strong> node so that the scene tree looks <span class="No-Break">like this:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer077">
					<img alt="Figure 6.3 – The scene tree so far" src="image/B19358_06_03.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.3 – The scene tree so far</p>
			<p>The <strong class="source-inline">Sprite2D</strong> node is a node<a id="_idIndexMarker342"/> that can display an image, also called a <strong class="bold">sprite</strong>. If you click on <strong class="source-inline">Sprite2D</strong>, you’ll see that the <strong class="bold">Inspector</strong> view on the right-hand side gets populated with information about <span class="No-Break">that node:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer078">
					<img alt="Figure 6.4 – The Inspector view of a Sprite2D node" src="image/B19358_06_04.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.4 – The Inspector view of a Sprite2D node</p>
			<p>There are settings for <strong class="bold">Texture</strong>, <strong class="bold">Offset</strong>, <strong class="bold">Animation</strong>, <strong class="bold">Region</strong>, and more. You can look through them to get an idea<a id="_idIndexMarker343"/> of all the available settings. The different tabs are <strong class="bold">Property Groups</strong>, while the settings themselves are <span class="No-Break">called </span><span class="No-Break"><strong class="bold">Properties</strong></span><span class="No-Break">.</span></p>
			<p>We are only interested in the <strong class="bold">Texture</strong> property because this is where we can set the image this node displays. So, let’s add a sprite for <span class="No-Break">our character!</span></p>
			<ol>
				<li>In the <strong class="bold">FileManager</strong> area, navigate <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">assets/sprites/character</strong></span><span class="No-Break">.</span><p class="list-inset">Here, you’ll find a bunch of premade <span class="No-Break">character sprites.</span></p></li>
			</ol>
			<p class="callout-heading">Kenney assets</p>
			<p class="callout">The assets we are using in this book all come from Kenney and are free to use in any project you want. You can find more of his great assets <span class="No-Break">at </span><a href="https://kenney.nl/"><span class="No-Break">https://kenney.nl/</span></a><span class="No-Break">.</span></p>
			<ol>
				<li value="2">Drag and drop any of <a id="_idIndexMarker344"/>them onto the <strong class="bold">Texture</strong> property of the <strong class="source-inline">Sprite2D</strong> node. I’m using the <span class="No-Break"><strong class="source-inline">character01.png</strong></span><span class="No-Break"> texture.</span></li>
				<li>The <strong class="bold">Inspector</strong> view for the <strong class="source-inline">Sprite2D</strong> node should now look something <span class="No-Break">like this:</span></li>
			</ol>
			<div>
				<div class="IMG---Figure" id="_idContainer079">
					<img alt="Figure 6.5 – Adding a texture to a sprite node" src="image/B19358_06_05.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.5 – Adding a texture to a sprite node</p>
			<p>The sprite should also <a id="_idIndexMarker345"/>turn up in the 2D view of the editor. However, it seems to be very small. That’s because the image is only <strong class="source-inline">16</strong> × <strong class="source-inline">16</strong> pixels in size. Let’s scale it up a little. Under the <strong class="bold">Transom</strong> tab in the sprite’s <strong class="bold">Inspector</strong> view, set <strong class="bold">Scale</strong> to <strong class="source-inline">3</strong>. You can set the scale for the X and Y axes separately, but we want them both to be equal so that the sprite scales <span class="No-Break">without stretching:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer080">
					<img alt="Figure 6.6 – The Transform properties of a sprite node" src="image/B19358_06_06.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.6 – The Transform properties of a sprite node</p>
			<p>Oh no – <span class="No-Break">what’s this?</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer081">
					<img alt="Figure 6.7 – A blurry pixel art sprite" src="image/B19358_06_07.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.7 – A blurry pixel art sprite</p>
			<p>The sprite looks blurry! This<a id="_idIndexMarker346"/> happened because we’re using <strong class="bold">pixel art</strong> assets, a style well known for its <a id="_idIndexMarker347"/>blocky pixels. When upscaling, Godot Engine uses an algorithm that blurs out these pixels. This is great for other art styles, such as hand-drawn or vector art, but not for pixel art. Luckily, there is a solution. Follow <span class="No-Break">these steps:</span></p>
			<ol>
				<li>Navigate to <strong class="bold">Project </strong>| <span class="No-Break"><strong class="bold">Project Settings...</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div class="IMG---Figure" id="_idContainer082">
					<img alt="Figure 6.8 – Going to Project Settings..." src="image/B19358_06_08.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.8 – Going to Project Settings...</p>
			<ol>
				<li value="2">Under <strong class="bold">Rendering</strong> | <strong class="bold">Textures</strong>, set<a id="_idIndexMarker348"/> <strong class="bold">Default Texture Filter</strong> <span class="No-Break">to </span><span class="No-Break"><strong class="bold">Nearest</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div class="IMG---Figure" id="_idContainer083">
					<img alt="Figure 6.9 – Setting Default Texture Filter to Nearest" src="image/B19358_06_09.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.9 – Setting Default Texture Filter to Nearest</p>
			<p>These settings will scale the image in a way that is better suited for pixel art. Now, our sprite looks <span class="No-Break">way better!</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer084">
					<img alt="Figure 6.10 – A crisp pixel art sprite" src="image/B19358_06_10.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.10 – A crisp pixel art sprite</p>
			<p>Now that we can see our <a id="_idIndexMarker349"/>player, let’s look into displaying a <span class="No-Break">hea<a id="_idTextAnchor427"/>lth UI.</span></p>
			<h2 id="_idParaDest-164"><a id="_idTextAnchor428"/>Displaying health</h2>
			<p>Next, let’s add something to display the<a id="_idIndexMarker350"/> player’s health above the character. Sure, we haven’t created a script for the player yet that tracks health, but we can put the visuals i<a id="_idTextAnchor429"/>n place. We will use a <strong class="source-inline">Label</strong> node, which can display text in <span class="No-Break">the game:</span></p>
			<ol>
				<li>Find and add a <strong class="source-inline">Label</strong> node to the <span class="No-Break"><strong class="source-inline">Player</strong></span><span class="No-Break"> node.</span></li>
				<li>Name the <span class="No-Break">node </span><span class="No-Break"><strong class="source-inline">HealthLabel</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div class="IMG---Figure" id="_idContainer085">
					<img alt="Figure 6.11 - The scene tree with the HealthLabel node added" src="image/B19358_06_11.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.11 - The scene tree with the HealthLabel node added</p>
			<ol>
				<li value="3">When selecting the <strong class="source-inline">Label</strong> node, the <strong class="bold">Inspector</strong> view will contain a <strong class="bold">Text</strong> property. Type <strong class="source-inline">10/10</strong> into it as if the player has 10 out of their <span class="No-Break">10 lives:</span></li>
			</ol>
			<div>
				<div class="IMG---Figure" id="_idContainer086">
					<img alt="Figure 6.12 – The Inspector view of a Label node with the text set to 10/10" src="image/B19358_06_12.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.12 – The Inspector view of a Label node with the text set to 10/10</p>
			<ol>
				<li value="4">Next, drag the<a id="_idIndexMarker351"/> label on top of the player so that it’s out of the way of <span class="No-Break">the sprite:</span></li>
			</ol>
			<div>
				<div class="IMG---Figure" id="_idContainer087">
					<img alt="Figure 6.13 – Repositioning the HealthLabel node above the player character" src="image/B19358_06_13.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.13 – Repositioning the HealthLabel node above the player character</p>
			<p>Great! With the <strong class="source-inline">HealthLabel</strong> label in place, we can update it through a script later on (see the <em class="italic">Creating the player script</em> section). This is all we need to set up the nodes in the <span class="No-Break">scene tree.</span></p>
			<p>Now, let’s see how we <a id="_idIndexMarker352"/>can manipulate the nodes <span class="No-Break">we’ve <a id="_idTextAnchor430"/>added.</span></p>
			<h2 id="_idParaDest-165"><a id="_idTextAnchor431"/>Manipulating nodes in the editor</h2>
			<p>Now that we have a small <a id="_idIndexMarker353"/>scene tree in place, let’s look at what tools we have available to manipulate the nodes. If you look at the top right of the 2D editor, you’ll see some of <span class="No-Break">these tools:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer088">
					<img alt="Figure 6.14 – The toolbar in the 2D editor view" src="image/B19358_06_14.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.14 – The toolbar in the 2D editor view</p>
			<p>There are many interesting tools in this toolbar, but the first four are the most important ones <span class="No-Break">for now:</span></p>
			<ul>
				<li><strong class="bold">Select mode</strong>: This is the default mode and is a multitool. You can select nodes within the scene and drag <span class="No-Break">them around.</span></li>
				<li><strong class="bold">Move mode</strong>: In this mode, you can move the <span class="No-Break">selected node.</span></li>
				<li><strong class="bold">Rotate mode</strong>: In this mode, you can rotate the <span class="No-Break">selected node.</span></li>
				<li><strong class="bold">Scale mode</strong>: In this mode, you can scale the <span class="No-Break">selected node.</span></li>
			</ul>
			<p>Try these modes by selecting the <strong class="source-inline">Player</strong> node and messing around a bit. This could lead you to a result <span class="No-Break">like this:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer089">
					<img alt="Figure 6.15 – The Player node after multiple transform manipulations" src="image/B19358_06_15.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.15 – The Player node after multiple transform manipulations</p>
			<p>You’ll also notice that when you move, rotate, or scale a node, its child nodes will be manipulated in the same way. This<a id="_idIndexMarker354"/> inheritance of transformation is the strength of the hierarchical <span class="No-Break">node system.</span></p>
			<p>If you look at the <strong class="bold">Transform</strong> tab in the <strong class="bold">Inspector</strong> view of the <strong class="source-inline">Player</strong> node, you’ll see the exact modifications you made to it. If you change any of these values, you’ll see them reflected in the 2D <span class="No-Break">editor too:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer090">
					<img alt="Figure 6.16 – The Transform parameters after multiple transform manipulations" src="image/B19358_06_16.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.16 – The Transform parameters after multiple transform manipulations</p>
			<p>As an experiment, try changing the value for <strong class="source-inline">Skew</strong> from the <span class="No-Break"><strong class="bold">Inspector</strong></span><span class="No-Break"> view.</span></p>
			<p>Before you continue with the following sections, don’t forget to reset all these manipulations in the <strong class="bold">Transform</strong> tab of the <strong class="source-inline">Player</strong> node. You can do this simply by pressing the ↺ symbol next to each property. This button will set the property back to its default value. Let’s also set the position of the <strong class="source-inline">Player</strong> node so that the player character is roughly centered on <span class="No-Break">the screen:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer091">
					<img alt="Figure 6.17 – Positioning the player character in the middle of the screen" src="image/B19358_06_17.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.17 – Positioning the player character in the middle of the screen</p>
			<p>With that, we’ve finished creating the base for our player character and learned how we can manipulate nodes within the editor. Next, we’ll focus on the player character’s script and learn how we <a id="_idIndexMarker355"/>can manipulate nodes <span class="No-Break">through code.</span></p>
			<h1 id="_idParaDest-166"><a id="_idTextAnchor432"/>Creating the player script</h1>
			<p>This is the moment we have<a id="_idIndexMarker356"/> been training for. We already know how to do this! So, start by creating a new script that is attached to the <span class="No-Break"><strong class="source-inline">Player</strong></span><span class="No-Break"> node:</span></p>
			<ol>
				<li>Right-click the <strong class="source-inline">Player</strong> node and select <span class="No-Break"><strong class="bold">Attach Script</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div class="IMG---Figure" id="_idContainer092">
					<img alt="Figure 6.18 – Attaching a script to the Player node" src="image/B19358_06_18.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.18 – Attaching a script to the Player node</p>
			<ol>
				<li value="2">In the dialogue<a id="_idIndexMarker357"/> that pops up, call the <span class="No-Break">script </span><span class="No-Break"><strong class="source-inline">player.gd</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div class="IMG---Figure" id="_idContainer093">
					<img alt="Figure 6.19 – Calling the script player.gd" src="image/B19358_06_19.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.19 – Calling the script player.gd</p>
			<ol>
				<li value="3">We’ll keep it simple <a id="_idIndexMarker358"/>for now and just add some code to manage the health of <span class="No-Break">the p<a id="_idTextAnchor433"/>layer:</span><pre class="source-code">
extends <a id="_idTextAnchor434"/>N<a id="_idTextAnchor435"/>ode2D
const MAX_HEALTH: in<a id="_idTextAnchor436"/>t<a id="_idTextAnchor437"/> = 10
var health: in<a id="_idTextAnchor438"/>t<a id="_idTextAnchor439"/> = 10
func add__health_points(difference:<a id="_idTextAnchor440"/> int):
   health += diff<a id="_idTextAnchor441"/>erence
   health = clamp(health, 0, MAX_HEALTH)</pre><p class="list-inset">The <strong class="source-inline">clamp()</strong> function we use in the <strong class="source-inline">add_health_points()</strong> function takes a numeric value as the first argument and keeps it in between the second two <span class="No-Break">numeric parameters.</span></p></li>			</ol>
			<p>This way, the health is always between <strong class="source-inline">0</strong> and <strong class="source-inline">MAX_HEALTH</strong>, which is <strong class="source-inline">10</strong> at <span class="No-Break">the max.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Remember that you can <em class="italic">Ctrl</em> and click on Windows and Linux or <em class="italic">Option</em> and click on Mac on any function to go to the documentation and have a look at what <span class="No-Break">it does.</span></p>
			<p>With this in place, we can <a id="_idIndexMarker359"/>change the player’s health. Now, let’s look at how we can update the <strong class="source-inline">HealthLabel</strong> node we created earlier to reflect <span class="No-Break">this<a id="_idTextAnchor442"/> value.</span></p>
			<h2 id="_idParaDest-167"><a id="_idTextAnchor443"/>Referencing nodes in a script</h2>
			<p>We want to update the <strong class="source-inline">HealthLabel</strong> node of our player character according to the amount of health the <a id="_idIndexMarker360"/>player still has left. To change nodes in our scene from within the script, we need to be able to reference them. Luckily, this is pretty easy in <span class="No-Break">Godot 4.</span></p>
			<p>There are multiple ways to get a node’s reference, but the easiest is the dollar notation. This notation looks <span class="No-Break">li<a id="_idTextAnchor444"/>ke this:</span></p>
			<pre class="source-code">
$HealthLabel</pre>			<p>The notation starts with a dollar sign (<strong class="source-inline">$</strong>), followed by the path through the scene tree to the node we want. Here, we reference the health label we <span class="No-Break">created earlier.</span></p>
			<p>Note that this path is relative to the node with the script where this path is mentioned. So if the main node has a script and we want to reference the player’s health label, the notation would look <span class="No-Break">li<a id="_idTextAnchor445"/>ke this:</span></p>
			<pre class="source-code">
$Player/HealthLabel</pre>			<p>So, now that we know how to get the reference to a node, let’s create a small function that updates the player’s health label and call it in the <span class="No-Break"><strong class="source-inline">add_health_points()</strong></span><span class="No-Break"> f<a id="_idTextAnchor446"/>unction:</span></p>
			<pre class="source-code">
func update_health_<a id="_idTextAnchor447"/>label():
   <strong class="bold">$HealthLabel.text = str(health) + "/" + str(MAX_HEALTH)</strong></pre>			<p>In this <strong class="source-inline">update_health_label()</strong> function, we take the <strong class="source-inline">HealthLabel</strong> node and directly change its <strong class="source-inline">text</strong> variable. This will change whatever text the label is showing on <span class="No-Break">the screen.</span></p>
			<p>Here, we use a new function named <strong class="source-inline">str()</strong> in <strong class="source-inline">update_health_label()</strong>. This function takes any parameter and converts it into a string. We need to do this because the <strong class="bold">+</strong> sign can only concatenate other strings together, so to concatenate the <strong class="source-inline">health</strong> and <strong class="source-inline">MAX_HEALTH</strong> values, which<a id="_idIndexMarker361"/> are integers, we’ll have to convert them into <span class="No-Break">a string.</span></p>
			<p>Now, we can use this <strong class="source-inline">update_health_label()</strong> function whenever we change the <span class="No-Break"><strong class="source-inline">heal<a id="_idTextAnchor448"/>th</strong></span><span class="No-Break"> value:</span></p>
			<pre class="source-code">
func add_health_points(differen<a id="_idTextAnchor449"/>ce: int):
   health += d<a id="_idTextAnchor450"/>ifference
   health = clamp(health, 0, MA<a id="_idTextAnchor451"/>X<a id="_idTextAnchor452"/>_HEALTH)
   <strong class="bold">update_health_label()</strong></pre>			<p>Just like this, we can directly change what the <strong class="source-inline">HealthLabel</strong> node is displaying. But there is a better way of accessing or referencing nodes within the scene tree: by caching them. We’ll take a look at <span class="No-Break">t<a id="_idTextAnchor453"/>hat next.</span></p>
			<h2 id="_idParaDest-168"><a id="_idTextAnchor454"/>Caching node references</h2>
			<p>Though the dollar notation is very<a id="_idIndexMarker362"/> convenient, sometimes, you will need to access a certain node often. In such cases, using the dollar notation will be slow because the engine will have to keep searching for the node within the tree and accessing it <span class="No-Break">every time.</span></p>
			<p class="callout-heading">Caching</p>
			<p class="callout">In computer lingo, caching means storing a certain piece of data for later so that you don’t have to load it every time it <span class="No-Break">is needed.</span></p>
			<p>To stop searching the node each time, we can save a reference to the node in a variable. For example, we can change the player scrip<a id="_idTextAnchor455"/>t <span class="No-Break">like so:</span></p>
			<pre class="source-code">
exte<a id="_idTextAnchor456"/>n<a id="_idTextAnchor457"/>ds Node2D
<strong class="bold">@onready var _health_label: Label = $H<a id="_idTextAnchor458"/>e<a id="_idTextAnchor459"/>althLabel</strong>
func update_healt<a id="_idTextAnchor460"/>h_label():
   <strong class="bold">_health_label</strong>.text = str(health) + "/" + str(MAX_HEALTH)</pre>			<p>Here, you see that we save the reference to the <strong class="source-inline">HealthLabel</strong> node in a variable called <strong class="source-inline">_health_label</strong>. Later on, we can use <span class="No-Break">this reference.</span></p>
			<p>The upside is, of course, that we only <a id="_idIndexMarker363"/>have to change the path to the node at one point: the line where the reference gets stored in a variable. Another upside is that we can type-hint the variable with the type of the node. So, we are making it even safer than the previous way of referencing <span class="No-Break">the node.</span></p>
			<p>You’ll also notice that I use the <strong class="source-inline">@onready</strong> annotation. We call commands that start with an <strong class="source-inline">@</strong> annotation, like the one shown previously. This annotation executes that line of code when the node is ready and has entered the scene tree. This is right before the <strong class="source-inline">_ready()</strong> function of that node is called. In Godot, the <strong class="source-inline">_ready()</strong> function of each node gets called after each of its children are ready, meaning that their <strong class="source-inline">_ready()</strong> functions get called before the parent node’s <strong class="source-inline">_ready()</strong> function. We need to wait for this moment to get any nodes in the tree because otherwise, there is a possibility for them not to <span class="No-Break">exist yet!</span></p>
			<p class="callout-heading">Annotations</p>
			<p class="callout">There are more annotations. We’ll return to them when they are applicable. But it’s already good to know that all of these annotations affect how external tools will treat the script and don’t change any logic within the <span class="No-Break">script itself.</span></p>
			<p>I advise that you always cache variables as described here because it will keep your code clea<a id="_idTextAnchor461"/>n <span class="No-Break">and fast.</span></p>
			<h2 id="_idParaDest-169"><a id="_idTextAnchor462"/>Trying out the player script</h2>
			<p>To try out what we have created so far, we can run a quick test by adding the <strong class="source-inline">_ready()</strong> function to the <a id="_idIndexMarker364"/><span class="No-Break">pl<a id="_idTextAnchor463"/>ayer script:</span></p>
			<pre class="source-code">
fu<a id="_idTextAnchor464"/>nc _ready():
   add_health_points(-2)</pre>			<p>Now, when you run the scene, you should see that the health label says <strong class="bold">8/10</strong>, <span class="No-Break">like so:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer094">
					<img alt="Figure 6.20 – The player’s health label has been updated to 8/10" src="image/B19358_06_20.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.20 – The player’s health label has been updated to 8/10</p>
			<p>After testing the script, remove the preceding lines again so that they don’t interfere with the rest of <span class="No-Break">our coding.</span></p>
			<p>In this section, we learned how to reference nodes from the scene tree within our code and how to update the values of these nodes. We also set up a basic script for tracking the health of our player. In the following section, we’ll learn about <span class="No-Break">exporting<a id="_idTextAnchor465"/> variables.</span></p>
			<h1 id="_idParaDest-170"><a id="_idTextAnchor466"/>Exporting variables to the editor</h1>
			<p>We have always defined variables<a id="_idIndexMarker365"/> within code and every time we wanted to change them, we had to change the code too. But in Godot, it is straightforward to expose variables to the editor so that we can change them without even opening the code editor. This is extremely useful when you want to test things out and tweak variables on the fly. An exported variable pops up in the <strong class="bold">Inspector</strong> view of that node, just like the transformation and text properties we saw in the <em class="italic">Manipulating nodes in the </em><span class="No-Break"><em class="italic">editor</em></span><span class="No-Break"> section.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">An exported variable is also useful for people who don’t know how to code, such as level designers, but still want to change the behavior of <span class="No-Break">specific nodes.</span></p>
			<p>To export a variable to the<a id="_idIndexMarker366"/> editor, we can use the <strong class="source-inline">@export</strong> annotation. Let’s change the line where we define the <strong class="source-inline">health</strong> variable, <span class="No-Break">like so:</span></p>
			<pre class="source-code">
<strong class="bold">@export</strong> var health: int = 10</pre>			<p>Make sure you save the script. Go to the 2D editor using the button at the top of <span class="No-Break">the editor.</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer095">
					<img alt="Figure 6.21 – Click 2D to go back to the 2D editor" src="image/B19358_06_21.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.21 – Click 2D to go back to the 2D editor</p>
			<p>Click on our <strong class="source-inline">Player</strong> node, and see the <strong class="source-inline">health</strong> variable in the <strong class="bold">Inspector</strong> view. This is our exported variable. Changing it will change the variable’s value at the start of the game, not directly in the <span class="No-Break">script itself:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer096">
					<img alt="Figure 6.22 – The health variable as an exported variable in the Inspector view of the Player node" src="image/B19358_06_22.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.22 – The health variable as an exported variable in the Inspector view of the Player node</p>
			<p>Now, when you change the player’s health value through the <strong class="bold">Inspector</strong> view and run the game, you’ll see that it doesn’t display the correct value. All we have to do to solve this is update the <strong class="source-inline">health</strong> label in the <strong class="source-inline">_ready()</strong> function<a id="_idTextAnchor467"/>, <span class="No-Break">like so:</span></p>
			<pre class="source-code">
fun<a id="_idTextAnchor468"/>c _ready():
   update_health_label()</pre>			<p>This will ensure that the health label is updated from the moment the <strong class="source-inline">Player</strong> node enters the <span class="No-Break">scene tree.</span></p>
			<p class="callout-heading">More information</p>
			<p class="callout">If you want to learn more about export variables, you can check out the official <span class="No-Break">documentation: </span><a href="https://docs.godotengine.org/en/stable/tutorials/scripting/gdscript/gdscript_exports.html"><span class="No-Break">https://docs.godotengine.org/en/stable/tutorials/scripting/gdscript/gdscript_exports.html</span></a><span class="No-Break">.</span></p>
			<p>Now, we start the game<a id="_idIndexMarker367"/> with the correct amount of health displayed on the health label. But there is a better way of updating this health label: using setters <a id="_idTextAnchor469"/><span class="No-Break">and getters.</span></p>
			<h2 id="_idParaDest-171"><a id="_idTextAnchor470"/>Setters and getters</h2>
			<p>When you change the player’s health value through the <strong class="bold">Inspector</strong> view and run the game, you’ll see that the value<a id="_idIndexMarker368"/> doesn’t update. But the correct value gets printed out if you run it with a <strong class="source-inline">_ready()</strong> funct<a id="_idTextAnchor471"/>ion, <span class="No-Break">like so:</span></p>
			<pre class="source-code">
f<a id="_idTextAnchor472"/>unc _ready():
   print(health)</pre>			<p>That is because the <strong class="source-inline">update_health_label()</strong> function is not being called when we change <span class="No-Break">the value!</span></p>
			<p>Luckily, we can fix this. In programming, <strong class="bold">getter</strong> and <strong class="bold">setter</strong> functions exist. These functions are called when you get or <a id="_idIndexMarker369"/>set the value of a variable. With these getter or setter functions, we <a id="_idIndexMarker370"/>can execute all the logic needed to handle a new value. We can define a getter and setter for our health va<a id="_idTextAnchor473"/>riable <span class="No-Break">like so:</span></p>
			<pre class="source-code">
@export var he<a id="_idTextAnchor474"/>alth: i<a id="_idTextAnchor475"/>nt = 10<strong class="bold">:</strong>
   <strong class="bold">get:</strong>
    <a id="_idTextAnchor476"/>  return health
   <a id="_idTextAnchor477"/><strong class="bold">set(new_value):</strong>
      health = clamp(new_value,<a id="_idTextAnchor478"/> 0, MAX_HEALTH)
      update_health_label()</pre>			<p>So, the getter is defined by <strong class="source-inline">get:</strong>, followed by the code block that defines the getter logic, and the setter by <strong class="source-inline">set(new_value):</strong>, followed by its code block. <strong class="source-inline">new_value</strong> is the new value that is assigned to the variable. Within the setter, we get the opportunity to process this value if needed or set other processes in motion. In our case, we don’t want to process the new value, but we do want to update the <span class="No-Break">health label.</span></p>
			<p>The getter does nothing special – it just returns the health value. On the other hand, the setter clamps the new value so that it is<a id="_idIndexMarker371"/> valid and then updates the <span class="No-Break">health label.</span></p>
			<p>When we get or set the <strong class="source-inline">health</strong> value, the interpreter will execute these functions first. He<a id="_idTextAnchor479"/>re’s <span class="No-Break">an example:</span></p>
			<pre class="source-code">
print(health) # Ex<a id="_idTextAnchor480"/>ecute the getter
health = 100 # Execute the setter</pre>			<p>This also simplifies the <strong class="source-inline">add_health_points()</strong> function because we no longer have to clamp the new health value as this already gets done in the setter. So, let’s update the <strong class="source-inline">add_health_points()</strong> function t<a id="_idTextAnchor481"/>o <span class="No-Break">the following:</span></p>
			<pre class="source-code">
func add_health_points(d<a id="_idTextAnchor482"/>ifference: int):
   health += difference</pre>			<p>But what is this? The project errors when we run <span class="No-Break">it now!</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer097">
					<img alt="Figure 6.23 – An error showing that the health label is non-existing" src="image/B19358_06_23.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.23 – An error showing that the health label is non-existing</p>
			<p>The setter function gets executed before the <strong class="source-inline">_health_label</strong> reference is created. So, we must make sure<a id="_idIndexMarker372"/> that the <strong class="source-inline">_health_label</strong> is filled in before we update its text. If it isn’t, we can just return fr<a id="_idTextAnchor483"/>om <span class="No-Break">the function:</span></p>
			<pre class="source-code">
func update<a id="_idTextAnchor484"/>_health_label():
   <strong class="bold">if not is_instance_valid<a id="_idTextAnchor485"/>(_health_labe<a id="_idTextAnchor486"/>l<a id="_idTextAnchor487"/>):</strong>
      <strong class="bold">return</strong>
   _health_label.text = str(health) + "/" + str(MAX_HEALTH)</pre>			<p>The <strong class="source-inline">is_instance_valid()</strong> function checks if the reference to a node is valid. It returns <strong class="source-inline">true</strong> if it is and <span class="No-Break"><strong class="source-inline">false</strong></span><span class="No-Break"> otherwise.</span></p>
			<p class="callout-heading">Checking if a node reference exists</p>
			<p class="callout">Your first instinct might be to check if the reference to the node is not <strong class="source-inline">null</strong> by running <strong class="source-inline">_health_label != null</strong>. However, this does not guarantee that the node is available. When the node is deleted, for example, this check for <strong class="source-inline">null</strong> will still return <strong class="source-inline">true</strong> because the reference still exists within the variable. <strong class="source-inline">is_instance_valid(_health_label)</strong> will check more than just whether the variable is <strong class="source-inline">null</strong> – it will also make sure that the node still exists and is in use within the <span class="No-Break">scene tree.</span></p>
			<p>At this point, the code<a id="_idIndexMarker373"/> for the player shoul<a id="_idTextAnchor488"/>d look <span class="No-Break">like thi<a id="_idTextAnchor489"/>s<a id="_idTextAnchor490"/>:</span></p>
			<pre class="source-code">
extends Node2D
const MAX<a id="_idTextAnchor491"/>_<a id="_idTextAnchor492"/>HEALTH: int = 10
@onready var _health_label: Lab<a id="_idTextAnchor493"/>e<a id="_idTextAnchor494"/>l = $HealthLabel
@export var <a id="_idTextAnchor495"/>health: int = 10:
   get:
      return health
   set(new_value):
      health = clamp(new_value, 0, MAX_HEALTH)
      upda<a id="_idTextAnchor496"/>t<a id="_idTextAnchor497"/>e_health_label()
func _ready():
   upda<a id="_idTextAnchor498"/>t<a id="_idTextAnchor499"/>e_health_label()
func update_health_label():
   if not is_instance_valid(_health_label):
      return
   _health_label.text = str(health) + "/" <a id="_idTextAnchor500"/>+<a id="_idTextAnchor501"/> str(MAX_HEALTH)
func add_health_points(difference: int):
   health += difference</pre>			<p>Setters and getters help us encapsulate behavior related to updating variables, as we saw in <a href="B19358_05.xhtml#_idTextAnchor365"><span class="No-Break"><em class="italic">Chapter 5</em></span></a>. It abstracts the logic behind what needs to happen when updating this variable so that the user of the class doesn’t have to worry <span class="No-Break">about it.</span></p>
			<p>With this code set up, the<a id="_idIndexMarker374"/> health of our player can easily be updated using the regular or special assignment operators and the health label will <span class="No-Break">u<a id="_idTextAnchor502"/>pdate accordingly.</span></p>
			<h2 id="_idParaDest-172"><a id="_idTextAnchor503"/>Changing values while the game is running</h2>
			<p>Another cool thing<a id="_idIndexMarker375"/> about these exported variables, now that we have a setter and a getter defined for them, is that we can change them while the game runs! So, if you run the game and change the <strong class="source-inline">health</strong> parameter in the <strong class="bold">Inspector</strong> view while it is running, you will see that change reflected in the health <span class="No-Break">label instantaneously.</span></p>
			<p>This (mostly) works with all built-in parameters too! If you keep the game open and change the player’s <strong class="bold">Transformation</strong> parameters, for example, you’ll see them c<a id="_idTextAnchor504"/>hange in <span class="No-Break">real time.</span></p>
			<p>This will be useful later on so that we don’t always have to re-launch the game when working <span class="No-Break">on it.</span></p>
			<h2 id="_idParaDest-173"><a id="_idTextAnchor505"/>Different types of exported variables</h2>
			<p>When exporting a variable that we type hinted, Godot will choose the right input field type for that type. It will have a <a id="_idIndexMarker376"/>numerical input field with up and down arrows for integers, while it will use a normal text input for strings, <span class="No-Break">like so:</span></p>
			<pre class="source-code">
@export var health: int = 10
@export var damage: float = 0.0
@export var player_name: String = "Erika"</pre>			<p>These three lines will each export a variable to the editor, but each with a different data type: integer, floating-point number, and string, respectively. The result is that we get a different kind of input field for each of <span class="No-Break">the variables:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer098">
					<img alt="Figure 6.24 – Different variable types that get exported" src="image/B19358_06_24.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.24 – Different variable types that get exported</p>
			<p>There are also other export annotations to be even more specific. One of those is the <strong class="source-inline">@export_range</strong> annotation, which specifies a number range the value should be in, <span class="No-Break">like so:</span></p>
			<pre class="source-code">
@export_range(0, 10) health: int = 10</pre>			<p>In the preceding code excerpt, we <a id="_idIndexMarker377"/>export the <strong class="source-inline">health</strong> variable and specify that it should be a number between 0 and 10, including the outer values of 0 and 20. When you try out this ranged export, you’ll see that you cannot input values that fall outside of <span class="No-Break">this range.</span></p>
			<p>To make it more dynamic, we can use the <strong class="source-inline">MAX_HEALTH</strong> variable we defined earlier within the <span class="No-Break">player’s script:</span></p>
			<pre class="source-code">
@export_range(0, MAX_HEALTH) health: int = 10</pre>			<p>Exporting variables is a very important technique to keep in our toolkit for tweaking variables and values when testing out the game. Now, let’s direct our attention to the arena and world the player will b<a id="_idTextAnchor506"/>e walking <span class="No-Break">around in.</span></p>
			<h1 id="_idParaDest-174"><a id="_idTextAnchor507"/>Creating a little world</h1>
			<p>Now that we have a little player character, let’s create<a id="_idIndexMarker378"/> a world for them to inhabit! In this section, we’ll flesh out the arena in which the player has to battle <span class="No-Break">challenging foes.</span></p>
			<h2 id="_idParaDest-175"><a id="_idTextAnchor508"/>Changing the background color</h2>
			<p>Let’s start simple by <a id="_idIndexMarker379"/>changing the background color for our arena. We can easily do this from the <span class="No-Break">project settings:</span></p>
			<ol>
				<li>Navigate to <strong class="bold">Rendering</strong> | <strong class="bold">Environment</strong> in the <span class="No-Break">project settings:</span></li>
			</ol>
			<div>
				<div class="IMG---Figure" id="_idContainer099">
					<img alt="Figure 6.25 – Finding Default Clear Color under Rendering &gt; Environment in the project settings" src="image/B19358_06_25.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.25 – Finding Default Clear Color under Rendering &gt; Environment in the project settings</p>
			<ol>
				<li value="2">Set the <strong class="bold">Default Clear Color</strong> setting to an appropriate color. I chose <strong class="source-inline">#e0bf7b</strong> because it looks like sand or <span class="No-Break">dried-up mud:</span></li>
			</ol>
			<div>
				<div class="IMG---Figure" id="_idContainer100">
					<img alt="Figure 6.26 – Picking a color using the color selection tool" src="image/B19358_06_26.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.26 – Picking a color using the color selection tool</p>
			<p>With this nice color in <a id="_idIndexMarker380"/>place, let’s add some features, such as boulders and<a id="_idTextAnchor509"/><a id="_idTextAnchor510"/> walls, to <span class="No-Break">our arena.</span></p>
			<h2 id="_idParaDest-176"><a id="_idTextAnchor511"/>Adding Polygon2D boulders</h2>
			<p>Now that we have a ground for the <a id="_idIndexMarker381"/>player character to stand on, let’s add some boulders that will serve as obstacles in the arena. To do this, we will be using the <strong class="source-inline">Polygon2D</strong> node. This node can draw any polygon shape on the screen in any color <span class="No-Break">we want:</span></p>
			<ol>
				<li>Add a <strong class="bold">Node2D</strong> node called <strong class="source-inline">Arena</strong> to the root node of our <span class="No-Break"><strong class="source-inline">Main</strong></span><span class="No-Break"> scene.</span></li>
				<li>Now, drag the <strong class="source-inline">Arena</strong> node we just created above the <strong class="source-inline">Player</strong> node. This will ensure everything within the <strong class="source-inline">Arena</strong> node will be drawn beneath the <strong class="source-inline">Player</strong> node. See the <em class="italic">Node drawing order</em> section to learn more <span class="No-Break">about this.</span></li>
				<li>We will put all our arena elements, such as boulders and walls, into this node. This way, we’ll keep<a id="_idIndexMarker382"/> the tree structure nice <span class="No-Break">and tidy.</span></li>
				<li>Now, add a <strong class="source-inline">Polygon2D</strong> node under the <strong class="source-inline">Arena</strong> node and call <span class="No-Break">it </span><span class="No-Break"><strong class="source-inline">Boulder</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div class="IMG---Figure" id="_idContainer101">
					<img alt="Figure 6.27 – The scene tree with the Arena node and a Boulder node" src="image/B19358_06_27.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.27 – The scene tree with the Arena node and a Boulder node</p>
			<ol>
				<li value="5">You can add points to the polygon by left-clicking anywhere on the screen while the <strong class="source-inline">Boulder</strong> node is selected. Right-clicking will remove a point. You can also drag earlier placed points around. Place some points and close the shape by clicking on the first point you <span class="No-Break">put down:</span></li>
			</ol>
			<div>
				<div class="IMG---Figure" id="_idContainer102">
					<img alt="Figure 6.28 – Drawing a boulder using a Polygon2D node" src="image/B19358_06_28.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.28 – Drawing a boulder using a Polygon2D node</p>
			<ol>
				<li value="6">Set the <strong class="source-inline">Boulder</strong> node’s color property to something that resembles a stone. I <span class="No-Break">chose </span><span class="No-Break"><strong class="source-inline">#504f51</strong></span><span class="No-Break">.</span></li>
			</ol>
			<p>These boulders might look <a id="_idIndexMarker383"/>simple, but they will serve <span class="No-Break">our purpose.</span></p>
			<h2 id="_idParaDest-177"><a id="_idTextAnchor512"/>Node drawing order</h2>
			<p>So, why did we drag the <strong class="source-inline">Arena</strong> node above the <strong class="source-inline">Player</strong> node? By default, the nodes get drawn in the order they’re in within<a id="_idIndexMarker384"/> the tree. The nodes closest to their parents get drawn first and the ones further away from the parent node within the tree structure are drawn on top of the <span class="No-Break">ones below.</span></p>
			<p>There are ways to circumvent this, but that’s out of the scope of this book. So, for now, we must structure our node <span class="No-Break">tree correctly:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer103">
					<img alt="Figure 6.29 – Nodes get drawn in the order they are in within the scene tree" src="image/B19358_06_29.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.29 – Nodes get drawn in the order they are in within the scene tree</p>
			<p>A well-structured tree will draw all nodes in the exact orde<a id="_idTextAnchor513"/>r we want them <span class="No-Break">to be.</span></p>
			<h2 id="_idParaDest-178"><a id="_idTextAnchor514"/>Creating an outer wall</h2>
			<p>For the outer wall of the <a id="_idIndexMarker385"/>arena, we’ll use a <strong class="source-inline">Polygon2D</strong> node again, but in a different way <span class="No-Break">this time:</span></p>
			<ol>
				<li>Add a <strong class="source-inline">Polygon2D</strong> node under the <strong class="source-inline">Arena</strong> node and call <span class="No-Break">it </span><span class="No-Break"><strong class="source-inline">OuterWall</strong></span><span class="No-Break">.</span></li>
				<li>Draw a rough rectangle that will be the inside of the arena. It’s okay if this rectangle is not perfect. This will make the arena look <span class="No-Break">extra medieval:</span></li>
			</ol>
			<div>
				<div class="IMG---Figure" id="_idContainer104">
					<img alt="Figure 6.30 – Drawing an arena outer wall using a Polygon2D node" src="image/B19358_06_30.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.30 – Drawing an arena outer wall using a Polygon2D node</p>
			<ol>
				<li value="3">Now, with <strong class="source-inline">OuterWall</strong> selected, find<a id="_idIndexMarker386"/> and enable the <strong class="bold">Invert</strong> parameter in the <strong class="bold">Inspector</strong> view. This option inverts the shape and makes it look like the outer walls of <span class="No-Break">the arena:</span></li>
			</ol>
			<div>
				<div class="IMG---Figure" id="_idContainer105">
					<img alt="Figure 6.31 – Inverting the shape of a Polygon2D node" src="image/B19358_06_31.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.31 – Inverting the shape of a Polygon2D node</p>
			<ol>
				<li value="4">Set the <strong class="bold">Border</strong> property under the <strong class="bold">Invert</strong> section to a high number, such as <strong class="source-inline">1000px</strong>, so that the walls expand <span class="No-Break">very far.</span></li>
				<li>Give the wall a fitting <a id="_idIndexMarker387"/>color. I chose <strong class="source-inline">#2d2c2e</strong>, which is a little darker than the boulders, so that the player sees <span class="No-Break">the difference:</span></li>
			</ol>
			<div>
				<div class="IMG---Figure" id="_idContainer106">
					<img alt="Figure 6.32 – The resulting arena" src="image/B19358_06_32.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.32 – The resulting arena</p>
			<p>Inverting a polygon makes it very easy to create the internals of an arena or room. The natural next step is to let our imagination loose and make a<a id="_idTextAnchor515"/> visually <span class="No-Break">nice arena.</span></p>
			<h2 id="_idParaDest-179"><a id="_idTextAnchor516"/>Getting creative</h2>
			<p>With these simple tools, get creative and create some interesting terrain to serve as <span class="No-Break">an arena.</span></p>
			<p>For instance, you can <a id="_idIndexMarker388"/>add some more boulders to your arena. You can do this by creating an entirely new <strong class="source-inline">Polygon2D</strong> node or by duplicating your earlier boulder and altering them a bit by dragging points around and using the <strong class="bold">Transform</strong> tools we <span class="No-Break">learned about.</span></p>
			<p>You can also add more walls and change the outer boundaries of the arena <span class="No-Break">some more.</span></p>
			<p>I came up with <span class="No-Break">this arena:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer107">
					<img alt="Figure 6.33 – My arena after spending some more time refining it" src="image/B19358_06_33.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.33 – My arena after spending some more time refining it</p>
			<p>Now that we can create <a id="_idIndexMarker389"/>our little worlds and arenas using colored rectangles and polygons, we have everything to create the basic visual structure of our game. Next, we’ll do some extra exercises and summarize <span class="No-Break">this chapter.</span></p>
			<h1 id="_idParaDest-180"><a id="_idTextAnchor517"/>Additional exercises – Sharpening the axe</h1>
			<ol>
				<li>Start by making more boulders and walls based on what we learned in the previous section so that you can populate <span class="No-Break">your arena.</span></li>
				<li>Based on what you learned about the <strong class="source-inline">health</strong> value of the player, add an exported variable that tracks the number of coins the player has, called <strong class="source-inline">number_of_coins</strong>, to the <span class="No-Break">player script.</span></li>
				<li>Add a setter and getter for the <span class="No-Break"><strong class="source-inline">number_of_coins</strong></span><span class="No-Break"> variable.</span></li>
				<li>Lastly, make a label that shows the coins above the player’s head. Make sure that everything gets handled and updated correctly so that we can update the variable from the editor and the code while the label always stays up to date <a id="_idTextAnchor518"/>when running <span class="No-Break">the game.</span></li>
			</ol>
			<h1 id="_idParaDest-181"><a id="_idTextAnchor519"/>Summary</h1>
			<p>In this chapter, we created our first real scene. We saw how different nodes do different things for us and we extended <strong class="bold">Node2D</strong> with a script that will manage the player’s health. We also created the area in which all the action will <span class="No-Break">take place.</span></p>
			<p>In the next chapter, we’ll make it possible for the player to move around and we’ll also refresh our vector math. Don’t worry – it won’t be painful, but a bit o<a id="_idTextAnchor520"/>f math will <span class="No-Break">be useful.</span></p>
			<h1 id="_idParaDest-182"><a id="_idTextAnchor521"/>Quiz time</h1>
			<ul>
				<li>Why did we start by making a Game Design Document (GDD) instead of jumping right into creating <span class="No-Break">the game?</span></li>
				<li>How do you reference nodes within <span class="No-Break">a script?</span></li>
				<li>What keyword can we use to make a variable, such as the amount of health, available <a id="_idTextAnchor522"/>in the <span class="No-Break"><strong class="bold">Inspector</strong></span><span class="No-Break"> view?</span></li>
				<li>What are setter and getter functions <span class="No-Break">used for?</span></li>
			</ul>
		</div>
	</body></html>