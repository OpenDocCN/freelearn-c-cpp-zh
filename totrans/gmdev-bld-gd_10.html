<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer131">
<h1 class="chapter-number" id="_idParaDest-164"><a id="_idTextAnchor165"/>10</h1>
<h1 id="_idParaDest-165"><a id="_idTextAnchor166"/>Making Things Look Better with Lights and Shadows</h1>
<p>We have a simple and clean-looking level design, but it could use a good makeover. For example, the sconces on the walls and the candles on the floor are just sitting there without adding much interest to the scene. Also, there is the slight issue of having this level as an underground environment since this is a cave. We must find a way to simulate the light from the exterior since Clara sailed her boat in. Overall, we will have the level be lit just enough for the players to perceive things.</p>
<p>In this chapter, we’ll introduce lights and shadows to our workflow so that our scene looks visually appealing. We covered lights earlier in <a href="B17473_04.xhtml#_idTextAnchor060"><em class="italic">Chapter 4</em></a>, <em class="italic">Adjusting Cameras and Lights</em>, but we did that in the context of Blender. While generic concepts still apply, we’ll have a chance to do things from a game development perspective this time instead of taking an artistic render in Blender. </p>
<p>Shadows are not automatically available in Godot. Therefore, we’ll show you how to turn them on and discover some of the shadow settings that balance quality and performance. Besides placing light objects and enabling shadows, and altering their qualities, we will present a higher-level concept, creating a <strong class="bold">WorldEnvironment</strong>. This is also referred to as post-processing and it’s a great tool to improve the look and feel of your scenes.</p>
<p>Although we’ll be improving the level with each new addition of the topics we have listed so far, to tie this all together, we’ll also tackle a somewhat advanced topic, <strong class="bold">global illumination</strong>, which will add a realistic touch to the scene. </p>
<p>We have many steps to take before we will have created a handsome-looking level. In this chapter, we will cover the following topics:</p>
<ul>
<li>Adding different types of light</li>
<li>Enabling and adjusting shadows</li>
<li>Creating post-processing effects</li>
<li>Using global illumination</li>
</ul>
<p>Even though the purpose of this chapter is to understand how the lighting system works, we’ll introduce a few complementary Godot topics along the way.</p>
<p>By the end of this chapter, you’ll be able to utilize lights and enable shadows, as well as to take advantage of global illumination and post-processing effects that will further enhance the atmosphere in the level.</p>
<h1 id="_idParaDest-166"><a id="_idTextAnchor167"/>Technical requirements</h1>
<p>We’ll add and change things from where we left off. You have two options at this point – you can either keep working on your copy from the previous chapter or use the <strong class="source-inline">Finish</strong> folder mentioned in <a href="B17473_09.xhtml#_idTextAnchor146"><em class="italic">Chapter 9</em></a>, <em class="italic">Designing the Level</em>, which is available in this book’s GitHub repository: <a href="https://github.com/PacktPublishing/Game-Development-with-Blender-and-Godot">https://github.com/PacktPublishing/Game-Development-with-Blender-and-Godot</a>.</p>
<h1 id="_idParaDest-167"><a id="_idTextAnchor168"/>Adding different types of light</h1>
<p>In <a href="B17473_04.xhtml#_idTextAnchor060"><em class="italic">Chapter 4</em></a>, <em class="italic">Adjusting Cameras and Lights</em>, we discussed how different types of light worked – more importantly, the <a id="_idIndexMarker421"/>kind of effect they bring to a scene. In this chapter, we’ll revisit the same topic but pursue the effort in the context of Godot. </p>
<p>Blender uses four light types: <strong class="bold">Sun</strong>, <strong class="bold">Point</strong>, <strong class="bold">Spot</strong>, and <strong class="bold">Area</strong>. However, Godot has only three lights, as follows:</p>
<ul>
<li><strong class="bold">DirectionalLight</strong>: This is the equivalent of the <strong class="bold">Sun</strong> light in Blender. We stated directionality <a id="_idIndexMarker422"/>in the <strong class="bold">Sun</strong> light’s description. The angle of this <a id="_idIndexMarker423"/>light type is the most important since it’s an infinitely distant light source, so all its rays are considered to flow parallel to each other. So, in Godot, this concept is part of the node’s name, hence making it easier to remember.</li>
</ul>
<p>We’ll not be using this type of light in our scene since it’s an indoor environment. Despite that, it may still be tempting to utilize it to give an overall light effect, but this light source would overwhelm the whole scene. We need <a id="_idIndexMarker424"/>something else that can be fine-tuned as we go. Therefore, we’ll <a id="_idIndexMarker425"/>focus on the two other light types.</p>
<ul>
<li><strong class="bold">OmniLight</strong>: This is what the <strong class="bold">Point</strong> light is in Blender. Lightbulbs and, yes, the sconces <a id="_idIndexMarker426"/>on the walls, are the right kind of objects for which this <a id="_idIndexMarker427"/>type of light is good. As a reminder, omni means in every direction.</li>
<li><strong class="bold">SpotLight</strong>: This one is self-evident – it’s the <strong class="bold">Spot</strong> light in Blender. It’s good for simulating <a id="_idIndexMarker428"/>car lights, flashlights, and any other light source that has <a id="_idIndexMarker429"/>a beam-like quality. We’ll be using this light to simulate the exterior light creeping into the cave.</li>
</ul>
<p>So, where is the <strong class="bold">Area</strong> light in Godot? It simply doesn’t exist. There are different mechanisms in Godot that you can use to simulate the effect of an <strong class="bold">Area</strong> light in Blender. Often, this kind of light is for mimicking the light coming in from a window, and it can be simulated with emissive materials. </p>
<p>Speaking of using different types of light, let’s start by lighting those candles.</p>
<h2 id="_idParaDest-168"><a id="_idTextAnchor169"/>Lighting candles</h2>
<p>For this type of exercise, the <strong class="bold">OmniLight</strong> type is the right choice, but how many are we supposed to have? If you look closely at the candle model, you’ll see that the model is <a id="_idIndexMarker430"/>composed of multiple candles; some short, some tall. Does it make sense to place one <strong class="bold">OmniLight</strong> above each wick? It’s entirely possible but it’s also an artistic decision to make, and we leave it to you. </p>
<p>In our case, we’ll assume that the overall light coming from this object could be reduced to a point over the candles’ wicks. Thus, it’s perfectly fine to place one <strong class="bold">OmniLight</strong> for the whole model. It’s time to demonstrate how this can be done:</p>
<ol>
<li>Double-click <strong class="source-inline">Candles_1.glb</strong> in <strong class="bold">FileSystem</strong> to create a <strong class="bold">New Inherited</strong> scene. Save it as <strong class="source-inline">Candles_1.tscn</strong> in its original folder (<strong class="source-inline">Models/Candles/</strong>).</li>
<li>Add an <strong class="bold">OmniLight</strong> to the <strong class="bold">Scene</strong> tree.</li>
<li>Adjust its <strong class="bold">Y</strong> position to <strong class="source-inline">0.8</strong>, for example, so that it’s slightly over the wicks.</li>
</ol>
<p>This will place a point light in your candle scene. Right now, with the default settings, it’s hard to see the impact. If you get close to the light object and adjust your camera angle so that you no longer see the horizon and the sky, you can get a better view. Perhaps turn the visibility of <strong class="bold">OmniLight</strong> on and off in the <strong class="bold">Scene</strong> tree to see the light’s contribution. </p>
<p>We’ll leave most of the settings in the <strong class="bold">Inspector</strong> panel untouched for now, but you can change the light’s color to, for example, <strong class="source-inline">d6d58e</strong>. This can be found under the <strong class="bold">Light</strong> section in the <strong class="bold">Inspector</strong> panel. The result is as follows:</p>
<div>
<div class="IMG---Figure" id="_idContainer116">
<img alt="Figure 10.1 – An OmniLight with a yellow color right over the candles " height="747" src="image/Figure_10.1_B17473.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.1 – An OmniLight with a yellow color right over the candles</p>
<p>Let’s take a moment <a id="_idIndexMarker431"/>to discuss why we’ve added a light to a scene that we are constructing out of a model instead of directly adding it to the level scene. After all, we already had several <strong class="bold">Spatial</strong> nodes to hold items that were similar, such as walls, columns, and more. We could have created a <strong class="bold">Spatial</strong> node called <em class="italic">Lights</em> and stuck a bunch of <strong class="bold">OmniLight</strong> nodes in there. </p>
<p>By introducing a light node to the model scene instead of the main level, you can utilize this candle scene in other scenes as well. Hence, you don’t have to create more light objects and position them over all the candles in the level. When you are decorating a level, and when you need candles, they will arrive as a full-service package.</p>
<p class="callout-heading">Overcoming the jagged edges</p>
<p class="callout">After adding lights to the scene, you may notice that some objects look jagged around the edges since the details are popping up more. To eliminate this, you can turn on the anti-aliasing setting. The hard edges will be smoothed out, objects will blend more seamlessly, and everything will look easier on the eyes. To enable it, set the <strong class="bold">Msaa</strong> value to <strong class="bold">2x</strong>. This setting can be found under the <strong class="bold">Quality</strong> subsection of <strong class="bold">Rendering</strong> in <strong class="bold">Project Settings</strong>.</p>
<p>So far, so good, but will the lights always be on? It seems so, for now. Let’s see how we can complete the <a id="_idIndexMarker432"/>full-service aspect of the candles by introducing a mechanism that will switch the lights off. To do this, we need to add a short script:</p>
<ol>
<li value="1">Right-click the root node (<strong class="bold">Candle_1</strong>) and choose <strong class="bold">Attach Script</strong>.</li>
<li>Keep everything the same in the upcoming pop-up screen, but change the path so that it shows <strong class="source-inline">/Models/Candles/Candles.gd</strong>.</li>
<li>Your script file should contain the following lines of code:<p class="source-code">extends Spatial</p><p class="source-code">export(bool) var is_lit = false setget switch</p><p class="source-code">func switch(condition):</p><p class="source-code">    is_lit = condition</p><p class="source-code">func _process(_delta: float) -&gt; void:</p><p class="source-code">    $OmniLight.visible = is_lit</p></li>
</ol>
<p>This will create a toggle state for <strong class="bold">OmniLight</strong>, and it’ll start its life off by default. Only when the player, or you as a developer, change the value of <strong class="source-inline">is_lit</strong> will the light become visible again. </p>
<p>To test this without running the game, you can add the <strong class="source-inline">tool</strong> keyword at the beginning of the script and see your changes live while you are still working on the level. Observe how the light’s <a id="_idIndexMarker433"/>visibility changes in the <strong class="bold">Scene</strong> panel when you toggle the state of <strong class="source-inline">is_lit</strong> in the <strong class="bold">Inspector</strong> panel.</p>
<p>We have another candle model, <strong class="source-inline">Candles_2.glb</strong>, that could also benefit from all this. Instead of starting from scratch, this is what we suggest you do:</p>
<ol>
<li value="1">In the <strong class="bold">Candles_1</strong> scene, right-click the <strong class="bold">OmniLight</strong> node in the <strong class="bold">Scene</strong> tree and choose <strong class="bold">Copy</strong>.</li>
<li>Create a scene out of <strong class="source-inline">Candles_2.glb</strong> and save it in its original folder.</li>
<li>Right-click the root node of this new scene and choose <strong class="bold">Paste</strong>.</li>
<li>Select the root node and attach <strong class="source-inline">Candles.gd</strong> to the <strong class="bold">Script</strong> property in the <strong class="bold">Inspector</strong> panel.</li>
</ol>
<p>This will minimize the number of steps you have to take to add an <strong class="bold">OmniLight</strong>, position it, then write pretty much the same script for controlling it. Here, we are using the same script for both scenes since the node references in the scene are the same. After making our most recent changes, the Godot editor will look as follows:</p>
<div>
<div class="IMG---Figure" id="_idContainer117">
<img alt="Figure 10.2 – A new candle scene using the same script for switch functionality " height="433" src="image/Figure_10.2_B17473.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.2 – A new candle scene using the same script for switch functionality</p>
<p>Although we have been working on a smart way to add lights via attaching light objects to the candle models, we haven’t made any changes to the level itself. We will discuss this next and share a few words about workflow improvements that you can make in your future projects. </p>
<h2 id="_idParaDest-169"><a id="_idTextAnchor170"/>Introducing candles to the level</h2>
<p>In <a href="B17473_09.xhtml#_idTextAnchor146"><em class="italic">Chapter 9</em></a>, <em class="italic">Designing the Level</em>, we instructed you to instance glTF files directly to the level, which <a id="_idIndexMarker434"/>kept the filesystem clean without creating redundant <strong class="source-inline">.tscn</strong> files. Otherwise, you’d have had one scene file per model with no purpose at all. A simple workflow such as only adding the models to a scene is often enough, especially in cases where you don’t have prior knowledge of where your project is headed. </p>
<p>On the other hand, in certain cases, such as where you have candles and sconces, you will most likely have a light node beside a <strong class="bold">MeshInstance</strong> node, as well as a script attached to control the light’s behavior. In that case, it pays off to convert the model into a scene and build up from there. </p>
<p>The <strong class="bold">Scene</strong> tree for the level still holds the raw candle models. In <a href="B17473_09.xhtml#_idTextAnchor146"><em class="italic">Chapter 9</em></a>, <em class="italic">Designing the Level</em>, we used two types of candles but three models in total to decorate the level. It’s perfectly alright to remove these models from the level so that you can instance the new candle scenes. You would have to reposition these new items though. So, we’ll follow a different path to keep the position information:</p>
<ol>
<li value="1">Select <strong class="bold">Candles_1</strong> in the <strong class="bold">Scene</strong> tree.</li>
<li>Instance <strong class="source-inline">Candles_1.tscn</strong>, which will result in a nested node.</li>
<li>Drag this nested node out of its parent and make it a sibling of its parent.</li>
</ol>
<p>By nesting the candle scene inside the old model instance, we are appropriating the position. If you added the candle scene directly into the <strong class="bold">Props</strong> node, you’d have to find the position of the model instance and apply it to the new item.</p>
<p>You can repeat this process for the other two candles, which will eventually double the number of visible candles in the level. That being said, our initial three candle model instances are no longer necessary, so you can delete them. Also, notice how a script icon appears in the <strong class="bold">Scene</strong> tree when you bring the candle scene versus keeping just the model itself. The following screenshot shows the result:</p>
<div>
<div class="IMG---Figure" id="_idContainer118">
<img alt=" Figure 10.3 – The new candles in the Scene tree have script icons " height="530" src="image/Figure_10.3_B17473.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"> Figure 10.3 – The new candles in the Scene tree have script icons</p>
<p>The preceding screenshot shows not only the more advanced candles that have been added to the level but also the fact that you can turn these candles on and off via the <strong class="bold">Is Lit</strong> property in the <strong class="bold">Inspector</strong> panel. Similar to what you’ve done for the candles, you can continue practicing point lights by creating a scene out of the sconce model. In that case, the light object’s position in the scene will most likely be higher since the model is taller, but the concept is the same. You can even bind the same script to the root of this sconce scene. </p>
<p>This creates a bit of a dilemma though. So far, we have kept everything related to candles in their own <a id="_idIndexMarker435"/>folder, with the script included. However, the light switch script is so generic that it could be used within any scene that has a similar structure. Although it’s also possible to attach the <strong class="source-inline">Candles.gd</strong> script inside the <strong class="source-inline">Candles</strong> folder to a scene in a different folder, if you want to generalize things, you can move the script file into a separate <strong class="source-inline">Scripts</strong> folder at the root of the project. </p>
<p>This is one of many project management conundrums you’ll face, so it’s up to you how you want to go with it. We’ve decided to keep things as generic as possible. Hence, the <strong class="source-inline">Finish</strong> folder of this chapter will have both the candles and the sconce share the light script from the <strong class="source-inline">Scripts</strong> folder.</p>
<p>After swapping the sconce models with the sconce scenes, the level will have a bit more character, as shown here:</p>
<div>
<div class="IMG---Figure" id="_idContainer119">
<img alt="Figure 10.4 – Three candles and four sconces are illuminating the level " height="534" src="image/Figure_10.4_B17473.jpg" width="1653"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.4 – Three candles and four sconces are illuminating the level</p>
<p>We have the basic lights covered, but we still don’t have the kind of light effect you may see inside a cave. The idea <a id="_idIndexMarker436"/>is that Clara used an opening to enter this structure, so it makes sense to get some sunlight into the general area. We’ll achieve this by using a <strong class="bold">SpotLight</strong> node.</p>
<h2 id="_idParaDest-170"><a id="_idTextAnchor171"/>Mimicking the sunlight</h2>
<p>The narrative in our game is that the dock area Clara secured her boat to wasn’t too far off from the <a id="_idIndexMarker437"/>entrance. Hence, it makes sense to get some sunlight from the exterior. An easy way to get an effect like this is to use a <strong class="bold">SpotLight</strong> node. Let’s also discuss an alternative.</p>
<p>Using a <strong class="bold">DirectionalLight</strong> node seems tempting at first, but that would brighten the whole scene. Also, we want this cave to look as dark as possible, and only to be illuminated with artificial lights such as candles and sconces. To achieve both goals, you’d have to position planes over the level, pretending that they’re the cave’s ceiling, to block most of the light. So, since that kind of effort feels counter-productive, we’ll try to light what we need instead of blocking the light.</p>
<p>Therefore, using a <strong class="bold">SpotLight</strong> node seems to be the best choice we have. We’ll describe the process we used to place the light over the level so that it highlights the boat and a portion of the pier. Here we go:</p>
<ol>
<li value="1">Select the root node of the level (<strong class="bold">Level-01</strong>).</li>
<li>Add a <strong class="bold">SpotLight</strong> node and position it over the boat seven units or so in the <strong class="bold">Y</strong> direction.</li>
<li>Rotate it <strong class="bold">-70</strong> degrees in the <strong class="bold">X</strong> and <strong class="bold">Y</strong> directions (hint: use <strong class="bold">Rotation Degrees</strong> under <strong class="bold">Transform</strong> in the <strong class="bold">Inspector</strong> panel).</li>
<li>Change its color to <strong class="source-inline">d6d58e</strong>.</li>
<li>Expand the <strong class="bold">Spot</strong> section in the <strong class="bold">Inspector</strong> panel and set the following values:<ol><li>Set <strong class="bold">Range</strong> to <strong class="source-inline">20</strong>.</li>
<li>Set <strong class="bold">Angle</strong> to <strong class="source-inline">55</strong>.</li>
</ol></li>
</ol>
<p>We’ll provide you with a screenshot right after we explain what the intention with the light’s placement is and give a disclaimer about the screenshot itself. Since the default environment settings in your Godot project will result in a scene that’s too bright for you to see the <a id="_idIndexMarker438"/>impact of what you are doing, we temporarily tweaked some settings to better highlight the contribution of the light you are working with. </p>
<p>We’ll study environment effects in the <em class="italic">Creating post-processing effects</em> section after we finish exploring lights and shadows. For now, we still owe you an explanation about the settings of the <strong class="bold">SpotLight</strong> node. Even when you’ve been following a similar layout, the coordinates you have picked for your floor tiles might be so different that there is no easy way to ask you to place the light in a certain position. Hence, we are giving you a mix of general and precise directions. This is what we have got so far:</p>
<div>
<div class="IMG---Figure" id="_idContainer120">
<img alt="Figure 10.5 – The SpotLight node simulating the sun in the cave " height="871" src="image/Figure_10.5_B17473.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.5 – The SpotLight node simulating the sun in the cave</p>
<p>The preceding screenshot shows the <strong class="bold">SpotLight</strong> node right above the boat’s back. We chose the top-down view for you to see how far the light goes from this object. The <strong class="bold">Range</strong> and <strong class="bold">Angle</strong> properties you set in the <strong class="bold">Inspector</strong> panel will configure this light source so that it reaches far and wide enough to illuminate the entrance partially. Thus, if your layout necessitates different values so that you have an area lit just enough, as shown in the reference picture, you may have to alter the rotation and position values.</p>
<p>If you fancy, you could create another <strong class="bold">SpotLight</strong> node and alter its values as if there is a secondary opening in the rock formation that is letting more light through. Once you figure out the <a id="_idIndexMarker439"/>technical parts, it’s up to you to push the envelope for an artistic result that pleases you.</p>
<p>So far, we’ve been analyzing different types of light and their impact on our level. With light, we usually expect shadows. These are not enabled by default, so we’ll discover how to turn them on, as well as adjusting a few settings in the context of our project.</p>
<h1 id="_idParaDest-171"><a id="_idTextAnchor172"/>Enabling and adjusting shadows</h1>
<p>In some situations, such as in stage arts, engineers work hard to illuminate parts of a stage with <a id="_idIndexMarker440"/>lights by casting their beams from so many angles that shadows <a id="_idIndexMarker441"/>can be eliminated. That’s an extreme case. Normally, a shadow is something that occurs naturally when there is a nearby light source. </p>
<p>Despite this natural phenomenon, simulating shadows doesn’t automatically happen in computer simulations just because there is a light object. The GPU has to know where the light is coming from and how strong it is. So, it can create an area, starting from the base of the object the light is turned to, and stretch this area out gradually in the opposite direction to the light by blending it into the surface the object is standing on. This is approximately how shadows are calculated and simulated by computers.</p>
<p>In Godot Engine, a light source is responsible for its own shadow. This means the shadow settings are part of a light object, but since the effort is resource-intensive, Godot has this property turned off by default. Let’s look at an example and see how we can enable it:</p>
<ol>
<li value="1">Double-click the <strong class="source-inline">Candles_1.tscn</strong> item in <strong class="bold">FileSystem</strong> to open it. </li>
<li>Select the <strong class="bold">OmniLight</strong> node and expand its <strong class="bold">Shadow</strong> section in the <strong class="bold">Inspector</strong> panel.</li>
<li>Turn the <strong class="bold">Enabled</strong> property on.</li>
</ol>
<p>The color of the shadow is irrelevant at this point, but it might be something you can tweak in your projects to get the dramatic effect you wish. At this point, we advise you to open the <strong class="bold">Candles_2</strong> and <strong class="bold">Sconce</strong> scenes to enable the shadow for the <strong class="bold">OmniLight</strong> nodes they have. When you save all these three files and go back to the <strong class="bold">Level-01</strong> scene, you should see something similar to the following:</p>
<div>
<div class="IMG---Figure" id="_idContainer121">
<img alt="Figure 10.6 – Let there be shadows, and shadows you shall have " height="755" src="image/Figure_10.6_B17473.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.6 – Let there be shadows, and shadows you shall have</p>
<p>Notice how enabling shadows elevates the experience overall. The column, the crates, and the other <a id="_idIndexMarker442"/>objects have started to come to life. There is one big missing piece <a id="_idIndexMarker443"/>in this picture, though: we still haven’t enabled the shadows for the light source we are using to simulate the sun’s effect. Go ahead and turn its shadow on; you’ll make the pier pop up, as shown here:</p>
<div>
<div class="IMG---Figure" id="_idContainer122">
<img alt="Figure 10.7 – The pier and the boat look more realistic thanks to the sun’s shadow effect " height="687" src="image/Figure_10.7_B17473.jpg" width="1502"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.7 – The pier and the boat look more realistic thanks to the sun’s shadow effect</p>
<p>We are slowly improving the visual quality of the level. Our last effort introduced shadows. They are nice and all, but sometimes, they can also create a few defects. Now, let’s talk about some of the settings you can find in the <strong class="bold">Shadow</strong> section of light nodes in the <strong class="bold">Inspector</strong> panel:</p>
<ul>
<li><strong class="bold">Bias</strong>: Some names you come across in game development will sound technical, and won’t always give you a quick idea about what they control. This one certainly sounds like one of those. In simple terms, this property controls where the shadows are going to start in comparison to an object’s volume. A picture is worth a thousand words, so please refer to the following diagram to see what different <strong class="bold">Bias</strong> values will lead to:</li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer123">
<img alt="Figure 10.8 – Different bias values and their effects " height="435" src="image/Figure_10.8_B17473.jpg" width="1375"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.8 – Different bias values and their effects</p>
<ul>
<li><strong class="bold">Contact</strong>: When you have a high <strong class="bold">Bias</strong> value, and it creates a gap between the shadow <a id="_idIndexMarker444"/>and the object (as shown in the preceding diagram), this <a id="_idIndexMarker445"/>property will try to fill in that gap.</li>
</ul>
<p>So, if you happen to have visual glitches due to enabling shadows, which may result in shadows not always meeting an object or self-shadowing issues, as shown in the preceding diagram, we suggest you explore using a combination of the <strong class="bold">Bias</strong> and <strong class="bold">Contact</strong> properties for your lights. </p>
<p>The level is starting to look like there is more life to it, thanks to lights and shadows. Still, everything looks a bit too bright. If only we could dim the overall brightness… We certainly can, and that’s what we are going to explore next.</p>
<h1 id="_idParaDest-172"><a id="_idTextAnchor173"/>Creating post-processing effects</h1>
<p>Since we are pretending that Clara is visiting a cave that’s got some human traffic in its past that led <a id="_idIndexMarker446"/>to having a pier built and sconces hung on the walls, it’s only normal to expect some areas of it to be really dark. We have been placing lights and turning on shadows to improve the visual fidelity of our scene, but we are fighting against the environment; it’s just too bright. </p>
<p>In this section, we’ll study an interesting Godot node that will control the environment or world settings so that you have a much better hold on how your world looks. This kind of process is also referred to as post-processing since its effects are applied after the directly placed elements such as lights, shadows, reflections, and others have been processed. It comes with a lot of settings, and hopefully, this will be clearer after we explore some.</p>
<p class="callout-heading">A node for everything</p>
<p class="callout">If you are coming from Unity, then the node system Godot uses might be confusing. In Unity, you attach scripts to game objects to add or control the behavior of systems. Nodes are analogous to scripts in Unity, but nodes are much more practical since you can also attach scripts to Godot nodes. This is convenient since you can nest nodes and compose bigger node structures. In Godot, you’ll most likely find a node that will do a crucial job. One such node is what we are discussing in this chapter. Also, you can find more about the <a id="_idIndexMarker447"/>process behind using nodes in the <em class="italic">Godot’s design philosophy</em> section at <a href="https://docs.godotengine.org/en/3.4/getting_started/introduction/">https://docs.godotengine.org/en/3.4/getting_started/introduction/</a>.</p>
<p>Godot has a nifty node, <strong class="bold">WorldEnvironment</strong>, that is responsible for the overall atmosphere in your scenes. Although the node’s name is quirky, introducing it to the level is no different than adding other nodes: </p>
<ol>
<li value="1">Open the <strong class="source-inline">Level-01.tscn</strong> scene.</li>
<li>Add a <strong class="bold">WorldEnvironment</strong> node to the <strong class="bold">Scene</strong> tree. For its <strong class="bold">Environment</strong> property, use <strong class="source-inline">default_env.tres</strong> from <strong class="bold">FileSystem</strong>.</li>
<li>Double-click <strong class="source-inline">default_env.tres</strong> in <strong class="bold">FileSystem</strong> to populate the <strong class="bold">Inspector</strong> panel with its properties.</li>
</ol>
<p>Chances are nothing has changed, but we have effectively created a <strong class="bold">WorldEnvironment</strong> node and attached an environment resource to it. When you create a new Godot project, it comes with a default environment resource. Instead of creating a new resource, we are repurposing the default environment resource that’s been sitting in the project folder all this time.</p>
<p>This opens up different possibilities for you. Your game may have different levels where you would like to <a id="_idIndexMarker448"/>have the visual clues support the characteristics of a particular level. In a situation like that, your project folder could store multiple environment resources and use them accordingly in the <strong class="bold">WorldEnvironment</strong> node.</p>
<p>Although the <strong class="bold">WorldEnvironment</strong> node’s purpose may sound self-evident by its name, to fully take advantage of it, it would be best if you practice using its properties. You can do this by looking at the properties of the resource it’s using. There are quite a few and we’ll discover the ones that are relevant to our goal. </p>
<h2 id="_idParaDest-173"><a id="_idTextAnchor174"/>Background</h2>
<p>This part of the environment’s settings is responsible for simulating the background. Currently, the <a id="_idIndexMarker449"/>mode is set to <strong class="bold">Sky</strong>, so the background is painted as if there is a dark ground portion that goes out far enough to meet the sky. In this mode, you can further customize the properties of the sky you want to depict. We won’t cover this since we are working with an indoor scene.</p>
<p>Thus, start by changing the mode to <strong class="bold">Custom Color</strong>. This will pick a black color by default, so the whole background of your scene will be pitch black. This will surely accentuate the candles and the sconces. </p>
<p>If you would like to use Godot Engine to take in-game renders of your models, then you can set the background to <strong class="bold">Clear Color</strong>, which will create a transparent color. We’re not using it in our case since having a completely dark background suits our artistic needs better and also, the body of water looks a bit awkward with transparency underneath. We’d need another similarly sized dark plane under it to hide the effect of transparency. </p>
<p>Therefore, we’ll stick with a custom background color. This will result in the following output:</p>
<div>
<div class="IMG---Figure" id="_idContainer124">
<img alt="Figure 10.9 – The cave is starting to look more ominous " height="642" src="image/Figure_10.9_B17473.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.9 – The cave is starting to look more ominous</p>
<p>Just a quick <a id="_idIndexMarker450"/>discussion about the <strong class="bold">Ambient Light</strong> section before we move on to <strong class="bold">ToneMap</strong>. The arched door seems to be hidden right now because there aren’t enough lights in the scene. So, to remedy this, you could pick a lighter ambient color. However, this will make the overall scene brighter again, and you’ll have some of the dark areas more lit. There is a much more judicious way to keep darker areas still dark but have the effects of light sources spread out further. We’ll look into achieving this kind of getting the best of both worlds later, in the <em class="italic">Using global illumination</em> section. </p>
<h2 id="_idParaDest-174"><a id="_idTextAnchor175"/>ToneMap</h2>
<p>This is something you <a id="_idIndexMarker451"/>can use as a quick solution for blending lights into darker areas, which will make everything look a bit more homogeneous. It comes <a id="_idIndexMarker452"/>with a few properties of its own:</p>
<ul>
<li><strong class="bold">Mode</strong>: The default mode is <strong class="bold">Linear</strong>, and this is what you’ve been experiencing all along. We leave it to your taste, but we suggest you change it to <strong class="bold">Filmic</strong> or <strong class="bold">ACES Fitted</strong>. It’ll remap the tones of the whole scene to the point that things will start to look more realistic.</li>
<li><strong class="bold">Exposure</strong>: Compared to <strong class="bold">Linear</strong> mode, the other modes may make your scene look really dark. Changing <strong class="bold">Exposure</strong> will brighten the scene while still applying the tone mapping. </li>
<li><strong class="bold">White</strong>: Digital cameras have a setting similar to this one. You designate a tone as white so that <a id="_idIndexMarker453"/>the other colors can be calculated according to this new baseline. Smaller values will blow out the whole scene because it’ll start considering a lot more colors as white. Naturally, higher values will exclude more colors, and make the scene darker.</li>
</ul>
<p>We won’t mess with the <strong class="bold">Exposure</strong> and <strong class="bold">White</strong> values in our exercise, but this is what we have <a id="_idIndexMarker454"/>after choosing <strong class="bold">ACES Fitted</strong> for <strong class="bold">ToneMap</strong>:</p>
<div>
<div class="IMG---Figure" id="_idContainer125">
<img alt="Figure 10.10 – Everything looks more pronounced thanks to tone mapping " height="642" src="image/Figure_10.10_B17473.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.10 – Everything looks more pronounced thanks to tone mapping</p>
<p>Since we’ve touched on the concept of exposure, a quick word about enabling <strong class="bold">Auto Exposure</strong>. We won’t use it in our work, but it is a helpful option for mitigating some of the problems you may face when the camera transitions between indoor and outdoor areas.</p>
<h2 id="_idParaDest-175"><a id="_idTextAnchor176"/>Screen Space Reflections (SSR)</h2>
<p>When some <a id="_idIndexMarker455"/>objects have reflective qualities due <a id="_idIndexMarker456"/>to their material settings, such as <strong class="bold">Metallic</strong>, <strong class="bold">Specular</strong>, and <strong class="bold">Roughness</strong>, turning this environment setting on will create a more realistic effect. </p>
<p>To appreciate the impact of <strong class="bold">SSR</strong>, the level must have more light, so it may not look like much is changing when you turn it on. The body of the statue has a reflective material. Thus, if you zoom into that area, you should be able to see some reflection where the feet of the stag meet the pedestal. </p>
<p>Reflections will be more pronounced when there are more lights nearby. When we work on the player character’s involvement in <a href="B17473_12.xhtml#_idTextAnchor206"><em class="italic">Chapter 12</em></a>, <em class="italic">Interacting with the World through Camera and Character Controllers</em>, and Clara walks by the statue with a torch in her hand, you may notice the effect even better. Until then, we’ll simply have this feature enabled. </p>
<h2 id="_idParaDest-176"><a id="_idTextAnchor177"/>Ambient Occlusion (SSAO)</h2>
<p>This isn’t the first time <a id="_idIndexMarker457"/>we have come across this term. We first got to know it in <a href="B17473_04.xhtml#_idTextAnchor060"><em class="italic">Chapter 4</em></a>, <em class="italic">Adjusting Cameras and Lights</em>, when we wanted to emphasize the edges of the objects where they connected. Similarly, we’ll turn <a id="_idIndexMarker458"/>this setting on in Godot too, but we have to tweak a few properties:</p>
<ul>
<li><strong class="bold">Light Affect</strong>: You won’t see the effect of <strong class="bold">Ambient Occlusion</strong> without the contribution of this property, so we are describing it first. It’s for adjusting the role of light sources in the occlusion. We’ll set it to <strong class="source-inline">1.0</strong>. </li>
</ul>
<p>It seems as if we are using it as an on/off switch in our current situation. However, since it can be any value between <strong class="source-inline">0.0</strong> and <strong class="source-inline">1.0</strong>, you can use it as a useful scale by controlling the value with scripts. This works in cases where you don’t want to fully turn off the occlusions but gradually decrease them. </p>
<ul>
<li><strong class="bold">Radius</strong>: When objects are close to each other, the contact points will look occluded. This setting is for adjusting the area that will be considered in the calculation for creating the correct amount of occlusion. We picked <strong class="source-inline">0.4</strong> as our value, but you can set it to any value, depending on your taste. </li>
</ul>
<p>Additionally, the <strong class="bold">Intensity</strong> property can be used with <strong class="bold">Radius</strong> to create more accurate <a id="_idIndexMarker459"/>occlusions. Also, with the help of a secondary set of radius and intensity, you can overlay more details.</p>
<p>As with most things in game development, adjusting the correct amount of Ambient Occlusion is <a id="_idIndexMarker460"/>often an artistic endeavor. With the suggested values, the result will be as follows:</p>
<div>
<div class="IMG---Figure" id="_idContainer126">
<img alt="Figure 10.11 – The level after Ambient Occlusion has been turned on " height="642" src="image/Figure_10.11_B17473.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.11 – The level after Ambient Occlusion has been turned on</p>
<p>The preceding screenshot may not be doing what we have achieved much justice. However, if you compare the previous two screenshots, you can see the occlusion in between the bricks, and also where the crates are making contact with the floor.</p>
<h2 id="_idParaDest-177"><a id="_idTextAnchor178"/>Glow</h2>
<p>This feature is <a id="_idIndexMarker461"/>often referred to as the bloom effect in other applications. It’s used to exaggerate the effect of colors, and especially light sources. While it <a id="_idIndexMarker462"/>has many properties, we’ll only focus on a couple:</p>
<ul>
<li><strong class="bold">Bloom</strong>: A value such as <strong class="source-inline">0.2</strong> will be enough to accentuate the effect of the sconces and the candles. In essence, while dark areas will stay relatively dark, lit areas will be glowing.</li>
<li><strong class="bold">Blend Mode</strong>: To increase the impact further, we suggest that you set this to <strong class="bold">Additive</strong>. It’ll give the lights <a id="_idIndexMarker463"/>in the scene a real nice cozy effect since the light sources are open fires.</li>
</ul>
<p>We won’t touch <a id="_idIndexMarker464"/>the rest of the settings. The following screenshot shows the final state of the level:</p>
<div>
<div class="IMG---Figure" id="_idContainer127">
<img alt="Figure 10.12 – Our light sources glow in the dark " height="642" src="image/Figure_10.12_B17473.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.12 – Our light sources glow in the dark</p>
<p>In the <strong class="bold">Glow</strong> settings, there is a particular section called <strong class="bold">Levels</strong>. You can expand that area and decide how far out the bloom and blur effect will emanate. It’s useful when you want to adjust the detail of the bloom that’s engulfing an object.</p>
<h2 id="_idParaDest-178"><a id="_idTextAnchor179"/>Adjustments</h2>
<p>While applying different environmental effects, some of the features will be competing against each other. Even <a id="_idIndexMarker465"/>though we have more oomph for the lights, and more defined contours and shadows for the models, after a while, you may end up with a scene that looks a bit washed out. You will employ two properties of the <strong class="bold">Adjustments</strong> feature that will give your scene a decent touch:</p>
<ul>
<li><strong class="bold">Brightness</strong>: Our main <a id="_idIndexMarker466"/>tool to remedy the washed-out look is increasing the contrast. However, turning up brightness alongside contrast works better. Feel free to adjust it the way you like it, but a value such as <strong class="source-inline">1.1</strong> or <strong class="source-inline">1.2</strong> might be enough.</li>
<li><strong class="bold">Contrast</strong>: This will tidy up the dull look and give the whole scene a more vibrant look. Using a value <a id="_idIndexMarker467"/>such as <strong class="source-inline">1.1</strong> will make things look better in tandem with more brightness.</li>
</ul>
<p>We could go on forever while changing so many of these settings. Depending on your taste, you may prefer different effects. However, we are content with what we have so far. </p>
<h2 id="_idParaDest-179"><a id="_idTextAnchor180"/>Wrapping up</h2>
<p>Our level’s look has <a id="_idIndexMarker468"/>changed drastically since we first started laying out the floor and wall pieces. Ordinary-looking brick surfaces now have character, and the scene looks more ominous, thanks to lights, shadows, and finally, the environment settings. This can be seen here:</p>
<div>
<div class="IMG---Figure" id="_idContainer128">
<img alt="Figure 10.13 – The post-processing effects are all in place and working together " height="585" src="image/Figure_10.13_B17473.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.13 – The post-processing effects are all in place and working together</p>
<p>Depending on the atmosphere you want to create for your game, you can come up with a different combination of post-processing effects. Also, you can adjust their values programmatically during a game session to entice the player even more.</p>
<p class="callout-heading">When one is too many</p>
<p class="callout">Post-processing effects are nice. You may feel like a kid in a candy store. However, keep in mind that some effects will enhance each other, and some will outdo each other. At the end of the day, you may end up having too many effects in play that are a burden on your computer. You can hear the cost of it when your GPU is vehemently trying to cool off.</p>
<p>Despite our efforts <a id="_idIndexMarker469"/>to improve the look of our level, there is room for improvement. While we have noticeably enhanced dark and bright areas, the scene is still missing another real-life quality that is often referred to as global illumination in the industry. </p>
<h1 id="_idParaDest-180"><a id="_idTextAnchor181"/>Using global illumination</h1>
<p>If you’ve ever used a digital camera, you may already be familiar with the concept we are going to <a id="_idIndexMarker470"/>present in this section. Our brains, through expectation and familiarity with a similar environment, will blend in the light with darker areas, and fill in the missing parts. A camera, on the other hand, doesn’t have prior knowledge of how places must look, and it can’t process dark areas as well as our brains. In other words, the human brain approximates the missing parts and paints a more complete picture. </p>
<p>The rendering engine has worked like a camera so far. If you look at the level now, you’ll see that the arched door is in the dark. It would be nice to have certain areas look more like what we would expect them to look like. If we increased the intensity of the light sources, it would cast the light farther away. However, we’d still end up with some areas darker than others. We need something that extends the effects of the existing light sources similar to the way our brains process light.</p>
<p>To that end, we’ll introduce global illumination to achieve a more realistic look. Via this method, the area near the arched door will look like it’s getting more light from nearby candles and sconces. If you haven’t guessed it already, there is a node for this job. Let’s add it to our scene:</p>
<ol>
<li value="1">Select the root node of the level.</li>
<li>Add a <strong class="bold">GIProbe</strong> node.</li>
<li>Adjust <strong class="bold">Extents</strong> in the <strong class="bold">Inspector</strong> panel so that <strong class="bold">x</strong> is <strong class="source-inline">12</strong>, <strong class="bold">y</strong> is <strong class="source-inline">5</strong>, and <strong class="bold">z</strong> is <strong class="source-inline">15</strong>.</li>
<li>Turn its <strong class="bold">Interior</strong> setting on.</li>
<li>Position this probe in your level so that it engulfs everything like an envelope.</li>
</ol>
<p><strong class="bold">GIProbe</strong> will resemble a green wireframe cube initially. After you place it so that it wraps around the level, the Godot interface will look as follows:</p>
<div>
<div class="IMG---Figure" id="_idContainer129">
<img alt="Figure 10.14 – GIProbe is in place but it’s not functional yet " height="631" src="image/Figure_10.14_B17473.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.14 – GIProbe is in place but it’s not functional yet</p>
<p>This node will <a id="_idIndexMarker471"/>probe the light sources in its volume. Then, it will interpolate this information to darker areas so that the light can be distributed more evenly, just as our eyes would expect. Although the probe is ready, we need to take care of two important things before we trigger the calculations.</p>
<h2 id="_idParaDest-181"><a id="_idTextAnchor182"/>Turning on Light Baking</h2>
<p>We have already <a id="_idIndexMarker472"/>seen some of the import settings <a id="_idIndexMarker473"/>relevant to 3D models. For example, we saw that materials are imported automatically because it’s the default setting in the <strong class="bold">Import</strong> panel. Also, using the <strong class="bold">Animation</strong> section in that panel, we were able to extract the actions from a model into the filesystem. All this was covered in <a href="B17473_07.xhtml#_idTextAnchor112"><em class="italic">Chapter 7</em></a>, <em class="italic">Importing Blender Assets into Godot</em>.</p>
<p>We’ll revisit the <strong class="bold">Import</strong> panel for a different need this time. We want some of the models to receive more light. So, by turning <strong class="bold">Light Baking</strong> on, some models will receive extra lighting information that’s been sent by <strong class="bold">GIProbe</strong>. As the name suggests, this technique will bake some of the light in the scene into a model’s material once. Then, it’ll get updates as needed when the light conditions change.</p>
<p>So, we’ll pick a list of models that look like they could benefit from light baking since they have large, uninterrupted surfaces:</p>
<ul>
<li><strong class="bold">Wall</strong> (<strong class="bold">Wall_Hole</strong>)</li>
<li><strong class="bold">Curve</strong></li>
<li><strong class="bold">Floor_Standard</strong> (<strong class="bold">Floor_Standard_Curved_1</strong> and <strong class="bold">Floor_Standard_Curved_4</strong>)</li>
<li><strong class="bold">Column_Round</strong></li>
</ul>
<p>Smaller objects <a id="_idIndexMarker474"/>such as props are usually not good <a id="_idIndexMarker475"/>candidates for light baking, but technically, you can turn the setting on for any model you import. For now, we’ll select the wall model and enable light baking for it:</p>
<ol>
<li value="1">Select <strong class="source-inline">Wall.glb</strong> in <strong class="bold">FileSystem</strong>.</li>
<li>Bring up the <strong class="bold">Import</strong> panel and scroll down to find the <strong class="bold">Light Baking</strong> option (hint: this is the last option in the <strong class="bold">Meshes</strong> section).</li>
<li>Change its value to <strong class="bold">Enable</strong>.</li>
<li>Click the <strong class="bold">Reimport</strong> button.</li>
<li>Repeat this process for the other aforementioned models.</li>
</ol>
<p>Generally speaking, we are enabling light baking for the architectural models in the scene. This is one part of the equation. Now that we have configured the models to accept light baking, we have to tell the renderer how much light should be baked into the materials for these models. We’ll do that by adjusting the energy levels of the light sources we have used so far.</p>
<h2 id="_idParaDest-182"><a id="_idTextAnchor183"/>Adjusting Indirect Energy</h2>
<p>The second most <a id="_idIndexMarker476"/>important thing in having proper global illumination <a id="_idIndexMarker477"/>is to adjust the energy levels of the light sources. Although this section’s title indicates that we’ll be adjusting indirect energy levels, it would also be useful to talk about what direct energy means.</p>
<p>In Blender, you changed the direct energy level for lights by adjusting their <strong class="bold">Power</strong> properties, which were measured in Watts. That meant you could have typed in real-life lightbulb values to get an accurate result. Godot’s energy values for lights don’t follow a unit system. So, it’s more of an artistic value you can adjust based on your scene and liking.</p>
<p>While the <strong class="bold">Energy</strong> property, also known as direct energy, defines how intense the light will be, its <strong class="bold">Indirect Energy</strong> value is used to calculate the natural effect we described earlier in the opening lines of the <em class="italic">Using global illumination</em> section, where we made a comparison between human sight and cameras. </p>
<p>There is a simple way to observe this effect at home when it’s sufficiently dark. You can light a candle and observe that there is going to be an adequately lit area near it. Then, the light will drop off gradually into the distance, but you’ll still be able to notice some faraway objects. Their details won’t be quite clear, but their most characteristic shapes will be apparent to the eye. It’s possible to simulate this kind of effect with indirect energy using <strong class="bold">GIProbe</strong>.</p>
<p>For this effort, we have to adjust some of the <strong class="bold">OmniLight</strong> nodes we have used so far:</p>
<ol>
<li value="1">Open <strong class="source-inline">Sconce.tscn</strong> and select its <strong class="bold">OmniLight</strong> node.</li>
<li>Change its <strong class="bold">Indirect Energy</strong> to <strong class="source-inline">2.5</strong> under the <strong class="bold">Light</strong> section.</li>
<li>Change its <strong class="bold">Range</strong> to <strong class="source-inline">8</strong> under the <strong class="bold">Omni</strong> section.</li>
</ol>
<p>This will increase the range of the light that’s emanating from the sconces so that it’ll reach farther. The energy level of <strong class="bold">1.0</strong> has already been used, hence we’re only adjusting the indirect energy since we want it to contribute to global illumination.</p>
<p>Let’s repeat this effort for the candles with different values:</p>
<ol>
<li value="1">Open <strong class="source-inline">Candles_1.tscn</strong> and <strong class="source-inline">Candles_2.tscn</strong> and select their <strong class="bold">OmniLight</strong> nodes.</li>
<li>Change <strong class="bold">Indirect Energy</strong> to <strong class="source-inline">1.5</strong> and <strong class="bold">Range</strong> to <strong class="source-inline">3</strong>.</li>
</ol>
<p>Compared to sconces, candles shouldn’t emit that much light. So, it makes sense to have lower values. However, since there isn’t one candle but a group of candles, the values aren’t too far off. This is something you may have to balance in your work too: artistic concerns versus realism. </p>
<p>We’ve been settings things up for <strong class="bold">GIProbe</strong> to do its job. It seems like we have increased the overall light in the scene. We need it to be that way since some of this extra light will go toward calculating a better light distribution. All there is left to do is trigger <strong class="bold">GIProbe</strong>:</p>
<ol>
<li value="1">Select <strong class="bold">GIProbe</strong> in the <strong class="bold">Scene</strong> tree.</li>
<li>Click the <strong class="bold">Bake GI Probe</strong> button in the header just above the 3D view.</li>
</ol>
<p>Godot Engine will calculate how light bounces off the surfaces of the models for which you have enabled light <a id="_idIndexMarker478"/>baking. Depending on the intensity, range, and <a id="_idIndexMarker479"/>indirect energy of the lights, the darker areas will receive more light. This will result in a more even distribution and give a more realistic look that meets our expectations. <em class="italic">Figure 10.15</em> shows the before and after of what global illumination does for the area near the arched door:</p>
<div>
<div class="IMG---Figure" id="_idContainer130">
<img alt="Figure 10.15 – The door has become more noticeable thanks to more evenly distributed light " height="622" src="image/Figure_10.15_B17473.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.15 – The door has become more noticeable thanks to more evenly distributed light</p>
<p>Depending on the size and layout of your levels, you may need to place multiple <strong class="bold">GIProbe</strong> nodes. For example, if you were designing a dungeon with many rooms and hallways, it might be <a id="_idIndexMarker480"/>a better idea to consider each room and hallway as a <a id="_idIndexMarker481"/>unique <strong class="bold">GIProbe</strong> node since the distribution of lights will be achieved more accurately. </p>
<p>Also, when you have a level where an outdoor environment is connecting to an indoor environment, it’s a good idea to create one <strong class="bold">GIProbe</strong> for each area and adjust the <strong class="bold">Interior</strong> settings accordingly. Using one major node that encompasses the whole level will do an injustice to either environment, so introduce as few and, sometimes, as many as necessary. </p>
<p>With that, we have improved the look of our level. Let’s summarize the steps we have taken to get here.</p>
<h1 id="_idParaDest-183"><a id="_idTextAnchor184"/>Summary</h1>
<p>The level we took over from the previous chapter looked complete, and yet uninteresting. To give it more life, we introduced a few instruments in this chapter.</p>
<p>First, we introduced two types of light nodes, <strong class="bold">OmniLight</strong> and <strong class="bold">SpotLight</strong>, to simulate candles, sconces, and the sun’s effect in the cave. While accomplishing this, you also saw the reason why creating a scene for a model might be useful, as well as necessary, compared to instancing the models directly in the level. This effort was followed by adding a small script that can help you switch the lights if needed. We’ll utilize this functionality later in this book.</p>
<p>Though lights were an obvious tool for improving the visuals, we also investigated shadows. They are resource-intensive, so you may want to turn them on for the lights that will have an important impact on your scenes.</p>
<p>To truly appreciate the effect of lights and shadows, we applied a bunch of environment settings. Although this helped the visuals a great deal, to elevate the realism to the next level, you’ve been introduced to global illumination. By carefully choosing which models should receive more indirect light and adjusting the setting of the lights in the scene, you’ve shed more light on certain areas, which resulted in a more accurate representation.</p>
<p>In the next chapter, we’ll work on a different kind of visual system. It’s a useful mechanism with which players can interact with the world: user interfaces.</p>
<h1 id="_idParaDest-184"><a id="_idTextAnchor185"/>Further reading</h1>
<p>Out of all the topics we have presented in this chapter, global illumination is the most technical one. Simulating real-life light is a challenging task, and professionals out there are still actively working toward this goal. If you want to get a taste of it, here are a few links that should give you a better idea about what it involves:</p>
<ul>
<li><a href="https://ohiostate.pressbooks.pub/graphicshistory/chapter/19-5-global-illumination/">https://ohiostate.pressbooks.pub/graphicshistory/chapter/19-5-global-illumination/</a></li>
<li><a href="https://www.scratchapixel.com/lessons/3d-basic-rendering/global-illumination-path-tracing">https://www.scratchapixel.com/lessons/3d-basic-rendering/global-illumination-path-tracing</a></li>
<li><a href="https://developer.nvidia.com/gpugems/gpugems2/part-v-image-oriented-computing/chapter-38-high-quality-global-illumination%20">https://developer.nvidia.com/gpugems/gpugems2/part-v-image-oriented-computing/chapter-38-high-quality-global-illumination</a></li>
</ul>
<p>On a more practical note, the official Godot documentation might be useful if you wish to learn more about what we have covered in this chapter: </p>
<ul>
<li><a href="https://docs.godotengine.org/en/3.4/tutorials/3d/lights_and_shadows.xhtml">https://docs.godotengine.org/en/3.4/tutorials/3d/lights_and_shadows.xhtml</a></li>
<li><a href="https://docs.godotengine.org/en/3.4/tutorials/3d/environment_and_post_processing.xhtml">https://docs.godotengine.org/en/3.4/tutorials/3d/environment_and_post_processing.xhtml</a></li>
<li><a href="https://docs.godotengine.org/en/3.4/tutorials/3d/gi_probes.xhtml">https://docs.godotengine.org/en/3.4/tutorials/3d/gi_probes.xhtml</a></li>
</ul>
</div>
</div>
</body></html>