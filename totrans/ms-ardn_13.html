<html><head></head><body>
        

                            
                    <h1 class="header-title">Using LCD Displays</h1>
                
            
            
                
<p>There are times that we would like to have the ability to display data from the Arduino to the user. For this, we can use an LCD display. There are numerous types of LCD displays that we can use and probably the most popular is the 1602 display. Because they are so popular, you can find numerous tutorials on how to use them on the internet. While these displays are easy to use, you are limited by what you can do with them.</p>
<p>In this chapter, we will look at a display that we can do a lot more with. This display is the <strong>Nokia 5110 LCD display</strong>.</p>
<p>In this chapter, you will learn:</p>
<ul>
<li>How to connect a Nokia 5110 LCD to an Arduino</li>
<li>How to print text to an LCD</li>
<li>How to draw circles on an LCD</li>
<li>How to draw rectangles on an LCD</li>
<li>How to draw rounded rectangles on an LCD</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Introduction</h1>
                
            
            
                
<p>The Nokia 5110 LCD display is a basic monochrome graphics LCD screen that can be used in numerous projects. Nokia originally developed this display for use with cell phones in the late 1990's. This display uses the <strong>PCD8544 LCD controller/driver</strong>.</p>
<p>Having an LCD display greatly improves the user interface of any project because we have the ability to display messages directly to the user letting them know what is happening or giving them specific error messages if something goes wrong. The 5110 LCD allows us to display both text and graphics.</p>
<p>The 5110 LCD has a display area of approximately 4.2 cm with 84 × 48 individual pixels. The display is inexpensive and very easy to use with the Adafruit 5110 LCD library that we will be using in this chapter. The 5110 LCD that we will be using in this chapter looks like the following:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/d52c7991-1a40-45b8-931e-b2ada86559ec.png" style="width:23.83em;height:24.08em;"/></p>
<p>The 5110 LCD display comes mounted on a PCB board and has eight pins that are used to power the display and interface with it. These pins are, from left to right:</p>
<ol>
<li><strong>RST</strong>: Reset – Active low</li>
<li><strong>CE</strong>: Chip Select – Active low</li>
<li><strong>DC</strong>: Mode (data/instruction) selection – Select between command mode (low) or data mode (high)</li>
<li><strong>DIN</strong>: Serial Data Inline</li>
<li><strong>CLK</strong>: Serial Clock Line</li>
<li><strong>VCC</strong>: Power input 3.3V</li>
<li><strong>BL</strong>: Backlight LED control – 3.3V</li>
<li><strong>GND</strong>: Ground</li>
</ol>
<p>The reset pin will reset the 5110 LCD module and is active low, which means that the reset will be triggered if the pin goes to 0V. The chip select pin is used when more than one SPI peripheral is connected. The pin is also active low.</p>
<p>The DC pin is used to select between data or command mode. When the pin is high data mode is used, and when the pin is low command mode is used.</p>
<p>The DIN pin is the input pin where serial instructions are sent.</p>
<p>The CLK pin is the common clock used for the SPI modules. The clock source is supplied to the pin.</p>
<p>The BL pin powers the backlight display. This pin should never be above 3.3V. If the pin is low, then the backlight will be off.</p>
<p>VCC and GND are power and ground respectively. Power should never be above 3.3V.</p>
<p>Let's see what parts we will need for this chapter's project.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Components needed</h1>
                
            
            
                
<ul>
<li>One Arduino Uno or compatible board</li>
<li>One Nokia 5110 LCD</li>
<li>Four 10K ohm resistors</li>
<li>One 1K ohm resistor</li>
<li>Jumper wires</li>
<li>One breadboard</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Circuit diagrams</h1>
                
            
            
                
<p>The following diagram shows the circuit diagram for this chapter's project:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/9b28f7ed-05cf-44cf-a980-7ea63e42fa13.png" style="width:36.25em;height:32.42em;"/></p>
<p>The Nokia 5110 LCD should use the 3.3V power out from the Arduino and not the 5V that we have used in the earlier projects. We use inline resistors to protect the 3.3V input lines on the LCD. The CE line uses a 1K ohm resistor and the remainder use 10K ohm resistors.</p>
<p>The following chart shows what pins on the 5110 LCD module are connected to what pins on the Arduino:</p>
<table border="1" style="border-collapse: collapse;width: 80%">
<tbody>
<tr>
<td><strong>5110</strong></td>
<td><strong>Arduino</strong></td>
</tr>
<tr>
<td>RST</td>
<td>3</td>
</tr>
<tr>
<td>CE</td>
<td>4</td>
</tr>
<tr>
<td>DC</td>
<td>5</td>
</tr>
<tr>
<td>DIN</td>
<td>11</td>
</tr>
<tr>
<td>CLK</td>
<td>13</td>
</tr>
<tr>
<td>VCC</td>
<td>3.3V out</td>
</tr>
<tr>
<td>BL</td>
<td>GND</td>
</tr>
<tr>
<td>GND</td>
<td>GND</td>
</tr>
</tbody>
</table>
<p>The backlight is set to ground to turn it off. If you wish to use the backlight, you can connect the pin to the 3.3V power out that was used for the VCC pin.</p>
<p>Now let's see how we can display items on the LCD.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Code</h1>
                
            
            
                
<p>We will need to start off by installing two Adafruit libraries. These are the <strong>Adafruit GFX Library</strong> and the <strong>Adafruit PCD8544 Nokia 5110 LCD library</strong>. These libraries are installed as we will need to include them and the SPI library. We can do this by adding the following <kbd>include</kbd> statements at the beginning of the sketch:</p>
<pre>#include &lt;SPI.h&gt;
#include &lt;Adafruit_GFX.h&gt;
#include &lt;Adafruit_PCD8544.h&gt;</pre>
<p>We will not want to initiate an instance of the <kbd>Adafruit_PCD8544</kbd> type using the following code:</p>
<pre>Adafruit_PCD8544 display = Adafruit_PCD8544(13, 11, 5, 4, 3);</pre>
<p>The parameters are the Arduino pin numbers that the CLK, DIN, DC, CE and RST pins respectively are connected too.</p>
<p>In the <kbd>setup()</kbd> function, we will want to add the following code to set up the <kbd>Adafruit_PCD8544</kbd> instance:</p>
<pre>Serial.begin(9600);
<br/>display.begin();
display.setContrast(40);</pre>
<p>Now the rest of the code can go in the <kbd>setup()</kbd> function for test purposes or in the <kbd>loop()</kbd> function. Let's start off by seeing how to light up a single pixel on the display. This can be accomplished by using the <kbd>drawPixel()</kbd> function as shown in the following code:</p>
<pre>display.clearDisplay();
display.drawPixel(10, 10, BLACK);
display.display();</pre>
<p>Before we draw anything to the screen, we will want to clear the display and buffer. We do this with the <kbd>clearDisplay()</kbd> function. Next, we use the <kbd>drawPixel()</kbd> function to light up a single pixel located at the <em>X</em> coordinate 10 and the <em>Y</em> coordinate 10. Before anything is displayed on the LCD, we need to run the <kbd>display()</kbd> function as shown in the preceding code. It is important to remember to run the <kbd>clearDisplay()</kbd> function before we draw anything to the LCD, and we run the <kbd>display()</kbd> function after we draw everything to the screen to display it.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Drawing a line</h1>
                
            
            
                
<p>We could put several of the <kbd>drawPixel()</kbd> function calls together to draw a line, but it would be a lot easier to use the <kbd>drawLine()</kbd> function as shown in the following code:</p>
<pre>// draw a line
display.drawLine(3,3,30,30, BLACK);
display.display();</pre>
<p>The <kbd>drawLine()</kbd> function takes five parameters. The first two parameters are the <em>X</em>/<em>Y</em> coordinates of the starting point for the line. The next two parameters are the <em>X</em>/<em>Y</em> coordinates for the ending point of the line, and the final parameter is the color to draw the line. Since the Nokia 5110 LCD is a monochrome display, the only options here are <kbd>BLACK</kbd> or <kbd>WHITE</kbd>.</p>
<p>If we ran this code, we would see a line on the display like the one seen in the following photograph:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/1e3d6003-54d4-4ab2-8aa3-be7ae4c97fee.png" style="width:23.33em;height:24.00em;"/></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Displaying text</h1>
                
            
            
                
<p>The Adafruit library also makes it very easy to display text to the Nokia 5110 LCD. The following code shows how we can display text:</p>
<pre>// Display text
display.setTextSize(1);
display.setTextColor(BLACK);
display.setCursor(0,0);
display.println("Hello, world!");

// Display Reverse Text
display.setTextColor(WHITE, BLACK);
display.println(3.14);

// Display Larger Text
display.setTextSize(2);
display.setTextColor(BLACK);
display.print("This is larger text");
display.display();</pre>
<p>The <kbd>setTextSize()</kbd> function sets the size of the text. In the first example, the text size is set to <kbd>1</kbd>. The <kbd>setTextColor()</kbd> function will set the color of the text. Once again, since the Nokia 5110 LCD is a monochrome display, the two options are <kbd>BLACK</kbd> or <kbd>WHITE</kbd>. The <kbd>setCursor()</kbd> function sets the position of the cursor to the position on the screen to write the text too. In this case, the cursor is set to the upper left corner of the screen. Finally, the <kbd>println()</kbd> function is used to print the <kbd>Hello World!</kbd> message to the screen.</p>
<p>In the next example, we use the <kbd>setTextColor()</kbd> function to set the foreground color to <kbd>WHITE</kbd> and the background color to <kbd>BLACK</kbd> to reverse the text and then use the <kbd>println()</kbd> function to print the value of PI to the screen. Since we did not call the <kbd>setTextSize()</kbd> function, the text stays at the previously defined size, which is <kbd>1</kbd>.</p>
<p>In the last example, the text size is set to <kbd>2</kbd>, and the text color is set back to black. The following image shows what the screen will display when this code is run:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/a3519eda-f2f0-4e8d-929b-4af212fe47bb.png" style="width:23.50em;height:24.00em;"/></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Rotating text</h1>
                
            
            
                
<p>We can also rotate text. The following code shows how to do this:</p>
<pre>display.setRotation(1);
display.setTextSize(1);
display.setTextColor(BLACK);
display.setCursor(0,0);
display.println("Hello, world!");
display.display();</pre>
<p>The <kbd>setRotation()</kbd> function will rotate the text counterclockwise. A value of 1 will rotate the text 90 degrees counterclockwise. Values of 2 and 3 can also be used to rotate the text at 180 and 270 degrees. The following photograph shows how the text will look when this code is run:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/1a8bca0e-b645-4efc-8487-16ae5408d4c4.png" style="width:22.42em;height:22.00em;"/></p>
<p>Notice that the text will wrap to a new line if it is longer than what can be displayed on a single line.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Basic shapes</h1>
                
            
            
                
<p>The Adafruit library also enables us to create basic shapes on the LCD. These include circles, rectangles and rounded rectangles. There are also functions that enable us to create these shapes and fill them in. The following code and screenshots show how to use the circle functions:</p>
<p class="mce-root"/>
<pre>display.drawCircle(display.width()/2, display.height()/2, 6, BLACK);</pre>
<p class="CDPAlignCenter CDPAlign"><img src="img/e18481b3-e029-4322-9c44-c89a8f4a7342.png" style="width:18.08em;height:17.75em;"/></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Filled shape</h1>
                
            
            
                
<pre>display.fillCircle(display.width()/2, display.height()/2, 6, BLACK);</pre>
<p class="CDPAlignCenter CDPAlign"><img src="img/d16f8195-efdd-4952-9087-92c6a8012ef3.png" style="width:18.33em;height:18.08em;"/></p>
<p>The circle functions take four parameters. The first two parameters are the <em>X</em>/<em>Y</em> coordinates for the center of the circle. In these two examples, the center of the circle is the center of the screen. The third parameter is the radius of the circle, and the last parameter is the color for the circle and also the color to fill the circle in the case of the <kbd>fillCircle()</kbd> function.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Rectangle</h1>
                
            
            
                
<p>The next two examples show how to draw a rectangle and also a filled rectangle:</p>
<pre>display.drawRect(15,15,30,15,BLACK);</pre>
<p class="CDPAlignCenter CDPAlign"><img src="img/d43d4e35-1433-4f50-a1f0-4465809cd95a.png" style="width:19.92em;height:20.33em;"/></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Filled rectangle</h1>
                
            
            
                
<pre>display.fillRect(15,15,30,15,BLACK);</pre>
<p class="CDPAlignCenter CDPAlign"><img src="img/84c7bc13-d2cf-469d-9bce-cae618e22e0d.png" style="width:20.42em;height:20.08em;"/></p>
<p class="mce-root"/>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Rounded rectangle</h1>
                
            
            
                
<p>The rectangle functions take five parameters. The first two are the <em>X</em>/<em>Y</em> coordinates of the upper left corner of the rectangle. The next two parameters are the <em>X</em>/<em>Y</em> coordinates of the lower right-hand corner of the rectangle, and the last parameter is the color to draw the rectangle and the color to fill the rectangle for the <kbd>fillRect()</kbd> function.</p>
<p>The next two examples show how we can draw rounded rectangles with the Adafruit library:</p>
<pre>display.drawRoundRect(15,15,30,15,4,BLACK);</pre>
<p class="CDPAlignCenter CDPAlign"><img src="img/980bd3b2-a0da-47a2-9093-3dd99ac64142.png" style="width:20.00em;height:20.17em;"/></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Filled rounded rectangle</h1>
                
            
            
                
<pre>display.fillRoundRect(15,15,30,15,8,BLACK);</pre>
<p class="CDPAlignCenter CDPAlign"><img src="img/a2741c8b-6bb9-48e2-bb18-e14606607272.png" style="width:21.58em;height:19.75em;"/></p>
<p>The first four parameters for the round rectangle functions are the same as the regular rectangle functions, which are the coordinates for the upper left and lower right corners of the rectangle. The next parameter is how much to round the corners, and the last parameter is the color to draw the rounded rectangle and the color to fill it.</p>
<p>As we can see from the examples in this chapter, we can do a lot more than text with the Nokia 5110 LCD display, and the Adafruit library makes it very easy to use.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Challenge</h1>
                
            
            
                
<p>For the challenge, take any of the previous projects in this book and add the Nokia 5110 LCD display to it. Then, rather than displaying the output to the serial console, display the output to the LCD display. An example would be to add the LCD display to the rangefinder project from <a href="52e8daa7-b58a-4c75-ac23-13795fc1279d.xhtml" target="_blank">Chapter 10</a>, <em>Obstacle Avoidance and Collision Detection</em>, and use the LCD to display the distance.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Summary</h1>
                
            
            
                
<p>In this chapter, we saw how we could add a Nokia 5110 LCD monochrome display to our projects. These displays can greatly enhance the user experience of almost any project because we are able to tell the users what is happening and what is wrong if there is an issue.</p>
<p>In the next chapter, we will see how we can add a voice synthesizer and voice recognition to our projects.</p>


            

            
        
    </body></html>