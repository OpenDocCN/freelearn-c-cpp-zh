<html><head></head><body>
<div id="_idContainer048">
<h1 class="chapter-number" id="_idParaDest-40"><a id="_idTextAnchor040"/><span class="koboSpan" id="kobo.1.1">2</span></h1>
<h1 id="_idParaDest-41"><a id="_idTextAnchor041"/><span class="koboSpan" id="kobo.2.1">Event Handling – Signals and Slots</span></h1>
<p><span class="koboSpan" id="kobo.3.1">The signals and slots mechanism in Qt 6 is one of its most important features. </span><span class="koboSpan" id="kobo.3.2">It’s a method that allows communication between objects, which is a crucial part of a program’s graphical user interface. </span><span class="koboSpan" id="kobo.3.3">A signal can be emitted from any </span><strong class="source-inline"><span class="koboSpan" id="kobo.4.1">QObject</span></strong><span class="koboSpan" id="kobo.5.1"> object or its subclasses, which will then trigger any slot functions of any objects that are connected to </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">the signal.</span></span></p>
<p><span class="koboSpan" id="kobo.7.1">In this chapter, we’re going to cover the following </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">main topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.9.1">Signals and slots in </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">a nutshell</span></span></li>
<li><span class="koboSpan" id="kobo.11.1">UI events with signals </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">and slots</span></span></li>
<li><span class="koboSpan" id="kobo.13.1">Asynchronous programming </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">made easier</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.15.1">Function callbacks</span></span></li>
</ul>
<h1 id="_idParaDest-42"><a id="_idTextAnchor042"/><span class="koboSpan" id="kobo.16.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.17.1">The technical requirements for this chapter include </span><strong class="bold"><span class="koboSpan" id="kobo.18.1">Qt 6.6.1 MinGW 64-bit</span></strong><span class="koboSpan" id="kobo.19.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.20.1">Qt Creator 12.0.2</span></strong><span class="koboSpan" id="kobo.21.1">. </span><span class="koboSpan" id="kobo.21.2">All the code used in this chapter can be downloaded from the following GitHub </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">repository: </span></span><a href="https://github.com/PacktPublishing/QT6-C-GUI-Programming-Cookbook---Third-Edition-/tree/main/Chapter02"><span class="No-Break"><span class="koboSpan" id="kobo.23.1">https://github.com/PacktPublishing/QT6-C-GUI-Programming-Cookbook---Third-Edition-/tree/main/Chapter02</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.24.1">.</span></span></p>
<h1 id="_idParaDest-43"><a id="_idTextAnchor043"/><span class="koboSpan" id="kobo.25.1">Signals and slots in a nutshell</span></h1>
<p><span class="koboSpan" id="kobo.26.1">Compared to </span><strong class="bold"><span class="koboSpan" id="kobo.27.1">callbacks</span></strong><span class="koboSpan" id="kobo.28.1"> (which Qt 6 also supports), the </span><strong class="bold"><span class="koboSpan" id="kobo.29.1">signals and slots</span></strong><span class="koboSpan" id="kobo.30.1"> mechanism is comparably more fluid and flexible for the </span><a id="_idIndexMarker118"/><span class="koboSpan" id="kobo.31.1">programmer to use. </span><span class="koboSpan" id="kobo.31.2">It is both type-safe and not strongly coupled to the processing function, which makes it better than </span><span class="No-Break"><span class="koboSpan" id="kobo.32.1">callback implementation.</span></span></p>
<h2 id="_idParaDest-44"><a id="_idTextAnchor044"/><span class="koboSpan" id="kobo.33.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.34.1">Let’s get started by following </span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.36.1">Let’s create a </span><strong class="bold"><span class="koboSpan" id="kobo.37.1">Qt Widgets Application</span></strong><span class="koboSpan" id="kobo.38.1"> project and open </span><span class="No-Break"><span class="koboSpan" id="kobo.39.1">up </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.40.1">mainwindow.ui</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.41.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.42.1">Drag and drop a </span><strong class="bold"><span class="koboSpan" id="kobo.43.1">PushButton</span></strong><span class="koboSpan" id="kobo.44.1"> widget from the </span><strong class="bold"><span class="koboSpan" id="kobo.45.1">Widget Box</span></strong><span class="koboSpan" id="kobo.46.1"> to the </span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">UI canvas:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer037">
<span class="koboSpan" id="kobo.48.1"><img alt="Figure 2.1 – Dragging and dropping a push button to the UI canvas" src="image/B20976_02_001.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.49.1">Figure 2.1 – Dragging and dropping a push button to the UI canvas</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.50.1">Right-click on the </span><strong class="bold"><span class="koboSpan" id="kobo.51.1">PushButton</span></strong><span class="koboSpan" id="kobo.52.1"> widget </span><a id="_idIndexMarker119"/><span class="koboSpan" id="kobo.53.1">and select </span><strong class="bold"><span class="koboSpan" id="kobo.54.1">Go to slot</span></strong><span class="koboSpan" id="kobo.55.1">. </span><span class="koboSpan" id="kobo.55.2">A window </span><span class="No-Break"><span class="koboSpan" id="kobo.56.1">will appear:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer038">
<span class="koboSpan" id="kobo.57.1"><img alt="Figure 2.2 – Selecting the clicked() signal and pressing OK" src="image/B20976_02_002.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.58.1">Figure 2.2 – Selecting the clicked() signal and pressing OK</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.59.1">You will see a list of built-in slot functions available for the push button. </span><span class="koboSpan" id="kobo.59.2">Let’s select the </span><strong class="bold"><span class="koboSpan" id="kobo.60.1">clicked()</span></strong><span class="koboSpan" id="kobo.61.1"> option and press </span><strong class="bold"><span class="koboSpan" id="kobo.62.1">OK</span></strong><span class="koboSpan" id="kobo.63.1">. </span><span class="koboSpan" id="kobo.63.2">A slot function called </span><strong class="source-inline"><span class="koboSpan" id="kobo.64.1">on_pushButton_clicked()</span></strong><span class="koboSpan" id="kobo.65.1"> will now appear in both </span><strong class="source-inline"><span class="koboSpan" id="kobo.66.1">mainwindow.h</span></strong><span class="koboSpan" id="kobo.67.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.68.1">mainwindow.cpp</span></strong><span class="koboSpan" id="kobo.69.1">. </span><span class="koboSpan" id="kobo.69.2">Qt Creator </span><a id="_idIndexMarker120"/><span class="koboSpan" id="kobo.70.1">automatically added the slot function to your source code after you pressed the </span><strong class="bold"><span class="koboSpan" id="kobo.71.1">OK</span></strong><span class="koboSpan" id="kobo.72.1"> button in the </span><strong class="bold"><span class="koboSpan" id="kobo.73.1">Go to slot</span></strong><span class="koboSpan" id="kobo.74.1"> window. </span><span class="koboSpan" id="kobo.74.2">If you check out </span><strong class="source-inline"><span class="koboSpan" id="kobo.75.1">mainwindow.h</span></strong><span class="koboSpan" id="kobo.76.1"> now, you should be able to see an extra function under the </span><strong class="source-inline"><span class="koboSpan" id="kobo.77.1">private </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.78.1">slots</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.79.1"> keyword:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.80.1">
class MainWindow : public QMainWindow {
    Q_OBJECT
public:
    explicit MainWindow(QWidget *parent = 0);
    ~MainWindow();
private slots:
    </span><strong class="bold"><span class="koboSpan" id="kobo.81.1">void on_pushButton_clicked();</span></strong><span class="koboSpan" id="kobo.82.1">
private:
    Ui::MainWindow *ui;
};</span></pre></li> <li><span class="koboSpan" id="kobo.83.1">The same goes for </span><strong class="source-inline"><span class="koboSpan" id="kobo.84.1">mainwindow.cpp</span></strong><span class="koboSpan" id="kobo.85.1">, where the </span><strong class="source-inline"><span class="koboSpan" id="kobo.86.1">on_pushButton_clicked()</span></strong><span class="koboSpan" id="kobo.87.1"> function has been added </span><span class="No-Break"><span class="koboSpan" id="kobo.88.1">for you:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.89.1">
void MainWindow::on_pushButton_clicked()
{
}</span></pre></li> <li><span class="koboSpan" id="kobo.90.1">Now, let’s add a </span><strong class="source-inline"><span class="koboSpan" id="kobo.91.1">QMessageBox</span></strong><span class="koboSpan" id="kobo.92.1"> header to</span><a id="_idIndexMarker121"/><span class="koboSpan" id="kobo.93.1"> the top of your </span><span class="No-Break"><span class="koboSpan" id="kobo.94.1">source file:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.95.1">
#include &lt;QMessageBox&gt;</span></pre></li> <li><span class="koboSpan" id="kobo.96.1">Then, add the following code within the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.97.1">on_pushButton_clicked()</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.98.1"> function:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.99.1">
void MainWindow::on_pushButton_clicked() {
    </span><strong class="bold"><span class="koboSpan" id="kobo.100.1">QMessageBox::information(this, «Hello», «Button has been clicked!»);</span></strong><span class="koboSpan" id="kobo.101.1">
}</span></pre></li> <li><span class="koboSpan" id="kobo.102.1">Now, build and run the project. </span><span class="koboSpan" id="kobo.102.2">Then, click on the </span><strong class="bold"><span class="koboSpan" id="kobo.103.1">Push</span></strong><span class="koboSpan" id="kobo.104.1"> button; you should see that a message box </span><span class="No-Break"><span class="koboSpan" id="kobo.105.1">pops out:</span></span></li>
</ol>
<p class="IMG---Figure"> </p>
<div>
<div class="IMG---Figure" id="_idContainer039">
<span class="koboSpan" id="kobo.106.1"><img alt="Figure 2.3 – A message box pops out after pressing the push button" src="image/B20976_02_003.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.107.1">Figure 2.3 – A message box pops out after pressing the push button</span></p>
<ol>
<li value="9"><span class="koboSpan" id="kobo.108.1">Next, we want to create our own </span><a id="_idIndexMarker122"/><span class="koboSpan" id="kobo.109.1">signals and slot functions. </span><span class="koboSpan" id="kobo.109.2">Go to </span><strong class="bold"><span class="koboSpan" id="kobo.110.1">File</span></strong><span class="koboSpan" id="kobo.111.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.112.1">New File or Project</span></strong><span class="koboSpan" id="kobo.113.1">, then create a new C++ class under the </span><strong class="bold"><span class="koboSpan" id="kobo.114.1">Files and </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.115.1">Classes</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.116.1"> category:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer040">
<span class="koboSpan" id="kobo.117.1"><img alt="Figure 2.4 – Creating a new C++ class" src="image/B20976_02_004.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.118.1">Figure 2.4 – Creating a new C++ class</span></p>
<ol>
<li value="10"><span class="koboSpan" id="kobo.119.1">Then, we need to name our class </span><strong class="source-inline"><span class="koboSpan" id="kobo.120.1">MyClass</span></strong><span class="koboSpan" id="kobo.121.1"> and make sure that the base class </span><span class="No-Break"><span class="koboSpan" id="kobo.122.1">is </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.123.1">QObject</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.124.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer041">
<span class="koboSpan" id="kobo.125.1"><img alt="Figure 2.5 – Defining your custom class, which inherits the QObject class" src="image/B20976_02_005.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.126.1">Figure 2.5 – Defining your custom class, which inherits the QObject class</span></p>
<ol>
<li value="11"><span class="koboSpan" id="kobo.127.1">Once you have created the</span><a id="_idIndexMarker123"/><span class="koboSpan" id="kobo.128.1"> class, open up </span><strong class="source-inline"><span class="koboSpan" id="kobo.129.1">myclass.h</span></strong><span class="koboSpan" id="kobo.130.1"> and add the following code, which is highlighted here </span><span class="No-Break"><span class="koboSpan" id="kobo.131.1">for clarity:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.132.1">
#include &lt;QObject&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.133.1">#include &lt;QMainWindow&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.134.1">#include &lt;QMessageBox&gt;</span></strong><span class="koboSpan" id="kobo.135.1">
class MyClass : public QObject {
    Q_OBJECT
public:
    explicit MyClass(QObject *parent = nullptr);
public slots:
    </span><strong class="bold"><span class="koboSpan" id="kobo.136.1">void doSomething();</span></strong><span class="koboSpan" id="kobo.137.1">
};</span></pre></li> <li><span class="koboSpan" id="kobo.138.1">Then, open up </span><strong class="source-inline"><span class="koboSpan" id="kobo.139.1">myclass.cpp</span></strong><span class="koboSpan" id="kobo.140.1"> and implement the </span><strong class="source-inline"><span class="koboSpan" id="kobo.141.1">doSomething()</span></strong><span class="koboSpan" id="kobo.142.1"> slot function. </span><span class="koboSpan" id="kobo.142.2">We’ll copy the message box</span><a id="_idIndexMarker124"/><span class="koboSpan" id="kobo.143.1"> function from the </span><span class="No-Break"><span class="koboSpan" id="kobo.144.1">previous example:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.145.1">
#include "myclass.h"
MyClass::MyClass(QObject *parent) : QObject(parent) {}
void MyClass::doSomething() {
    </span><strong class="bold"><span class="koboSpan" id="kobo.146.1">QMessageBox::information(this, «Hello», «Button has been clicked!»);</span></strong><span class="koboSpan" id="kobo.147.1">
}</span></pre></li> <li><span class="koboSpan" id="kobo.148.1">Now, open up </span><strong class="source-inline"><span class="koboSpan" id="kobo.149.1">mainwindow.h</span></strong><span class="koboSpan" id="kobo.150.1"> and include the </span><strong class="source-inline"><span class="koboSpan" id="kobo.151.1">myclass.h</span></strong><span class="koboSpan" id="kobo.152.1"> header at </span><span class="No-Break"><span class="koboSpan" id="kobo.153.1">the top:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.154.1">
#ifndef MAINWINDOW_H
#define MAINWINDOW_H
</span><strong class="bold"><span class="koboSpan" id="kobo.155.1">#include "myclass.h"</span></strong><span class="koboSpan" id="kobo.156.1">
namespace Ui {
class MainWindow;
}</span></pre></li> <li><span class="koboSpan" id="kobo.157.1">Also, declare a </span><strong class="source-inline"><span class="koboSpan" id="kobo.158.1">doNow()</span></strong><span class="koboSpan" id="kobo.159.1"> signal </span><span class="No-Break"><span class="koboSpan" id="kobo.160.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.161.1">myclass.h</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.162.1">:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.163.1">
signals:
    </span><strong class="bold"><span class="koboSpan" id="kobo.164.1">void doNow();</span></strong><span class="koboSpan" id="kobo.165.1">
private slots:
    void on_pushButton_clicked();</span></pre></li> <li><span class="koboSpan" id="kobo.166.1">After that, open up </span><strong class="source-inline"><span class="koboSpan" id="kobo.167.1">mainwindow.cpp</span></strong><span class="koboSpan" id="kobo.168.1"> and define a </span><strong class="source-inline"><span class="koboSpan" id="kobo.169.1">MyClass</span></strong><span class="koboSpan" id="kobo.170.1"> object. </span><span class="koboSpan" id="kobo.170.2">Then, we’ll connect the </span><strong class="source-inline"><span class="koboSpan" id="kobo.171.1">doNow()</span></strong><span class="koboSpan" id="kobo.172.1"> signal that we created in the previous step with our </span><strong class="source-inline"><span class="koboSpan" id="kobo.173.1">doSomething()</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.174.1">slot function:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.175.1">
MainWindow::MainWindow(QWidget *parent) : QMainWindow(parent),
ui(new Ui::MainWindow){
    ui-&gt;setupUi(this);
    </span><strong class="bold"><span class="koboSpan" id="kobo.176.1">MyClass* myclass = new MyClass;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.177.1">    connect(this, &amp;MainWindow::doNow, myclass, &amp;MyClass::doSomething);</span></strong><span class="koboSpan" id="kobo.178.1">
}</span></pre></li> <li><span class="koboSpan" id="kobo.179.1">Then, we have to change</span><a id="_idIndexMarker125"/><span class="koboSpan" id="kobo.180.1"> the code of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.181.1">on_pushButton_clicked()</span></strong><span class="koboSpan" id="kobo.182.1"> function to something </span><span class="No-Break"><span class="koboSpan" id="kobo.183.1">like this:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.184.1">
void MainWindow::on_pushButton_clicked() {
    </span><strong class="bold"><span class="koboSpan" id="kobo.185.1">emit doNow();</span></strong><span class="koboSpan" id="kobo.186.1">
}</span></pre></li> <li><span class="koboSpan" id="kobo.187.1">If you build and run the program now, you will get a result that is similar to what’s shown in the previous example. </span><span class="koboSpan" id="kobo.187.2">However, we have placed the message box code in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.188.1">MyClass</span></strong><span class="koboSpan" id="kobo.189.1"> object instead of </span><span class="No-Break"><span class="koboSpan" id="kobo.190.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.191.1">MainWindow</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.193.1">The preceding steps demonstrated how we can utilize the slot-and-signal feature in Qt 6 to easily link a widget action to an event function. </span><span class="koboSpan" id="kobo.193.2">It really is </span><span class="No-Break"><span class="koboSpan" id="kobo.194.1">that simple.</span></span></p>
<h2 id="_idParaDest-45"><a id="_idTextAnchor045"/><span class="koboSpan" id="kobo.195.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.196.1">The signals and slots mechanism has </span><a id="_idIndexMarker126"/><span class="koboSpan" id="kobo.197.1">gone through some changes in the recent version of Qt, most notably its coding syntax. </span><span class="koboSpan" id="kobo.197.2">Qt 6 no longer supports the older syntax; therefore, if you are trying to port your older Qt 5 project to Qt 6, you must change your code to comply with the </span><span class="No-Break"><span class="koboSpan" id="kobo.198.1">newer syntax.</span></span></p>
<p><span class="koboSpan" id="kobo.199.1">In the good old days, we would typically connect a signal to a slot </span><span class="No-Break"><span class="koboSpan" id="kobo.200.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.201.1">
connect(
    sender, SIGNAL(valueChanged(QString)),
    receiver, SLOT(updateValue(QString))
);</span></pre> <p><span class="koboSpan" id="kobo.202.1">However, things have changed slightly since then. </span><span class="koboSpan" id="kobo.202.2">In the new syntax, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.203.1">SIGNAL</span></strong><span class="koboSpan" id="kobo.204.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.205.1">SLOT</span></strong><span class="koboSpan" id="kobo.206.1"> macros are now gone, and you </span><a id="_idIndexMarker127"/><span class="koboSpan" id="kobo.207.1">must specify the type of your object, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.208.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.209.1">
connect(
    sender, &amp;Sender::valueChanged,
    receiver, &amp;Receiver::updateValue
);</span></pre> <p><span class="koboSpan" id="kobo.210.1">The new syntax also allows you to connect a signal directly to a function instead </span><span class="No-Break"><span class="koboSpan" id="kobo.211.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.212.1">QObject</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.213.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.214.1">
connect(
    sender, &amp;Sender::valueChanged, myFunction
);</span></pre> <p><span class="koboSpan" id="kobo.215.1">Additionally, you can also connect</span><a id="_idIndexMarker128"/><span class="koboSpan" id="kobo.216.1"> your signal to a </span><strong class="bold"><span class="koboSpan" id="kobo.217.1">lambda expression</span></strong><span class="koboSpan" id="kobo.218.1">. </span><span class="koboSpan" id="kobo.218.2">We will talk more about this in the </span><em class="italic"><span class="koboSpan" id="kobo.219.1">Asynchronous programming made </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.220.1">easier</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.221.1"> recipe.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.222.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.223.1">A signal of an </span><strong class="source-inline"><span class="koboSpan" id="kobo.224.1">arbitrary</span></strong><span class="koboSpan" id="kobo.225.1"> class can trigger any private slots of an unrelated class that is going to be invoked, which is not possible </span><span class="No-Break"><span class="koboSpan" id="kobo.226.1">with callbacks.</span></span></p>
<h2 id="_idParaDest-46"><a id="_idTextAnchor046"/><span class="koboSpan" id="kobo.227.1">There’s more…</span></h2>
<p><span class="koboSpan" id="kobo.228.1">All Qt projects come with a project file with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.229.1">.pro</span></strong><span class="koboSpan" id="kobo.230.1"> extension. </span><span class="koboSpan" id="kobo.230.2">This project file is used specifically by Qt’s own </span><strong class="bold"><span class="koboSpan" id="kobo.231.1">qmake</span></strong><span class="koboSpan" id="kobo.232.1"> build system, which</span><a id="_idIndexMarker129"/><span class="koboSpan" id="kobo.233.1"> helps simplify most of the complex build process by using a straightforward declarative style, defining standard variables to indicate the source and header files that are used in </span><span class="No-Break"><span class="koboSpan" id="kobo.234.1">the project.</span></span></p>
<p><span class="koboSpan" id="kobo.235.1">There’s an alternative </span><a id="_idIndexMarker130"/><span class="koboSpan" id="kobo.236.1">build system called </span><strong class="bold"><span class="koboSpan" id="kobo.237.1">CMake</span></strong><span class="koboSpan" id="kobo.238.1">, which is also compatible with Qt. </span><span class="koboSpan" id="kobo.238.2">The Qt project file is not needed if you are using CMake. </span><span class="koboSpan" id="kobo.238.3">Instead, you can directly open </span><strong class="source-inline"><span class="koboSpan" id="kobo.239.1">CMakeLists.txt</span></strong><span class="koboSpan" id="kobo.240.1"> with Qt Creator and it will open the project just like using Qt’s project file. </span><span class="koboSpan" id="kobo.240.2">However, it’s not recommended</span><a id="_idIndexMarker131"/><span class="koboSpan" id="kobo.241.1"> for beginners to use CMake when developing their first application with Qt, as CMake is much more manual and it takes longer time to grasp </span><span class="No-Break"><span class="koboSpan" id="kobo.242.1">its functionality.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.243.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.244.1">To learn more about CMake, please </span><span class="No-Break"><span class="koboSpan" id="kobo.245.1">visit </span></span><a href="https://doc.qt.io/qt-6/cmake-get-started.html"><span class="No-Break"><span class="koboSpan" id="kobo.246.1">https://doc.qt.io/qt-6/cmake-get-started.html</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.247.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.248.1">Qt categorizes its features and functionality in the form of modules and classes. </span><span class="koboSpan" id="kobo.248.2">Each module contains a set of related functionalities that can be added to your project separately when needed. </span><span class="koboSpan" id="kobo.248.3">This allows the programmer to keep their program in optimum size and performance. </span><span class="koboSpan" id="kobo.248.4">The Qt Core and Qt GUI modules are included in every Qt project by default. </span><span class="koboSpan" id="kobo.248.5">To add additional modules, you simply need to add the module keyword to your Qt project file or add the package and link its libraries in </span><strong class="source-inline"><span class="koboSpan" id="kobo.249.1">CMakeLists.txt</span></strong><span class="koboSpan" id="kobo.250.1"> if you are using CMake for </span><span class="No-Break"><span class="koboSpan" id="kobo.251.1">your project.</span></span></p>
<p><span class="koboSpan" id="kobo.252.1">For example, if I want to add the Qt </span><strong class="source-inline"><span class="koboSpan" id="kobo.253.1">Network</span></strong><span class="koboSpan" id="kobo.254.1"> module to my project, I will add the following keyword to my Qt </span><span class="No-Break"><span class="koboSpan" id="kobo.255.1">project file:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.256.1">
QT += network</span></pre> <p><span class="koboSpan" id="kobo.257.1">In CMake, however, it gets </span><span class="No-Break"><span class="koboSpan" id="kobo.258.1">slightly longer:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.259.1">
find_package(Qt6 REQUIRED COMPONENTS Network)
target_link_libraries(mytarget PRIVATE Qt6::Network)</span></pre> <p><span class="koboSpan" id="kobo.260.1">After you have added the Qt </span><strong class="source-inline"><span class="koboSpan" id="kobo.261.1">Network</span></strong><span class="koboSpan" id="kobo.262.1"> module, you can now access its C++ classes such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.263.1">QNetworkAccessManager</span></strong><span class="koboSpan" id="kobo.264.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.265.1">QNetworkInterface</span></strong><span class="koboSpan" id="kobo.266.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.267.1">QNetworkRequest</span></strong><span class="koboSpan" id="kobo.268.1">, and so on. </span><span class="koboSpan" id="kobo.268.2">This modular approach creates an expandable ecosystem for Qt while allowing the developers to maintain this complex and powerful framework </span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">with ease.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.270.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.271.1">To learn more about all the different Qt modules, please </span><span class="No-Break"><span class="koboSpan" id="kobo.272.1">visit </span></span><a href="https://doc.qt.io/qt.html"><span class="No-Break"><span class="koboSpan" id="kobo.273.1">https://doc.qt.io/qt.html</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.274.1">.</span></span></p>
<h1 id="_idParaDest-47"><a id="_idTextAnchor047"/><span class="koboSpan" id="kobo.275.1">UI events with signals and slots</span></h1>
<p><span class="koboSpan" id="kobo.276.1">In the previous recipe, we </span><a id="_idIndexMarker132"/><span class="koboSpan" id="kobo.277.1">demonstrated the use of signals and slots on a </span><a id="_idIndexMarker133"/><span class="koboSpan" id="kobo.278.1">push button. </span><span class="koboSpan" id="kobo.278.2">Now, let’s explore the signals and slots that are available in other common </span><span class="No-Break"><span class="koboSpan" id="kobo.279.1">widget types.</span></span></p>
<h2 id="_idParaDest-48"><a id="_idTextAnchor048"/><span class="koboSpan" id="kobo.280.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.281.1">To learn how to use signals and slots with UI events, follow </span><span class="No-Break"><span class="koboSpan" id="kobo.282.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.283.1">Let’s create a new </span><strong class="bold"><span class="koboSpan" id="kobo.284.1">Qt Widgets </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.285.1">Application</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.286.1"> project.</span></span></li>
<li><span class="koboSpan" id="kobo.287.1">Drag and drop a </span><strong class="bold"><span class="koboSpan" id="kobo.288.1">PushButton</span></strong><span class="koboSpan" id="kobo.289.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.290.1">Combo Box</span></strong><span class="koboSpan" id="kobo.291.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.292.1">Line Edit</span></strong><span class="koboSpan" id="kobo.293.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.294.1">Spin Box</span></strong><span class="koboSpan" id="kobo.295.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.296.1">Slider</span></strong><span class="koboSpan" id="kobo.297.1"> widget from the </span><strong class="bold"><span class="koboSpan" id="kobo.298.1">Widget Box</span></strong><span class="koboSpan" id="kobo.299.1"> into your </span><span class="No-Break"><span class="koboSpan" id="kobo.300.1">UI canvas:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer042">
<span class="koboSpan" id="kobo.301.1"><img alt="Figure 2.6 – Placing several widgets on the UI canvas" src="image/B20976_02_006.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.302.1">Figure 2.6 – Placing several widgets on the UI canvas</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.303.1">Then, right-click on the push button, select </span><strong class="bold"><span class="koboSpan" id="kobo.304.1">clicked()</span></strong><span class="koboSpan" id="kobo.305.1">, and press the </span><strong class="bold"><span class="koboSpan" id="kobo.306.1">OK</span></strong><span class="koboSpan" id="kobo.307.1"> button to proceed. </span><span class="koboSpan" id="kobo.307.2">A slot function will be created for you by </span><span class="No-Break"><span class="koboSpan" id="kobo.308.1">Qt Creator:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer043">
<span class="koboSpan" id="kobo.309.1"><img alt="Figure 2.7 – Selecting the clicked() signal and pressing OK" src="image/B20976_02_007.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.310.1">Figure 2.7 – Selecting the clicked() signal and pressing OK</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.311.1">Repeat the previous step, but</span><a id="_idIndexMarker134"/><span class="koboSpan" id="kobo.312.1"> this time, select the next selection until every</span><a id="_idIndexMarker135"/><span class="koboSpan" id="kobo.313.1"> function in </span><strong class="source-inline"><span class="koboSpan" id="kobo.314.1">QAbstractButton</span></strong><span class="koboSpan" id="kobo.315.1"> has been added to the </span><span class="No-Break"><span class="koboSpan" id="kobo.316.1">source code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.317.1">
void on_pushButton_clicked();
void on_pushButton_clicked(bool checked);
void on_pushButton_pressed();
void on_pushButton_released();
void on_pushButton_toggled(bool checked);</span></pre></li> <li><span class="koboSpan" id="kobo.318.1">Next, repeat the same steps on the combo box until all the slot functions available under the </span><strong class="source-inline"><span class="koboSpan" id="kobo.319.1">QComboBox</span></strong><span class="koboSpan" id="kobo.320.1"> class have been added to the </span><span class="No-Break"><span class="koboSpan" id="kobo.321.1">source code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.322.1">
void on_comboBox_activated(const QString &amp;arg1);
void on_comboBox_activated(int index);
void on_comboBox_currentIndexChanged(const QString &amp;arg1);
void on_comboBox_currentIndexChanged(int index);
void on_comboBox_currentTextChanged(const QString &amp;arg1);
void on_comboBox_editTextChanged(const QString &amp;arg1);
void on_comboBox_highlighted(const QString &amp;arg1);
void on_comboBox_highlighted(int index);</span></pre></li> <li><span class="koboSpan" id="kobo.323.1">The same goes for </span><strong class="source-inline"><span class="koboSpan" id="kobo.324.1">lineEdit</span></strong><span class="koboSpan" id="kobo.325.1">, all </span><a id="_idIndexMarker136"/><span class="koboSpan" id="kobo.326.1">of which are</span><a id="_idIndexMarker137"/><span class="koboSpan" id="kobo.327.1"> under the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.328.1">QLineEdit</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.329.1"> class:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.330.1">
void on_lineEdit_cursorPositionChanged(int arg1, int arg2);
void on_lineEdit_editingFinished();
void on_lineEdit_returnPressed();
void on_lineEdit_selectionChanged();
void on_lineEdit_textChanged(const QString &amp;arg1);
void on_lineEdit_textEdited(const QString &amp;arg1);</span></pre></li> <li><span class="koboSpan" id="kobo.331.1">After that, add the slot functions</span><a id="_idIndexMarker138"/><span class="koboSpan" id="kobo.332.1"> from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.333.1">QSpinBox</span></strong><span class="koboSpan" id="kobo.334.1"> class for our </span><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">spin box</span></strong><span class="koboSpan" id="kobo.336.1"> widget as well, which is</span><a id="_idIndexMarker139"/> <span class="No-Break"><span class="koboSpan" id="kobo.337.1">relatively short:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.338.1">
void on_spinBox_valueChanged(const QString &amp;arg1);
void on_spinBox_valueChanged(int arg1);</span></pre></li> <li><span class="koboSpan" id="kobo.339.1">Lastly, repeat the same step for our </span><strong class="source-inline"><span class="koboSpan" id="kobo.340.1">slider</span></strong><span class="koboSpan" id="kobo.341.1"> widget, which yields </span><span class="No-Break"><span class="koboSpan" id="kobo.342.1">similar results:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.343.1">
void on_horizontalSlider_actionTriggered(int action);
void on_horizontalSlider_rangeChanged(int min, int max);
void on_horizontalSlider_sliderMoved(int position);
void on_horizontalSlider_sliderPressed();
void on_horizontalSlider_sliderReleased();
void on_horizontalSlider_valueChanged(int value);</span></pre></li> <li><span class="koboSpan" id="kobo.344.1">Once you’re done with</span><a id="_idIndexMarker140"/><span class="koboSpan" id="kobo.345.1"> that, open up </span><strong class="source-inline"><span class="koboSpan" id="kobo.346.1">mainwindow.h</span></strong><span class="koboSpan" id="kobo.347.1"> and </span><a id="_idIndexMarker141"/><span class="koboSpan" id="kobo.348.1">add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.349.1">QDebug</span></strong><span class="koboSpan" id="kobo.350.1"> header, as highlighted in the </span><span class="No-Break"><span class="koboSpan" id="kobo.351.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.352.1">
#ifndef MAINWINDOW_H
#define MAINWINDOW_H
#include &lt;QMainWindow&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.353.1">#include &lt;QDebug&gt;</span></strong><span class="koboSpan" id="kobo.354.1">
namespace Ui {
class MainWindow;
}</span></pre></li> <li><span class="koboSpan" id="kobo.355.1">Let’s implement the slot functions for our </span><span class="No-Break"><span class="koboSpan" id="kobo.356.1">push button:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.357.1">
void MainWindow::on_pushButton_clicked() {
    </span><strong class="bold"><span class="koboSpan" id="kobo.358.1">qDebug() &lt;&lt; «Push button clicked»;</span></strong><span class="koboSpan" id="kobo.359.1">
}
void MainWindow::on_pushButton_clicked(bool checked) {
    </span><strong class="bold"><span class="koboSpan" id="kobo.360.1">qDebug() &lt;&lt; «Push button clicked: « &lt;&lt; checked;</span></strong><span class="koboSpan" id="kobo.361.1">
}
void MainWindow::on_pushButton_pressed() {
    </span><strong class="bold"><span class="koboSpan" id="kobo.362.1">qDebug() &lt;&lt; «Push button pressed»;</span></strong><span class="koboSpan" id="kobo.363.1">
}
void MainWindow::on_pushButton_released() {
    </span><strong class="bold"><span class="koboSpan" id="kobo.364.1">qDebug() &lt;&lt; «Push button released»;</span></strong><span class="koboSpan" id="kobo.365.1">
}
void MainWindow::on_pushButton_toggled(bool checked) {
    </span><strong class="bold"><span class="koboSpan" id="kobo.366.1">qDebug() &lt;&lt; «Push button toggled: « &lt;&lt; checked;</span></strong><span class="koboSpan" id="kobo.367.1">
}</span></pre></li> <li><span class="koboSpan" id="kobo.368.1">If you build and run the project</span><a id="_idIndexMarker142"/><span class="koboSpan" id="kobo.369.1"> now, and then click on the push button, you will see that a different status gets</span><a id="_idIndexMarker143"/><span class="koboSpan" id="kobo.370.1"> printed out but at a slightly different time. </span><span class="koboSpan" id="kobo.370.2">This is due to different signals being emitted at different actions during the whole </span><span class="No-Break"><span class="koboSpan" id="kobo.371.1">clicking process:</span></span></li>
</ol>
<pre class="console"><span class="koboSpan" id="kobo.372.1">
Push button pressed
Push button released
Push button clicked
Push button clicked: false</span></pre> <ol>
<li value="12"><span class="koboSpan" id="kobo.373.1">Next, we will move on to the combo box. </span><span class="koboSpan" id="kobo.373.2">Since the default combo box is empty, let’s add some options to it by double-clicking on it from </span><strong class="source-inline"><span class="koboSpan" id="kobo.374.1">mainwindow.ui</span></strong><span class="koboSpan" id="kobo.375.1"> and adding the options that are shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.376.1">pop-up window:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer044">
<span class="koboSpan" id="kobo.377.1"><img alt="Figure 2.8 – Adding more options to the combo box" src="image/B20976_02_008.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.378.1">Figure 2.8 – Adding more options to the combo box</span></p>
<ol>
<li value="13"><span class="koboSpan" id="kobo.379.1">Then, let’s implement the slot </span><a id="_idIndexMarker144"/><span class="koboSpan" id="kobo.380.1">functions for the combo box </span><span class="No-Break"><span class="koboSpan" id="kobo.381.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.382.1">mainwindow.cpp</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.383.1">:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.384.1">
void MainWindow::on_comboBox_activated(const QString &amp;arg1) {
    </span><strong class="bold"><span class="koboSpan" id="kobo.385.1">qDebug() &lt;&lt; «Combo box activated: « &lt;&lt; arg1;</span></strong><span class="koboSpan" id="kobo.386.1">
}
void MainWindow::on_comboBox_activated(int index) {
    </span><strong class="bold"><span class="koboSpan" id="kobo.387.1">qDebug() &lt;&lt; «Combo box activated: « &lt;&lt; index;</span></strong><span class="koboSpan" id="kobo.388.1">
}
void MainWindow::on_comboBox_currentIndexChanged(const QString &amp;arg1) {
    </span><strong class="bold"><span class="koboSpan" id="kobo.389.1">qDebug() &lt;&lt; «Combo box current index changed: « &lt;&lt; arg1;</span></strong><span class="koboSpan" id="kobo.390.1">
}
void MainWindow::on_comboBox_currentIndexChanged(int index) {
    </span><strong class="bold"><span class="koboSpan" id="kobo.391.1">qDebug() &lt;&lt; «Combo box current index changed: « &lt;&lt; index;</span></strong><span class="koboSpan" id="kobo.392.1">
}</span></pre></li> <li><span class="koboSpan" id="kobo.393.1">We will continue to</span><a id="_idIndexMarker145"/><span class="koboSpan" id="kobo.394.1"> implement the rest of the slot functions for the </span><span class="No-Break"><span class="koboSpan" id="kobo.395.1">combo box:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.396.1">
void MainWindow::on_comboBox_currentTextChanged(const QString &amp;arg1) {
    </span><strong class="bold"><span class="koboSpan" id="kobo.397.1">qDebug() &lt;&lt; «Combo box current text changed: « &lt;&lt; arg1;</span></strong><span class="koboSpan" id="kobo.398.1">
}
void MainWindow::on_comboBox_editTextChanged(const QString
&amp;arg1) {
    </span><strong class="bold"><span class="koboSpan" id="kobo.399.1">qDebug() &lt;&lt; «Combo box edit text changed: « &lt;&lt; arg1;</span></strong><span class="koboSpan" id="kobo.400.1">
}
void MainWindow::on_comboBox_highlighted(const QString &amp;arg1) {
    </span><strong class="bold"><span class="koboSpan" id="kobo.401.1">qDebug() &lt;&lt; «Combo box highlighted: « &lt;&lt; arg1;</span></strong><span class="koboSpan" id="kobo.402.1">
}
void MainWindow::on_comboBox_highlighted(int index) {
    </span><strong class="bold"><span class="koboSpan" id="kobo.403.1">qDebug() &lt;&lt; «Combo box highlighted: « &lt;&lt; index;</span></strong><span class="koboSpan" id="kobo.404.1">
}</span></pre></li> <li><span class="koboSpan" id="kobo.405.1">Build and run the project. </span><span class="koboSpan" id="kobo.405.2">Then, try </span><a id="_idIndexMarker146"/><span class="koboSpan" id="kobo.406.1">to click on the</span><a id="_idIndexMarker147"/><span class="koboSpan" id="kobo.407.1"> combo box, hover over the other options, and select an option by clicking on it. </span><span class="koboSpan" id="kobo.407.2">You should see similar results to the following in your </span><span class="No-Break"><span class="koboSpan" id="kobo.408.1">debug output:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.409.1">
Combo box highlighted: 0
Combo box highlighted: "Option One"
Combo box highlighted: 1
Combo box highlighted: "Option Two"
Combo box highlighted: 2
Combo box highlighted: "Option Three"
Combo box current index changed: 2
Combo box current index changed: "Option Three"
Combo box current text changed: "Option Three"
Combo box activated: 2
Combo box activated: "Option Three"</span></pre></li> <li><span class="koboSpan" id="kobo.410.1">Next, we will move on to</span><a id="_idIndexMarker148"/><span class="koboSpan" id="kobo.411.1"> line edit and implement its slot functions, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.412.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.413.1">
void MainWindow::on_lineEdit_cursorPositionChanged(int arg1, int arg2) {
    </span><strong class="bold"><span class="koboSpan" id="kobo.414.1">qDebug() &lt;&lt; «Line edit cursor position changed: « &lt;&lt; arg1 &lt;&lt; arg2;</span></strong><span class="koboSpan" id="kobo.415.1">
}
void MainWindow::on_lineEdit_editingFinished() {
    </span><strong class="bold"><span class="koboSpan" id="kobo.416.1">qDebug() &lt;&lt; «Line edit editing finished»;</span></strong><span class="koboSpan" id="kobo.417.1">
}
void MainWindow::on_lineEdit_returnPressed() {
    </span><strong class="bold"><span class="koboSpan" id="kobo.418.1">qDebug() &lt;&lt; «Line edit return pressed»;</span></strong><span class="koboSpan" id="kobo.419.1">
}</span></pre></li> <li><span class="koboSpan" id="kobo.420.1">We will continue to </span><a id="_idIndexMarker149"/><span class="koboSpan" id="kobo.421.1">implement the rest of the slot functions of </span><span class="No-Break"><span class="koboSpan" id="kobo.422.1">line edit:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.423.1">
void MainWindow::on_lineEdit_selectionChanged() {
    </span><strong class="bold"><span class="koboSpan" id="kobo.424.1">qDebug() &lt;&lt; «Line edit selection changed»;</span></strong><span class="koboSpan" id="kobo.425.1">
}
void MainWindow::on_lineEdit_textChanged(const QString &amp;arg1) {
    </span><strong class="bold"><span class="koboSpan" id="kobo.426.1">qDebug() &lt;&lt; «Line edit text changed: « &lt;&lt; arg1;</span></strong><span class="koboSpan" id="kobo.427.1">
}
void MainWindow::on_lineEdit_textEdited(const QString &amp;arg1) {
    </span><strong class="bold"><span class="koboSpan" id="kobo.428.1">qDebug() &lt;&lt; «Line edit text edited: « &lt;&lt; arg1;</span></strong><span class="koboSpan" id="kobo.429.1">
}</span></pre></li> <li><span class="koboSpan" id="kobo.430.1">Build and run the project. </span><span class="koboSpan" id="kobo.430.2">Then, click on the line edit and type </span><strong class="source-inline"><span class="koboSpan" id="kobo.431.1">Hey</span></strong><span class="koboSpan" id="kobo.432.1">. </span><span class="koboSpan" id="kobo.432.2">You should see results similar to the</span><a id="_idIndexMarker150"/><span class="koboSpan" id="kobo.433.1"> following appearing in the debug </span><span class="No-Break"><span class="koboSpan" id="kobo.434.1">output panel:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.435.1">
Line edit cursor position changed: -1 0
Line edit text edited: "H"
Line edit text changed: "H"
Line edit cursor position changed: 0 1
Line edit text edited: "He"
Line edit text changed: "He"
Line edit cursor position changed: 1 2
Line edit text edited: "Hey"
Line edit text changed: "Hey"
Line edit cursor position changed: 2 3
Line edit editing finished</span></pre></li> <li><span class="koboSpan" id="kobo.436.1">After that, we need to implement the slot functions for the spin box widget, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.437.1">following</span></span><span class="No-Break"><a id="_idIndexMarker151"/></span><span class="No-Break"><span class="koboSpan" id="kobo.438.1"> code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.439.1">
void MainWindow::on_spinBox_valueChanged(const QString &amp;arg1){
    </span><strong class="bold"><span class="koboSpan" id="kobo.440.1">qDebug() &lt;&lt; «Spin box value changed: « &lt;&lt; arg1;</span></strong><span class="koboSpan" id="kobo.441.1">
}
void MainWindow::on_spinBox_valueChanged(int arg1) {
    </span><strong class="bold"><span class="koboSpan" id="kobo.442.1">qDebug() &lt;&lt; «Spin box value changed: « &lt;&lt; arg1;</span></strong><span class="koboSpan" id="kobo.443.1">
}</span></pre></li> <li><span class="koboSpan" id="kobo.444.1">Try to build and run the program. </span><span class="koboSpan" id="kobo.444.2">Then, click the arrow buttons on the spin box, or directly edit the value in the box – you should get something similar </span><span class="No-Break"><span class="koboSpan" id="kobo.445.1">to this:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.446.1">
Spin box value changed: "1"
Spin box value changed: 1
Spin box value changed: "2"
Spin box value changed: 2
Spin box value changed: "3"
Spin box value changed: 3
Spin box value changed: "2"
Spin box value changed: 2
Spin box value changed: "20"
Spin box value changed: 20</span></pre></li> <li><span class="koboSpan" id="kobo.447.1">Lastly, we’ll implement the</span><a id="_idIndexMarker152"/><span class="koboSpan" id="kobo.448.1"> slot functions for the horizontal </span><a id="_idIndexMarker153"/><span class="No-Break"><span class="koboSpan" id="kobo.449.1">slider widget:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.450.1">
void MainWindow::on_horizontalSlider_actionTriggered(int
action) {
    </span><strong class="bold"><span class="koboSpan" id="kobo.451.1">qDebug() &lt;&lt; «Slider action triggered» &lt;&lt; action;</span></strong><span class="koboSpan" id="kobo.452.1">
}
void MainWindow::on_horizontalSlider_rangeChanged(int min, int max) {
    </span><strong class="bold"><span class="koboSpan" id="kobo.453.1">qDebug() &lt;&lt; «Slider range changed: « &lt;&lt; min &lt;&lt; max;</span></strong><span class="koboSpan" id="kobo.454.1">
}
void MainWindow::on_horizontalSlider_sliderMoved(int position)
{
    </span><strong class="bold"><span class="koboSpan" id="kobo.455.1">qDebug() &lt;&lt; «Slider moved: « &lt;&lt; position;</span></strong><span class="koboSpan" id="kobo.456.1">
}</span></pre></li> <li><span class="koboSpan" id="kobo.457.1">Continue to implement the slot function for the slider, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.458.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.459.1">
void MainWindow::on_horizontalSlider_sliderPressed() {
    </span><strong class="bold"><span class="koboSpan" id="kobo.460.1">qDebug() &lt;&lt; «Slider pressed»;</span></strong><span class="koboSpan" id="kobo.461.1">
}
void MainWindow::on_horizontalSlider_sliderReleased() {
    </span><strong class="bold"><span class="koboSpan" id="kobo.462.1">qDebug() &lt;&lt; «Slider released»;</span></strong><span class="koboSpan" id="kobo.463.1">
}
void MainWindow::on_horizontalSlider_valueChanged(int value) {
    </span><strong class="bold"><span class="koboSpan" id="kobo.464.1">qDebug() &lt;&lt; «Slider value changed: « &lt;&lt; value;</span></strong><span class="koboSpan" id="kobo.465.1">
}</span></pre></li> <li><span class="koboSpan" id="kobo.466.1">Build and run the </span><a id="_idIndexMarker154"/><span class="koboSpan" id="kobo.467.1">program. </span><span class="koboSpan" id="kobo.467.2">Then, click and drag the slider </span><a id="_idIndexMarker155"/><span class="koboSpan" id="kobo.468.1">to the left and right – you should see results that are similar to </span><span class="No-Break"><span class="koboSpan" id="kobo.469.1">the following:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.470.1">
Slider pressed
Slider moved: 1
Slider action triggered 7
Slider value changed: 1
Slider moved: 2
Slider action triggered 7
Slider value changed: 2
Slider moved: 3
Slider action triggered 7
Slider value changed: 3
Slider moved: 4
Slider action triggered 7
Slider value changed: 4
Slider released</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.471.1">Almost every widget has a set of slot functions associated with its usage or purpose. </span><span class="koboSpan" id="kobo.471.2">For example, a push button will start </span><a id="_idIndexMarker156"/><span class="koboSpan" id="kobo.472.1">emitting signals that trigger the slot functions associated with it when it’s </span><a id="_idIndexMarker157"/><span class="koboSpan" id="kobo.473.1">pressed or released. </span><span class="koboSpan" id="kobo.473.2">These expected behaviors that define the widget have slot functions that get called when the user triggers an action. </span><span class="koboSpan" id="kobo.473.3">As programmers, all we need to do is implement the slot functions and tell Qt what to do when these slot functions are </span><span class="No-Break"><span class="koboSpan" id="kobo.474.1">being triggered.</span></span></p>
<h1 id="_idParaDest-49"><a id="_idTextAnchor049"/><span class="koboSpan" id="kobo.475.1">Asynchronous programming made easier</span></h1>
<p><span class="koboSpan" id="kobo.476.1">Since the signals and slots mechanism is </span><em class="italic"><span class="koboSpan" id="kobo.477.1">asynchronous</span></em><span class="koboSpan" id="kobo.478.1"> in nature, we can make use of it for things other than user interfaces. </span><span class="koboSpan" id="kobo.478.2">In programming terms, an </span><em class="italic"><span class="koboSpan" id="kobo.479.1">asynchronous operation</span></em><span class="koboSpan" id="kobo.480.1"> is a process that works independently, allowing the program to continue its operation without waiting for the </span><a id="_idIndexMarker158"/><span class="koboSpan" id="kobo.481.1">process to complete, which may stall the whole program. </span><span class="koboSpan" id="kobo.481.2">Qt 6 allows you to make use of its signals and slots mechanism to easily achieve asynchronous processes without much effort. </span><span class="koboSpan" id="kobo.481.3">This is even more true after Qt 6 enforced the new syntax for signals and slots, which allows a signal to trigger a normal function instead of a slot function from a </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.482.1">Qobject</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.483.1"> object.</span></span></p>
<p><span class="koboSpan" id="kobo.484.1">In the following example, we will further explore this opportunity and learn how we can improve our program’s efficiency by using asynchronous operations through the signals and slots mechanism that’s provided by </span><span class="No-Break"><span class="koboSpan" id="kobo.485.1">Qt 6.</span></span></p>
<h2 id="_idParaDest-50"><a id="_idTextAnchor050"/><span class="koboSpan" id="kobo.486.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.487.1">To learn how to achieve asynchronous operations using the signals and slots mechanism, let’s follow </span><span class="No-Break"><span class="koboSpan" id="kobo.488.1">this example:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.489.1">Create a </span><strong class="bold"><span class="koboSpan" id="kobo.490.1">Qt Console </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.491.1">Application</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.492.1"> project:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer045">
<span class="koboSpan" id="kobo.493.1"><img alt="Figure 2.9 – Creating a new Qt Console Application project" src="image/B20976_02_009.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.494.1">Figure 2.9 – Creating a new Qt Console Application project</span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.495.1">This type of project will only </span><a id="_idIndexMarker159"/><span class="koboSpan" id="kobo.496.1">provide a </span><strong class="source-inline"><span class="koboSpan" id="kobo.497.1">main.cpp</span></strong><span class="koboSpan" id="kobo.498.1"> file for you, instead of </span><strong class="source-inline"><span class="koboSpan" id="kobo.499.1">mainwindow.h</span></strong><span class="koboSpan" id="kobo.500.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.501.1">mainwindow.cpp</span></strong><span class="koboSpan" id="kobo.502.1">, like our previous example projects. </span><span class="koboSpan" id="kobo.502.2">Let’s open up </span><strong class="source-inline"><span class="koboSpan" id="kobo.503.1">main.cpp</span></strong><span class="koboSpan" id="kobo.504.1"> and add the following headers </span><span class="No-Break"><span class="koboSpan" id="kobo.505.1">to it:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.506.1">
#include &lt;QNetworkAccessManager&gt;
#include &lt;QNetworkReply&gt;
#include &lt;QDebug&gt;</span></pre></li> <li><span class="koboSpan" id="kobo.507.1">Then, add the following code to our </span><strong class="source-inline"><span class="koboSpan" id="kobo.508.1">main()</span></strong><span class="koboSpan" id="kobo.509.1"> function. </span><span class="koboSpan" id="kobo.509.2">We will be using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.510.1">QNetworkAccessManager</span></strong><span class="koboSpan" id="kobo.511.1"> class to initiate a </span><strong class="source-inline"><span class="koboSpan" id="kobo.512.1">GET</span></strong><span class="koboSpan" id="kobo.513.1"> request to the following </span><span class="No-Break"><span class="koboSpan" id="kobo.514.1">web URL:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.515.1">
int main(int argc, char *argv[]) {
    QCoreApplication a(argc, argv);
    QString *html = new QString;
    qDebug() &lt;&lt; "Start";
    QNetworkAccessManager manager;
    QNetworkRequest req(QUrl("http://www.dustyfeet.com"));
    QNetworkReply* reply = manager.get(req);</span></pre></li> <li><span class="koboSpan" id="kobo.516.1">Then, we use C++11’s </span><strong class="bold"><span class="koboSpan" id="kobo.517.1">lambda expression</span></strong><span class="koboSpan" id="kobo.518.1"> to connect </span><strong class="source-inline"><span class="koboSpan" id="kobo.519.1">QNetworkReply</span></strong><span class="koboSpan" id="kobo.520.1"> signals</span><a id="_idIndexMarker160"/><span class="koboSpan" id="kobo.521.1"> to </span><span class="No-Break"><span class="koboSpan" id="kobo.522.1">inline </span></span><span class="No-Break"><a id="_idIndexMarker161"/></span><span class="No-Break"><span class="koboSpan" id="kobo.523.1">functions:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.524.1">
QObject::connect(reply, &amp;QNetworkReply::readyRead,
 [reply, html]() {
         html-&gt;append(QString(reply-&gt;readAll()));
     });
     QObject::connect(reply, &amp;QNetworkReply::downloadProgress, [reply](qint64 bytesReceived, qint64 bytesTotal) {
         qDebug() &lt;&lt; "Progress: " &lt;&lt; bytesReceived &lt;&lt; "bytes /" &lt;&lt; bytesTotal &lt;&lt; "bytes";
     });</span></pre></li> <li><span class="koboSpan" id="kobo.525.1">We can also use a lambda expression with </span><strong class="source-inline"><span class="koboSpan" id="kobo.526.1">connect()</span></strong><span class="koboSpan" id="kobo.527.1"> to call a function that is not under a </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.528.1">QObject</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.529.1"> class:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.530.1">
QObject::connect(reply, &amp;QNetworkReply::finished, [=]() {
        printHTML(*html);
    });
    return a.exec();
}</span></pre></li> <li><span class="koboSpan" id="kobo.531.1">Lastly, we define the </span><strong class="source-inline"><span class="koboSpan" id="kobo.532.1">printHTML()</span></strong><span class="koboSpan" id="kobo.533.1"> function, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.534.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.535.1">
void printHTML(QString html) {
    qDebug() &lt;&lt; "Done";
    qDebug() &lt;&lt; html;
}</span></pre></li> <li><span class="koboSpan" id="kobo.536.1">If you build and run the program now, you will see that it’s functional even without declaring any</span><a id="_idIndexMarker162"/><span class="koboSpan" id="kobo.537.1"> slot function. </span><strong class="bold"><span class="koboSpan" id="kobo.538.1">Lambda expressions</span></strong><span class="koboSpan" id="kobo.539.1"> make declaring a slot function optional, but</span><a id="_idIndexMarker163"/><span class="koboSpan" id="kobo.540.1"> this is only recommended if your code is </span><span class="No-Break"><span class="koboSpan" id="kobo.541.1">really short:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer046">
<span class="koboSpan" id="kobo.542.1"><img alt="Figure 2.10 – Printing HTML source code on the terminal window" src="image/B20976_02_010.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.543.1">Figure 2.10 – Printing HTML source code on the terminal window</span></p>
<ol>
<li value="8"><span class="koboSpan" id="kobo.544.1">If the terminal window does not appear after you build and run your Qt console application project, go to </span><strong class="bold"><span class="koboSpan" id="kobo.545.1">Edit</span></strong><span class="koboSpan" id="kobo.546.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.547.1">Preferences</span></strong><span class="koboSpan" id="kobo.548.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.549.1">Build &amp; Run</span></strong><span class="koboSpan" id="kobo.550.1"> and select </span><strong class="bold"><span class="koboSpan" id="kobo.551.1">Enabled</span></strong><span class="koboSpan" id="kobo.552.1"> for the </span><strong class="bold"><span class="koboSpan" id="kobo.553.1">Default for “Run in </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.554.1">terminal”</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.555.1"> option.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer047">
<span class="koboSpan" id="kobo.556.1"><img alt="Figure 2.11 – Enabling the terminal window from the Preferences settings" src="image/B20976_02_011.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.557.1">Figure 2.11 – Enabling the terminal window from the Preferences settings</span></p>
<p><span class="koboSpan" id="kobo.558.1">The preceding example demonstrated</span><a id="_idIndexMarker164"/><span class="koboSpan" id="kobo.559.1"> how we can run a lambda function within the network reply slot function. </span><span class="koboSpan" id="kobo.559.2">This way, we can ensure that our code is shorter and easier to debug, but the lambda function is only suitable if the function is meant to be called </span><span class="No-Break"><span class="koboSpan" id="kobo.560.1">only once.</span></span></p>
<h2 id="_idParaDest-51"><a id="_idTextAnchor051"/><span class="koboSpan" id="kobo.561.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.562.1">The preceding example is a very simple application that showcases the use of lambda expressions to connect a signal with a lambda function or a regular function without declaring any slot function and thus does not need to be inherited from a </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.563.1">QObject</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.564.1"> class.</span></span></p>
<p><span class="koboSpan" id="kobo.565.1">This is especially useful for calling asynchronous processes that are not under UI objects. </span><span class="koboSpan" id="kobo.565.2">Lambda expressions are functions that get defined within another function anonymously, which is quite similar to the </span><a id="_idIndexMarker165"/><span class="koboSpan" id="kobo.566.1">anonymous functions in </span><strong class="bold"><span class="koboSpan" id="kobo.567.1">JavaScript</span></strong><span class="koboSpan" id="kobo.568.1">. </span><span class="koboSpan" id="kobo.568.2">The format of a lambda function looks </span><span class="No-Break"><span class="koboSpan" id="kobo.569.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.570.1">
[captured variables](arguments) {
    lambda code
}</span></pre> <p><span class="koboSpan" id="kobo.571.1">You can insert variables into a lambda expression by placing them into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.572.1">captured variables</span></strong><span class="koboSpan" id="kobo.573.1"> part, as we did in the example project in this recipe. </span><span class="koboSpan" id="kobo.573.2">We capture the </span><strong class="source-inline"><span class="koboSpan" id="kobo.574.1">QNetworkReply</span></strong><span class="koboSpan" id="kobo.575.1"> object called </span><strong class="source-inline"><span class="koboSpan" id="kobo.576.1">reply</span></strong><span class="koboSpan" id="kobo.577.1">, and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.578.1">QString</span></strong><span class="koboSpan" id="kobo.579.1"> object called </span><strong class="source-inline"><span class="koboSpan" id="kobo.580.1">html</span></strong><span class="koboSpan" id="kobo.581.1">, and put them in our </span><span class="No-Break"><span class="koboSpan" id="kobo.582.1">lambda expression.</span></span></p>
<p><span class="koboSpan" id="kobo.583.1">Then, we can use these variables</span><a id="_idIndexMarker166"/><span class="koboSpan" id="kobo.584.1"> within our lambda code, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.585.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.586.1">
[</span><strong class="bold"><span class="koboSpan" id="kobo.587.1">reply, html</span></strong><span class="koboSpan" id="kobo.588.1">]() {
    </span><strong class="bold"><span class="koboSpan" id="kobo.589.1">html</span></strong><span class="koboSpan" id="kobo.590.1">-&gt;append(QString(</span><strong class="bold"><span class="koboSpan" id="kobo.591.1">reply</span></strong><span class="koboSpan" id="kobo.592.1">-&gt;readAll()));
}</span></pre> <p><span class="koboSpan" id="kobo.593.1">The argument part is similar to an ordinary function, where you input values to the arguments and use them within your lambda code. </span><span class="koboSpan" id="kobo.593.2">In this case, the values of </span><strong class="source-inline"><span class="koboSpan" id="kobo.594.1">bytesReceived</span></strong><span class="koboSpan" id="kobo.595.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.596.1">bytesTotal</span></strong><span class="koboSpan" id="kobo.597.1"> are coming from the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.598.1">downloadProgress</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.599.1"> signal:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.600.1">
QObject::connect(reply, &amp;QNetworkReply::downloadProgress,
[reply](qint64 </span><strong class="source-inline"><span class="koboSpan" id="kobo.601.1">bytesReceived</span></strong><span class="koboSpan" id="kobo.602.1">, qint64 </span><strong class="source-inline"><span class="koboSpan" id="kobo.603.1">bytesTotal</span></strong><span class="koboSpan" id="kobo.604.1">) {
    qDebug() &lt;&lt; "Progress: " &lt;&lt; </span><strong class="source-inline"><span class="koboSpan" id="kobo.605.1">bytesReceived</span></strong><span class="koboSpan" id="kobo.606.1"> &lt;&lt; "bytes /" &lt;&lt; </span><strong class="source-inline"><span class="koboSpan" id="kobo.607.1">bytesTotal</span></strong><span class="koboSpan" id="kobo.608.1"> &lt;&lt; "bytes";
});</span></pre> <p><span class="koboSpan" id="kobo.609.1">You can also capture all variables that are used in your function using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.610.1">=</span></strong><span class="koboSpan" id="kobo.611.1"> sign. </span><span class="koboSpan" id="kobo.611.2">In this case, we captured the </span><strong class="source-inline"><span class="koboSpan" id="kobo.612.1">html</span></strong><span class="koboSpan" id="kobo.613.1"> variable without specifying it in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.614.1">captured </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.615.1">variables</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.616.1"> area:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.617.1">
[=]() {
    printHTML(*html);
}</span></pre> <h1 id="_idParaDest-52"><a id="_idTextAnchor052"/><span class="koboSpan" id="kobo.618.1">Function callbacks</span></h1>
<p><span class="koboSpan" id="kobo.619.1">Even though Qt 6 supports the signals and slots</span><a id="_idIndexMarker167"/><span class="koboSpan" id="kobo.620.1"> mechanism, some of the features in Qt 6 still use </span><strong class="bold"><span class="koboSpan" id="kobo.621.1">function callbacks</span></strong><span class="koboSpan" id="kobo.622.1">, such as keyboard input, window resizing, graphics painting, and others. </span><span class="koboSpan" id="kobo.622.2">Since these events only need to be implemented once, there is no need to use the signals and </span><span class="No-Break"><span class="koboSpan" id="kobo.623.1">slots mechanism.</span></span></p>
<h2 id="_idParaDest-53"><a id="_idTextAnchor053"/><span class="koboSpan" id="kobo.624.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.625.1">Let’s get started by following </span><span class="No-Break"><span class="koboSpan" id="kobo.626.1">this example:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.627.1">Create a </span><strong class="bold"><span class="koboSpan" id="kobo.628.1">Qt Widgets Application</span></strong><span class="koboSpan" id="kobo.629.1"> project, open</span><a id="_idIndexMarker168"/><span class="koboSpan" id="kobo.630.1"> up </span><strong class="source-inline"><span class="koboSpan" id="kobo.631.1">mainwindow.h</span></strong><span class="koboSpan" id="kobo.632.1">, and add the </span><span class="No-Break"><span class="koboSpan" id="kobo.633.1">following headers:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.634.1">
#include &lt;QDebug&gt;
#include &lt;QResizeEvent&gt;
#include &lt;QKeyEvent&gt;
#include &lt;QMouseEvent&gt;</span></pre></li> <li><span class="koboSpan" id="kobo.635.1">Then, declare these functions </span><span class="No-Break"><span class="koboSpan" id="kobo.636.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.637.1">mainwindow.h</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.638.1">:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.639.1">
public:
    explicit MainWindow(QWidget *parent = 0);
    ~MainWindow();
    </span><strong class="bold"><span class="koboSpan" id="kobo.640.1">void resizeEvent(QResizeEvent *event);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.641.1">    void keyPressEvent(QKeyEvent *event);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.642.1">    void keyReleaseEvent(QKeyEvent *event);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.643.1">    void mouseMoveEvent(QMouseEvent *event);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.644.1">    void mousePressEvent(QMouseEvent *event);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.645.1">    void mouseReleaseEvent(QMouseEvent *event);</span></strong></pre></li> <li><span class="koboSpan" id="kobo.646.1">After that, open up </span><strong class="source-inline"><span class="koboSpan" id="kobo.647.1">mainwindow.cpp</span></strong><span class="koboSpan" id="kobo.648.1"> and add the following code to the </span><span class="No-Break"><span class="koboSpan" id="kobo.649.1">class constructor:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.650.1">
MainWindow::MainWindow(QWidget *parent) : QMainWindow(parent),
ui(new Ui::MainWindow) {
    ui-&gt;setupUi(this);
    </span><strong class="bold"><span class="koboSpan" id="kobo.651.1">this-&gt;setMouseTracking(true);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.652.1">    ui-&gt;centralWidget-&gt;setMouseTracking(true);</span></strong><span class="koboSpan" id="kobo.653.1">
}</span></pre></li> <li><span class="koboSpan" id="kobo.654.1">Then, define</span><a id="_idIndexMarker169"/><span class="koboSpan" id="kobo.655.1"> the </span><strong class="source-inline"><span class="koboSpan" id="kobo.656.1">resizeEvent()</span></strong><span class="koboSpan" id="kobo.657.1"> and </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.658.1">keyPressedEvent()</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.659.1"> functions:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.660.1">
void MainWindow::resizeEvent(QResizeEvent *event) {
    qDebug() &lt;&lt; "Old size:" &lt;&lt; event-&gt;oldSize() &lt;&lt; ", New size:" &lt;&lt; event-&gt;size();
}
void MainWindow::keyPressEvent(QKeyEvent *event) {
    if (event-&gt;key() == Qt::Key_Escape) {
        this-&gt;close();
    }
    qDebug() &lt;&lt; event-&gt;text() &lt;&lt; "has been pressed";
}</span></pre></li> <li><span class="koboSpan" id="kobo.661.1">Continue to implement the rest of </span><span class="No-Break"><span class="koboSpan" id="kobo.662.1">the functions:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.663.1">
void MainWindow::keyReleaseEvent(QKeyEvent *event) {
    qDebug() &lt;&lt; event-&gt;text() &lt;&lt; "has been released";
}
void MainWindow::mouseMoveEvent(QMouseEvent *event) {
    qDebug() &lt;&lt; "Position: " &lt;&lt; event-&gt;pos();
}
void MainWindow::mousePressEvent(QMouseEvent *event) {
    qDebug() &lt;&lt; "Mouse pressed:" &lt;&lt; event-&gt;button();
}
void MainWindow::mouseReleaseEvent(QMouseEvent *event) {
    qDebug() &lt;&lt; "Mouse released:" &lt;&lt; event-&gt;button();
}</span></pre></li> <li><span class="koboSpan" id="kobo.664.1">Build and run the program. </span><span class="koboSpan" id="kobo.664.2">Then, try and move the mouse around, rescale the main window, press some</span><a id="_idIndexMarker170"/><span class="koboSpan" id="kobo.665.1"> random keys on your keyboard, and finally press the </span><em class="italic"><span class="koboSpan" id="kobo.666.1">Esc</span></em><span class="koboSpan" id="kobo.667.1"> key on your keyboard to close </span><span class="No-Break"><span class="koboSpan" id="kobo.668.1">the program.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.669.1">You should be seeing debug texts similar to the ones that are being printed out on the application </span><span class="No-Break"><span class="koboSpan" id="kobo.670.1">output window:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.671.1">
Old size: QSize(-1, -1) , New size: QSize(400, 300)
Old size: QSize(400, 300) , New size: QSize(401, 300)
Old size: QSize(401, 300) , New size: QSize(402, 300)
Position: QPoint(465,348)
Position: QPoint(438,323)
Position: QPoint(433,317)
"a" has been pressed
"a" has been released
"r" has been pressed
"r" has been released
"d" has been pressed
"d" has been released
"\u001B" has been pressed</span></pre> <h2 id="_idParaDest-54"><a id="_idTextAnchor054"/><span class="koboSpan" id="kobo.672.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.673.1">Qt 6 objects, especially the main window, have a dozen built-in callback functions that exist as </span><strong class="bold"><span class="koboSpan" id="kobo.674.1">virtual functions</span></strong><span class="koboSpan" id="kobo.675.1">. </span><span class="koboSpan" id="kobo.675.2">These functions can</span><a id="_idIndexMarker171"/><span class="koboSpan" id="kobo.676.1"> be overridden to perform your intended behavior when called. </span><span class="koboSpan" id="kobo.676.2">Qt 6 may invoke</span><a id="_idIndexMarker172"/><span class="koboSpan" id="kobo.677.1"> these </span><strong class="bold"><span class="koboSpan" id="kobo.678.1">callback functions</span></strong><span class="koboSpan" id="kobo.679.1"> when its expected condition has been met, such as a keyboard button has been pressed, the mouse cursor has been moved, the window has been resized, and </span><span class="No-Break"><span class="koboSpan" id="kobo.680.1">so on.</span></span></p>
<p><span class="koboSpan" id="kobo.681.1">The functions that we declared in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.682.1">mainwindow.h</span></strong><span class="koboSpan" id="kobo.683.1"> file are virtual functions that are built into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.684.1">QWidget</span></strong><span class="koboSpan" id="kobo.685.1"> class. </span><span class="koboSpan" id="kobo.685.2">We are just overriding them with our own code to define their new behavior when they</span><a id="_idIndexMarker173"/> <span class="No-Break"><span class="koboSpan" id="kobo.686.1">are called.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.687.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.688.1">Do take note that you must call </span><strong class="source-inline"><span class="koboSpan" id="kobo.689.1">setMouseTracking(true)</span></strong><span class="koboSpan" id="kobo.690.1"> for both </span><strong class="source-inline"><span class="koboSpan" id="kobo.691.1">MainWindow</span></strong><span class="koboSpan" id="kobo.692.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.693.1">centralWidget</span></strong><span class="koboSpan" id="kobo.694.1"> for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.695.1">mouseMoveEvent()</span></strong><span class="koboSpan" id="kobo.696.1"> callback </span><span class="No-Break"><span class="koboSpan" id="kobo.697.1">to work.</span></span></p>
<p><span class="koboSpan" id="kobo.698.1">Without features such as function callbacks, signals and slots, we as programmers will have a more difficult time developing applications that are responsive and intuitive to use. </span><span class="koboSpan" id="kobo.698.2">Qt 6 shortens our development cycles and allows us to focus more on designing </span><span class="No-Break"><span class="koboSpan" id="kobo.699.1">user-friendly applications.</span></span></p>
</div>
</body></html>