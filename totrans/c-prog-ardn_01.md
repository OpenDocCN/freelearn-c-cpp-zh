# 第1章。让我们连接东西

Arduino的一切都是关于连接东西。在我们对微控制器的一般知识以及特别是庞大而惊人的Arduino大家族有了更多了解之后，我们将在这几分钟内做到这一点。本章将教会你如何完全准备好用你的新硬件朋友进行编码、布线和测试。是的，这很快就会发生，非常快；现在让我们深入探讨吧！

# 什么是微控制器？

**微控制器**是一个**集成电路**（**IC**），包含典型计算机的所有主要部分，如下所述：

+   处理器

+   存储器

+   外设

+   输入和输出

**处理器**是大脑，是所有决策被做出并可以进行计算的部分。

**存储器**通常是核心内部程序和用户元素运行的空间（通常称为**只读存储器**（**ROM**）和**随机存取存储器**（**RAM**））。

我将全局板上的自包含外设定义为外设；这些是具有主要目的的非常不同类型的集成电路：支持处理器并扩展其功能。

输入和输出是世界（围绕微控制器）与微控制器本身之间通信的方式。

第一款单片处理器是在1971年由英特尔公司建造并提出的，名为**Intel 4004**。它是一个4位的**中央处理单元**（**CPU**）。

自从70年代以来，事物已经发生了很大的变化，我们周围有很多处理器。看看四周，你会看到你的手机、你的电脑和你的屏幕。处理器或微处理器几乎驱动着一切。

与微处理器相比，微控制器提供了一种减少功耗、尺寸和成本的方法。确实，即使微处理器的速度比微控制器中嵌入的处理器快，它们也需要大量的外围设备才能工作。微控制器提供的高度集成使其成为汽车引擎控制器、电视遥控器、包括您漂亮的打印机在内的桌面设备、家用电器、儿童游戏、移动电话等嵌入式系统的朋友。我可以继续……

我无法在这本书中介绍许多微控制器系列，不提**PICs** ([http://en.wikipedia.org/wiki/PIC_microcontroller](http://en.wikipedia.org/wiki/PIC_microcontroller)) 和 **Parallax SX** 微控制器系列。我还想提及一个特定的音乐硬件开发开源项目：**MIDIbox**（基于PIC，然后基于STM32，查看 [http://www.ucapps.de](http://www.ucapps.de)）。这是一个非常强大且稳健的框架，非常可调整。Protodeck控制器 ([http://julienbayle.net/protodeck](http://julienbayle.net/protodeck)) 基于MIDIbox。

现在你已经明白你手中有一台完整的电脑，让我们具体描述Arduino板！

# 介绍Arduino大家族

Arduino是一个开源([http://en.wikipedia.org/wiki/Open_source](http://en.wikipedia.org/wiki/Open_source))的单板式微控制器。它是一个非常流行的平台，源自**Wiring**平台([http://www.wiring.org.co/](http://www.wiring.org.co/))，最初设计用于推广在交互式设计大学生的项目中使用电子技术。

![展示大型的Arduino家族](img/7584_01_001.jpg)

我手中的Arduino MEGA

它基于Atmel AVR处理器([http://www.atmel.com/products/microcontrollers/avr/default.aspx](http://www.atmel.com/products/microcontrollers/avr/default.aspx))，并且在一块自给自足的硬件上提供了许多输入和输出。该项目的官方网站是[http://www.arduino.cc](http://www.arduino.cc)。

该项目始于2005年的意大利，由创始人Massimo Banzi和David Cuartielles发起。如今，它是开源概念在硬件世界中最美丽的例子之一，经常只在软件世界中使用。

我们谈论Arduino家族，因为今天我们可以数出大约15款基于Arduino的板子，这是一个有趣的元术语，用来定义所有使用Atmel AVR处理器制作的不同类型的板子设计。这些板子之间的主要区别是：

+   处理器类型

+   输入和输出的数量

+   外形尺寸

一些Arduino板在计算速度上更强大，一些有更多的内存，一些有大量的输入/输出（检查巨大的Arduino Mega），一些旨在集成到更复杂的项目中，具有非常小的外形尺寸和很少的输入/输出……就像我经常对我的学生说，*每个人都能在Arduino家族中找到他的朋友*。还有一些板子包括像以太网连接器或甚至蓝牙模块这样的外围设备，包括天线。

这个家族背后的魔法事实是我们可以在我们的计算机上使用相同的**集成开发环境**(**IDE**)来使用任何这些板子([http://en.wikipedia.org/wiki/Integrated_development_environment](http://en.wikipedia.org/wiki/Integrated_development_environment))。一些设置需要正确配置，但这是我们将会使用的相同软件和语言：

![展示大型的Arduino家族](img/7584_01_002.jpg)

一些值得注意的Arduino家族成员：Uno R3、LilyPad、Arduino Ethernet、Arduino Mega、Arduino Nano、Arduino Pro和原型板

你可以在[http://arduino.cc/en/Main/Hardware](http://arduino.cc/en/Main/Hardware)找到关于此的非常棒但并不详尽的参考页面。

我特别想让你检查以下型号：

+   **Arduino Uno**是基本型号，具有可更换的芯片组

+   **Arduino Mega**，2560提供了大量的输入和输出

+   **Arduino LilyPad**，可以像衣服一样穿戴

+   **Arduino Nano**，非常小巧

在这本书中，我会使用Arduino Mega和Arduino Uno；但不要害怕，当你掌握了Arduino编程，你将能够使用它们中的任何一个！

# 关于硬件原型

我们今天可以很容易地使用大量的开源框架来编程和构建软件，你可以在网上找到很多有帮助的社区。我想到的是**Processing**（基于Java，请查看[http://processing.org](http://processing.org))，和**openFrameworks**（基于C++，请查看[http://www.openframeworks.cc](http://www.openframeworks.cc))，但还有很多其他的使用非常不同的范例，比如图形编程语言，如**Pure Data** ([http://puredata.info](http://puredata.info))，**Max 6** ([http://cycling74.com/products/max/](http://cycling74.com/products/max/))，或**vvvv** ([http://vvvv.org](http://vvvv.org))。

因为作为制造者，我们完全沉浸在DIY实践中，我们都想并且需要构建和设计我们自己的工具，这通常意味着硬件和电子工具。我们希望扩展我们的计算机，添加传感器、闪烁的灯光，甚至创建独立的设备。

即使是测试非常基本的事情，比如闪烁一个**发光二极管**（**LED**），也涉及到从供电到芯片组低级编程，从电阻值计算到电压驱动石英钟设置等多个元素。所有这些步骤都让学生们头疼，甚至那些有动力的学生也可能因为第一次测试而放弃。

Arduino的出现改变了整个领域的格局，它提出了一个价格低廉且功能齐全的解决方案（我们不得不为Arduino Uno R3支付30美元），一个跨平台的工具链，在Windows、OS X和Linux上运行，一个非常容易使用的高级C语言和库，它也可以调整低级位，以及一个完全可扩展的开源框架。

事实上，有了这个包含所有功能的可爱的小板，一根USB线，和你的电脑，你可以学习电子学，使用C语言编程嵌入式硬件，并使LED闪烁。

由于整个框架提供的软件和硬件之间的高度集成，硬件原型变得（几乎）和软件原型一样容易。

在这里要理解的最重要的事情之一是原型周期。

![关于硬件原型](img/7584_01_003.jpg)

一个简单的硬件原型步骤列表

从我们的想法到我们的最终渲染，我们通常必须遵循这些步骤。

如果我们想让那个LED闪烁，我们必须定义几个闪烁特性。这将有助于精确地定义项目，这是成功的关键。

然后，我们需要用我们的Arduino板和LED绘制一个原理图；这将解决“它们是如何连接在一起”的问题。

使用C语言进行固件编程可以直接在我们绘制电路图后开始，因为，正如我们稍后将会看到的，它与硬件直接相关。这是Arduino开发的强大功能之一。你还记得吗？板的设计只是为了让我们思考我们的项目，而不是用非常低级的抽象学习片段来混淆我们。

上传步骤非常重要。它可以为我们提供大量信息，尤其是在进一步故障排除的情况下。一旦将板正确连接到我们的计算机，我们将了解到这一步骤不需要超过几个点击。

然后，将进行子周期测试和修复。我们将通过制作、测试和失败来学习。这是过程的一个重要部分，它将教会你很多。我必须承认一个重要的事情：在我第一次开始我的**bonome**项目([http://julienbayle.net/bonome](http://julienbayle.net/bonome))，一个RGB monome克隆设备时，我花了两个小时修复一个反向焊接的LED矩阵。现在，我非常了解它们，因为我有一天失败了。

最后一步是最酷的。我之所以提到它，是因为我们必须牢记最终目标，那就是最终让我们感到快乐的那个目标；这是成功的一个秘密！

# 理解Arduino软件架构

为了理解如何让我们的Arduino板正好按照我们的意愿工作，我们必须了解全局软件架构以及我们将很快使用的工具链。

拿起你的Arduino板。你会看到一个矩形形状的IC，上面写着ATMEL；这就是处理器。

这个处理器是包含我们将要编写的整个程序并使事物发生的地方。

当我们购买Arduino（请参阅*附录G，组件分销商列表*以及此链接：[http://arduino.cc/en/Main/Buy](http://arduino.cc/en/Main/Buy)）时，处理器，也称为*芯片组*，已经预先烧录。它已经被细心的人编程，以便让我们的生活更轻松。芯片组中已经包含的程序称为**引导加载程序**([http://en.wikipedia.org/wiki/Booting](http://en.wikipedia.org/wiki/Booting))。基本上，它负责处理当您给它供电时的处理器生命的第一个时刻。但它的主要作用是加载我们的固件([http://en.wikipedia.org/wiki/Firmware](http://en.wikipedia.org/wiki/Firmware))，我的意思是，我们宝贵的编译程序。

让我们看看一个小图解，以便更好地理解：

![理解Arduino软件架构](img/7584_01_004.jpg)

我喜欢通过以下方式来定义它：*引导加载程序是硬件的软件，而固件是用户的软件*。确实，它也有一些重要性，因为芯片组中的内存空间在写操作上并不相等（我们将在本书的后续章节中讨论特定的硬件）。使用**编程器**，我们无法覆盖引导加载程序（在阅读的这一点上更安全），但只能覆盖固件。即使对于高级用途，这也将绰绰有余，正如你将在整本书中看到的那样。

并非所有Arduino板上的引导加载程序都是等效的。实际上，它们被设计得非常具体，针对硬件部分，这为我们提供了更多的硬件抽象；我们可以专注于更高层次的设计，因为引导加载程序为我们提供了诸如通过USB和串行监控上传固件等服务。

现在我们下载一些必需的软件：

+   **FTDI USB驱动程序**：[http://www.ftdichip.com/Drivers/VCP.htm](http://www.ftdichip.com/Drivers/VCP.htm)

+   **Arduino IDE**：[http://arduino.cc/en/Main/Software](http://arduino.cc/en/Main/Software)

+   **Processing**：[http://processing.org/download/](http://processing.org/download/)

**Processing在本书中被使用，但不是编程和使用Arduino板所必需的**。

### 小贴士

**Arduino的工具链是什么**？

通常，我们将Arduino的**工具链**称为一组软件工具，用于处理从我们在计算机上的Arduino IDE中输入的C代码到上传到板上的固件的所有步骤。确实，你输入的C代码在编译步骤之前必须由avr-gcc和avr-g++编译器准备。一旦结果的目标文件通过工具链中的其他程序链接，通常只有一个文件，你就完成了。这可以稍后上传到板子上。还有其他使用Arduino板的方法，我们将在本书的最后一章中介绍。

# 安装Arduino开发环境（IDE）

让我们在上一部分下载的[http://arduino.cc/en/Main/Software](http://arduino.cc/en/Main/Software)中找到压缩文件，并在我们的计算机上解压缩它。

无论平台如何，IDE都同样工作，即使我将描述三个不同平台的一些特定部分，我也只会描述IDE的使用，并展示从OS X的截图。

## 安装IDE

由于它运行在**Java虚拟机**上，因此没有典型的IDE安装。这意味着你只需要下载它，将其解压缩到系统中的某个位置，然后启动它，JAVA就会执行程序。你可以只使用**CLI**（**命令行界面**，著名的g33ks窗口，你可以在其中直接向系统输入命令）来构建你的二进制文件，而不是图形界面，但在这个阶段，我不推荐这样做。

通常，Windows和OS X都预装了Java。如果没有，请从`java.com`网站页面[http://www.java.com/en/download/](http://www.java.com/en/download/)安装它。

在Linux中，这个过程实际上取决于您使用的发行版，因此我建议您查看页面[http://www.arduino.cc/playground/Learning/Linux](http://www.arduino.cc/playground/Learning/Linux)，如果您想从源代码检查和安装所有环境和依赖项，您也可以查看页面[http://www.arduino.cc/playground/Linux/All](http://www.arduino.cc/playground/Linux/All)。

## 如何启动环境？

在Windows中，请点击解压缩文件夹中包含的`.exe`文件。在OS X中，请点击带有漂亮Arduino标志的全局自包含包。在Linux中，您必须从GUI或通过在CLI中输入来启动Arduino脚本。

您必须知道，使用IDE，您可以完成本书中我们将要做的所有事情。

## IDE长什么样？

IDE提供了一个图形界面，您可以在其中编写代码、调试它、编译它，并上传它，基本上。

![IDE长什么样？](img/7584_01_005.jpg)

在Arduino IDE中打开的著名Blink代码示例

从左到右有六个图标，我们必须非常熟悉，因为我们每次都会使用它们：

+   **验证**（检查符号）：这提供了代码错误检查

+   **上传**（右侧箭头）：这编译并将我们的代码上传到Arduino板

+   **新建**（小空白页）：这创建了一个新的空白草图

+   **打开**（向上箭头）：这打开了一个列表，列出了我们草图簿中所有已存在的草图

+   **保存**（向下箭头）：这将在我们的草图簿中保存我们的草图

+   **串行监视器**（小放大镜）：这提供了串行监控功能

顶部栏中的每个菜单项都提供了我们将逐步在本书中发现更多选项。

然而，**工具**菜单值得更仔细的关注：

+   **自动格式化**: 这提供了带有正确和标准缩进的代码格式化

+   **存档草图**: 这将压缩整个当前草图及其所有文件

+   **板**: 这提供了所有支持板的列表

+   **串行端口**: 这提供了系统上所有串行设备的列表

+   **编程器**: 这提供了所有支持并用于AVR芯片组完全重新编程的编程设备的列表

+   **烧录引导加载程序**: 当您想在您的板上覆盖（甚至写入）新的引导加载程序时，请选择此选项。![IDE长什么样？](img/7584_01_006.jpg)

    工具菜单

预设对话框也是我们现在必须了解的部分。像往常一样，预设对话框是一个我们实际上并不需要经常去的地方，但只是为了更改IDE的全局参数。您可以在该对话框中选择草图簿位置和编辑器语言。您还可以更改一些设置，例如在启动时自动检查IDE更新或编辑器字体大小。

草图簿的概念会使我们的生活更简单。实际上，草图簿是一个文件夹，基本上，你所有的草图都会放在里面。从我的个人观点来看，这样使用它非常宝贵，因为它真的为你组织了东西，你可以更容易地检索你的代码片段。跟我来吧；你以后会感谢我的。

当我们从零开始创建草图时，我们基本上是输入代码，验证它，上传它，并保存它。通过第一次保存，IDE会创建一个文件夹，它将把所有与当前草图相关的文件都放在里面。点击这个文件夹内的草图文件，Arduino IDE将打开，并且相关的代码将在窗口的编辑/输入部分显示。

我们几乎完成了！

让我们在系统上安装Arduino USB接口的驱动程序。

# 安装Arduino驱动程序

Arduino板子提供了一个USB接口。在我们插入USB电缆并将板子连接到计算机之前，我们必须在计算机上安装特定的驱动程序。

在这里，Windows和OS X之间有很大的区别；基本上，OS X不需要为Arduino Uno或甚至Mega 2560安装任何特定的驱动程序。如果你使用的是较老的板子，你将不得不在FTDI网站上下载最新版本的驱动程序，双击包，然后按照说明操作，最后，重新启动你的计算机。

让我们描述一下它在基于Windows的系统上是如何工作的，我的意思是Windows 7、Vista和XP。

## 安装Arduino Uno R3的驱动程序

重要的是要遵循下面提到的步骤，才能使用Arduino Uno R3和一些其他板子。请访问Arduino网站获取最新的参考资料。

1.  插入你的板子，等待Windows开始驱动程序安装过程。几分钟后，过程失败。

1.  点击开始菜单，打开**控制面板**。

1.  在**控制面板**中，导航到**系统和安全**。然后点击**系统**。一旦**系统**窗口打开，打开**设备管理器**。

1.  在**端口（COM & LPT）**下查看。检查名为**Arduino UNO (COMxx)**的已打开端口。

1.  右键点击**Arduino UNO (COMxx)**端口，并选择**更新驱动程序软件**选项。

1.  接下来，选择**浏览计算机以查找驱动程序软件**选项。

1.  最后，导航并选择位于Arduino软件下载的`Drivers`文件夹中的名为`ArduinoUNO.inf`的驱动文件，注意：不是`FTDI USB Drivers`子目录。

1.  Windows将从那里完成驱动程序的安装，一切都会正常。

## 安装Arduino Duemilanove、Nano或Diecimilla的驱动程序

当你连接板子时，Windows应该会启动驱动程序安装过程（如果你之前没有使用过Arduino板子的话）。

在Windows Vista上，驱动程序应该会自动下载并安装。（真的，它工作得很好！）

在Windows XP上，将打开**添加新硬件向导**：

1.  当被问及**Windows是否可以连接到Windows更新以搜索软件？**时，选择**不，这次不行**。点击**下一步**。

1.  选择**从列表或指定位置安装（高级）**，然后点击**下一步**。

1.  确保已勾选**在这些位置搜索最佳驱动程序**，取消勾选**搜索可移动媒体**，勾选**将此位置包含在搜索中**，并浏览到Arduino发行版的**drivers/FTDI USB Drivers**目录。（驱动程序的最新版本可以在*FTDI*网站上找到。）点击**下一步**。

1.  向导将搜索驱动程序，然后告诉你找到了**USB串行转换器**。点击**完成**。

1.  新硬件向导将再次出现。按照相同的步骤进行，选择相同选项和位置进行搜索。这次，将找到**USB串行端口**。

你可以通过打开**Windows设备管理器**（在**系统**控制面板的**硬件**选项卡中）来检查驱动程序是否已安装。在**端口**部分查找**USB串行端口**；那就是Arduino板。

现在，我们的电脑可以识别我们的Arduino板。让我们稍微转向物理世界，将有形和无形的世界结合起来。

# 电力是什么？

Arduino全关于电子，而电子指的是电。这可能是你第一次进入这个由电线和电压组成的神奇宇宙，包括闪烁的LED和信号。我在这部分定义了几个非常有用的概念；你可以考虑将此页的角落向下折起，并在需要时随时回来。

在这里，我使用的是通常的水的类比。基本上，电线是管道，水是电本身。

## 电压

**电压**是电位差。基本上，这种差异是由发电机产生并维持的。这个值以伏特单位（符号为V）表示。

与液压系统的直接类比是将电压比作管道两点之间水的压力差。压力越高，水流动得越快，当然是在管道直径恒定的情况下。

在整本书中，我们将处理低电压，这意味着不超过5 V。很快，我们将使用12 V为电机供电，我会每次都明确指出。

当你打开闭合电路的发电机时，它会产生并保持这种电位差。电压是一个差异，必须在电路上的两点之间进行测量。我们使用电压表来测量电压。

## 电流和功率

**电流**可以与液压体积流量率相比较，这是在时间间隔内流动水的体积量。

电流值以安培（符号为A）表示。电流越高，移动的电量就越多。

流量不需要测量两点之间的压力差作为差异；我们只需要电路的一个点，就可以使用名为安培计的设备进行测量。

在我们所有的应用中，我们将处理**直流**（**DC**），这与**交流**（**AC**）不同。

**功率**是一个特定的概念，用瓦特（符号为 W）表示。

以下是电压、电流和功率之间的数学关系：

P = V x I

其中，P 是瓦特的功率，V 是伏特的电压，I 是安培的电流。

你已经感觉好多了吗？这个类比必须作为一个恰当的类比来理解，但它确实有助于理解我们稍后会做什么。

## 那么，电阻器、电容器等等是什么呢？

按照同样的类比，**电阻器**是减缓电流流动的小型组件。它们的电阻性比任何你可以使用的电线都要强；它们通常将其作为热量耗散。它们是两个无源端子组件，并且不是极化的，这意味着你可以以两个方向布线。

电阻器由其表示为欧姆（符号为 Ω）的*电阻*定义。

电阻器两侧测量的电压、电流和电阻之间存在直接的数学关系，称为欧姆定律：

R = V / I

其中 R 是欧姆的电阻，V 是伏特的电压，I 是安培的电流。

对于恒定的电压值，如果电阻高，电流就低，反之亦然。这一点很重要。

每个电阻器上都有一个颜色代码，显示其电阻值。

电阻器有很多种类型。有些具有恒定的电阻，有些则可以根据物理参数（例如温度或光强度）提供不同的电阻值。

**电位器**是一种可变电阻器。你移动滑块或旋转旋钮，电阻就会改变。我想你开始理解我的观点了…

**电容器**（或**电容器**）是另一种非常常用的组件。直接的类比是将橡胶膜放入管道中：水不能通过它，但水可以通过拉伸它移动。

它们也是无源双端子组件，但可以是极化的。通常，小电容器不是。

我们通常说电容器通过充电来储存电能。确实，当你拉伸橡胶膜时，橡胶膜本身会储存能量；试着释放拉伸的膜，它会回到最初的位置。

电容是定义每个电容器的值。它以法拉（符号为 F）表示。

我们在这里就电容计算停止，因为它涉及到高级数学，而这本书的目的不是这个。顺便说一句，记住电容越大，电容器可以储存的电能就越多。

**二极管**又是一个双端子无源组件，但它是极化的。它只允许电流单向通过它，并在另一方向阻止电流。我们将看到，即使在直流的情况下，它也可以在某些情况下帮助并使我们的电路更安全。

LED 是一种特殊的二极管。当电流以正确的方向通过它们时，它们会发光。这是一个很好的特性，我们将在几分钟内用它来检查我们的电路是否正确闭合。

**晶体管**是我在这里描述的最后一个项目，因为它稍微复杂一些，但我们不能不引用它来谈论电子学。

晶体管是半导体器件，可以根据其使用方式放大和切换电子信号和电力。它们是三端组件。这是我们周围几乎所有现代电子设备的关键活性组件。微处理器由晶体管制成，甚至可以包含超过10亿个晶体管。

在Arduino世界中，晶体管通常用于驱动高电流，如果没有烧毁Arduino板，这些电流无法通过Arduino板本身。在这种情况下，我们基本上将它们用作模拟开关。当我们需要它们关闭高电流电路以驱动电机等设备时，我们只需用来自Arduino的5V电压驱动它们的一个三端，高电流就会通过它，就像它已经闭合了电路一样。在这种情况下，它扩展了Arduino板的功能，使我们能够用我们的小块硬件驱动更高的电流。

## 连接事物和Fritzing

通过前面的类比，我们可以很好地理解电路需要闭合才能让电流流动。

电路是由导线制成的，导线基本上是导体。导体是一种电阻接近于零的物质；它使电流容易流动。金属通常是良好的导体。我们通常使用铜线。

为了使我们的布线操作简单，我们经常使用引脚和引线。这是一种不需要每次都使用烙铁就能连接事物的不错方式！

顺便说一下，有几种不同的方法可以将不同的组件连接在一起。为了我们的原型设计目的，我们不会设计印刷电路板或甚至使用我们的烙铁；我们将使用面板！

![连接事物和Fritzing](img/7584_01_007.jpg)

一个总线（bus）带有蓝色和红色的总线，以及其众多的穿孔。

面板（breadboard）是快速原型设计的方式，这也是我们在这里要采取的方式。

基本上，面板由一块塑料制成，上面有许多穿孔，其中包含小块导体，允许在面板内部连接电线和组件引脚。

两个穿孔之间的距离是2.54毫米（等于0.1英寸），这是一个标准；例如，双列直插式集成电路的引脚都是这个特定的距离，因此，你甚至可以将IC放在面板上。

正如我们在上一张截图中所看到的，有总线（bus）和端子条（terminal strips）。

**总线**是中央部分的一系列五个穿孔，并按列放置，其下方的导体是连接的。我用绿色线条包围了一个总线。

**终端**是通常用于为电路供电的特殊总线，它们出现在蓝色和红色线路之间。通常，我们用蓝色表示地线，红色表示电压源（在某些情况下为5 V或3.3 V）。一整行的终端都有其穿孔全部相连，这样在所有面包板上就可以轻松地获得电压源和地线，而无需使用大量的连接到Arduino。我围绕了4个终端中的2个用红色和蓝色线条标出。

面包板提供了一种无需焊接的简单原型制作方法。这也意味着你可以多年使用和重复使用你的面包板！

### 什么是Fritzing？

当我需要制作关于2010年我制作的Protodeck控制器([http://julienbayle.net/protodeck](http://julienbayle.net/protodeck))的第一次大师班幻灯片原理图工具时，我发现了开源的**Fritzing**项目([http://fritzing.org](http://fritzing.org))。

Fritzing被定义为*一个开源倡议，旨在支持设计师、艺术家、研究人员和爱好者以创造性的方式与交互式电子设备一起工作*。听起来就像是为我们量身定做的，不是吗？

你可以在[http://fritzing.org/download/](http://fritzing.org/download/)找到Fritzing的最新版本。

基本上，使用Fritzing，你可以设计和绘制电子电路。因为电子电路有许多表示方式，这个宝贵的工具提供了两种经典的表示方式，以及一个PCB设计工具。

考虑到我们将要做的第一个实际工作，你必须拿出你的面包板、Arduino，并将引线和电阻连接得与下一张截图所示完全一致：

![什么是Fritzing?](img/7584_01_008.jpg)

显示我们第一个电路的面包板视图

**面包板视图**看起来最像我们在桌子上面前的东西。你代表所有电线，并将虚拟面包板连接到你的Arduino，并直接插入组件。

魔法在于，当你正在面包板视图中绘制草图时，原理图会自动构建。而且它是双向的！你可以制作一个原理图，Fritzing会在面包板视图中连接组件。当然，你可能需要将部件放置在更方便或美观的位置，但它工作得非常完美。特别是，**自动布线器**可以帮助你使所有电线更加线性简单。

在下一张截图，你可以看到与之前相同的电路，但以*原理图视图*显示：

![什么是Fritzing?](img/7584_01_009.jpg)

表示电路图的原理图视图

已经有许多为Fritzing特别设计的组件，你甚至可以非常容易地创建自己的组件。访问此目的的页面是[http://fritzing.org/parts/](http://fritzing.org/parts/)。

本地库包含本书中所有Arduino板、任何离散元件和IC所需的所有部件。确实，本书的所有原理图都是使用Fritzing制作的！

现在你已经知道如何在不使用烙铁的情况下接线，以及如何在将实物连接到桌面之前，在你的电脑上安静地绘制和检查事物，让我们学习一些关于电源供应的知识。

## 电源供应基础

我们之前学了一些关于电的知识，但如何在现实生活中为所有电路供电呢？

Arduino板可以通过三种不同的方式供电：

+   通过电脑的USB线缆（提供5 V电压）

+   通过电池或直接的外部**电源供应单元**（**PSU**）/适配器

+   通过将稳压5 V连接到+5 V引脚

USB线缆包含四根线：两根用于数据通信，两根用于电源供应。后两根主要用于当你通过USB将Arduino连接到电脑时为Arduino供电。

USB是一种特殊的通信总线，提供5 V电压，但不超过500 mA（0.5 A）。这意味着在需要大量LED、电机和其他大量电流驱动设备的特殊项目中，我们必须使用另一个电源来源。

### 提示

**我可以使用什么适配器与我的Arduino一起使用？**

Arduino Uno和Mega可以直接通过直流适配器供电，但这个适配器*必须*符合一些特性：

+   输出电压应在9 V到12 V之间。

+   它应该能够驱动至少250 mA的电流。

+   它必须有一个2.1毫米的电源插头，中心为正极。

通常，如果你在考虑是否使用适配器，这意味着你需要比USB的500 mA更多的电流（实际上，问自己这个问题是否需要大约400 mA）。

使用USB或2.1毫米电源插头加适配器是使用Arduino板最安全的方式，原因有很多。最主要的是这两个来源（希望）是干净的，这意味着它们提供的是稳压电压。

然而，如果你想使用其中一个来源，你必须在板上做一些更改：跳线必须移动到正确的位置：

![电源供应基础](img/7584_01_015.jpg)

在左侧，跳线设置为USB电源供电，在右侧，它设置为外部电源供电。

通常，一个空闲的Arduino板大约消耗100 mA的电流，除非在特定情况下（见[第9章](ch09.html "第9章. 使事物移动和创造声音")，*使事物移动和创造声音*），我们将使用USB供电方式。现在你必须这样做：将USB线缆同时插入Arduino和你的电脑。

启动Arduino IDE，然后让我们进一步了解我们系统的硬件*Hello World*，我称之为*Hello LED*！

## 嘿，LED！

如果你的Arduino没有固件，LED可能不会做任何事。如果你检查Arduino板上的内置LED，那个应该会闪烁。

让我们控制一下现在插在面包板上的外部可爱LED。

### 我们到底想做什么？

如果你记得正确，这是我们首先要问的第一个问题。当然，我们绕过了这个步骤，特别是关于硬件的部分，因为我不得不在你接线的时候解释事情，但让我们继续通过检查代码和上传来继续原型制作过程。

我们想让我们的LED闪烁。但是闪烁速度是多少？多长时间？让我们说我们想让它在每250ms闪烁一次，闪烁之间有1秒的暂停。并且我们想无限期地这样做。

如果你检查了电路图，你可以理解LED被放置在地线和数字输出引脚8之间。

有一个电阻，你现在知道它可以通过抵抗流向LED的电流来消耗一点能量。我们可以说电阻保护了我们的LED。

为了让LED发光，我们必须创建一个电流流。将+5V发送到数字输出8可以实现这一点。这样，LED的两个引脚之间将会有电位差，使其发光。但是数字输出不应该每次都处于+5V。我们必须控制它提供这种电压的时刻。还正常吗？

让我们总结一下我们需要做什么：

1.  在250ms内将5V加到数字输出8上。

1.  停止驱动数字输出8 1秒。

1.  每次Arduino上电时都重新启动

### 我该如何使用C代码做到这一点？

如果你正确地遵循了上一页的说明，你已经在你的Arduino板上通过USB线连接到电脑的一侧，并通过面包板连接到另一侧。

现在，启动你的Arduino IDE。

#### 从一个新的空白页面开始

如果你已经通过加载一些示例或编写一些代码测试了你的IDE，你必须点击**新建图标**来加载一个空白页面，准备容纳我们的`Blink250ms`代码：

![从一个新的空白页面开始](img/7584_01_012.jpg)

一个漂亮且吸引人的空白页面

#### 根据我们使用的板设置环境

IDE必须知道它将使用哪个板进行通信。我们将在以下步骤中完成：

1.  前往**工具**菜单并选择正确的板。第一个是**Arduino Uno**：![根据我们使用的板设置环境](img/7584_01_013.jpg)

    选择你正在使用的板

1.  一旦我们完成了这个步骤，我们就必须选择正确的串行端口。再次转到**工具**菜单并选择正确的串行端口：

    +   在OS X上，正确的端口对于Uno和Mega 2560开始于**/dev/tty.usbmodem**，对于较老的板则是**/dev/tty.usbserial**。

    +   在Windows上，正确的端口通常是**COM3**（**COM1**和**COM2**通常被操作系统保留）。顺便说一句，它也可以是**COM4**、**COM5**或任何其他端口。为了确保，请检查设备管理器。

    +   在Linux上，端口通常是**/dev/ttyUSB0**：

    ![根据我们使用的板设置环境](img/7584_01_014.jpg)

    选择与你的板对应的串行端口

现在，我们的IDE可以与我们的板通信。让我们现在推送代码。

#### 让我们编写代码

以下为完整代码。你可以在`Chapter01/Blink250ms/`文件夹中的zip文件中找到它：

### 小贴士

**下载示例代码**

你可以从你购买的所有Packt书籍的账户中下载示例代码文件。[http://www.packtpub.com](http://www.packtpub.com)。如果你在其他地方购买了这本书，你可以访问[http://www.packtpub.com/support](http://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给你。

[PRE0]

让我们给它加一点注释。确实，我们将在下一章学习如何编写自己的C代码，然后我将只描述这个，并给你一些小贴士。

首先，所有在`/*`和`*/`之间的内容，以及所有在`//`之后的内容，都只是注释。第一种形式用于一次注释多行，而另一种形式用于单行注释。你可以写任何这样的注释，并且它们不会被编译器考虑。我强烈建议你注释你的代码；这是成功的另一个关键。

然后，代码的第一部分包含一个变量声明和初始化：

[PRE1]

然后，我们可以在花括号之间看到两个特定的结构：

[PRE2]

第一个（`setup()`）是一个函数，当Arduino板启动（或重置）时只执行一次；这是我们告诉板子连接LED的引脚是输出引脚的地方，也就是说，当激活时，这个引脚将必须驱动电流。

第二个（`loop()`）是一个函数，当Arduino板供电时无限执行。这是我们代码的主要部分，其中我们可以找到我们想要点亮LED 250毫秒并关闭LED 1秒的步骤，重复进行。

### 最后，让我们上传代码！

如果你正确地按照之前解释的方式操作了硬件和IDE，我们现在已经准备好将代码上传到板上。

只需在IDE中点击上传按钮。你会看到TX和RX LED灯微微闪烁……你的面包板上的LED灯应该按照预期闪烁。这是我们非常第一个 *HELLO LED!* 示例，希望你喜欢。

如果你想要稍微调整一下代码，你可以替换以下行：

[PRE3]

例如，用以下行：

[PRE4]

现在再次上传这段新代码，看看会发生什么。

# 摘要

在本章中，我们了解了一些关于Arduino和微控制器，以及关于电的知识。这将在我们将在下一章中大量讨论电路的章节中帮助我们。

我们还安装了我们将每次编程Arduino板时都会使用的IDE，甚至测试了第一段代码。我们现在可以通过学习更多关于C语言本身的内容来继续我们的旅程。
