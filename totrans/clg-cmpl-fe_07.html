<html><head></head><body>
<div id="book-content" class="calibre2">
<div id="sbo-rt-content" class="calibre3"><section id="chapter-5-clang-tidy-linter-framework" class="level" data-number="2.1">
<h1 data-number="2.1" class="calibre5"><span>5</span></h1>
<h1 id="sigil_toc_id_82" class="calibre5"><a id="x1-990005" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Clang-Tidy Linter Framework</h1>
<p class="hidden">This chapter introduces Clang-Tidy, the clang-based linter framework that utilizes the <strong class="calibre12">Abstract Syntax Tree </strong>(<strong class="calibre12">AST</strong>) to <a id="dx1-99001" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>identify anti-patterns in C/C++/Objective-C code. First, we’ll discuss Clang-Tidy’s capabilities, the types of checks it offers, and how to use them. After that, we will delve into the architecture of Clang-Tidy and explore how to create our own custom lint check. In this chapter, we’ll cover the following topics:</p>
<ul class="calibre6">
<li class="calibre14"><p class="calibre15">An overview of Clang-Tidy, including a brief description of the different checks provided by default</p></li>
<li class="calibre14"><p class="calibre15">The internal design of Clang-Tidy</p></li>
<li class="calibre14"><p class="calibre15">How to create a custom Clang-Tidy check</p></li>
</ul>
<p class="hidden"><a id="x1-99002r302" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<section id="technical-requirements-4" class="level" data-number="2.1.1">
<h2 data-number="2.1.1" id="sigil_toc_id_83" class="likechapterhead"><span>5.1 </span> <a id="x1-1000001" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Technical requirements</h2>
<p class="hidden">The source code for this chapter is located in the <code class="calibre13">chapter5 </code>folder of the book’s GitHub repository: <a href="https://github.com/PacktPublishing/Clang-Compiler-Frontend-Packt/tree/main/chapter5" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">https://github.com/PacktPublishing/Clang-Compiler-Frontend-Packt/tree/main/chapter5</a>. <a id="x1-100001r305" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
</section>
<section id="overview-of-clang-tidy-and-usage-examples" class="level" data-number="2.1.2">
<h2 data-number="2.1.2" id="sigil_toc_id_84" class="likechapterhead"><span>5.2 </span> <a id="x1-1010002" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Overview of Clang-Tidy and usage examples</h2>
<p class="hidden">Clang-Tidy is a linter and static analysis tool for C and C++ code. It is a part of the Clang and LLVM project. The tool is <a id="dx1-101001" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>built on top of the Clang frontend, which means it understands your code in depth, giving it the ability to <a id="dx1-101002" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>catch a wide range of issues.</p>
<p class="hidden">Here are some key points to understand about Clang-Tidy:</p>
<ul class="calibre6">
<li class="calibre14"><p class="calibre15"><strong class="calibre12">Checks</strong>: Clang-Tidy contains a series of ”checks” that identify various issues or suggest enhancements. These checks range from performance improvements and potential bugs to coding style and modern C++ best practices. For instance, it might suggest using <span><code class="calibre13">emplace_back</code></span> instead of <span><code class="calibre13">push_back</code></span> for certain cases or identify areas where you might be accidentally using integer overflow.</p></li>
<li class="calibre14"><p class="calibre15"><strong class="calibre12">Extensibility</strong>: New checks can be added to Clang-Tidy, making it a highly extensible tool. If you have specific coding guidelines or practices you want to enforce, you can write a check for it.</p></li>
<li class="calibre14"><p class="calibre15"><strong class="calibre12">Integration</strong>: Clang-Tidy is often used within CI/CD pipelines or integrated with development environments. Many IDEs support Clang-Tidy directly or via plugins, so you can get real-time feedback on your code as you write it.</p></li>
<li class="calibre14"><p class="calibre15"><strong class="calibre12">Automatic fixes</strong>: One of the powerful features of Clang-Tidy is its ability to not only identify issues but also automatically fix many of them. This is done with the <code class="calibre13">-fix </code>option. It is, however, important to review the proposed changes, as automatic fixes might not always be perfect.</p></li>
<li class="calibre14"><p class="calibre15"><strong class="calibre12">Configuration</strong>: You can configure which checks Clang-Tidy performs using a configuration file or command-line options. This allows teams to enforce specific coding standards or <a id="dx1-101003" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>prioritize certain types of issues. For example, the <code class="calibre13">-checks=’-*,modernize-*’ </code>command-line option will <a id="dx1-101004" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>disable all checks but not the checks from modernize set.</p></li>
<li class="calibre14"><p class="calibre15"><strong class="calibre12">Modern C++ best practices</strong>: One of the often-appreciated features of Clang-Tidy is its emphasis on modern C++ idioms and best practices. It can guide developers to write safer, more performant, and more idiomatic C++ code.</p></li>
</ul>
<p class="hidden">After acquiring basic knowledge about Clang-Tidy, let’s examine how it can be built. <a id="x1-101005r287" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<section id="building-and-testing-clang-tidy" class="level" data-number="2.1.2.1">
<h3 data-number="2.1.2.1" id="sigil_toc_id_85" class="likesectionhead"><span>5.2.1 </span> <a id="x1-1020001" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Building and testing Clang-Tidy</h3>
<p class="hidden">We will use the basic build configuration specified in <a href="B19722_01.xhtml#x1-27004r4" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 1.4</a> and build Clang-Tidy with the following Ninja command:</p>
<pre id="verbatim-74" class="console">$ ninja clang-tidy</pre>
<p class="hidden"><a id="x1-102001r1" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-102002" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.1</strong>: Using the Ninja command to build Clang-Tidy </p>
<p class="hidden">We can install the Clang-Tidy <a id="dx1-102003" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>binary to the designated <code class="calibre13">install </code>folder using the following command:</p>
<pre id="verbatim-75" class="console">$ ninja install-clang-tidy</pre>
<p class="hidden"><a id="x1-102004r2" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-102005" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.2</strong>: Using the Ninja command to install Clang-Tidy </p>
<p class="hidden">Using the <a id="dx1-102006" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>build configuration from <a href="B19722_01.xhtml#x1-27004r4" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 1.4</a>, the command will install the Clang-Tidy binary under the <code class="calibre13">&lt;...&gt;/llvm-project/install/bin </code>folder. Here, <code class="calibre13">&lt;...&gt;/llvm-project </code>refers to the path where the LLVM code base was cloned (see <a href="B19722_01.xhtml#x1-25005r1" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 1.1</a>).</p>

<p class="hidden"><span>Important note</span></p>

<p class="hidden">If you use a build configuration with shared libraries (with the <code class="calibre13">BUILD</code><code class="calibre13">_SHARED</code><code class="calibre13">_LIBS </code>flag set to <code class="calibre13">ON </code>), as shown in <a href="B19722_01.xhtml#x1-30003r12" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 1.12</a>, then you might need to install and built all artifacts with <code class="calibre13">ninja</code> <code class="calibre13">install </code>.</p>

<p class="hidden">Clang-Tidy is part of Clang-Tools-Extra, and its tests are a part of the <code class="calibre13">clang-tools </code>CMake target. Thus, we can run the tests with the following command:</p>
<pre id="verbatim-76" class="console">$ ninja check-clang-tools</pre>
<p class="hidden"><a id="x1-102007r3" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-102008" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.3</strong>: Using the Ninja command to run Clang-Tidy tests </p>
<p class="hidden">The command will run LIT tests (see <a href="B19722_04.xhtml#x1-830002" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"><em class="calibre11">Section</em><em class="calibre11"> 4.5.2</em></a><em class="calibre11">, LLVM test</em> <em class="calibre11">framework</em>) for all Clang-Tidy checks, and will also run unit <a id="dx1-102009" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>tests for the Clang-Tidy core system. You can also run a specific LIT test separately; for example, if we <a id="dx1-102010" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>want to run the LIT test for the <code class="calibre13">modernize-loop-convert </code>check, we can use the following command:</p>
<pre id="verbatim-77" class="console">$ cd &lt;...&gt;/llvm-project
$ build/bin/llvm-lit -v \
clang-tools-extra/test/clang-tidy/checkers/modernize/loop-convert-basic.cpp</pre>
<p class="hidden"><a id="x1-102011r4" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-102012" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.4</strong>: Testing the modernize-loop-convert clang-tidy check </p>
<p class="hidden">The command will produce the following output:</p>
<pre id="verbatim-78" class="console">-- Testing: 1 tests, 1 workers --
PASS: Clang Tools :: clang-tidy/checkers/modernize/loop-convert-basic.cpp
(1 of 1)

Testing Time: 1.38s
  Passed: 1</pre>
<p class="hidden"><a id="x1-102013r5" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-102014" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.5</strong>: LIT test output for the cppcoreguidelines-owning-memory clang-tidy check </p>
<p class="hidden">After building and testing Clang-Tidy, it’s now time to run it on some code examples. <a id="x1-102015r307" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
</section>
<section id="clang-tidy-usage" class="level" data-number="2.1.2.2">
<h3 data-number="2.1.2.2" id="sigil_toc_id_86" class="likesectionhead"><span>5.2.2 </span> <a id="x1-1030002" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Clang-Tidy usage</h3>
<p class="hidden">To test Clang-Tidy, we will <a id="dx1-103001" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>use the following test program:</p>
<pre class="source-code"><span>1 </span>#include &lt;iostream&gt; 
 
<span>2 </span>#include &lt;vector&gt; 
 
<span>3 </span> 
 

<span>4 </span>int main() { 
 
<span>5 </span>  std::vector&lt;int&gt; numbers = {1, 2, 3, 4, 5}; 
 

<span>6 </span>  for (std::vector&lt;int&gt;::iterator it = numbers.begin(); it != numbers.end(); 
 

<span>7 </span>       ++it) { 
 
<span>8 </span>    std::cout &lt;&lt; *it &lt;&lt; std::endl; 
 

<span>9 </span>  } 
 
<span>10 </span>  return 0; 
 
<span>11 </span>}</pre>
<p class="hidden"><a id="x1-103014r6" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-103015" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.6</strong>: Test program for Clang-Tidy: loop-convert.cpp </p>
<p class="hidden">The program is correctly written in the older C++ code style, that is, before C++11. Clang-Tidy has a set of checks <a id="dx1-103016" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>that encourage adopting the modern C++ code style and using new C++ idioms available in the latest C++ standard. These checks can be run on the program as follows:</p>
<pre id="listing-38" class="source-code">1$ &lt;...&gt;/llvm-project/install/bin/clang-tidy \ 
 

<span>2 </span>  -checks=’-*,modernize-*’               \ 
 

<span>3 </span>  loop-convert.cpp                       \ 
 

<span>4 </span>  -- -std=c++17</pre>
<p class="hidden"><a id="x1-103021r7" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-103022" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.7</strong>: Running Clang-Tidy modernize checks on loop-convert.cpp </p>
<p class="hidden">The most important parts of <a href="#x1-103021r7" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 5.7</a> are as follows:</p>
<ul class="calibre6">
<li class="calibre14"><p class="calibre15"><em class="calibre11">Line 1</em>: The path to the Clang-Tidy binary is specified here.</p></li>
<li class="calibre14"><p class="calibre15"><em class="calibre11">Line 2</em>: We remove all checks using the ’<code class="calibre13">-* </code>’ option. Then, we enable all checks with the ’<code class="calibre13">modernize </code>’ prefix by using the ’<code class="calibre13">-*,modernize-*</code> ’ value for the ’<code class="calibre13">--checks </code>’ argument.</p></li>
<li class="calibre14"><p class="calibre15"><em class="calibre11">Line 3</em>: We specify the path to the code to be tested.</p></li>
<li class="calibre14"><p class="calibre15"><em class="calibre11">Line 4</em>: We pass additional arguments to the compiler, notably specifying that we want the compiler to use C++17 as the C++ standard.</p></li>
</ul>
<p class="hidden">The output of the program will be as follows:</p>
<pre id="verbatim-79" class="console">loop-convert.cpp:4:5: warning: use a trailing return type for this function
...
    4 | int main() {
      | ~~~ ^
      | auto       -&gt; int
loop-convert.cpp:6:3: warning: use range-based for loop instead
[modernize-loop-convert]
    6 |   for (std::vector&lt;int&gt;::iterator it = numbers.begin();
          it != numbers.end();
      |   ^   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      |       (int &amp; number : numbers)
    7 |        ++it) {
      |        ~~~~~
    8 |     std::cout &lt;&lt; *it &lt;&lt; std::endl;
      |                  ~~~
      |                  number
loop-convert.cpp:6:8: warning: use auto when declaring iterators
[modernize-use-auto]
    6 |   for (std::vector&lt;int&gt;::iterator it = numbers.begin();
          it != numbers.end();</pre>
<pre id="verbatim-80" class="console">      |        ^
note: this fix will not be applied because it overlaps with another fix
</pre>
<p class="hidden"><a id="x1-103023r8" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-103024" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.8</strong>: Output from running Clang-Tidy on loop-convert.cpp </p>
<p class="hidden">As we can see, several <a id="dx1-103025" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>issues were detected, and Clang-Tidy suggested some fixes. Unfortunately, some of them conflict with each other, especially <code class="calibre13">modernize-loop-convert </code>and <code class="calibre13">modernize-use-auto </code>, and cannot be applied together. On the other hand, we can apply the fix suggested by <code class="calibre13">modernize-loop-convert </code>by running only this specific check to avoid any conflicts, as follows:</p>
<pre id="listing-39" class="source-code">1$ &lt;...&gt;/llvm-project/install/bin/clang-tidy \ 
 

<span>2 </span>  -checks=’-*,modernize-loop-convert’    \ 
 

<span>3 </span>  -fix                                  \ 
 

<span>4 </span>  loop-convert.cpp                       \ 
 

<span>5 </span>  -- -std=c++17</pre>
<p class="hidden"><a id="x1-103031r9" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-103032" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.9</strong>: Running a modernize-loop-convert check on loop-convert.cpp </p>
<p class="hidden">As we can see, the second line <a id="dx1-103033" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>has changed compared to <a href="#x1-103021r7" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 5.7</a>, and another line (3) has been added. The latter instructs Clang-Tidy to apply the fixes suggested by the check. The resulting code can be found in the original file:</p>
<pre class="source-code"><span>1 </span>#include &lt;iostream&gt; 
 
<span>2 </span>#include &lt;vector&gt; 
 
<span>3 </span> 
 

<span>4 </span>int main() { 
 

<span>5 </span>  std::vector&lt;int&gt; numbers = {1, 2, 3, 4, 5}; 
 

<span>6 </span>  for (int &amp; number : numbers) { 
 

<span>7 </span>    std::cout &lt;&lt; number &lt;&lt; std::endl; 
 
<span>8 </span>  } 
 

<span>9 </span>  return 0; 
 
<span>10 </span>}</pre>
<p class="hidden"><a id="x1-103045r10" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-103046" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.10</strong>: Fixed test program for Clang-Tidy: loop-convert.cpp </p>
<p class="hidden">As we can see, <em class="calibre11">Lines 6 </em>and <em class="calibre11">7 </em>have changed compared to the original code from <a href="#x1-103014r6" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 5.6</a>. This functionality makes Clang-Tidy a powerful tool that can not only detect issues but also fix them. We will explore this possibility in greater depth later in <a href="B19722_07.xhtml#x1-1410003" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"><em class="calibre11">Section</em><em class="calibre11"> 7.3</em></a><em class="calibre11">, Clang-Tidy as a code modification</em> <em class="calibre11">tool</em>. <a id="x1-103047r313" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
</section>
<section id="clang-tidy-checks" class="level" data-number="2.1.2.3">
<h3 data-number="2.1.2.3" id="sigil_toc_id_87" class="likesectionhead"><span>5.2.3 </span> <a id="x1-1040003" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Clang-Tidy checks</h3>
<p class="hidden">Clang-Tidy has a wide variety of checks grouped into different categories. Here’s a concise list of some of the main categories, with an <a id="dx1-104001" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>example check from each and a brief description:</p>
<ol class="calibre6">
<li class="calibre7"><div id="x1-104003x1" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">boost-*</strong>:</p>
<ul class="calibre9">
<li class="calibre7"><p class="calibre15"><code class="calibre13">boost-use-to-string</code>: Suggests replacing <code class="calibre13">boost::lexical</code><code class="calibre13">_cast&lt;std:</code> <code class="calibre13">:string&gt; </code>with <code class="calibre13">boost::to</code><code class="calibre13">_string</code></p></li>
</ul>
</div></li>
<li class="calibre7"><div id="x1-104005x2" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">bugprone-*</strong>:</p>
<ul class="calibre9">
<li class="calibre7"><p class="calibre15"><code class="calibre13">bugprone-integer-division</code>: Warns when integer division in a floating-point context is likely to cause unintended loss of precision</p></li>
</ul>
</div></li>
<li class="calibre7"><div id="x1-104007x3" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">cert-* </strong>(Checks related to the CERT C++ Secure Coding Standard):</p>
<ul class="calibre9">
<li class="calibre7"><p class="calibre15"><code class="calibre13">cert-dcl03-c</code>: Ensures that macros are not used in unsafe contexts</p></li>
</ul>
</div></li>
<li class="calibre7"><div id="x1-104009x4" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">cppcoreguidelines-* </strong>(Checks from C++ Core Guidelines):</p>
<ul class="calibre9">
<li class="calibre7"><p class="calibre15"><code class="calibre13">cppcoreguidelines-slicing</code>: Warns on slicing (object slicing, where a derived object is assigned to a base object, cutting off the derived parts)</p></li>
</ul>
</div></li>
<li class="calibre7"><div id="x1-104011x5" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">google-* </strong>(Google’s coding conventions):</p>
<ul class="calibre9">
<li class="calibre7"><p class="calibre15"><code class="calibre13">google-build-using-namespace</code>: Flags using-directives</p></li>
</ul>
</div></li>
<li class="calibre7"><div id="x1-104013x6" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">llvm-* </strong>(LLVM coding conventions):</p>
<ul class="calibre9">
<li class="calibre7"><p class="calibre15"><code class="calibre13">llvm-namespace-comment</code>: Ensures that namespaces have closing comments</p></li>
</ul>
</div></li>
<li class="calibre7"><div id="x1-104015x7" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">misc-* </strong>(Miscellaneous checks):</p>
<ul class="calibre9">
<li class="calibre7"><p class="calibre15"><code class="calibre13">misc-unused-parameters</code>: Flags parameters that are unused</p></li>
</ul>
</div></li>
<li class="calibre7"><div id="x1-104017x8" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">modernize-* </strong>(Modernization checks for C++):</p>
<ul class="calibre9">
<li class="calibre7"><p class="calibre15"><code class="calibre13">modernize-use-auto</code>: Recommends the use of <code class="calibre13">auto </code>for variable declarations when appropriate</p></li>
</ul>
</div></li>
<li class="calibre7"><div id="x1-104019x9" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">performance-*</strong>:</p>
<ul class="calibre9">
<li class="calibre7"><p class="calibre15"><code class="calibre13">performance-faster-string-find</code>: Suggests faster alternatives for string searching</p></li>
</ul>
</div></li>
<li class="calibre7"><div id="x1-104021x10" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">readability-*</strong>:</p>
<ul class="calibre9">
<li class="calibre7"><p class="calibre15"><code class="calibre13">readability-identifier-naming</code>: Ensures consistent identifier naming</p></li>
</ul>
</div></li>
</ol>
<p class="hidden">This list is just a representation of a <a id="dx1-104022" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>subset of the checks available. Each category contains multiple checks, and there are additional categories in the tool as well. For a complete, up-to-date list of checks and their detailed descriptions, refer to the official Clang-Tidy documentation [<a href="B19722_Bib.xhtml#Xllvm_clang_tidy" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">17</a>] or use the <code class="calibre13">clang-tidy -list-checks</code> command on your system.</p>
<p class="hidden">After learning how to build and use clang-tidy, it’s time to delve deeper and examine its internal design. <a id="x1-104023r306" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
</section>
</section>
<section id="clang-tidys-internal-design" class="level" data-number="2.1.3">
<h2 data-number="2.1.3" id="sigil_toc_id_88" class="likechapterhead"><span>5.3 </span> <a id="x1-1050003" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Clang-Tidy’s internal design</h2>
<p class="hidden">Clang-Tidy is built on top of Clang. At its core, Clang-Tidy leverages Clang’s ability to parse and analyze source code into an AST. Each check in Clang-Tidy essentially involves defining patterns or conditions to <a id="dx1-105001" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>match against this AST. When a match is found, a diagnostic can be raised, and in many cases, an automatic fix can be suggested. The tool operates on the basis of individual ”checks” that target specific issues or coding styles. Checks are implemented as plugins, making Clang-Tidy extensible. The <code class="calibre13">ASTMatchers </code>library facilitates writing these checks by providing a domain-specific language to query the AST; see <a href="B19722_03.xhtml#x1-630005" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"><em class="calibre11">Section</em><em class="calibre11"> 3.5</em></a><em class="calibre11">, AST matchers</em> and the official documentation [<a href="B19722_Bib.xhtml#Xllvm_astmatchers" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">16</a>] for more info. This ensures that checks are both concise and expressive. Clang-Tidy also has support for analyzing the code base using a compilation database, which provides context such as compile flags (see <a href="B19722_09.xhtml#x1-1810009" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"><em class="calibre11">Chapter</em><em class="calibre11"> 9</em></a><em class="calibre11">, Appendix 1: Compilation Database</em> for more info). This comprehensive integration with Clang’s internals makes Clang-Tidy a powerful static analysis tool with precise code transformation capabilities. <a id="x1-105002r321" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<section id="internal-organization" class="level" data-number="2.1.3.1">
<h3 data-number="2.1.3.1" id="sigil_toc_id_89" class="likesectionhead"><span>5.3.1 </span> <a id="x1-1060001" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Internal organization</h3>
<p class="hidden">The internal organization of clang-tidy <a id="dx1-106001" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>within the Clang code base can be complex due to its deep integration with the Clang libraries, but at a high level, the organization can be broken down as follows:</p>
<ol class="calibre6">
<li class="calibre7"><div id="x1-106003x1" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">Source and headers</strong>: The main source code and headers for <code class="calibre13">clang-tidy </code>are located in the <code class="calibre13">clang-tools-extra </code>repository, specifically within the <code class="calibre13">clang-tidy </code>directory.</p>
</div></li>
<li class="calibre7"><div id="x1-106005x2" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">Main driver</strong>: The <code class="calibre13">ClangTidyMain.cpp </code>file, located in the <code class="calibre13">tool</code> subfolder, serves as the main driver for the Clang-Tidy tool.</p>
</div></li>
<li class="calibre7"><div id="x1-106007x3" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">Core infrastructure</strong>: Files such as <code class="calibre13">ClangTidy.cpp </code>, <code class="calibre13">ClangTidy.h</code> manage the core functionalities and options.</p>
</div></li>
<li class="calibre7"><div id="x1-106009x4" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">Checks</strong>: Checks are organized into subdirectories based on categories (e.g., <code class="calibre13">bugprone </code>or <code class="calibre13">modernize </code>).</p>
</div></li>
<li class="calibre7"><div id="x1-106011x5" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">Utilities</strong>: The <code class="calibre13">utils </code>directory contains utility classes and functions.</p>
</div></li>
<li class="calibre7"><div id="x1-106013x6" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">AST Matchers</strong>: The <code class="calibre13">ASTMatchers </code>library, which we explored previously in <a href="B19722_03.xhtml#x1-630005" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"><em class="calibre11">Section</em><em class="calibre11"> 3.5</em></a><em class="calibre11">, AST matchers</em>, is integral for querying the AST.</p>
</div></li>
<li class="calibre7"><div id="x1-106015x7" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">Clang diagnostics</strong>: Clang-Tidy actively uses the Clang diagnostics subsystem to print diagnostics messages and suggest fixes (see <a href="B19722_04.xhtml#x1-800002" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"><em class="calibre11">Section</em><em class="calibre11"> 4.4.2</em></a><em class="calibre11">, Diagnostics support</em>).</p>
</div></li>
<li class="calibre7"><div id="x1-106017x8" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">Tests</strong>: Tests are located in the <code class="calibre13">test </code>directory and use LLVM’s LIT framework (see <a href="B19722_04.xhtml#x1-830002" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"><em class="calibre11">Section</em><em class="calibre11"> 4.5.2</em></a><em class="calibre11">, LLVM test framework</em>). It’s worth noting that the test folder is shared with other projects inside the <code class="calibre13">clang-tools-extra </code>folder.</p>
</div></li>
<li class="calibre7"><div id="x1-106019x9" class="tableofcontents">
<p class="calibre15"><strong class="calibre12">Documentation</strong>: The <code class="calibre13">docs </code>directory contains documentation for Clang-Tidy. As well as the tests, the documentation is a part of other projects inside the <code class="calibre13">clang-tools-extra </code>folder.</p>
</div></li>
</ol>
<p class="hidden">These relationships are schematically illustrated in the following figure:</p>
<div class="tableofcontents">
<div class="tableofcontents">
<img src="../media/Figure5.11_B19722.png" alt="Figure 5.11: Clang-Tidy’s internal organization " class="calibre35"/>
</div>
<p class="hidden"><strong class="calibre12">Figure 5.11</strong>: Clang-Tidy’s internal organization </p>
</div>
<p class="hidden">Now that we have gained an understanding of Clang-Tidy’s internals and its relationship with other parts of Clang/LLVM, it’s time to <a id="dx1-106022" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>explore components external to the Clang-Tidy binary: its configuration and other tools that leverage the functionality provided by Clang-Tidy. <a id="x1-106023r323" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
</section>
<section id="configuration-and-integration" class="level" data-number="2.1.3.2">
<h3 data-number="2.1.3.2" id="sigil_toc_id_90" class="likesectionhead"><span>5.3.2 </span> <a id="x1-1070002" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Configuration and integration</h3>
<p class="hidden">The Clang-Tidy <a id="dx1-107001" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>binary can interact with <a id="dx1-107002" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>other components, as shown in <a href="#Figure5.12" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 5.12</a>.</p>
<div class="tableofcontents">
<div class="tableofcontents">
<img src="../media/Figure5.12_B19722.png" alt="Figure 5.12: Clang-Tidy external components: configuration and integrations " class="calibre38"/>
</div>
<p class="hidden"><span id="Figure5.12"><strong class="calibre12">Figure 5.12</strong>: </span>Clang-Tidy external components: configuration and integrations </p>
</div>
<p class="hidden">Clang-Tidy can be seamlessly integrated with various <strong class="calibre12">Integrated Development</strong> <strong class="calibre12">Environments </strong>(<strong class="calibre12">IDEs</strong>), such as Visual <a id="dx1-107005" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Studio Code, CLion, and Eclipse, to provide real-time feedback during coding. We will explore this possibility later in <a href="B19722_08.xhtml#x1-1700002" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"><em class="calibre11">Section</em><em class="calibre11"> 8.5.2</em></a><em class="calibre11">, Clang-Tidy</em>.</p>
<p class="hidden">It can also be incorporated into build systems such as CMake and Bazel to run checks during builds. <strong class="calibre12">Continuous Integration </strong>(<strong class="calibre12">CI</strong>) platforms, such as <a id="dx1-107006" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Jenkins and GitHub Actions, often employ Clang-Tidy to <a id="dx1-107007" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>ensure code quality on pull requests. Code review platforms, such as Phabricator, utilize Clang-Tidy for automated reviews. Additionally, custom scripts and static analysis <a id="dx1-107008" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>platforms can harness Clang-Tidy’s capabilities for tailored workflows and combined analyses.</p>
<p class="hidden">Another important part of Clang-Tidy shown in <a href="#Figure5.12" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 5.12</a> is its configuration. Let’s explore it in detail.</p>
<section id="clang-tidy-configuration" class="level" data-number="2.1.3.2.1">
<h4 data-number="2.1.3.2.1" class="sigil_not_in_toc"><a id="x1-1080002" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Clang-Tidy configuration</h4>
<p class="hidden">Clang-Tidy uses a configuration file to specify which checks to run and to set options for those checks. This configuration is done using a <code class="calibre13">.clang-tidy</code> file.</p>
<p class="hidden">The <code class="calibre13">.clang-tidy </code>file is written in YAML format. It typically contains two main keys: <code class="calibre13">Checks </code>and <code class="calibre13">CheckOptions </code>.</p>
<p class="hidden">We will begin with the <code class="calibre13">Checks </code>key, which allows us to specify which checks to enable or disable:</p>
<ul class="calibre6">
<li class="calibre14"><p class="calibre15">Use - to disable a check</p></li>
<li class="calibre14"><p class="calibre15">Use * as a wildcard to match multiple checks</p></li>
<li class="calibre14"><p class="calibre15">Checks are comma-separated</p></li>
</ul>
<p class="hidden">Here’s an example:</p>
<pre id="listing-40" class="source-code">1  Checks: ’-*,modernize-*’</pre>
<p class="hidden"><a id="x1-108002r13" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-108003" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.13</strong>: Checks key of a .clang-tidy config file </p>
<p class="hidden">The next key is <code class="calibre13">CheckOptions </code>. This key allows us to set options for specific checks, with each option specified as a key-value pair. An example is provided here:</p>
<pre id="listing-41" class="source-code">1CheckOptions: 
 

<span>2 </span>  - key: readability-identifier-naming.NamespaceCase 
 

<span>3 </span>   value: CamelCase 
 

<span>4 </span>  - key: readability-identifier-naming.ClassCase 
 

<span>5 </span>   value: CamelCase</pre>
<p class="hidden"><a id="x1-108009r14" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-108010" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.14</strong>: CheckOptions key of a .clang-tidy config file </p>
<p class="hidden">When Clang-Tidy is run, it searches for the <code class="calibre13">.clang-tidy </code>file in the directory of the file being processed and its <a id="dx1-108011" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>parent directories. The search stops when the file is found.</p>
<p class="hidden">Now that we have an understanding of Clang-Tidy’s internal design, it’s time to create our first custom Clang-Tidy check using the information we’ve gathered from this and previous chapters of the book. <a id="x1-108012r322" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
</section>
</section>
</section>
<section id="custom-clang-tidy-check" class="level" data-number="2.1.4">
<h2 data-number="2.1.4" id="sigil_toc_id_91" class="likechapterhead"><span>5.4 </span> <a id="x1-1090004" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Custom Clang-Tidy check</h2>
<p class="hidden">In this part of the chapter, we will transform our plugin example (see <a href="B19722_04.xhtml#x1-840006" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"><em class="calibre11">Section</em><em class="calibre11"> 4.6</em></a><em class="calibre11">, Clang plugin project</em>) into a Clang-Tidy check. This <a id="dx1-109001" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>check will estimate the complexity of a C++ class based on the number of methods it contains. We will define a threshold as a parameter for the check.</p>
<p class="hidden">Clang-Tidy offers a tool designed to aid in the creation of checks. Let’s begin by creating a skeleton for our check. <a id="x1-109002r325" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<section id="creating-a-skeleton-for-the-check" class="level" data-number="2.1.4.1">
<h3 data-number="2.1.4.1" id="sigil_toc_id_92" class="likesectionhead"><span>5.4.1 </span> <a id="x1-1100001" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Creating a skeleton for the check</h3>
<p class="hidden">Clang-Tidy provides a <a id="dx1-110001" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>specific Python script, <code class="calibre13">add</code><code class="calibre13">_new</code><code class="calibre13">_check.py </code>, to assist in creating new checks. This script is located in the <code class="calibre13">clang-tools-extra/clang-tidy</code> directory. The script requires two positional parameters:</p>
<ul class="calibre6">
<li class="calibre14"><p class="calibre15"><code class="calibre13">module </code>: This refers to the module directory where the new tidy check will be placed. In our case, this will be <code class="calibre13">misc </code>.</p></li>
<li class="calibre14"><p class="calibre15"><code class="calibre13">check </code>: This is the name of the new tidy check to add. For our purposes, we will name it <code class="calibre13">classchecker </code>.</p></li>
</ul>
<p class="hidden">By running the script in the <code class="calibre13">llvm-project </code>directory (which contains the cloned LLVM repository), we receive the following output:</p>
<pre id="verbatim-81" class="console">$ ./clang-tools-extra/clang-tidy/add_new_check.py misc classchecker
...
Updating ./clang-tools-extra/clang-tidy/misc/CMakeLists.txt...
Creating ./clang-tools-extra/clang-tidy/misc/ClasscheckerCheck.h...
Creating ./clang-tools-extra/clang-tidy/misc/ClasscheckerCheck.cpp...
Updating ./clang-tools-extra/clang-tidy/misc/MiscTidyModule.cpp...
Updating clang-tools-extra/docs/ReleaseNotes.rst...
Creating clang-tools-extra/test/clang-tidy/checkers/misc/classchecker.cpp...
Creating clang-tools-extra/docs/clang-tidy/checks/misc/classchecker.rst...
Updating clang-tools-extra/docs/clang-tidy/checks/list.rst...</pre>
<pre id="verbatim-82" class="console">Done. Now it’s your turn!
</pre>
<p class="hidden"><a id="x1-110002r15" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-110003" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.15</strong>: Creating a skeleton for the misc-classchecker check </p>
<p class="hidden">From the output, we can observe <a id="dx1-110004" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>that several files under the <code class="calibre13">clang-tools-extra/</code> <code class="calibre13">clang-tidy </code>directory have been updated. These files pertain to checks registration, such as <code class="calibre13">misc/MiscTidyModule.cpp </code>, or build configuration, such as <code class="calibre13">misc/CMakeLists.txt</code> . The script also generated several new files, which we need to modify in order to implement our check’s desired logic:</p>
<ul class="calibre6">
<li class="calibre14"><p class="calibre15"><code class="calibre13">misc/ClasscheckerCheck.h </code>: This is the header file for our check</p></li>
<li class="calibre14"><p class="calibre15"><code class="calibre13">misc/ClasscheckerCheck.cpp </code>: This file will house the implementation of our check</p></li>
</ul>
<p class="hidden">Additionally, the script has generated a LIT test for our check, named <code class="calibre13">ClassChecker.cpp.</code> This test can be found in the <code class="calibre13">clang-tools-extra/test/clang-tidy/checkers/misc</code> directory.</p>
<p class="hidden">Apart from the source files, the script also modifies some documentation files in the <code class="calibre13">clang-tools-extra/docs </code>directory:</p>
<ul class="calibre6">
<li class="calibre14"><p class="calibre15"><code class="calibre13">ReleaseNotes.rst </code>: This file contains updated <a id="dx1-110005" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>release notes with placeholder entries for our new check</p></li>
<li class="calibre14"><p class="calibre15"><code class="calibre13">clang-tidy/checks/misc/classchecker.rst </code>: This serves as the primary documentation for our check</p></li>
<li class="calibre14"><p class="calibre15"><code class="calibre13">clang-tidy/checks/list.rst </code>: The list of checks has been updated to include our new check alongside other checks from the ’<code class="calibre13">misc </code>’ module</p></li>
</ul>
<p class="hidden">We will now turn our attention to implementing the check and the subsequent build process. <a id="x1-110006r331" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
</section>
<section id="clang-tidy-check-implementation" class="level" data-number="2.1.4.2">
<h3 data-number="2.1.4.2" id="sigil_toc_id_93" class="likesectionhead"><span>5.4.2 </span> <a id="x1-1110002" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Clang-Tidy check implementation</h3>
<p class="hidden">We’ll begin by modifying <code class="calibre13">ClasscheckerCheck.cpp </code>. The generated file can be found in the <code class="calibre13">clang-tools-extra/clang-tidy/misc </code>directory. Let’s <a id="dx1-111001" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>replace the generated code with the following (note: the generated comment containing the license info has been omitted for brevity):</p>
<pre class="source-code"><span>1 </span>#include "ClasscheckerCheck.h" 
 

<span>2 </span>#include "clang/AST/ASTContext.h" 
 

<span>3 </span>#include "clang/ASTMatchers/ASTMatchFinder.h" 
 

<span>4 </span>using namespace clang::ast_matchers; 
 

<span>5 </span> 
 
<span>6 </span>namespace clang::tidy::misc { 
 

<span>7 </span>void ClasscheckerCheck::registerMatchers(MatchFinder *Finder) { 
 

<span>8 </span>    // Match every C++ class. 
 
<span>9 </span>    Finder-&gt;addMatcher(cxxRecordDecl().bind("class"), this); 
 

<span>10 </span>} 
 
<span>11 </span>void ClasscheckerCheck::check(const MatchFinder::MatchResult &amp;Result) { 
 

<span>12 </span>    const auto *ClassDecl = Result.Nodes.getNodeAs&lt;CXXRecordDecl&gt;("class"); 
 

<span>13 </span>    if (!ClassDecl || !ClassDecl-&gt;isThisDeclarationADefinition()) 
 

<span>14 </span>        return; 
 
<span>15 </span>    unsigned MethodCount = 0; 
 

<span>16 </span>    for (const auto *D : ClassDecl-&gt;decls()) { 
 

<span>17 </span>        if (isa&lt;CXXMethodDecl&gt;(D)) 
 

<span>18 </span>            MethodCount++; 
 
<span>19 </span>    } 
 
<span>20 </span>    unsigned Threshold = Options.get("Threshold", 5); 
 

<span>21 </span>    if (MethodCount &gt; Threshold) { 
 

<span>22 </span>        diag(ClassDecl-&gt;getLocation(), 
 

<span>23 </span>             "class %0 is too complex: method count = %1", 
 

<span>24 </span>             DiagnosticIDs::Warning) 
 

<span>25 </span>            &lt;&lt; ClassDecl-&gt;getName() &lt;&lt; MethodCount; 
 

<span>26 </span>    } 
 
<span>27 </span>} 
 
<span>28 </span>} // namespace clang::tidy::misc</pre>
<p class="hidden"><a id="x1-111031r16" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-111032" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.16</strong>: Modifications to ClasscheckerCheck.cpp </p>
<p class="hidden">We replaced the original stub with <em class="calibre11">Lines 15-35 </em>to implement the necessary changes.</p>
<p class="hidden">To integrate our check into the Clang-Tidy binary, we can execute the standard build procedure from the <code class="calibre13">build </code>directory within the LLVM source tree; see <a href="#x1-102004r2" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 5.2</a>.</p>
<p class="hidden">The name of our check is <a id="dx1-111033" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>defined in the modified <code class="calibre13">MiscTidyModule.cpp </code>file in <code class="calibre13">clang-tools-extra/clang-tidy/misc </code>folder:</p>
<pre class="source-code"><span>40 </span>class MiscModule : public ClangTidyModule { 
 

<span>41 </span>public: 
 
<span>42 </span>  void addCheckFactories(ClangTidyCheckFactories &amp;CheckFactories) override { 
 

<span>43 </span>    CheckFactories.registerCheck&lt;ClasscheckerCheck&gt;( 
 

<span>44 </span>        "misc-classchecker"); 
 
<span>45 </span>    CheckFactories.registerCheck&lt;ConfusableIdentifierCheck&gt;( 
 

<span>46 </span>        "misc-confusable-identifiers");</pre>
<p class="hidden"><a id="x1-111042r17" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-111043" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.17</strong>: Modifications to MiscTidyModule.cpp </p>
<p class="hidden">As illustrated in <a href="#x1-111042r17" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 5.17</a> (<em class="calibre11">Lines 43-44</em>), we registered the new check under the name <span><code class="calibre13">"</code><code class="calibre13">misc</code><code class="calibre13">-</code><code class="calibre13">classchecker</code><code class="calibre13">"</code></span>. After the code modification, we are ready to recompile Clang-Tidy with</p>
<pre id="verbatim-83" class="console">$ ninja install</pre>
<p class="hidden">We can verify that the check has been added by executing Clang-Tidy with the <code class="calibre13">-list-checks </code>argument as follows:</p>
<pre id="verbatim-84" class="console">&lt;...&gt;/llvm-project/install/bin/clang-tidy -checks ’*’ -list-checks
...
    misc-classchecker
...</pre>
<p class="hidden"><a id="x1-111044r18" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-111045" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.18</strong>: Clang-Tidy <code class="calibre13">-list-checks </code>option </p>
<p class="hidden">It’s worth noting that we enabled all checks using the <code class="calibre13">-checks ’*’ </code>command-line option, as shown in <a href="#x1-111044r18" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 5.18</a>.</p>
<p class="hidden">To test the check, we can use the file from the clang plugin project, as seen in <a href="B19722_04.xhtml#x1-91014r39" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 4.39</a>:</p>
<pre class="source-code"><span>1 </span>class Simple { 
 
<span>2 </span>public: 
 
<span>3 </span>  void func1() {} 
 

<span>4 </span>  void func2() {} 
 
<span>5 </span>  void func3() {} 
 
<span>6 </span>};</pre>
<p class="hidden"><a id="x1-111053r19" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-111054" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.19</strong>: Test file for the misc-classchecker clang-tidy check: test.cpp </p>
<p class="hidden">This file contains <a id="dx1-111055" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>three methods. To trigger a warning, we must set the threshold to 2, as demonstrated:</p>
<pre id="listing-42" class="source-code">1$ &lt;...&gt;/llvm-project/install/bin/clang-tidy                           \ 
 

<span>2 </span>  -checks=’-*,misc-classchecker’                                      \ 
 

<span>3 </span>  -config="{CheckOptions: [{key:misc-classchecker.Threshold, value:’2’}]}"\ 
 

<span>4 </span>  test.cpp                                                           \ 
 

<span>5 </span>  -- -std=c++17</pre>
<p class="hidden"><a id="x1-111061r20" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-111062" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.20</strong>: Run a misc-classchecker check on the test file: test.cpp </p>
<p class="hidden">The output will be as follows:</p>
<pre id="verbatim-85" class="console">test.cpp:1:7: warning: class Simple is too complex: method count = 3
[misc-classchecker]
class Simple {
      ^</pre>
<p class="hidden"><a id="x1-111063r21" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-111064" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.21</strong>: Output of the misc-classchecker check for the test.cpp test file </p>
<p class="hidden">After testing the file with custom source code, it’s time to create an LIT test for our check. <a id="x1-111065r333" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
</section>
<section id="lit-test" class="level" data-number="2.1.4.3">
<h3 data-number="2.1.4.3" id="sigil_toc_id_94" class="likesectionhead"><span>5.4.3 </span> <a id="x1-1120003" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>LIT test</h3>
<p class="hidden">For the LIT test, we will use the <a id="dx1-112001" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>slightly modified <a id="dx1-112002" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>code from <a href="B19722_04.xhtml#x1-93048r43" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 4.43</a>. Let’s modify <code class="calibre13">classchecker.cpp </code>, located in the <code class="calibre13">clang-tools-extra/test/clang-tidy/checkers/misc </code>folder, as follows:</p>
<pre class="source-code"><span>1 </span>// RUN: %check_clang_tidy %s misc-classchecker %t 
 

<span>2 </span> 
 
<span>3 </span>class Simple { 
 
<span>4 </span>public: 
 
<span>5 </span>  void func1() {} 
 

<span>6 </span>  void func2() {} 
 
<span>7 </span>}; 
 
<span>8 </span> 
 
<span>9 </span>// CHECK-MESSAGES: :[[LINE+1]]:{{[0-9]+}}: warning: class Complex is too complex: method count = 6 [misc-classchecker] 
 




<span>10 </span>class Complex { 
 
<span>11 </span>public: 
 
<span>12 </span>  void func1() {} 
 

<span>13 </span>  void func2() {} 
 
<span>14 </span>  void func3() {} 
 

<span>15 </span>  void func4() {} 
 
<span>16 </span>  void func5() {} 
 

<span>17 </span>  void func6() {} 
 
<span>18 </span>};</pre>
<p class="hidden"><a id="x1-112022r22" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-112023" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.22</strong>: LIT test: classchecker.cpp </p>
<p class="hidden">As we can see, the only difference compared to <a href="B19722_04.xhtml#x1-93048r43" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 4.43</a> is in <em class="calibre11">Line 1</em>, where we specify which commands should be run, and in <em class="calibre11">Line 9</em>, where we define the test pattern.</p>
<p class="hidden">We can run the test as follows:</p>
<pre id="verbatim-86" class="console">$ cd &lt;...&gt;/llvm-project
$ build/bin/llvm-lit -v \
  clang-tools-extra/test/clang-tidy/checkers/misc/classchecker.cpp</pre>
<p class="hidden"><a id="x1-112024r23" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-112025" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.23</strong>: Testing the misc-classchecker clang-tidy check </p>
<p class="hidden">The <a id="dx1-112026" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>command produces <a id="dx1-112027" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>the following output:</p>
<pre id="verbatim-87" class="console">-- Testing: 1 tests, 1 workers --
PASS: Clang Tools :: clang-tidy/checkers/misc/classchecker.cpp (1 of 1)

Testing Time: 0.12s
  Passed: 1</pre>
<p class="hidden"><a id="x1-112028r24" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-112029" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.24</strong>: Testing output for misc-classchecker </p>
<p class="hidden">We can also use the command shown in <a href="#x1-102007r3" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 5.3</a> to run all clang-tidy checks, including our newly added one.</p>
<p class="hidden">When we run our check on a real code base, as opposed to synthetic tests, we may encounter unexpected results. One such issue has already been discussed in <a href="B19722_03.xhtml#x1-650007" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"><em class="calibre11">Section</em><em class="calibre11"> 3.7</em></a><em class="calibre11">, Processing AST in the case of errors</em> and pertains to the impact of compilation errors on Clang-Tidy results. Let’s delve into this problem using a specific example. <a id="x1-112030r343" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
</section>
<section id="results-in-the-case-of-compilation-errors" class="level" data-number="2.1.4.4">
<h3 data-number="2.1.4.4" id="sigil_toc_id_95" class="likesectionhead"><span>5.4.4 </span> <a id="x1-1130004" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Results in the case of compilation errors</h3>
<p class="hidden">Clang-Tidy uses AST as the information provider for checks, and the checks can produce wrong results if <a id="dx1-113001" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>the information source is broken. The typical case is when the analyzed code has compilation errors (see <a href="B19722_03.xhtml#x1-650007" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"><em class="calibre11">Section</em><em class="calibre11"> 3.7</em></a><em class="calibre11">, Processing AST in the case of errors</em>).</p>
<p class="hidden">Consider the following code as an example:</p>
<pre class="source-code"><span>1 </span>class MyClass { 
 
<span>2 </span>public: 
 
<span>3 </span>  void doSomething(); 
 
<span>4 </span>}; 
 

<span>5 </span> 
 
<span>6 </span>void MyClass::doSometing() {}</pre>
<p class="hidden"><a id="x1-113009r25" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-113010" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.25</strong>: Test file with compilation errors: error.cpp </p>
<p class="hidden">In the example, we made a <a id="dx1-113011" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>syntax error in <em class="calibre11">Line 6</em>: the method name is incorrectly written as ’doSometing’ instead of ’doSomet<strong class="calibre12">h</strong>ing’. If we run our check on the file without any parameters, we will receive the following output:</p>
<pre id="verbatim-88" class="console">error.cpp:1:7: warning: class MyClass is too complex: method count = 7
[misc-classchecker]
class MyClass {
      ^
error.cpp:6:15: error: out-of-line definition of ’doSometing’ ...
[clang-diagnostic-error]
void MyClass::doSometing() {}
              ^~~~~~~~~~
              doSomething
error.cpp:3:8: note: ’doSomething’ declared here
  void doSomething();
       ^
Found compiler error(s).</pre>
<p class="hidden"><a id="x1-113012r26" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-113013" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.26</strong>: Running a misc-classchecker check on a file containing compilation errors </p>
<p class="hidden">Our check seems to be working incorrectly with this code. It assumes the class has seven methods when, in fact, it has only one.</p>
<p class="hidden">The case of compilation errors can be considered an edge case, and we can process it correctly. Before addressing these cases, we should investigate the produced AST to examine the issue. <a id="x1-113014r348" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
</section>
<section id="compilation-errors-as-edge-cases" class="level" data-number="2.1.4.5">
<h3 data-number="2.1.4.5" id="sigil_toc_id_96" class="likesectionhead"><span>5.4.5 </span> <a id="x1-1140005" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Compilation errors as edge cases</h3>
<p class="hidden">Let’s use <code class="calibre13">clang-query </code>(see <a href="B19722_03.xhtml#x1-640006" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"><em class="calibre11">Section</em><em class="calibre11"> 3.6</em></a><em class="calibre11">, Explore Clang AST with</em> <em class="calibre11">clang-query</em>) to explore what has happened with the AST. The program <a id="dx1-114001" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>with the error fixed is shown in the following figure:</p>
<pre class="source-code"><span>1 </span>class MyClass { 
 
<span>2 </span>public: 
 
<span>3 </span>  void doSomething(); 
 
<span>4 </span>}; 
 

<span>5 </span> 
 
<span>6 </span>void MyClass::doSomething() {}</pre>
<p class="hidden"><a id="x1-114009r27" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-114010" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.27</strong>: noerror.cpp test file with compilation errors fixed </p>
<p class="hidden">The <code class="calibre13">clang-query </code>command can be run on the file as follows:</p>
<pre id="verbatim-89" class="console">$ &lt;...&gt;/llvm-project/install/bin/clang-query noerror.cpp -- --std=c++17</pre>
<p class="hidden"><a id="x1-114011r28" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-114012" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.28</strong>: Clang-Query run on noerror.cpp file with compilation errors fixed </p>
<p class="hidden">Then, we will set up Clang-Query’s output as <code class="calibre13">dump </code>and find all matches for <code class="calibre13">CXXRecordDecl</code></p>
<pre id="verbatim-90" class="console">clang-query&gt; set output dump
clang-query&gt; match cxxRecordDecl()</pre>
<p class="hidden"><a id="x1-114013r29" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-114014" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.29</strong>: Setup Clang-Query output and run matchers </p>
<p class="hidden">The result is shown below</p>
<pre id="verbatim-91" class="console">Match #1:

Binding for "root":
CXXRecordDecl ... &lt;noerror.cpp:1:1, line:4:1&gt; line:1:7 class MyClass
definition
|-DefinitionData ...
| |-DefaultConstructor exists trivial ...
| |-CopyConstructor simple trivial ...
| |-MoveConstructor exists simple trivial ...
| |-CopyAssignment simple trivial ...
| |-MoveAssignment exists simple trivial ...
| ‘-Destructor simple irrelevant trivial ...
|-CXXRecordDecl ... &lt;col:1, col:7&gt; col:7 implicit class MyClass
|-AccessSpecDecl ... &lt;line:2:1, col:7&gt; col:1 public
‘-CXXMethodDecl ... &lt;line:3:3, col:20&gt; col:8 doSomething ’void ()’
...</pre>
<p class="hidden"><a id="x1-114015r30" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-114016" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.30</strong>: AST for the noerror.cpp file with compilation errors fixed </p>
<p class="hidden">Compare it with the output for the <a id="dx1-114017" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>code with an error (see <a href="#x1-113009r25" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 5.25</a>). We run Clang-Query on the error.cpp file and set up the required matcher as follows</p>
<pre id="verbatim-92" class="console">$ &lt;...&gt;/llvm-project/install/bin/clang-query error.cpp -- --std=c++17
clang-query&gt; set output dump
clang-query&gt; match cxxRecordDecl()</pre>
<p class="hidden"><a id="x1-114018r31" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-114019" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.31</strong>: Clang-Query run on error.cpp </p>
<p class="hidden">The found match is shown below:</p>
<pre id="verbatim-93" class="console">CXXRecordDecl ... &lt;error.cpp:1:1, line:4:1&gt; line:1:7 class MyClass
definition
|-DefinitionData ...
| |-DefaultConstructor exists trivial ...
| |-CopyConstructor simple trivial ..
| |-MoveConstructor exists simple trivial
| |-CopyAssignment simple trivial ...
| |-MoveAssignment exists simple trivial
| ‘-Destructor simple irrelevant trivial
|-CXXRecordDecl ... &lt;col:1, col:7&gt; col:7 implicit class MyClass
|-AccessSpecDecl ... &lt;line:2:1, col:7&gt; col:1 public
|-CXXMethodDecl ... &lt;line:3:3, col:20&gt; col:8 doSomething ’void ()’
|-CXXConstructorDecl ... &lt;line:1:7&gt; col:7 implicit constexpr MyClass
’void ()’ ...
|-CXXConstructorDecl ... &lt;col:7&gt; col:7 implicit constexpr MyClass
’void (const MyClass &amp;)’ ...
| ‘-ParmVarDecl ... &lt;col:7&gt; col:7 ’const MyClass &amp;’
|-CXXMethodDecl ... &lt;col:7&gt; col:7 implicit constexpr operator= ’MyClass
&amp;(const MyClass &amp;)’ inline default trivial ...
| ‘-ParmVarDecl ... &lt;col:7&gt; col:7 ’const MyClass &amp;’
|-CXXConstructorDecl ... &lt;col:7&gt; col:7 implicit constexpr MyClass ’void
(MyClass &amp;&amp;)’ ...
| ‘-ParmVarDecl ... &lt;col:7&gt; col:7 ’MyClass &amp;&amp;’
|-CXXMethodDecl ... &lt;col:7&gt; col:7 implicit constexpr operator= ’MyClass
&amp;(MyClass &amp;&amp;)’ ...
| ‘-ParmVarDecl ... &lt;col:7&gt; col:7 ’MyClass &amp;&amp;’
                                                                     

                                                                     
‘-CXXDestructorDecl ... &lt;col:7&gt; col:7 implicit ~MyClass ’void ()’ inline
default ...
...
</pre>
<p class="hidden"><a id="x1-114020r32" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-114021" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.32</strong>: AST for the error.cpp file with a compilation error </p>
<p class="hidden">As we can see, all additional methods are added implicitly. We can exclude them by modifying <em class="calibre11">Line 30 </em>(see <a href="#x1-111031r16" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">Figure 5.16</a>) of our check code, as shown:</p>
<pre class="source-code"><span>29 </span>    for (const auto *D : ClassDecl-&gt;decls()) { 
 

<span>30 </span>      if (isa&lt;CXXMethodDecl&gt;(D) &amp;&amp; !D-&gt;isImplicit()) 
 

<span>31 </span>            MethodCount++; 
 
<span>32 </span>    }</pre>
<p class="hidden"><a id="x1-114027r33" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-114028" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.33</strong>: Exclude implicit declaration from the check report </p>
<p class="hidden">If we run the modified check on the <a id="dx1-114029" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>file that contains compilation errors, we will get the following output:</p>
<pre id="verbatim-94" class="console">error.cpp:6:15: error: out-of-line definition of ’doSometing’ ...
[clang-diagnostic-error]
void MyClass::doSometing() {}
              ^~~~~~~~~~
              doSomething
error.cpp:3:8: note: ’doSomething’ declared here
  void doSomething();
       ^
Found compiler error(s).</pre>
<p class="hidden"><a id="x1-114030r34" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/> <a id="x1-114031" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
<p class="hidden"><strong class="calibre12">Figure 5.34</strong>: Running a fixed misc-classchecker check on a file containing compilation errors </p>
<p class="hidden">As we can see, the compiler error is reported, but our check does not trigger any warnings.</p>
<p class="hidden">Despite the fact that we correctly processed the unusual clang-tidy result, it’s worth noting that not every compilation error can be correctly processed. As mentioned in <a href="B19722_03.xhtml#x1-650007" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"><em class="calibre11">Section</em><em class="calibre11"> 3.7</em></a><em class="calibre11">, Processing AST in the case of errors</em>, the Clang compiler tries to produce an AST even when encountering compilation errors. This approach is because it’s designed for use by IDEs and other tools that benefit from as much information as possible, even in the presence of errors. However, this ”error-recovery” mode of the AST can produce structures that Clang-Tidy <a id="dx1-114032" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>might not anticipate. Therefore, we should adhere to the following rule:</p>

<p class="hidden"><span>Tip</span></p>

<p class="hidden">Always ensure your code compiles without errors before running Clang-Tidy and other Clang Tools. This guarantees that the AST is both accurate and complete.</p>

<p class="hidden"><a id="x1-114033r330" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
</section>
</section>
<section id="summary-4" class="level" data-number="2.1.5">
<h2 data-number="2.1.5" id="sigil_toc_id_97" class="likechapterhead"><span>5.5 </span> <a id="x1-1150005" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Summary</h2>
<p class="hidden">In this chapter, we delved into Clang-Tidy, a robust tool for code analysis. We explored its configuration, execution, and internal architecture. Additionally, we developed a custom Clang-Tidy check to assess class complexity. Our check utilized basic AST matchers, akin to regular expressions within the AST. For complexity determination, we employed a simple method. More sophisticated metrics, such as cyclomatic complexity, demand tools such as <strong class="calibre12">Control Flow Graphs </strong>(<strong class="calibre12">CFGs</strong>). The adventure continues in the next chapter, where we’ll dive deep into designing intricate checks using CFG. <a id="x1-115001r363" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
</section>
<section id="further-reading-4" class="level" data-number="2.1.6">
<h2 data-number="2.1.6" id="sigil_toc_id_98" class="likechapterhead"><span>5.6 </span> <a id="x1-1160006" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/>Further reading</h2>
<ul class="calibre6">
<li class="calibre14"><p class="calibre15">Clang-Tidy extra Clang tools documentation: <a href="https://clang.llvm.org/extra/clang-tidy/" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">https://clang.llvm.org/extra/clang-tidy/</a></p></li>
<li class="calibre14"><p class="calibre15">AST matcher reference: <a href="https://clang.llvm.org/docs/LibASTMatchersReference.html" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8">https://clang.llvm.org/docs/LibASTMatchersReference.html</a></p></li>
</ul>
<p class="hidden"><a id="x1-116001r304" class="pcalibre1 pcalibre2 pcalibre3 pcalibre calibre8"/></p>
</section>
</section>
</div>
</div>
</body></html>