<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Setting Up Your C Compiler on Windows</h1>
                </header>
            
            <article>
                
<p>Microsoft Windows is one of the most popular desktop operating systems.</p>
<p>Before beginning, I highly recommend that you install <strong>7-Zip</strong> from <a href="https://www.7-zip.org">https://www.7-zip<span>.org</span></a><span>/. 7-Zip will allow you to extract the various compression archive formats that library source code is</span> distributed<span> in.</span></p>
<p class="mce-root">Let's continue and get MinGW, OpenSSL, and <kbd>libssh</kbd> set up on Windows 10.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Installing MinGW GCC</h1>
                </header>
            
            <article>
                
<p>MinGW is a port of GCC to Windows. It is the compiler we recommend for this book.</p>
<p>You can obtain MinGW from <a href="http://www.mingw.org/">http://www.mingw.org/</a>. Find the download link on that page and download and run the <strong>MinGW Installation Manager</strong> (<strong>mingw-get</strong>).</p>
<p>The MinGW Installation Manager is a GUI tool for installing MinGW. It's shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/84679923-d996-454e-914b-7077bac444c6.png" style="width:37.92em;height:29.25em;"/></p>
<p>Click <span class="packt_screen">Install</span>. Then, click <span class="packt_screen">Continue</span>. Wait while some files download, and then click <span class="packt_screen">Continue</span> once again.</p>
<p>At this point, the tool will give you a list of packages that you can install. You need to mark <span class="packt_screen">mingw32-base-bin</span>, <span class="packt_screen">msys-base-bin</span>, and <span class="packt_screen">mingw32-gcc-g++-bin</span> for installation. This is shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/0c4584f0-3672-41e6-912d-ca2c5e8311da.png" style="width:40.08em;height:22.92em;"/></p>
<p>You will also want to select the <span class="packt_screen">mingw32-libz-dev</span> package. It is listed under the <span class="packt_screen">MinGW Libraries</span> section. The following screenshot shows this selection:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/f80d717a-c480-4811-b918-af1b220e155a.png" style="width:40.17em;height:23.00em;"/></p>
<p>The <kbd>g++</kbd> and <kbd>libz</kbd> packages we've selected are required for building <kbd>libssh</kbd> later.</p>
<p>When you're ready to proceed, click <span class="packt_screen">Installation</span> from the menu and select <span class="packt_screen">Apply Changes</span>.</p>
<p>A new dialog will show the changes to be made. The following screenshot shows what this dialog may look like:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/8e98f21f-e4d0-442c-9707-f5d06334bdcc.png" style="width:42.92em;height:28.58em;"/></p>
<p>Click the <span class="packt_screen">Apply</span> button to download and install the packages. Once the installation is complete, you can close the <span class="packt_screen">MinGW Installation Manager</span>.</p>
<p>To be able to use MinGW from the command line<span> </span><span>easily</span><span>, you will need to add MinGW to your</span> <kbd>PATH</kbd><span>.</span></p>
<p>The steps for adding MinGW to your <kbd>PATH</kbd> are as follows:</p>
<ol>
<li>Open the <span class="packt_screen">System</span> control panel (Windows key + <em>Pause</em>/<em>Break</em>).</li>
<li>Select <span class="packt_screen">Advanced system settings</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/e776b32e-ffa4-4c58-a8f4-878ebfc15151.png" style="width:44.25em;height:37.17em;"/></p>
<ol start="3">
<li>From the <span class="packt_screen">System Properties</span> window, navigate to the <span class="packt_screen">Advanced</span> tab and click the <span class="packt_screen">Environment Variables...</span> button:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/c57bf130-4e24-406a-90f1-4733d447a8da.png" style="width:27.08em;height:30.75em;"/></p>
<ol start="4">
<li>From this screen, find the <kbd>PATH</kbd> variable under <span class="packt_screen">System variables</span>. Select it and press <strong>Edit...</strong>.</li>
<li>Click <span class="packt_screen">New</span> and type in the MinGW path—<kbd>C:\mingw\bin</kbd>, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/9f990d51-0b4b-4e7a-ad35-55e58858f68e.png" style="width:30.67em;height:29.08em;"/></p>
<ol start="6">
<li>Click <span class="packt_screen">OK</span> to save your changes.</li>
</ol>
<p>Once MinGW has been added to your <kbd>PATH</kbd>, you can open a new command window and enter <kbd>gcc --version</kbd> to ensure that <kbd>gcc</kbd> has been installed correctly. This is shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/0558634c-758f-49ab-ac91-9ad356da1c56.png" style="width:42.58em;height:12.17em;"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Installing Git</h1>
                </header>
            
            <article>
                
<p>You will need to have the<span> </span><kbd>git</kbd><span> </span>version control software installed to download this book's code.</p>
<p><kbd>git</kbd> is available from <a href="https://git-scm.com/download">https://git-scm.com/download</a>. A handy GUI-based installer is provided, and you shouldn't have any issues getting it working. When installing, be sure to check the option for adding <kbd>git</kbd> to your <kbd>PATH</kbd>. This is shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/f0b7a8df-4d1e-45fa-bc23-fb303a42bf62.png" style="width:31.17em;height:24.25em;"/></p>
<p>After <kbd>git</kbd> has finished installing, you can test it by opening a new command window and entering <kbd>git --version</kbd>:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/5ad52e29-8376-4e11-8232-5d6ff30c9744.png" style="width:31.17em;height:10.25em;"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Installing OpenSSL</h1>
                </header>
            
            <article>
                
<p>The OpenSSL library can be tricky to get going on Windows.</p>
<p>If you are brave, you can obtain the OpenSSL library source code directly from <a href="https://www.openssl.org/source/">https://www.openssl.org/source/</a>. You will, of course, need to build OpenSSL before it can be used. Building OpenSSL is not easy, but instructions are provided in the<span> </span><kbd>INSTALL</kbd><span> and <kbd>NOTES.WIN</kbd> </span>files included with the OpenSSL source code.</p>
<p>An easier alternative is to install prebuilt OpenSSL binaries. You can find a list of prebuilt OpenSSL binaries from the OpenSSL wiki at <a href="https://wiki.openssl.org/index.php/Binaries">https://wiki.openssl.org/index.php/Binaries</a>. You will need to locate binaries that match your operating system and compiler. Installing them will be a matter of copying the relevant files to the MinGW <kbd>include</kbd>, <kbd>lib</kbd>, and <kbd>bin</kbd> directories.</p>
<p>The following screenshot shows a binary OpenSSL distribution. The <kbd>include</kbd> and <kbd>lib</kbd> folders should be copied over to <kbd>c:\mingw\</kbd> and merged with the existing folders, while <kbd>openssl.exe</kbd> and the two DLL files need to be placed in <kbd>c:\mingw\bin\</kbd>:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/f9238f39-e6e9-4b9c-a17a-1e9b05038b65.png" style="width:47.83em;height:30.17em;"/></p>
<p>You can try building <kbd>openssl_version.c</kbd> from <a href="47ba170d-42d9-4e38-b5d8-89503e005708.xhtml">Chapter 9</a>, <em>Loading Secure Web Pages with HTTPS and OpenSSL</em>, to test that everything is installed correctly. It should look like the following:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/b798e570-c39f-4c2f-a3cd-62b920b3e749.png" style="width:54.00em;height:19.50em;"/></p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Installing libssh</h1>
                </header>
            
            <article>
                
<p>You can obtain the latest <kbd>libssh</kbd> library from <a href="https://www.libssh.org/">https://www.libssh.org/</a>. If you are proficient in installing C libraries, feel free to give it a go. Otherwise, read on for step-by-step instructions.</p>
<p>Before beginning, be sure that you've first installed the OpenSSL libraries successfully. These are required by the <kbd>libssh</kbd> library.</p>
<p>We will need CMake installed in order to build <kbd>libssh</kbd>. You can obtain CMake from <a href="https://cmake.org/">https://cmake.org/</a>. They provide a nice GUI installer, and you shouldn't run into any difficulties. Make sure you select the option to add CMake to your <kbd>PATH</kbd> during installation:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/e80c6ca3-2751-432e-a3b5-afdf77b81058.png" style="width:32.25em;height:25.25em;"/></p>
<p>Once you have the CMake tool and the OpenSSL libraries installed, navigate to the <kbd>libssh</kbd> website to download the <kbd>libssh</kbd> source code. At the time of writing, Version 0.8.7 is the latest, and it is available from <a href="https://www.libssh.org/files/0.8/">https://www.libssh.org/files/0.8/</a>. Download and extract the <kbd>libssh</kbd> source code.</p>
<p>Take a look at the included <kbd>INSTALL</kbd> file.</p>
<p>Now, open a command window in the <kbd>libssh</kbd> source code directory. Create a new <kbd>build</kbd> folder with the following commands:</p>
<pre><strong>mkdir build<br/></strong><strong>cd build</strong></pre>
<p>Keep this command window open. We'll do the build here in a minute.</p>
<p>Start <span class="packt_screen">CMake 3.14.3</span> (<strong>cmake-gui</strong>) from the start menu or desktop shortcut.</p>
<p>You need to set the source code and build locations using the <span class="packt_screen">Browse Source...</span> and <span class="packt_screen">Browse Build...</span> buttons. This is shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/c4cf41a7-8d2d-4576-8b81-ab20ddd20bde.png" style="width:30.67em;height:26.58em;"/></p>
<p>Then, click <span class="packt_screen">Configure</span>.</p>
<p>On the next screen, select <span class="packt_screen">MinGW Makefiles</span> as the generator for this project. Click <span class="packt_screen">Finish</span>.</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/349233d1-58f1-492d-85fa-76bec0dd6ae1.png" style="width:18.92em;height:19.92em;"/></p>
<p>It may take a moment to process.</p>
<p>From the configuration options, make the following changes:</p>
<ol>
<li>Uncheck <span class="packt_screen">WITH_NACL</span></li>
<li>Uncheck <span class="packt_screen">WITH_GSSAPI</span></li>
<li>Change <kbd>CMAKE_INSTALL_PREFIX</kbd> to <kbd>c:\mingw</kbd></li>
</ol>
<p>Then, click <span class="packt_screen">Configure</span> again. It will take a moment. If everything worked, click <span class="packt_screen">Generate</span>.</p>
<p>You should now be able to build <kbd>libssh</kbd>.</p>
<p>Go back to your command window in the build directory. Use the following command to complete the build:</p>
<pre><strong>mingw32-make</strong></pre>
<p>After the build completes, use the following command to copy the files over to your MinGW installation:</p>
<pre><strong>mingw32-make install</strong></pre>
<p><span>You can try building </span><kbd>ssh_version.c</kbd><span> from <a href="c9d0a1dc-878b-4961-825e-65688fac08ae.xhtml"/><a href="c9d0a1dc-878b-4961-825e-65688fac08ae.xhtml">Chapter 11</a>, <em>Establishing SSH Connections with libssh</em></span><span>, to test that everything is installed correctly. It should look like the following:</span></p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/cb20c15a-dc94-4992-9eb1-11dffc687062.png" style="width:53.50em;height:19.33em;"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Alternatives</h1>
                </header>
            
            <article>
                
<p>In this book, we recommend free software whenever possible. This is important for user freedom, and this is one reason we recommend GCC throughout the book.</p>
<p>In addition, to MinGW GCC, the Clang C compiler is also open source and excellent quality. The code in this book was also tested to run successfully using Clang on Windows.</p>
<p>Command-line tools such as GCC and Clang are often easier to integrate into the complicated workflows required for larger projects. These open source tools also provide better standards compliance than Microsoft's compilers.</p>
<p><span>That said, the code in this book also works with Microsoft's compilers. The code was tested for both Microsoft Visual Studio 2015 and Microsoft Visual Studio 2017.</span></p>


            </article>

            
        </section>
    </body></html>