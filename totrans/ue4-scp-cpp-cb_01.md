# UE4 开发工具

在本章中，我们将概述一些基本的入门配方，用于开始使用 **Unreal Engine 4**（**UE4**）进行游戏开发，以及我们将用于创建游戏代码的基本工具。这包括以下配方：

+   安装 Visual Studio

+   在 Visual Studio 中创建和构建您的第一个 C++ 项目

+   在 Visual Studio 中更改代码字体和颜色

+   扩展 – 在 Visual Studio 中更改颜色主题

+   在 Visual Studio 中格式化您的代码（自动完成设置）

+   Visual Studio 中的快捷键

+   Visual Studio 中扩展鼠标使用

+   UE4 – 安装

+   UE4 – 第一个项目

+   UE4 – 创建您的第一个关卡

+   UE4 – 热重载

+   UE4 – 使用 UE_LOG 进行日志记录

+   UE4 – 从 FStrings 和其他变量创建 FString

# 简介

创建一个游戏是一项复杂的任务，需要**资源**和**代码**的结合。为了创建资源和代码，我们需要一些相当高级的工具，包括**艺术工具**、**声音工具**、**关卡编辑工具**和**代码编辑工具**。在本章中，我们将讨论寻找适合资源创建和编码的工具。资源包括任何视觉艺术作品（2D 精灵、3D 模型）、音频（音乐和音效）和游戏关卡。代码是指导计算机如何将这些资源组合在一起以创建游戏世界和关卡，以及如何使该游戏世界**运行**的文本（通常是 C++）。每个任务都有数十个非常好的工具；我们将探索其中的一些，并提出一些建议。游戏编辑工具尤其庞大，需要强大的 CPU 和大量的内存，以及非常好的、理想的 GPU 以获得良好的性能。保护您的资源和工作是必要的实践。我们将探讨并描述源代码控制，这是您在远程服务器上备份工作的方法。还包括 UE4 编程的简介，我们还将探讨基本日志功能和使用库。完成这些任务还需要进行大量的规划，因此我们将使用任务规划软件包来完成。

# 技术要求

如 UE4 的常见问题解答页面所示，建议使用具有 Windows 7 64 位或更高版本的 macOS X 10.9.2 或更高版本的桌面 PC，8 GB 的 RAM，四核 Intel 或 AMD 处理器，以及兼容 DX11 的显卡。UE4 可以在低于这些推荐配置的桌面和笔记本电脑上运行，但性能可能有限。

对于使用 Mac 电脑的用户，Visual Studio for Mac 目前不支持 C++。您需要使用不同的 IDE，例如 Visual Studio Code 或 Xcode。

# 安装 Visual Studio

Visual Studio 是编辑 UE4 游戏的 C++ 代码时进行代码编辑的必备软件包。

# 准备工作

我们将设置一个 C++ 编码环境来构建我们的 UE4 应用程序。我们将下载 Visual Studio 2017，安装它，并为其设置 UE4 C++ 编码。

# 如何做...

1.  首先，访问[`www.visualstudio.com/en-us/products/visual-studio-community-vs.aspx`](https://www.visualstudio.com/en-us/products/visual-studio-community-vs.aspx)。点击下载 VS Community 2017。这将下载约 1,250 KB 的加载器/安装程序：

![图片](img/37a4e26f-1a6c-4d42-89cc-6616e08dada8.png)

您可以在[`visualstudio.microsoft.com/vs/compare/`](https://visualstudio.microsoft.com/vs/compare/)比较 Visual Studio 的不同版本。本书中，Visual Studio 的社区版对于 UE4 开发来说是完全足够的，也就是说，只要您是个人开发者，进行学术研究，或者您的团队中人数少于六人。

1.  启动安装程序，继续通过安装程序，直到您到达选择要添加到您的 PC 上的 Visual Studio 2017 组件的窗口。请记住，您选择的特性越多，您的安装就会越大。

1.  C++的支持现在是 Visual Studio 的可选部分，默认情况下不会安装，因此我们必须选择我们想要安装它。在“工作负载”部分，向下滚动到“移动和游戏”标题并勾选“使用 C++进行游戏开发”选项：

![图片](img/9046c623-4635-47df-a26a-ffa4bf6af989.png)

在此阶段，您也可以通过在安装详情菜单的“可选”部分选择它来下载 Unreal Engine 安装程序，但我们将在此章节的稍后部分通过 Epic Games 直接获取最新的 Epic Games 启动器和 Unreal Engine。

1.  在您选择了想要添加到 Visual Studio 的工具后，点击“安装”按钮。安装工具将下载所需的组件并继续设置。安装完成后，安装程序可能会要求您重新启动计算机。请继续这样做。

1.  下载并安装 Visual Studio 2017 后，启动它。您将看到一个登录对话框：

![图片](img/bd3b8bc4-3e7c-40dd-b5bd-4481abe3eb71.png)

您可以使用您的微软账户（您用于登录 Windows 10 的账户）登录，或者注册一个新账户。登录或注册后，您将能够登录 Visual Studio 本身。在桌面代码编辑程序中登录可能看起来有些奇怪，但您的登录将用于对您的代码库进行源代码控制提交。在首次登录 Visual Studio 时，您可以（仅限一次）选择一个独特的 URL 作为您的源代码仓库，这些仓库托管在 Visualstudio.com（[`visualstudio.microsoft.com/`](https://visualstudio.microsoft.com/)）。

# 它是如何工作的...

Visual Studio 是一个出色的编辑器，您将在其中编码时拥有极好的体验。在下一个菜谱中，我们将讨论如何创建和编译我们自己的代码。

关于 Visual Studio 设置过程中 C++和 UE4 的更多信息，请查看[`docs.unrealengine.com/en-us/Programming/Development/VisualStudioSetup`](https://docs.unrealengine.com/en-us/Programming/Development/VisualStudioSetup)

# 在 Visual Studio 中创建和构建你的第一个 C++ 项目

为了从 Visual Studio 编译和运行代码，必须在项目内部进行。

# 准备工作

在这个菜谱中，我们将确定如何从 Visual Studio 创建一个实际的可执行运行程序。我们将通过在 Visual Studio 中创建一个项目来做到这一点，以托管、组织和编译代码。

# 如何操作...

在 Visual Studio 中，每一组代码都被包含在称为 **项目** 的东西中。项目是一组可构建的代码和资源的集合，可以生成可执行文件（`.exe` 可运行）或库（`.lib` 或 `.dll`）。一组项目可以收集到称为 **解决方案** 的东西中。让我们先构建一个 Visual Studio 解决方案和一个控制台应用程序项目，然后构建一个 UE4 示例项目和解决方案：

1.  打开 Visual Studio 并转到文件 | 新建 | 项目...

1.  你将看到一个对话框，如下所示：

![](img/f5817a52-3ab0-4606-9bb6-df5dce1f49df.png)

1.  在左侧的面板中选择 Visual C++。在中间面板中，点击 Windows 控制台应用程序。在下面的框中命名你的项目，然后点击确定：

![](img/0dd0f699-2838-4353-88f7-5554a3c10f6d.png)

一旦应用程序向导完成，你将创建你的第一个项目。将创建一个解决方案和一个项目。

1.  要查看这些，你需要解决方案资源管理器。为了确保解决方案资源管理器正在显示，请转到视图 | 解决方案资源管理器（或按 *Ctrl* + *Alt* + *L*）。解决方案资源管理器是一个通常出现在主编辑器窗口右侧的窗口，如下面的截图所示：

![](img/b282bb55-46b4-440a-855e-e9d29b9244e9.png)

解决方案资源管理器位置

你可以在 Visual Studio 内部随意安排你的布局。如果你想要回到默认布局，你可以转到窗口 | 重置窗口布局。

解决方案资源管理器还显示项目中的所有文件。这个默认解决方案已经包含了一些文件，我们可以在这一节中添加和删除新文件。随着项目的增长，越来越多的文件将被添加到项目中。在 `源文件` 文件夹中，你还会注意到一个名为 `FirstProject.cpp` 的文件，其外观如下：

```cpp
// FirstProject.cpp : This file contains the 'main' function. Program execution begins and ends there.
//

#include "pch.h"
#include <iostream>

int main()
{
    std::cout << "Hello World!\n"; 
}

// Run program: Ctrl + F5 or Debug > Start Without Debugging menu
// Debug program: F5 or Debug > Start Debugging menu

// Tips for Getting Started: 
// 1\. Use the Solution Explorer window to add/manage files
// 2\. Use the Team Explorer window to connect to source control
// 3\. Use the Output window to see build output and other messages
// 4\. Use the Error List window to view errors
// 5\. Go to Project > Add New Item to create new code files, or Project > Add Existing Item to add existing code files to the project
// 6\. In the future, to open this project again, go to File > Open > Project and select the .sln file
```

1.  按 *Ctrl* + *Shift* + *B* 构建项目，然后按 *Ctrl* + *F5* 运行项目。

1.  你的可执行文件将被创建，你将看到一个带有程序运行结果的黑色小窗口：

![](img/62f00ac5-ad2c-4a20-b0f8-4e86e9f0b720.png)

# 它是如何工作的...

构建可执行文件涉及将你的 C++ 代码从文本语言转换为二进制文件。运行该文件将运行你的游戏程序，这仅仅是出现在 `main()` 函数 `{` 和 `}` 之间的代码文本。

# 更多内容...

构建配置是我们在这里将要讨论的构建**样式**。您应该至少了解两种重要的构建配置：调试和发布。当前选定的构建配置位于编辑器的顶部，位于工具栏下方默认位置：

![图片](img/2ddb187d-8c1a-44de-9e79-8d898d32b9cb.png)

当前所选构建配置的位置

根据您选择的配置，将使用不同的编译器选项。调试配置通常在构建中包含大量的调试信息，以及关闭优化的能力以加快编译速度。发布构建通常是优化过的（要么是针对大小，要么是针对速度），构建时间会稍长一些；它们的结果是更小或更快的可执行文件。通过调试器逐行移动来逐步执行文件的行为在调试模式下通常比在发布模式下更好。

# 在 Visual Studio 中更改代码字体和颜色

在 Visual Studio 中自定义字体和颜色不仅关乎灵活性。由于显示器分辨率过高或过低，这可能会成为一种必要性！

# 准备工作

Visual Studio 是一款高度可定制的代码编辑工具。您可能会发现默认字体对您的屏幕来说太小了。这可以通过按住 *Ctrl* 键并使用鼠标滚轮来增加或减小字体大小轻松调整，但您可能想要更改默认值。或者，也许您想要有更多的控制权，比如您可能想要更改代码的字体大小和颜色。您还可能想要完全自定义关键字和文本背景颜色。本节中将向您展示如何使用“字体和颜色”对话框，它允许您完全自定义代码编辑器字体和颜色的各个方面：

![图片](img/9fed72ff-060d-4d5b-b45d-333297d2206d.png)

# 如何操作...

1.  在 Visual Studio 中，转到“工具 | 选项...”：

![图片](img/6f99dc57-eb9b-45c8-9fca-d63960ee12be.png)

1.  从出现的对话框中选择“环境 | 字体和颜色”。它看起来就像以下截图所示：

![图片](img/3d185848-6e47-47d1-8426-757578c298cb.png)

1.  在文本编辑器/纯文本中尝试调整字体和字体大小。点击对话框中的“确定”，然后在代码文本编辑器中查看结果：

![图片](img/6faf956d-11d4-48b2-aa8d-88c5de098c59.png)

修改后的字体和颜色

文本编辑器/纯文本描述了在常规代码编辑器中用于所有代码文本的字体和大小。如果您更改字体大小，则编码窗口中输入的任何文本的大小都会改变（包括 C、C++、C# 等所有语言）。

要返回基于您主题的默认菜单，请点击“显示设置”选项右侧的“使用默认值”按钮。

每个项目的颜色（前景和背景）都是完全可定制的。尝试为文本编辑器/关键字设置（影响所有语言）或为特定于 C++ 的项目，如文本编辑器/C++ 函数进行此操作。点击“确定”，你将在代码编辑器中看到项目颜色的变化。

你还可能想要配置输出窗口的字体大小，在“显示设置”选项下进行配置，因此点击下拉菜单并选择“输出窗口”，如图下截图所示：

![图片](img/0b498932-bbab-428c-a5e4-b73af88ea458.png)

输出窗口是位于编辑器底部的小窗口，用于显示构建结果和编译错误。

你不能保存（导出）或导入你的字体和颜色对话框中的更改。但你可以使用名为 **Visual Studio 主题编辑器扩展** 的工具。要了解更多信息，请参考本章的 *扩展 - 在 Visual Studio 中更改颜色主题* 菜谱，了解如何导出和导入自定义颜色主题。

因此，你可能想要避免从该对话框更改字体颜色。然而，你必须使用此对话框来更改字体和字体大小，对于任何设置（在撰写本文时）。

# 它是如何工作的...

字体和颜色对话框只是简单地更改文本编辑器以及其他窗口（如输出窗口）中代码的外观。这对于使你的编码环境更加舒适非常有用。

# 更多内容...

一旦你已自定义了你的设置，你会发现你可能想要保存你的自定义字体和颜色设置供他人使用，或者将其放入另一个安装的 Visual Studio 中，这个 Visual Studio 你在另一台机器上。不幸的是，默认情况下，你将无法保存你的自定义字体和颜色设置。你需要一个名为 Visual Studio 主题编辑器扩展的工具来做到这一点。我们将在下一个菜谱中探讨这个问题。

# 相关内容

+   *扩展 - 在 Visual Studio 中更改颜色主题* 菜谱描述了如何导入和导出颜色主题

# 扩展 - 在 Visual Studio 中更改颜色主题

默认情况下，你不能保存你在字体和颜色对话框中做出的字体颜色和背景设置的改变。为了解决这个问题，Visual Studio 有一个名为 **主题** 的功能。如果你转到“工具”|“选项”|“环境”|“常规”，你可以将主题更改为三个预安装的库存主题之一（浅色、蓝色和深色）：

![图片](img/e3eb472a-0844-4c28-b74e-7050f3746912.png)

不同的主题可以完全改变 Visual Studio 的外观，从标题栏的颜色到文本编辑器窗口的背景颜色。

你也可以完全自定义 Visual Studio 的主题，但你需要一个扩展来实现这一点。扩展是一些小程序，可以安装到 Visual Studio 中以修改其行为。

默认情况下，没有扩展，你的自定义颜色设置无法保存或重新加载到另一个 Visual Studio 安装中。有了扩展，你还可以将你自己的颜色主题保存下来与他人分享。你也可以将其他人或你自己制作的颜色设置加载到一个新的 Visual Studio 复制中。

# 如何做到这一点...

1.  前往工具 | 扩展和更新...

1.  从出现的对话框中，在左侧面板中选择在线。在右侧的搜索框中开始输入“主题编辑器”。Visual Studio 的颜色主题编辑器选项将在你的搜索结果中弹出：

![图片](img/fc1673f3-3e23-441c-aaf6-635c81ae6419.png)

1.  点击条目右上角的下载按钮。点击通过安装对话框提示，允许插件安装。然后你会在窗口底部注意到它已安排安装，但会等待 Visual Studio 关闭。

1.  关闭窗口和 Visual Studio，保存我们的项目。在我们程序关闭后，VSIX 安装程序窗口将出现以确认你想要安装软件。点击修改按钮，它应该开始：

![图片](img/9184e6c8-dad1-453f-8209-5a3552d6534c.png)

或者，访问 [`marketplace.visualstudio.com/items?itemName=VisualStudioPlatformTeam.VisualStudio2017ColorThemeEditor`](https://marketplace.visualstudio.com/items?itemName=VisualStudioPlatformTeam.VisualStudio2017ColorThemeEditor) 并通过双击浏览器中提供的 `.vsix` 文件下载/安装扩展。

1.  安装完成后，再次打开 Visual Studio 并打开我们的项目。这样做最快的方法是从启动页的最近部分：

![图片](img/b036144a-38e0-430e-ab2a-fd94b29ba47c.png)

1.  重启后，转到工具 | 自定义颜色以打开颜色主题编辑器页面：

![图片](img/cbc7ab5a-8f95-4872-8093-4f174f8cb083.png)

颜色主题编辑器页面

1.  从出现的颜色主题对话框中，点击你想要用作基础或起始主题的主题右上角的那个小调色板形状的图标（我在这里点击了浅色主题的调色板，如以下截图所示）：

![图片](img/996f768b-84ae-4716-9349-9435b34e7093.png)

1.  主题的副本将出现在颜色主题窗口下方的自定义主题部分。点击编辑主题以修改当你悬停在自定义主题上时出现的中间按钮的主题。当你编辑主题时，你可以从字体文本颜色到 C++ 关键词颜色更改一切。

1.  你感兴趣的主要区域是 C++ 文本编辑器部分。要访问所有 C++ 文本编辑器选项，请确保在主题编辑器窗口的顶部选择“显示所有元素”选项，如下面的截图所示：

![图片](img/f40eaa8c-bf51-43c6-8b50-91fc07effd69.png)

确保在主题编辑器窗口中选择“显示所有元素”选项，以显示针对 C++ 的特定文本编辑器设置。否则，你将只能进行 Chrome/GUI 类型的修改。

1.  注意，虽然你感兴趣的大多数设置将在“文本编辑器”|“C/C++”下，但一些设置可能没有“C++”子标题。例如，编辑器窗口内主/纯文本的设置（适用于所有语言）在“文本编辑器”|“纯文本”（没有“C++”子标题）下。

1.  从“工具”|“选项”|“环境”|“常规”中选择要使用的主题。你创建的任何新主题都会自动出现在下拉菜单中。

# 它是如何工作的...

一旦我们加载了插件，它就会很好地集成到 Visual Studio 中。导出和上传你的主题与他人分享也非常简单。

将主题添加到 Visual Studio 中，它将在“工具”|“扩展和更新...”中作为扩展安装。要删除主题，只需卸载其扩展：

![](img/a451719f-e357-414b-b8a3-b1486650a68b.png)

# 在 Visual Studio 中格式化代码（自动完成设置）

使用 Visual Studio 编写代码的格式化是一种乐趣。在这个菜谱中，我们将讨论如何控制 Visual Studio 展示代码文本的方式。

# 准备工作

代码必须格式正确。如果你的代码格式一致，你和你的合作程序员将能够更好地理解、掌握并保持代码无错误。这就是为什么 Visual Studio 在编辑器内包含了许多自动格式化工具。

# 如何操作...

1.  前往“工具”|“选项”。一旦到达那里，转到“文本编辑器”|“C/C++”部分并选择它。此对话框显示一个窗口，允许你切换自动括号完成：

![](img/0a3d0243-2005-425b-bb93-59942d70d2e0.png)

自动括号完成是一个功能，当你输入 `{` 时，会自动为你输入相应的 `}`。如果你不喜欢文本编辑器意外地插入字符，这个功能可能会让你感到烦恼。

你通常希望自动列出成员开启，因为这样会在你开始输入时立即显示一个包含完整数据成员名称的对话框。这使得记住变量名变得容易，因此你不必记住它们：

![](img/e3522db1-0b15-45a1-8cc7-81eca020029a.png)

如果你在任何时间在代码编辑器中按下 *Ctrl* + 空格键，自动列表就会弹出。

1.  一些更多的自动完成行为选项位于“文本编辑器”|“C/C++”|“格式化”下：

![](img/2c6cb741-3ca4-45de-97e3-360e54abf7d8.png)

我建议最初使用所有选项，然后仅当它们干扰你的工作流程时才禁用它们。

你也可以通过选择“编辑”|“高级”|“格式化选择”（*Ctrl* + *K*，*Ctrl* + *F*）来通过突出显示文本的一部分来自动格式化文本的一部分。

# 它是如何工作的...

默认的自动完成和自动格式化行为可能会让你感到烦恼。你需要与你的团队讨论你希望代码如何格式化（空格或制表符缩进，缩进大小等），然后相应地配置你的 Visual Studio 设置。

# Visual Studio 中的快捷键

有许多快捷键可以使你的编码和项目导航更快、更高效。在这个菜谱中，我们将描述如何使用一些常见的快捷键，这些快捷键将真正提高你的编码速度。

# 准备工作

要开始使用，你需要安装 Visual Studio 并打开一个项目来查看其功能。

# 如何做到这一点...

以下是一些非常实用的键盘快捷键，你可以尝试使用：

1.  点击代码的一部分，然后点击至少 10 行代码以外的某个地方。现在，按 *Ctrl* + *-* [向后导航]。通过按 *Ctrl* + *-* 和 *Ctrl* + *Shift* + *-* 分别在源代码的不同页面之间导航（你最后所在的位置，以及你现在所在的位置）：

![](img/96a3c744-7446-4066-830d-27b17f03f485.png)

注意，这里提到的键是键盘上靠近 0 键的那个键，并且与数字键盘上的键不兼容。

使用 *Ctrl* + *-* 在文本编辑器中跳转。光标将跳回到最后的位置，该位置距离超过 10 行代码，即使最后的位置是在不同的文件中。

例如，如果你在一个地方编辑代码，并想回到你刚刚所在的地方（或者回到你来自的代码部分），只需按 *Ctrl* + *-*，这样就会把你带回到你最后所在的位置。要向前跳转到你之前所在的位置，按 *Ctrl* + *-*，然后按 *Ctrl* + *Shift* + *-*。要返回，前一个位置应该超过 10 行，或者在不同的文件中。这对应于工具栏中的前进和后退菜单按钮：

![](img/1aa31481-9a3e-432c-85d1-0c97fe27f9c9.png)

工具栏中的后退和前进导航按钮分别对应于 *Ctrl* + *-* 和 *Ctrl* + *Shift* + *-* 快捷键。

1.  按 *Ctrl* + *W* 突出一个单词。

1.  按住 *Ctrl* + *Shift* + 向右箭头（或向左箭头）（不是 *Shift* + 向右箭头）仅用于移动到光标的左右，选择整个单词。

1.  按 *Ctrl* + *C* 复制文本，*Ctrl* + *X* 剪切文本，*Ctrl* + *V* 粘贴文本。

1.  **剪贴板循环**：剪贴板循环是一种对事实的参考，即 Visual Studio 维护一个最近复制操作的堆栈。通过按 *Ctrl* + *C*，你将你正在复制的文本推入一个有效的堆栈。在另一段文本上第二次按 *Ctrl* + *C* 将该文本推入 **剪贴板堆栈**。例如，在以下图中，我们首先按 *Ctrl* + *C* 在单词 *cyclic* 上，然后之后按 *Ctrl* + *C* 在单词 *paste* 上。

如你所知，按下 *Ctrl* + *V* 会粘贴堆栈顶部的项目。按下 *Ctrl* + *Shift* + Insert 会访问该会话中所有已复制项目的非常长的历史记录，即堆栈顶部以下的项目。在你用尽项目列表后，列表会回绕到堆栈顶部的项目。这是一个奇特的功能，但你可能会偶尔发现它很有用。

1.  *Ctrl* + *M* 会折叠代码部分：

![图片](img/a1e7ab10-2a4e-476f-aea2-bad7a5238d99.png)

# 它是如何工作的...

键盘快捷键可以通过减少编码会话中必须执行的鼠标点击次数来加快代码编辑器中的工作速度。

# Visual Studio 中的扩展鼠标使用

鼠标是一个相当方便的工具，用于选择文本。在本节中，我们将强调如何以高级方式使用鼠标，以便你可以快速编辑代码文本。

# 如何操作...

1.  按住 *Ctrl* 键同时点击以选择整个单词：

![图片](img/b134cd1a-6c42-4cdb-9844-f985d795ca6b.png)

1.  按住 *Alt* 键以选择文本框（*Alt* + 左键点击 + 拖动）：

![图片](img/af625ed1-7100-4629-abf0-58296eec61cf.png)

你可以随后剪切、复制或覆盖矩形文本区域；在后一种情况下，你输入的字符将在所有选定的行中重复。

# 它是如何工作的...

单击鼠标本身可能会很繁琐，但有了 *Ctrl* + *Alt* 的帮助，它变得相当酷。

# 安装 Unreal Engine 4 (UE4)

要正确安装和配置 UE4，需要遵循一系列步骤。在这个菜谱中，我们将介绍正确的安装和设置引擎的方法。

# 准备工作

UE4 需要占用相当多的空间，所以你应该在目标驱动器上至少有 20 GB 左右的空闲空间。请注意，每个项目至少也需要 1 GB 的空间，所以如果你希望创建更多的项目，你需要在你的电脑上（或额外的硬盘）上预留更多的空间。

# 如何操作...

1.  在你选择的网页浏览器中访问 [unrealengine.com](http://unrealengine.com)：

![图片](img/a07cf0f4-b721-4595-bbfc-7bf0ee31012e.png)

1.  在屏幕的右上角，点击下载按钮。然后系统会要求你创建一个 Epic Games 账户。如果你已经有了账户，你可以滚动到屏幕底部并点击登录选项。

1.  通过双击 `EpicGamesLauncherInstaller-x.x.x-xxx.msi` 安装程序来运行 Epic Games Launcher 程序的安装程序。将其安装在默认位置。

1.  Epic Games Launcher 程序安装完成后，通过双击其图标打开它，该图标可以在你的桌面上或开始菜单中找到：

![图片](img/b86be0b9-a313-4123-877c-1f19a9822343.png)

1.  你需要使用你之前创建或使用的相同登录信息进行登录，然后你会到达启动器的主页：

![图片](img/4023b8b0-08f1-4f99-9246-496d24b1f573.png)

1.  有很多可用的选项，但我们需要点击屏幕左上角的 Unreal Engine 选项。

1.  浏览起始页面，四处看看。最终，您将需要安装一个引擎。点击屏幕上的大号橙色安装引擎按钮，如图所示：

![图片](img/9d0f21d6-0123-41ae-858e-ad95880947c4.png)

1.  将弹出一个对话框，要求您同意最终许可协议。之后，您将被要求选择安装位置。然后，点击安装按钮：

![图片](img/11f35862-2ecb-4091-9f29-d93439fa6c83.png)

启动器将开始下载引擎。它大约有 7 GB，所以可能需要一段时间。完成后，您的屏幕应该看起来像这样：

![图片](img/b8badf1d-a24a-4cc1-afb6-64fc40097366.png)

在引擎安装完成后，安装引擎按钮将更改为启动引擎按钮。

# 它是如何工作的...

Epic Games 启动器是您启动引擎本身的程序。它将所有项目库的副本保存在“库”选项卡中。

# 更多...

随着您对在 UE4 中工作的了解越来越多，您应该查看“库 | 保险库”部分中的某些免费库包。为此，请点击左侧的“库”项，并向下滚动，直到您在“我的项目”下看到保险库。

# 在 UE4 中创建您的第一个项目

在 UE4 中设置项目需要多个步骤。确保您的选项正确，以便您可以拥有您喜欢的设置，因此在构建第一个项目时仔细遵循此配方。

在 UE4 中创建的每个项目至少占用约 1 GB 的空间，因此您应该决定是否希望您的项目位于同一目标驱动器上，或者位于外部或单独的硬盘驱动器上。

# 如何做到这一点...

1.  从 Epic Games 启动器中，点击屏幕左侧的启动 Unreal Engine 4.21.2 按钮。一旦您进入引擎，就会提供一个创建新项目或加载现有项目的选项。

注意，根据您阅读这本书的时间，版本号可能不同，但如果不是极其相似，步骤应该是相同的。

1.  选择“新建项目”选项卡。

1.  决定您是否将使用 C++来编写项目代码，或者仅使用蓝图：

+   如果您仅使用蓝图，请从蓝图选项卡中选择要使用的模板。

+   如果您除了蓝图之外还使用 C++来构建项目，请选择基于 C++选项卡的项目模板来构建项目。

+   如果您不确定基于哪个模板编写代码，基本代码是任何 C++项目的绝佳起点（或者对于仅使用蓝图的项目（Unreal 的内置可视化脚本语言）来说，空白是一个不错的选择）：

![图片](img/8c76e0d5-e09d-4688-8bdb-ef37d110325c.png)

为了这本书的目的，我们将始终使用 C++项目：

1.  查看模板列表下方出现的三个图标。这里有三种选项可以配置：

+   您可以选择针对桌面或移动应用程序。

+   你可以选择更改质量设置（太阳在植物上的图片），但你可能不需要更改这些设置。无论如何，质量设置都可以在引擎 | 引擎可伸缩性设置下重新配置。

+   最后一个选项是是否将启动内容包含在项目中。你可能可以在你的项目中使用启动内容包。它包含一些对初学者非常有价值的优秀材料和纹理，但随着你开始创建自己的高级项目，你可能会不再需要它。

如果你不喜欢启动内容包，可以尝试 UE4 市场中的包。那里有一些优秀的内容，包括游戏纹理材质包。

1.  选择你将保存项目的驱动器和文件夹。请记住，每个项目大约有 1GB 的大小，你将在目标驱动器上需要至少这么多空间。

1.  为你的项目命名。最好给它起一个独特且具体于你计划创建的内容的名字。

1.  点击创建。UE4 编辑器和 Visual Studio 2017 窗口应该会弹出，使你可以编辑你的项目。

在未来，请记住，你可以使用两种方法之一打开 Visual Studio 2017 解决方案。第一种是使用你的本地文件资源管理器。导航到你的项目存储的根目录，双击`ProjectName.sln`文件。第二种方法是从 UE4：点击文件 | 打开 Visual Studio。

# 在 UE4 中创建你的第一个层级

在 UE4 中创建层级非常简单，得益于一个功能强大的全面 UI。在这个菜谱中，我们将概述基本编辑器使用方法，并描述一旦你启动了第一个项目，如何构建你的第一个层级。

# 准备工作

完成之前的菜谱，*在 UE4 中创建你的第一个项目*。一旦你构建了一个项目，我们就可以继续创建层级。

# 如何做到这一点...

1.  当你开始一个新项目时，默认设置的层级将包含一些默认几何和场景，如果创建项目时包含了启动内容：

![](img/5b58e8d6-dc21-4be9-8731-78ad44f0dc90.png)

最小默认层级和 Unreal Engine 4 界面

你不需要从这些启动内容开始。如果你不想从它开始构建，你可以删除它，或者创建一个新的层级。

1.  要创建一个新的层级，点击文件 | 新建层级...：

![](img/541267b6-e0c5-487a-8a9c-f336a90aa967.png)

从这里，你可以选择创建带有背景天空（默认）或没有背景天空（空层级）的层级。

如果你选择创建一个没有背景天空的层级，请记住，你必须添加一个**灯光**才能看到你添加到其中的几何形状。

1.  如果你在你项目的创建过程中加载了启动内容（或某些其他内容），那么你可以使用内容浏览器将内容拖放到你的层级中。只需将内容浏览器中的内容实例拖放到层级中，然后保存，并按播放按钮玩游戏。

1.  使用模式面板（窗口 | 模式）向您的关卡添加一些几何形状。务必点击最左边的带有灯泡和立方体图片的按钮，以访问可放置的几何形状：

![](img/f8217cff-4439-44a1-971d-bb86f4078fc8.png)

默认情况下，选择了基本选项，其中包含在虚幻中需要的通用几何形状和其他常见功能。您还可以通过点击模式标签左侧的灯光子标签通过模式选项卡添加灯光。这些可以通过拖放添加到关卡中。

模式面板包含两个用于关卡构建的有用项目：一些要添加的示例几何形状（立方体、球体等），以及一个充满灯光的面板。尝试这些并实验以开始布置您的关卡。

如果您想了解更多关于在虚幻引擎内部构建关卡的信息，请查看[`docs.unrealengine.com/en-us/Engine/QuickStart`](https://docs.unrealengine.com/en-us/Engine/QuickStart)。

# UE4 – 热重载

当您创建一个新的虚幻引擎 4 C++项目时，您会看到 Visual Studio 和虚幻引擎 4 都打开了。在这个食谱中，我们将通过修改 Visual Studio 中的脚本并编译代码以查看更改的示例。

# 准备工作

要查看更改其中一个类的影响，我们必须实际使用该类。虚幻引擎默认为我们创建了一个这样的类（`AChapter01_GameModeBase`），因此在这个简单的例子中，我们将使用它。

注意，在本章的食谱中，您在任何地方看到`Chapter01`，我指的是项目名称，如果您的项目名称不同，您可能会看到不同的文本。

1.  从虚幻编辑器转到编辑 | 项目设置。在项目部分下选择地图和模式选项。

1.  在默认游戏模式下，选择 Chapter01_GameMode：

![](img/b887caf3-0c76-4c00-9d58-39b1f6e90ea3.png)

注意，在代码中类名为`AChapter01_GameModeBase`，而在虚幻引擎的菜单中它没有`A`。这是因为虚幻引擎为继承自`Actor`类的类添加了`A`作为命名约定。我们将在本书后面的部分详细讨论这一点。

**游戏模式**是一个包含您游戏类型规则的类。

想要了解更多关于游戏模式的信息，请查看[`docs.unrealengine.com/en-US/Gameplay/Framework/GameMode`](https://docs.unrealengine.com/en-US/Gameplay/Framework/GameMode)。

# 如何操作...

1.  在 Visual Studio 的解决方案资源管理器下，您将看到许多预创建的文件。打开`Games/Chapter_01/Source/Chapter_01`文件夹，您应该会看到`Chapter01GameModeBase.h`和`.cpp`文件。双击`.h`文件以打开它：

![](img/3ca35114-5579-492a-9b4b-52303519acca.png)

1.  将以下（加粗）代码添加到文件中：

```cpp
// Fill out your copyright notice in the Description page of Project Settings.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/GameModeBase.h"
#include "Chapter_01GameModeBase.generated.h"

/**
 * 
 */
UCLASS()
class CHAPTER_01_API AChapter_01GameModeBase : public AGameModeBase
{
 GENERATED_BODY()
public:
 void BeginPlay();

};
```

1.  接下来，打开`.cpp`文件并更新它以包含以下内容：

```cpp
// Fill out your copyright notice in the Description page of Project Settings.

#include "Chapter_01GameModeBase.h"

void AChapter_01GameModeBase::BeginPlay()
{
 Super::BeginPlay();
}
```

这段代码目前没有任何作用，但它为我们提供了在未来的章节食谱中稍后添加更改的能力。

1.  保存两个文件并返回到 Unreal 编辑器。从编辑器，点击编译按钮：

![图片](img/53f00d56-68f2-41e8-a43b-030fcb92d3d0.png)

如果一切顺利，你应该在屏幕的右下角看到一个菜单出现，经过一段时间后，你应该看到它显示 Compile Complete!：

![图片](img/ee3d438b-4321-4a7a-a7fb-df1646911ac8.png)

你也可以通过在解决方案资源管理器中右键单击项目来在 Visual Studio 中编译你的代码，并选择 Build。完成后，当我们回到 Unreal 编辑器时，它应该自动加载所做的更改。

在我们修改代码文件时，记住编译我们的代码非常重要。否则，我们将无法看到这些更改在我们的项目中反映出来。

关于如何为 Unreal Engine 4 编译自己的代码的更多信息，请查看[`docs.unrealengine.com/en-US/Programming/QuickStart`](https://docs.unrealengine.com/en-US/Programming/QuickStart)。

# UE4 – 使用 UE_LOG 进行日志记录

**日志记录**对于输出内部游戏数据非常重要。使用日志工具可以让你在 UE4 编辑器中的方便的小输出日志窗口中打印信息。

# 准备工作

当编码时，我们有时可能希望将一些调试信息发送到 UE 日志窗口。这可以通过使用`UE_LOG`宏来实现。**宏**是一段被赋予名称的代码片段。每当在代码中使用该名称时，在编译时都会用宏的内容替换它。日志消息是在开发程序时跟踪信息的一种极其重要且方便的方式。

你应该有一个代码文件来完成这个食谱。如果你是第一次在 Unreal 中编码，你应该在继续这个食谱之前完成上一个食谱。

# 如何做到这一点...

1.  在你的代码中，输入一行代码，使用以下形式：

```cpp
UE_LOG(LogTemp, Warning, TEXT("Some warning message") );
```

例如，如果你想将此内容添加到上一个食谱中的脚本中，它可能看起来像这样：

```cpp
#include "Chapter_01GameModeBase.h"

void AChapter_01GameModeBase::BeginPlay()
{
  Super::BeginPlay();

 // Basic UE_LOG message
 UE_LOG(LogTemp, Warning, TEXT("Some warning message") );
}
```

1.  在 UE4 编辑器中，通过转到 Window | Developer Tools | Output Log 来打开输出日志，以查看程序运行时在该窗口中打印的日志消息：

![图片](img/5be2810d-c8aa-404c-be08-ac2cd59cebed.png)

1.  如果你通过点击顶部工具栏中的播放按钮来玩游戏，你应该注意到我们的文本在日志中以黄色显示：

![图片](img/1542e346-58e3-4c3c-839c-7a40d883d68f.png)

为了使你的输出更容易看到，你可以在任何时候通过在窗口内右键单击输出日志并选择 Clear Log 来清除输出日志。

# 它是如何工作的...

`UE_LOG`宏接受至少三个参数：

+   `Log`类别（我们在这里使用`LogTemp`来表示临时日志中的日志消息）

+   日志级别（我们在这里使用警告来表示日志消息，以黄色警告文本打印）

+   日志消息的实际文本字符串

不要忘记在你的日志消息文本周围使用 `TEXT()` 宏，因为它会将文本转换为 `UE_LOG` 可用的格式。对于那些更熟悉编码的人来说，`TEXT()` 宏在编译器设置为在 Unicode 上运行时将包含的文本提升为 Unicode（在前面添加一个 `L`）。

`UE_LOG` 也接受可变数量的参数，就像 C 编程语言中的 `printf()` 一样：

```cpp
#include "Chapter_01GameModeBase.h"

void AChapter_01GameModeBase::BeginPlay()
{
  Super::BeginPlay();

  // Basic UE_LOG message

  UE_LOG(LogTemp, Warning, TEXT("Some warning message") );

  // UE_LOG message with arguments
 int intVar = 5;
 float floatVar = 3.7f;
 FString fstringVar = "an fstring variable";
 UE_LOG(LogTemp, Warning, TEXT("Text, %d %f %s"), intVar, floatVar, *fstringVar );
}
```

当使用 `UE_LOG` 来解引用 `FString` 到常规的 C 风格 `TCHAR` 指针时，变量前将会有一个星号 `*`。这意味着它正在将指针转换成它所指向的实际值。

`TCHAR` 通常定义为一种变量类型，如果编译时使用 Unicode，则 `TCHAR` 解析为内置数据类型 `wchar_t`。如果 Unicode 关闭（`_UNICODE` 编译器开关未定义），则 `TCHAR` 解析为标准的 `char` 类型。

更多关于 `TCHAR` 和使用 C++ 处理字符串的信息，请查看[`docs.microsoft.com/en-us/windows/desktop/learnwin32/working-with-strings#tchars`](https://docs.microsoft.com/en-us/windows/desktop/learnwin32/working-with-strings#tchars)。

在你不再需要它们时，不要忘记清除你的日志消息！否则，你的控制台可能会因为消息而变得臃肿，难以找到你想要的东西。

# UE4 – 从 FStrings 和其他变量创建 FString

在 UE4 中编码时，你经常想要从变量中构建一个字符串。使用 `FString::Printf` 或 `FString::Format` 函数来做这件事相当简单。

# 准备工作

对于这个，你应该有一个现有的项目，你可以在其中输入一些 UE4 C++ 代码。将变量放入字符串中是通过**打印**来实现的。将变量打印到字符串中可能不太直观，但你不能简单地将变量连接起来并希望它们会自动转换为字符串，就像在某些语言（如 JavaScript）中那样。

# 如何做到...

在这个菜谱中，我们将看到如何以两种不同的方式打印。首先，我们将使用 `FString::Printf()`：

1.  考虑你想要打印到字符串中的变量。注意每个变量类型是什么。

1.  打开并查看 `printf` 格式说明符的参考页面，例如 [`en.cppreference.com/w/cpp/io/c/fprintf`](http://en.cppreference.com/w/cpp/io/c/fprintf)。对于你想要打印的每个变量，注意其说明符。例如，`%s` 用于格式化的字符串。

1.  尝试以下代码：

```cpp
FString name = "Tim"; 
int32 mana = 450; 
FString string = FString::Printf( TEXT( "Name = %s Mana = 
 %d" ), *name, mana );
```

注意前面的代码块是如何精确地使用格式说明符，就像传统的 `printf` 函数一样。在上面的例子中，我们使用了 `%s` 来在格式化的字符串中放置一个字符串，并使用 `%d` 来在格式化的字符串中放置一个整数。不同类型的变量有不同的格式说明符，你应该在 `cppreference.com` 等网站上查找它们。

也可以使用 `FString::Format()` 来打印一个字符串。

1.  按以下形式编写代码：

```cpp
FString name = "Tim"; 
int32 mana = 450; 
TArray< FStringFormatArg > args; 
args.Add( FStringFormatArg( name ) ); 
args.Add( FStringFormatArg( mana ) ); 
FString string = FString::Format( TEXT( "Name = {0} Mana = 
 {1}" ), args );

UE_LOG( LogTemp, Warning, TEXT( "Your string: %s" ), 
        *string );
```

使用 `FString::Format()` 时，我们不是使用正确的格式说明符，而是使用简单的整数和一个 `TArray` 的 `FStringFormatArg`。`FstringFormatArg` 帮助 `FString::Format()` 推断要放入字符串中的变量的类型。请参考以下截图：

![](img/d32f957e-4bc9-4527-b98d-5a65f69fd593.png)

无论你使用哪种方法，在调用 `UE_LOG` 之后，你都会得到相同的输出。
