<html><head></head><body>
<div><h1 class="chapter-number" id="_idParaDest-274"><a id="_idTextAnchor275"/>14</h1>
<h1 id="_idParaDest-275"><a id="_idTextAnchor276"/>Deploying Multiplayer Games</h1>
<p>Deploying an Unreal multiplayer game can be a daunting task for any developer.</p>
<p>In this chapter, I will present you with the key steps involved in packaging and deploying a game – a process that needs proper planning and preparation beforehand. This will help you avoid most issues, resulting in a successful launch at deploy time.</p>
<p>This process will also involve a crucial task – compiling Unreal Engine from its source code and then packaging your game as a standalone server executable and client executable.</p>
<p>So, in the next sections, I will present you with the following topics:</p>
<ul>
<li>Going online for real</li>
<li>Compiling Unreal Engine</li>
<li>Setting up a dedicated server</li>
</ul>
<h1 id="_idParaDest-276"><a id="_idTextAnchor277"/>Technical requirements</h1>
<p>To follow the topics presented in this chapter, you should have completed all the previous chapters and have understood their content.</p>
<p>Although not mandatory, basic knowledge of Git technology (<a href="https://git-scm.com">https://git-scm.com</a>) will help in the second section of this chapter.</p>
<h1 id="_idParaDest-277"><a id="_idTextAnchor278"/>Going online for real</h1>
<p>Up until now, to work on your projects, you have been utilizing an Unreal Engine official release that can be <a id="_idIndexMarker775"/>accessed through the Epic Games Launcher. However, if you aspire to enhance your skills in multiplayer development, you must take a further step to proficiently excel in this field and become an adept multiplayer game developer.</p>
<p>The first thing you need to know is that Unreal Engine releases are not “complete” versions of the software; they offer almost all that’s needed to work on your project, but they usually miss less common and more advanced features. One of the main reasons is to keep the regular version of Unreal Engine to a smaller, more affordable size.</p>
<p>Regrettably, these releases lack the necessary functionality to compile a project for multiplayer deployment, which in turn means that if you plan to release your game in the wild, you are out of luck.</p>
<p>Luckily there is a solution available – compiling the Unreal Engine Editor yourself directly from the source code. The full Unreal Engine source code is available in a repository hosted on GitHub (<a href="https://github.com/">https://github.com/</a>) and, with minimum effort, you will be able to get it and use it for your own needs. There are many advantages in compiling your own version of the engine, including peeking through the actual engine implementation classes – such as Actor and Pawn – and stepping inside the engine code while debugging your game to get an introspection on what’s happening.</p>
<p>A great number <a id="_idIndexMarker776"/>of individuals have made valuable contributions to the engine by identifying software glitches and taking the time to fix them. At the time of writing this chapter, the number of contributors to the engine is as many as 563 developers, as shown in <em class="italic">Figure 14</em><em class="italic">.1</em>:</p>
<div><div><img alt="Figure 14.1 – The Unreal Engine GitHub page" src="img/Figure_14_01_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.1 – The Unreal Engine GitHub page</p>
<p>Another advantage of accessing the engine source code and compiling your own executable version is that you will <a id="_idIndexMarker777"/>be able to compile your multiplayer game as a <strong class="bold">dedicated server</strong> – a game version that will run without rendering any <a id="_idIndexMarker778"/>visuals and that will not run on a client machine. This kind of game<a id="_idIndexMarker779"/> instance is usually referred to as a <strong class="bold">headless</strong> game version.</p>
<p>Using a dedicated server offers many advantages over a listen server:</p>
<ul>
<li>The size of the <a id="_idIndexMarker780"/>executable will be smaller</li>
<li>The server version will mainly focus on gameplay logic and handling information from the clients</li>
<li>No client will have advantages or disadvantages over the others due to hosting the game session</li>
<li>You can build a dedicated server release separate from the client release and a client release from the dedicated server</li>
<li>The server-side code logic can be compiled just in the server, obfuscating important code that may be available to malevolent hackers if distributed inside the client</li>
</ul>
<p>With this in mind, let’s kick off this exciting journey by creating our very own executable program for the Unreal Engine Editor using the source code.</p>
<p>The first thing to do is to obtain the actual source code from the GitHub repository – something we are going to do in the next section.</p>
<h1 id="_idParaDest-278"><a id="_idTextAnchor279"/>Compiling the Unreal Engine</h1>
<p>In this section, you’ll be <a id="_idIndexMarker781"/>downloading the engine source code and building it to get a personal, executable release that will let you create your own dedicated servers for multiplayer deployment.</p>
<p>This process is divided into two main parts:</p>
<ul>
<li>Cloning the project from the official Epic Games GitHub repository</li>
<li>Setting up and building the sources with Visual Studio</li>
</ul>
<p>Don’t worry if you’re <a id="_idIndexMarker782"/>unfamiliar with GitHub – I’ll walk you through everything with clear and easy-to-follow step-by-step instructions.</p>
<h2 id="_idParaDest-279"><a id="_idTextAnchor280"/>Downloading the Unreal Engine source project</h2>
<p>During the next steps, you will be downloading the Unreal Engine source code from the official Epic Games GitHub <a id="_idIndexMarker783"/>repository in order to have the full project in your hands. The requisites you will need to satisfy are as follows:</p>
<ul>
<li>Have Git installed on your computer</li>
<li>Have a GitHub account</li>
<li>Connect the GitHub account to your Epic Games account</li>
</ul>
<p class="callout-heading">Note</p>
<p class="callout">If you already know Git, chances are you will already have satisfied some or all of the requisites. If so, feel free to skip the following steps.</p>
<p>You will start by installing Git on your computer.</p>
<h3>Installing Git on your computer</h3>
<p><strong class="bold">Git</strong> is a version control system that <a id="_idIndexMarker784"/>is both free and open source. It is designed to track the changes made <a id="_idIndexMarker785"/>to computer files, which <a id="_idIndexMarker786"/>it does by taking “snapshots” of a project’s files whenever a commit is executed. This feature enables developers to oversee and regulate their code’s evolution in an efficient, speedy fashion. Git is an excellent source code management tool for projects of all sizes, ranging from small to extremely large.</p>
<p>As stated before, you don’t have to be proficient with Git in order to obtain the Unreal Engine repository – you will just be using its cloning capabilities to download the engine source code.</p>
<p>To install Git on your computer, head to the official download page (<a href="https://git-scm.com/downloads">https://git-scm.com/downloads</a>) and get <a id="_idIndexMarker787"/>the latest release. Once it is downloaded, simply install it as you would do <a id="_idIndexMarker788"/>with any common <a id="_idIndexMarker789"/>software. Once the installation phase has been completed, you will have the Git command line available on your machine.</p>
<p class="callout-heading">Note</p>
<p class="callout">Some people – including me – prefer to use dedicated client software instead of using the command line, easing the pain of using the command prompt. If you feel uncomfortable with the command line, you can use a third-party client, some of which are listed on this page: <a href="https://git-scm.com/downloads/guis">https://git-scm.com/downloads/guis</a>.</p>
<p>Once you have installed Git, you can safely proceed to create a GitHub account.</p>
<h3>Creating a GitHub account</h3>
<p><strong class="bold">GitHub</strong> (<a href="https://github.com/">https://github.com/</a>) is a cloud-based<a id="_idIndexMarker790"/> service that allows software developers to store, manage, track, and control changes made to their code base using Git. It enables developers to <a id="_idIndexMarker791"/>collaborate on projects from <a id="_idIndexMarker792"/>anywhere and provides a range of features such as project management tools, documentation, issue tracking, and continuous integration and deployment. GitHub is widely used in the software development industry and has become a crucial part of the software development workflow for many organizations and developers.</p>
<p>To create a GitHub account, you just need to click the <strong class="bold">Sign up</strong> button and, after adding your email, follow the instructions you will be presented with.</p>
<p>Once you have got your GitHub account, it’s time to get access to the Epic Games organization by connecting the GitHub and Epic Games accounts.</p>
<h3>Connecting your GitHub account to the Epic Games account</h3>
<p>Epic Games has <a id="_idIndexMarker793"/>a GitHub organization (<a href="https://github.com/EpicGames">https://github.com/EpicGames</a>) where public repositories <a id="_idIndexMarker794"/>are stored, including the Unreal Engine project. Accessing this organization is free – you just have to connect the Epic <a id="_idIndexMarker795"/>Games account to the GitHub one. Here’s how to do so:</p>
<ol>
<li>Visit your Epic Games account page (<a href="https://www.epicgames.com/account">https://www.epicgames.com/account</a>).</li>
<li>Select the <strong class="bold">APPS AND </strong><strong class="bold">ACCOUNTS</strong> page.</li>
<li>In the <strong class="bold">GITHUB</strong> section, click the <strong class="bold">CONNECT</strong> button, as shown in <em class="italic">Figure 14</em><em class="italic">.2</em>:</li>
</ol>
<div><div><img alt="Figure 14.2 – The Apps and Accounts section" src="img/Figure_14_02_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.2 – The Apps and Accounts section</p>
<p>Once you have <a id="_idIndexMarker796"/>authorized the connect operation, you will be granted access to the Epic Games <a id="_idIndexMarker797"/>GitHub organization (<a href="https://github.com/EpicGames">https://github.com/EpicGames</a>) and to the <a id="_idIndexMarker798"/>Unreal Engine repository (<a href="https://github.com/EpicGames/UnrealEngine">https://github.com/EpicGames/UnrealEngine</a>). The Unreal Engine repository includes all the <a id="_idIndexMarker799"/>Unreal Engine versions organized in their own separate branches.</p>
<p>In Git, a <code>release</code> branch includes the latest stable release of the engine.</p>
<p>You are now ready to clone the repository on your local machine:</p>
<ol>
<li>On your PC, navigate to an empty folder or create a new one.</li>
<li>Right-click and, from the drop-down menu, select <strong class="bold">Git Bash Here</strong>, as depicted in <em class="italic">Figure 14</em><em class="italic">.3</em>:</li>
</ol>
<div><div><img alt="Figure 14.3 – The Git Bash Here option" src="img/Figure_14_03_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.3 – The Git Bash Here option</p>
<p>This will open <a id="_idIndexMarker801"/>a command prompt <a id="_idIndexMarker802"/>and you will be ready to <a id="_idIndexMarker803"/>clone the Unreal Engine project.</p>
<ol>
<li value="3">Type the following command:<pre class="source-code">
git clone https://github.com/EpicGames/UnrealEngine.git</pre></li>
</ol>
<p>You may be asked to enter your credentials; in this case, use those of your GitHub account.</p>
<p>The download and clone process may take a long time, depending on your internet connection.</p>
<ol>
<li value="4">Once the process has finished, you should see an <code>UnrealEngine</code> folder in your directory; this is the project source code. In the Git terminal, type the following:<pre class="source-code">
git fetch origin</pre></li>
</ol>
<p>This command will retrieve all available branches in the remote repository.</p>
<ol>
<li value="5">As an <a id="_idIndexMarker804"/>optional step, if you want to work with a particular release of the <a id="_idIndexMarker805"/>engine, you can type the <a id="_idIndexMarker806"/>following command:<pre class="source-code">
git checkout –b [version number] origin/[version number]</pre></li>
</ol>
<p>For instance, if you need Unreal Engine 5.1, you will type:</p>
<pre class="source-code">
git checkout –b 5.1 origin/5.1</pre>
<p>This command will switch to the 5.1 version branch and make its sources available.</p>
<p>Once the process has finished, you are ready to go and compile the sources.</p>
<h2 id="_idParaDest-280"><a id="_idTextAnchor281"/>Compiling from the source code</h2>
<p>Once you have <a id="_idIndexMarker807"/>downloaded the source code from the GitHub repository, you’ll need to compile it, in order to get an executable out of it. This will allow you to launch the compiled Unreal Engine application and take advantage of all its features.</p>
<p>There are four main steps you’ll need to complete in order to have a fully working executable:</p>
<ul>
<li>Set up your programming IDE</li>
<li>Set up the project</li>
<li>Generate the project files</li>
<li>Compile the source files</li>
</ul>
<p>Let’s get started by checking that your programming IDE is up to date and ready to go.</p>
<h3>Setting up your programming IDE</h3>
<p>As you have been working with Unreal and C++ so far, your programming IDE should already be up to <a id="_idIndexMarker808"/>date to compile the source files, but a double-check is mandatory, in order to have everything properly set up:</p>
<ol>
<li>Open the Visual Studio installer on your PC.</li>
<li>Select <strong class="bold">Modify</strong> from your own Visual Studio installation, as shown in <em class="italic">Figure 14</em><em class="italic">.4</em>:</li>
</ol>
<div><div><img alt="Figure 14.4 – Visual Studio Installer" src="img/Figure_14_04_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.4 – Visual Studio Installer</p>
<ol>
<li value="3">Once the <strong class="bold">Modyfing</strong> window is open, select the <strong class="bold">Individual components</strong> tab, as shown in <em class="italic">Figure 14</em><em class="italic">.5</em>:</li>
</ol>
<div><div><img alt="Figure 14.5 – The Modifying window" src="img/Figure_14_05_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.5 – The Modifying window</p>
<ol>
<li value="4">From the <strong class="bold">Individual components</strong> tab, install the latest .NET Framework development <a id="_idIndexMarker809"/>tools, the latest .NET Framework SDK and – not mandatory, but strongly recommended – all the previous versions of the .NET Framework SDK. <em class="italic">Figure 14</em><em class="italic">.6</em> depicts my setup at the time of writing this book:</li>
</ol>
<div><div><img alt="Figure 14.6 – The individual components setup" src="img/Figure_14_06_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.6 – The individual components setup</p>
<p>Once the <a id="_idIndexMarker810"/>installation is finished, you can safely close the Visual Studio installer and you’ll be ready to set up the project.</p>
<h3>Setting up the project</h3>
<p>In this step, you’ll be downloading the needed dependency files in order to properly set up the project. This <a id="_idIndexMarker811"/>process is pretty straightforward, but it may take some time, depending on your internet connection. Just open the source file project folder you cloned from GitHub, which should be named <code>Setup.bat</code> file, as shown in <em class="italic">Figure 14</em><em class="italic">.7</em>:</p>
<div><div><img alt="Figure 14.7 – The Setup.bat file" src="img/Figure_14_07_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.7 – The Setup.bat file</p>
<p>Then right-click on this file and select <strong class="bold">Run as administrator</strong>; this will open the command prompt and run the needed commands.</p>
<p class="callout-heading">Note</p>
<p class="callout">For a more advanced level of customization, you may want to pre-determine the target hardware and platform. For instance, you can run the <code>Setup.bat</code> command excluding unneeded platforms by using the <code>-exclude</code> option. As an extra benefit, fewer files will be downloaded and, by the end of the build process, you will get an engine with a smaller file size.</p>
<p>Once the process <a id="_idIndexMarker812"/>has finished, you will have added the needed dependencies and will be ready for the next step.</p>
<h3>Generating the project files</h3>
<p>Once you have properly set up your project, you are ready to generate the project files, in order to open <a id="_idIndexMarker813"/>the project in Visual Studio. The process is almost identical to the previous one, but you will have to run another <code>.bat</code> file instead. In the sources project folder (i.e., the <code>UnrealEngine</code> folder), locate the <code>GenerateProjectFiles.bat</code> file, as shown in <em class="italic">Figure 14</em><em class="italic">.8</em>:</p>
<div><div><img alt="Figure 14.8  – The GenerateProjectFiles.bat file" src="img/Figure_14_08_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.8  – The GenerateProjectFiles.bat file</p>
<p>Again, right-click on the file and select <code>UE.sln</code> file added to your source files folder, as depicted in <em class="italic">Figure 14</em><em class="italic">.9</em>:</p>
<div><div><img alt="Figure 14.9 – The .sln file" src="img/Figure_14_09_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.9 – The .sln file</p>
<p class="callout-heading">Note</p>
<p class="callout">If you require a greater degree of customization for the project generation command, I recommend referring to the official documentation, which provides an exhaustive list of all available command options: <a href="https://docs.unrealengine.com/5.1/en-US/how-to-generate-unreal-engine-project-files-for-your-ide/">https://docs.unrealengine.com/5.1/en-US/how-to-generate-unreal-engine-project-files-for-your-ide/</a>.</p>
<p>You are now <a id="_idIndexMarker815"/>ready to open Visual Studio and build Unreal Engine.</p>
<h3>Compiling the source files</h3>
<p>We will now compile the source code in Visual Studio through the previously generated solution. To <a id="_idIndexMarker816"/>open it, just double-click on the <code>UE.sln</code> file and the software should open up.</p>
<p class="callout-heading">Note</p>
<p class="callout">If you have more than one Visual Studio version, you may need to open the right one in order to correctly compile the project. This will depend on your PC configuration and .NET SDK installations.</p>
<p>The first thing to do is to set the correct solution configuration. To do so, locate the <strong class="bold">Solution Configurations</strong> drop-down menu in the toolbar and set its value to <strong class="bold">Development Editor</strong>, as shown in <em class="italic">Figure 14</em><em class="italic">.10</em>:</p>
<div><div><img alt="Figure 14.10 – The Solution Configurations drop-down menu" src="img/Figure_14_10_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.10 – The Solution Configurations drop-down menu</p>
<p>Next, you need to check the solution platform you will be compiling for. In the Visual Studio toolbar, locate the <strong class="bold">Solution Platforms</strong> drop-down menu and double-check that the target platform is set to <strong class="bold">Win64</strong>, as shown in <em class="italic">Figure 14</em><em class="italic">.11</em></p>
<div><div><img alt="Figure 14.11 – The Solution Platforms drop-down menu" src="img/Figure_14_11_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.11 – The Solution Platforms drop-down menu</p>
<p>You are finally ready to start the build process. To do so, locate the <code>Engine</code> folder content. Then right-click on <strong class="bold">UE5</strong> and select <strong class="bold">Build</strong> as shown in <em class="italic">Figure 14</em><em class="italic">.12</em>:</p>
<div><div><img alt="Figure 14.12 – The Build option" src="img/Figure_14_12_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.12 – The Build option</p>
<p>The build process will require a lot of time to complete (which will further depend on the capabilities <a id="_idIndexMarker818"/>of your computer), so you can relax and have a coffee break.</p>
<p>After completing the process, you’ll have something to celebrate! You’ve just created your very own, fresh-out-of-the-box executable for Unreal Engine. The <code>.exe</code> file can be found in your source files project, in the <code>Engine</code> | <code>Binaries</code> | <code>Win 64</code> folder. My own compiled binaries are shown in <em class="italic">Figure 14</em><em class="italic">.13</em>:</p>
<div><div><img alt="Figure 14.13 – The Unreal Engine compiled executable" src="img/Figure_14_13_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.13 – The Unreal Engine compiled executable</p>
<p>When you double-click on it, Unreal Engine will launch, and you’ll notice that things look pretty much the same as the regular Unreal Engine Editor. However, the difference is that, under the hood, you will have a more powerful engine with more features at your disposal.</p>
<p>In this section, you have accomplished the challenging task of compiling the Unreal Engine Editor <a id="_idIndexMarker819"/>from its source code – that’s something to be really proud of! Now, get ready for an even more challenging task in the next section, where you’ll be creating a dedicated server for a multiplayer game.</p>
<h1 id="_idParaDest-281"><a id="_idTextAnchor282"/>Setting up a dedicated server</h1>
<p>In this section, you’ll be compiling a multiplayer project as a dedicated server. To keep things simple, you’ll be<a id="_idIndexMarker820"/> working with a simple project generated from one of the official templates, but all the topics and techniques can be easily adapted to any other project, including the Unreal Shadows project you’ve been working on so far.</p>
<p>In order to proceed with the creation of a dedicated server, your project must meet the specified requirements listed here:</p>
<ul>
<li>You must utilize <a id="_idIndexMarker821"/>a source build of Unreal Engine – the one you compiled in the previous section</li>
<li>Your project must be created as a C++ one</li>
<li>The project needs to, obviously, support client-server gameplay</li>
</ul>
<p>Without any more delays, let’s get started by creating the project.</p>
<h2 id="_idParaDest-282"><a id="_idTextAnchor283"/>Creating the project</h2>
<p>In this section, you’ll be creating a new project starting from an Unreal Engine template. To do this, the first <a id="_idIndexMarker822"/>thing you will need to do is to open your own compiled Unreal Engine Editor. So, locate the executable, which can be found in your GitHub downloaded directory using the following path:</p>
<p><code>[Your Project Folder]</code> | <code>Engine</code> | <code>Binaries</code> | <code>Win64</code> | <code>UnrealEngine.exe</code></p>
<p>Double-click on the file to launch the Unreal Engine Editor and, once it has started, create a new project with the following settings:</p>
<ul>
<li><strong class="bold">Template</strong>: <strong class="bold">Games</strong> | <strong class="bold">Third Person</strong></li>
<li><strong class="bold">Project </strong><strong class="bold">Name</strong>: <strong class="bold">TP_Multiplayer</strong></li>
<li><strong class="bold">Project Type</strong>: <strong class="bold">C++</strong> (if you opt for a <strong class="bold">Blueprint</strong> project, just remember that, later on, you will have to convert it to a C++ one when you need to compile the dedicated server; this will be a really easy task, as you will just need to add a C++ class to the project)</li>
<li>Leave <strong class="bold">Starter </strong><strong class="bold">Content</strong> unchecked</li>
</ul>
<p>My setup for this project is shown in <em class="italic">Figure 14</em><em class="italic">.14</em>:</p>
<div><div><img alt="Figure 14.14 – The project setup" src="img/Figure_14_14_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.14 – The project setup</p>
<p>Once the project <a id="_idIndexMarker823"/>has been created, you are ready to set up and build the project solution.</p>
<h2 id="_idParaDest-283"><a id="_idTextAnchor284"/>Building the project solution</h2>
<p>Now that you <a id="_idIndexMarker824"/>have created the project, locate the <code>Source</code> folder inside your project. Here, you will find two files named <code>TP_Multiplayer.Target.cs</code> and <code>TP_MultiplayerEditor.Target.cs</code>.</p>
<p>Target files are written in C# language and their purpose is to define how the Unreal Engine build tool will compile the target builds. In this case, the first one will be used when packaging a regular executable and the second one will be used for the Unreal Engine Editor.</p>
<p>We need to define a third one that will be used to package the server version of the application. In order to do this, in the same folder as the other two <code>.Target.cs</code> files, create a third target file and name it <code>TP_MultiplayerServer.Target.cs</code>.</p>
<p>Once the file has been created, open it with your text editor of choice and insert the following code:</p>
<pre class="source-code">
using UnrealBuildTool;
using System.Collections.Generic;
public class TP_MultiplayerServerTarget : TargetRules
{
  public TP_MultiplayerServerTarget(TargetInfo Target) : base(Target)
  {
    Type = TargetType.Server;
    DefaultBuildSettings = BuildSettingsVersion.V2;
    ExtraModuleNames.AddRange( new string[] { "TP_Multiplayer" } );
  }
}</pre>
<p>If you are not familiar with C# syntax, don’t worry! There’s not much to understand here – we are just defining <a id="_idIndexMarker825"/>a class named <code>TP_MultiplayerServerTarget</code> and, in the constructor, we are defining some build settings. The only thing to notice is that we have defined the built target type as <code>Server</code> as we need to create a dedicated server build.</p>
<p>Get back to the root folder of your project and locate the Unreal Engine project file, which should be called <code>TP_Multiplayer.uproject</code>. Right-click on it and, from the drop-down options, select <strong class="bold">Generate Visual Studio project files</strong>, as depicted in <em class="italic">Figure 14</em><em class="italic">.15</em>:</p>
<div><div><img alt="Figure 14.15 – The project file generation option" src="img/Figure_14_15_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.15 – The project file generation option</p>
<p>Once the generation process has finished, your project will be set to also compile a server build – something you will need to create your dedicated server.</p>
<p>You can now open <a id="_idIndexMarker826"/>Visual Studio by double-clicking on the <code>TP_Multiplayer.sln</code> solution file, in order to create the needed builds. Once your programming IDE is opened, create your build by clicking on the <strong class="bold">Solution Configurations</strong> drop-down menu in the main toolbar and selecting <strong class="bold">Development Server</strong>, as shown in <em class="italic">Figure 14</em><em class="italic">.16</em>:</p>
<div><div><img alt="Figure 14.16 – The solution configuration set as Development Server" src="img/Figure_14_16_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.16 – The solution configuration set as Development Server</p>
<p>You can now build the project by right-clicking on the <strong class="bold">TP_Multiplayer</strong> item in the <strong class="bold">Solution Explorer</strong> window and selecting <strong class="bold">Build</strong>.</p>
<p>Once the process has finished, you will have successfully built the development server, which will allow the Unreal build tool to recognize the server build target.</p>
<p>Before getting back to the Unreal Engine Editor, you will have to also build the Development Editor <a id="_idIndexMarker827"/>configuration, so repeat the previous steps with the Editor configuration by taking the following steps. In the main toolbar, click on the <strong class="bold">Solution Configurations</strong> drop-down menu and select <strong class="bold">Development Editor</strong>. Then build the project by right-clicking on the <strong class="bold">TP_Multiplayer</strong> item in the <strong class="bold">Solution Explorer</strong> window and selecting <strong class="bold">Build</strong>.</p>
<p>Once the build process has finished, you can safely close Visual Studio and get back to Unreal Engine to build the dedicated server.</p>
<h2 id="_idParaDest-284"><a id="_idTextAnchor285"/>Building the dedicated server</h2>
<p>In this subsection, you’ll be building a dedicated server executable for your project from the Unreal <a id="_idIndexMarker828"/>Engine Editor. The first thing you will need to do is to create a new map that will serve as an entry point for the server:</p>
<ol>
<li>From the main menu, select <strong class="bold">File</strong> | <strong class="bold">New Level</strong> and create a new <strong class="bold">Basic</strong> level.</li>
<li>In the Content Browser, create a <code>Maps</code> folder and save the level in it, calling it <code>Map_0</code>.</li>
<li>In the <strong class="bold">World Setting</strong> window of the level, set <strong class="bold">Game Mode Override</strong> to <strong class="bold">Game Mode Base</strong>; this will avoid opening this level with the default Third Person Game Mode.</li>
</ol>
<p>This map will be used by the client as an entry point when connecting to the server. The next step is to update some project settings before starting the server packaging phase.</p>
<ol>
<li value="4">Let’s start by selecting <strong class="bold">Edit</strong> | <strong class="bold">Project Settings</strong> from the main menu. Then select the <strong class="bold">Maps &amp; </strong><strong class="bold">Modes</strong> section.</li>
<li>In the <strong class="bold">Default Modes</strong> | <strong class="bold">Selected GameMode</strong> category, expand the <strong class="bold">Advanced</strong> section.</li>
<li>Set the <strong class="bold">Global Default Server Game Mode</strong> drop-down value to <strong class="bold">BP_ThirdPersonGameMode</strong>, as shown in <em class="italic">Figure 14</em><em class="italic">.17</em>:</li>
</ol>
<div><div><img alt="Figure 14.17 – Global Default Server Game Mode" src="img/Figure_14_17_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.17 – Global Default Server Game Mode</p>
<p>The aforementioned setup will define the Game Mode that will be used by clients when connected to the server.</p>
<p>We are now <a id="_idIndexMarker829"/>going to define the game and server maps, in order to set the entry point that will be used when the clients connect. Locate the <strong class="bold">Default Maps</strong> category and do the following:</p>
<ol>
<li value="7">In the <strong class="bold">Game Default Map</strong> drop-down menu, select <strong class="bold">Map_0</strong>.</li>
<li>Expand the <strong class="bold">Advanced</strong> section and, in the <strong class="bold">Server Default Map</strong> drop-down menu, select <strong class="bold">ThirdPersonMap</strong>.</li>
</ol>
<p>The final result for the <strong class="bold">Default Maps</strong> category is shown in <em class="italic">Figure 14</em><em class="italic">.18</em>:</p>
<div><div><img alt="Figure 14.18 – The Default Maps category" src="img/Figure_14_18_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.18 – The Default Maps category</p>
<p>We are done with the <strong class="bold">Maps &amp; Modes</strong> settings. You will now need to define the packaging settings for your project:</p>
<ol>
<li value="9">In <strong class="bold">Project Settings</strong>, expand the <strong class="bold">Packaging</strong> | <strong class="bold">Advanced</strong> section.</li>
<li>Locate the <strong class="bold">List of maps to include in the packaged build</strong> array field.</li>
<li>Use the <strong class="bold">+</strong> button <a id="_idIndexMarker830"/>to add the <strong class="bold">Map_0.umap</strong> level.</li>
<li>Use the <strong class="bold">+</strong> button again to add the <strong class="bold">ThirdPersonMap.umap</strong> level.</li>
</ol>
<p>You should now have a setup pretty similar to the one shown in <em class="italic">Figure 14</em><em class="italic">.19</em>:</p>
<div><div><img alt="Figure 14.19 – The list of maps to be packaged in the build" src="img/Figure_14_19_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.19 – The list of maps to be packaged in the build</p>
<ol>
<li value="13">As an additional step, double-check that in the <strong class="bold">Project</strong> category, the <strong class="bold">Build</strong> configuration is set to <strong class="bold">Development</strong>; this will allow us to connect to the server through the command line later on in this chapter.</li>
<li>Close the <strong class="bold">Project Settings</strong> window and in the Unreal Engine main toolbar, click the <strong class="bold">Platforms</strong> button and select <strong class="bold">Windows</strong> | <strong class="bold">TP_MultiplayerServer</strong> to set the build target, as shown in <em class="italic">Figure 14</em><em class="italic">.20</em>:</li>
</ol>
<div><div><img alt="Figure 14.20 – Building the server" src="img/Figure_14_20_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.20 – Building the server</p>
<ol>
<li value="15">Next, click <strong class="bold">Windows</strong> | <strong class="bold">Package Content</strong> to start packaging the application and, once the build has <a id="_idIndexMarker831"/>finished, you will have in your hands a dedicated server executable!</li>
<li>To get a client executable, you will have to repeat the same steps as above, using a different build target. To do so, in the Unreal Engine main toolbar, click the <strong class="bold">Platforms</strong> button and select <strong class="bold">Windows</strong> | <strong class="bold">TP_Multiplayer</strong> to set the build target, as shown in <em class="italic">Figure 14</em><em class="italic">.21</em>:</li>
</ol>
<div><div><img alt=" Figure 14.21 – Building the client" src="img/Figure_14_21_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"> Figure 14.21 – Building the client</p>
<p>Then, click <strong class="bold">Windows</strong> | <strong class="bold">Package Content</strong> to start packaging the client build. Once it has finished, you will <a id="_idIndexMarker832"/>also have the client executable, and you will be ready to test the application.</p>
<h2 id="_idParaDest-285"><a id="_idTextAnchor286"/>Testing the project</h2>
<p>Now that both <a id="_idIndexMarker833"/>the dedicated server and the client have been successfully built, it’s time to test their functionalities.</p>
<p>To start your server locally, all you have to do is double-click on the build executable you created in the previous steps.</p>
<p>Alternatively, if you are interested in checking the server log, you can take the following steps:</p>
<ol>
<li>Open the Windows Command Prompt.</li>
<li>Through the <code>cd</code> command, navigate to the folder that contains the server executable.</li>
<li>Insert the name of your server executable, followed by the <code>–log</code> parameter, for instance:<pre class="source-code">
TP_MultiplayerServer.exe -log</pre></li>
</ol>
<p>Once the server has started, it will start listening for connection requests from clients.</p>
<p>As we have used an out-of-the-box, base template and we did not implement any session logic, we will be connecting the clients from the Unreal Engine command line. This is something you obviously won’t use in a final release but that is really handy at development time.</p>
<p>The command line is available in the client executable because we compiled the project as a development build in the previous steps.</p>
<p>To start the client <a id="_idIndexMarker834"/>application, all you have to do is to double-click on the executable, which should be named <code>TP_Multiplayer.exe</code>. This will open the executable with the default starting map (i.e., <code>Map_0</code>).</p>
<p>As stated before, to connect to the server, we will be using the console command, which can be opened by default with the ’ character (i.e., backtick). Once the console is open, enter the following command:</p>
<pre class="source-code">
open 127.0.0.1</pre>
<p>The client application with the console command open is shown in <em class="italic">Figure 14</em><em class="italic">.22</em>:</p>
<div><div><img alt="Figure 14.22 – The client application with the console command open" src="img/Figure_14_22_B18203.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.22 – The client application with the console command open</p>
<p class="callout-heading">Note</p>
<p class="callout">If you are using a keyboard that does not support the backtick character (like mine), you can easily change the keyboard shortcut by opening <strong class="bold">Editor Preferences</strong> and looking for the <strong class="bold">Open Console Command </strong><strong class="bold">Box</strong> field.</p>
<p>The client should now <a id="_idIndexMarker835"/>open the regular Third Person map and your client will be connected to the dedicated server. To double-check this, if you started the server with the <code>–log</code> option enabled, you should see a log message similar to this one:</p>
<pre class="source-code">
LogNet: Join Succeeded: [Client Identifier]</pre>
<p>And that’s it – you have finally succeeded in creating your own dedicated server and connecting your clients to a LAN!</p>
<p>If you want an extra challenge, you can give compiling the Unreal Shadows project with a dedicated server a try. You already have some knowledge in this area, so it shouldn’t take too much effort.</p>
<p>Additionally, if you <a id="_idIndexMarker836"/>want to go deeper into this topic, Epic Games has provided a full tutorial on how to compile Lyra Starter Game (<a href="https://docs.unrealengine.com/5.1/en-US/lyra-sample-game-in-unreal-engine/">https://docs.unrealengine.com/5.1/en-US/lyra-sample-game-in-unreal-engine/</a>), a real-world project including many of the topics covered in this book. The link to the tutorial is <a href="https://docs.unrealengine.com/5.1/en-US/setting-up-dedicated-servers-in-unreal-engine/">https://docs.unrealengine.com/5.1/en-US/setting-up-dedicated-servers-in-unreal-engine/</a>.</p>
<p>Anything is possible with a little bit of hard work!</p>
<h1 id="_idParaDest-286"><a id="_idTextAnchor287"/>Summary</h1>
<p>In this chapter, you have faced the frightening task of downloading the Unreal Engine Editor source code from GitHub and compiling it into an executable application.</p>
<p>If you plan to make a living as a multiplayer developer, building Unreal Engine source code is a mandatory skill whenever you want to set up a dedicated server for your game or need to customize the engine’s networking and multiplayer settings.</p>
<p>As you have discovered, building and packaging a dedicated server is not an easy task and requires a lot of time and patience – and sometimes a bit of luck!</p>
<p>In the next – and final – chapter, you will learn how to take a step further in multiplayer game development by using online cloud services, specifically Epic Online Services.</p>
</div>
</body></html>