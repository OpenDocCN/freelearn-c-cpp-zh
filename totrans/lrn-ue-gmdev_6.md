# 第六章：粒子系统与声音

在本章中，我们将触及游戏组件中极其重要但往往被忽视的部分，除非它们设计不当或位置不当。是的，我们将在本章中涵盖粒子系统和声音。在大多数游戏中，它们融合得如此自然，以至于很容易被遗忘。它们也可以用来创造游戏中最难忘的时刻。

简单回顾一下，粒子系统常用于在游戏中创建火花、爆炸、烟雾、雨、雪和其他类似效果，这些效果是动态的、有点模糊且具有随机性。声音可以是环境声音，如树叶沙沙声和风声，一次性声音，如厨房里锅子掉落的声音，或重复性声音，如角色的跑步脚步声甚至收音机播放的音乐。声音可以用来设定游戏氛围，提醒玩家注意某些需要关注的事情，并为场景提供现实主义，使一个地方变得生动。让我们开始吧。

# 什么是粒子系统？

粒子系统是一种模拟模糊物体（如雨、火、云、烟和水）的方法，这些物体没有平滑、明确的外表面，且是非刚性的。该系统通过控制许多小几何对象或精灵的运动、行为、交互和外观，实现了一种优化方法，以获得这种流畅和动态的视觉表现。

通过使用由不同形状、大小、材料和纹理组成的不同粒子，具有不同的运动速度、旋转方向/速度、生成率、浓度、可见持续时间等因素的组合，我们能够创建出大量动态复杂的系统。

在本章中，我们将使用虚幻的粒子系统编辑器和 Cascade 编辑器来了解粒子系统的组件，并使用这些编辑器为您的场景创建一些附加内容。

# 探索现有的粒子系统

我们首先来看看在虚幻引擎 4 的默认包中我们能得到什么样的粒子系统。转到**内容浏览器** | **游戏** | **粒子**。有几个粒子系统我们可以直接拖放到场景中，并查看它们的外观。

要打开粒子系统，只需双击任何一个系统。让我们一起来查看**P_Fire**。您可以随意查看其他系统。然而，我将使用这个例子来了解我们为了创建我们场景的新粒子系统需要什么。此截图显示了编辑器中的**P_Fire**：

![探索现有的粒子系统](img/B03679_06_01.jpg)

在左侧是**视口**，我们可以预览粒子系统。在右侧的**发射器**选项卡中，你可以看到几个带有**火焰**（两次）、**烟雾**、**火星**和**火花**字样的盒子列。

发射器可以被视为构成粒子系统的独立组件，你可以根据你想要创建的内容为每个发射器赋予不同的属性。当你将多个发射器组合在一起时，你会看到它们组合起来为你提供一个完整的视觉效果。在这个**P_Fire**粒子系统中，你可以看到火焰以不可预测的方式移动，伴随着一些火花和火星漂浮，烟雾模拟火焰爆发。在下一节中，我们将探讨更多具体的术语，这些术语描述了 Unreal Engine 4 中的粒子系统。

# 粒子系统的主体组件

简单来说，以下段落（摘自在线可用的官方 Unreal 4 文档）非常恰当地描述了粒子系统中不同组件之间的关系：

> *"模块，用于定义粒子行为，并放置在...发射器，用于发射特定类型的粒子以产生效果，可以在...粒子系统中放置任意数量的发射器，粒子系统是内容浏览器中可用的一项资产，然后可以反过来由...发射器演员引用，发射器演员是存在于你的关卡中的一个可放置对象，用于控制粒子在你的场景中如何使用。"* 

多次阅读以确保你对不同组件之间的关系有清晰的认识。

因此，正如我们在前面关于**P_Fire**的描述中提到的，我们知道发射器被标记为**火焰**、**火星**、**火花**、**烟雾**等等。每个发射器的不同属性是通过向其中添加模块来定义的，例如**生命周期**、**初始速度**等等。所有发射器共同构成了一个粒子系统。最后，当你将发射器放置在游戏关卡中时，实际上你是在拖动引用特定粒子系统的发射器演员。

## 模块

**默认必需**和**生成**模块是每个发射器都需要拥有的模块。还有一长串其他可选模块，Cascade 粒子编辑器提供这些模块以自定义你的粒子系统。在我使用的当前版本编辑器中，我有**加速度**、**吸引**、**光束**、**相机**、**碰撞**、**颜色**、**事件**、**杀死**、**生命周期**、**位置**、**轨道**、**方向**、**参数**、**旋转**、**旋转速率**、**大小**、**生成**、**子 UV**、**矢量场**和**速度**模块。

我们将通过一个基于 **P_Fire** 的简单练习，从这长长的模块列表中涵盖一些常用的模块。我理解，如果我只是简单地给出您可以在网上轻易找到的所有定义，那么在这里掌握基础知识将会非常无聊且不太有用。相反，我们将通过自定义 **P_Fire** 来创建我们关卡中的壁炉，从而进入这一节。同时，我们将了解不同模块中可以调整的关键值。这样，您可以看看这些值如何影响粒子系统的外观。

关于每个模块和参数的定义的更详细文档，您可以参考 Unreal 4 在线文档（[`docs.unrealengine.com/latest/INT/Engine/Rendering/ParticleSystems/Reference/index.html`](https://docs.unrealengine.com/latest/INT/Engine/Rendering/ParticleSystems/Reference/index.html)）。

常用的模块如下所示：

| 模块 | 它可以控制的键参数 |
| --- | --- |
| **必需** | 用于粒子的材质 |
| **生成** | 生成的速率和分布 |
| **初始大小** | 初始粒子的尺寸 |
| **生命周期** | 粒子保持可见的时间长度 |
| **生命周期中的颜色** | 粒子在其生命周期中的颜色 |

# 粒子系统的设计原则

粒子系统的设计原则可以通过研究和迭代创意过程进行配置。让我们在接下来的部分中逐一查看。

## 研究

细节可能是设计逼真粒子系统的关键。通常，创建粒子系统属于艺术家的领域，因为我们需要艺术感来创建一个视觉上吸引人且在一定程度上逼真的效果复制品。

首先，研究一下实际效果看起来是什么样子是很好的。以下是一些帮助您开始的步骤：

+   确定所需的不同组件（将粒子效果分解为不同的组件）。

+   确定不同组件之间的关系（相对大小的粒子、生成速率、生命周期等）。

+   接下来，看看在 **计算机图形学**（**CG**）空间中创建的其他类似效果。这样做的原因是，有时实际效果可能有点单调，而且有许多令人惊叹的视觉效果人员，您可以向他们学习，为效果增添一些活力。因此，花点时间检查一下别人已经做了什么，而不是花大量时间实验却得不到想要的结果，这是一个很好的主意。

## 迭代创意过程

创建你想要的完美外观的粒子系统通常需要相当多的调整和参数试验。做到这一点的关键是了解有哪些参数以及它们的影响。在设计初期阶段，你也应该尝试添加或删除某些模块，以了解它们实际上如何影响系统的整体外观。这并不意味着越多越好。此外，保存迭代备份副本也是明智之举，这样你就可以轻松地回到之前的版本。

我认为，在创建粒子系统方面非常熟练，涉及良好的设计规划、有耐心进行迭代以及进行小的调整以获得你最终想要的外观。

# 示例 – 创建壁炉粒子系统

在本例中，我们将复制**P_Fire**并编辑它以在级别中创建一个壁炉。我们还将更改当前级别的一部分，其中我们必须放置这个新的壁炉粒子系统。

前往**内容浏览器** | **粒子**，选择**P_Fire**并复制它。将其重命名为`P_Fireplace`。此截图显示了在`粒子`文件夹中创建**P_Fireplace**的方式：

![示例 – 创建壁炉粒子系统](img/B03679_06_02.jpg)

让我们打开**Chapter5Level**并将其重命名为`Chapter6Level`。我们首先将在级别中添加一个壁炉结构，为这个壁炉效果设定上下文。这将帮助你更好地跟随创建过程。此截图显示了原始客厅空间：

![示例 – 创建壁炉粒子系统](img/B03679_06_03.jpg)

以下截图显示了带有壁炉的修改后的客厅空间：

![示例 – 创建壁炉粒子系统](img/B03679_06_04.jpg)

如果你打算构建它，此截图显示了壁炉结构的放大版本：

![示例 – 创建壁炉粒子系统](img/B03679_06_05.jpg)

放大金属通风口将看起来像这样：

![示例 – 创建壁炉粒子系统](img/B03679_06_06.jpg)

我们在这里所做的是删除灯光和低柜结构，并用这个替换：

+   **TopWoodPanel**（材料：**M_Wood_Walnut**）：X = 120, Y = 550, Z = 60

+   玻璃周围的混凝土柱（材料：**M_Brick_Cut_Stone**）

+   **ConcretePillar_L**和**ConcretePillar_R**：X = 100, Y = 150, Z = 220

+   **ConcretePillar_Top**：X = 100, Y = 250, Z = 100

+   壁炉玻璃和内部（材料：**M_Glass**）

+   **Fireglass**：X = 5, Y = 250, Z = 120

+   **MetalPanel**和**MetalPanel_Subtractive**：X = 40, Y = 160, Z = 10

+   **FireVent1**到**FireVent5**

使用以下设置的 BSP 减法圆柱体，如图所示。在这里，**Z** 是 **10**，**外半径** 是 **3**，**侧面** 是 **8**：

![示例 – 创建壁炉粒子系统](img/B03679_06_07.jpg)

下方扩展结构（由两个 BSP 组成）包括以下内容：

+   **较薄的扩展平台**：X = 140，Y = 550，Z = 10

+   **较厚的底部**：X = 120，Y = 550，Z = 30

## 制作**P_Fireplace**

现在，双击**P_Fireplace**以打开级联粒子系统编辑器。由于我们从**P_Fire**中复制了它，它具有与**P_Fire**相同的发射器：两个**火焰**，一个**烟雾**，一个**火花**，一个**火星**和一个**扭曲**模块。

观察当前视口。你看到了什么？原始的**P_Fire**效果更像是随机爆发的火焰序列，在初始爆发后很快消失。我们为创建的壁炉需要什么样的火焰？我们需要更多或更少的连续且移动较慢的火焰，这些火焰在固定位置悬浮。

带着这种差异和目标意识，我们接下来将确定我们想要保留哪些**P_Fire**组件作为壁炉的火焰效果。

### 观察系统的单个发射器

使用每个模块中的单独按钮和复选框，切换**S**的开关，并交替标记/取消标记复选框以观察单个组件。此截图显示了单独按钮和复选框的位置：

![观察系统的单个发射器](img/B03679_06_08.jpg)

### 删除非必要发射器

第一步是删除第二个**火焰**发射器（第一个是最左侧的）和**烟雾**发射器。我认为这样做的原因是，我可以使用单个火焰来为壁炉创建火焰效果。删除**烟雾**发射器主要是因为这是一个气/电火焰；因此，我预计烟雾会少一些。你也可以选择先取消勾选窗口顶部的复选框，隐藏整个发射器，然后再永久删除它。

### 专注于编辑火焰发射器

保留唯一的**火焰**发射器，火焰仍然在某个半径内的随机位置出现，然后很快消失。我们将逐一解决以下问题：

+   **配置寿命**：因此，由于我们需要让火焰持续燃烧而不是短时间爆发，我将首先调整**寿命**属性，以便火焰在消失之前燃烧更长的时间。将**分布浮点均匀**设置为**最小值**为**0.7**，**最大值**为**1.0**，**分布常数**为**1.2**。

+   **移除恒定加速度+**：现在，火焰在屏幕上停留的时间更长，然后消失。然而，火焰似乎在生成后从生成位置漂移。对于一个壁炉，火焰大致保持在相同的位置。因此，我在**火焰**模块中取消勾选复选框以关闭**恒定加速度+**。现在，火焰似乎很少从生成位置漂移。

+   **移除初始速度**：在移除加速度模块后，火焰看起来仍然像是在远离；我猜测这是因为粒子有一些初始速度，所以我关闭了这个模块来证实我的怀疑，并且看起来效果不错。

+   **配置生成**：由于火焰很小，看起来相当稀疏，这会在短时间内生成区域内产生一些空白空间。我可以调整火焰的大小使其更大，但当我这样做时，火焰看起来过于扭曲。所以，我决定增加生成率，这样每分钟就能产生更多的火焰。将**速率缩放分布**的**5.0**改为**20.0**。将**分布浮点常数**从**1.0**增加到**3.0**。

### 查看完整的粒子系统

现在，我已经重新开启了其他发射器，以查看整个粒子系统效果，并看看是否需要更多的编辑。现在看起来作为壁炉火焰已经相当不错了，所以我在这里停止了。请随意调整其他属性以改进设计。这些都是修改现有粒子系统的基本方法，我希望你通过这次练习已经熟悉了粒子系统编辑器。

# 声音和音乐

声音和音乐是游戏体验的重要组成部分。你有没有看过电视，音量调到静音？仅仅看字幕和唇语是不够的。你想要听到屏幕上的人物在说什么，以及他们是如何说的。对于游戏来说，情况基本上是相似的，而且，通常，你会通过声音和音乐获得提示。如果你玩过《异形：隔离》，你需要听游戏中的声音来判断是否有异形朝你这边靠近。这在游戏中可能是生死攸关的事情。这基本上决定了你最终是成为赢家还是成为异形的美食。那么，我们现在准备好学习如何为游戏制作声音和音乐，以及如何使用虚幻引擎编辑器将它们整合到我们的游戏关卡中了吗？

# 我们如何为游戏制作声音和音乐？

许多游戏制作都有专为游戏场景编写的原创音乐；一些游戏还使用专业歌手演唱的实际歌曲作为主题曲。游戏中的音乐非常重要，并且被游戏粉丝深深记住。有时，音乐本身就足以唤起游戏体验的记忆。因此，游戏工作室需要花时间创作合适的音乐来补充他们的游戏。

如果你是一个视频游戏音乐的超级粉丝，你也可以去参加音乐会，那里管弦乐队演奏流行游戏的音乐（查看[Video Games Live](http://www.videogameslive.com/index.php?s=home)）。

为游戏创作音乐与为作品创作音乐非常相似；当它播放时，应该激发适当的情感。音乐的选择需要与游戏的节奏和情境相匹配。以 JRPG 游戏为例，你应该能够区分战斗音乐和你在菜单中、加载游戏时或刚刚赢得战斗时播放的音乐。通常，音乐是根据游戏的需求创作的，音乐作曲家可能需要提出几个不同的版本，并让团队和/或管理层审查，然后选择最佳作品。

如果你没有打算为你的游戏创作原创音乐或声音，现在网上可以找到许多免费下载的声音和音乐。在使用免费在线音乐和声音时，务必确保在将它们融入你的游戏中时，没有违反任何数字版权或版权。

# 音质

我们讨论音质的原因是因为音质，就像图像质量一样，在当今社会非常重要。我们今天已经使用了 4K 分辨率的图像质量，未来将有更多设备和游戏支持这一标准。那么声音呢？听觉体验需要与图像质量相匹配，并不仅仅是提供单声道或立体声声音。声音体验也已经发展到多声道环绕声，从 5.1、7.1 开始，现在甚至更高级，以获得逼真的沉浸式音频体验。这绝对是在创建、存储和播放音频文件时需要考虑的事情。

# 声音是如何录制的？

声音以模拟波的形式产生，是连续的波，你将在接下来的图中看到。我们可以通过录音设备录制环绕声。对于多声道录音，你需要有某些方法来录制可以使用简单录音设置的音乐，这种设置被称为**十点树**。在这里，麦克风以特定的方式放置，以捕捉来自源头的左、右、前和后的声音。还有许多处理技术可以过滤和转换录制的声音，以模仿每个通道所需的各个组成部分。

我们以接近的时间间隔（采样频率即为采样间隔的速率）采集钢琴产生的模拟声波样本。从模拟波中采集样本以数字方式存储的过程称为**脉冲编码调制**（**PCM**）。这些样本可以存储在未压缩的 PCM 类似格式中，或者使用音频压缩技术压缩成更小、更易于管理的文件大小。Wav、MP3、Ogg Vorbis、Dolby TrueHD 和 DTS-HD 是音频通常保存的一些格式。理想情况下，我们希望将音频保存到无损压缩格式中，以便我们得到一个包含惊人声音的小型可管理文件。

当播放数字格式的声音时，使用存储的信息重建模拟声音波。与原始模拟声音波非常相似是确保声音质量良好的方法之一。通过增加通道数量，使用基本的 5.1 环绕声创建 3D 音效，这需要五个扬声器，一个用于前左，一个用于前右，一个用于中心，一个用于后左（作为环绕），一个用于后右（作为环绕）和一个低音炮，也极大地改善了听觉体验。

# Unreal 音频系统

现在我们已经对为什么游戏需要音频以及它是如何创建和录制的有了基本的了解。让我们了解 Unreal 音频系统以及可以用来将这些音频文件导入游戏的编辑器，我们还将了解可以用来编辑和控制播放的工具。

# 将音频导入 Unreal

我们如何将音频文件导入 Unreal？需要注意哪些事项？

## 音频格式

Unreal 仅支持导入`.wav`格式的声音。`.wav`格式是一种广泛使用的格式，可以存储原始未压缩的声音数据。

## 采样率

推荐的采样率为 44100 Hz 或 22050 Hz。如前所述，采样率决定了模拟波记录的频率。频率越高（以赫兹或 Hz 计），收集的模拟波数据点越多，这有助于更好地重建波形。

## 位深度

位深度设置为 16。它决定了音频波振幅可以记录的粒度，也称为声音的分辨率。对于 16 位的位深度，可以得到高达 65,536 个整数值（2¹⁶）。我们之所以关注位深度，是因为在模拟波的采样过程中，波振幅的实际值被近似为基于位深度可以存储的某个整数值。以下图显示了两种不同的位深度。左侧的图显示了位深度低时，信号采样不准确，因为它以较大的增量进行采样。右侧的图显示了位深度高时，可以以较小的增量进行采样，从而更准确地表示波形：

![位深度](img/B03679_06_09.jpg)

波形表示精度损失可以称为量化误差。当位深度太低时，量化误差会很高。

**信噪比**（**SQNR**）是用于确定这种转换质量的测量方法。它是通过最大标称信号强度与量化误差之间的比率来计算的。比率越好，转换质量越好。

## 支持的声音通道

Unreal 目前支持单声道、立体声、2.1、4.1、5.1、6.1 和 7.1 等通道。

当将文件导入虚幻引擎时，请注意文件命名约定，以确保正确的声音从正确的声道播放。

以下表格显示了 7.1 环绕声配置以及所有必要的文件命名约定，以确保正确播放：

| **扬声器** | 前左 |   | 前中 |   | 前右 |
| --- | --- | --- | --- | --- | --- |
| **扩展名** | `_fl` |   | `_fc` |   | `_fr` |
|   |   |   |   |   |   |
| **扬声器** | 左侧 |   | 低频（通常称为低音炮） |   | 右侧 |
| **扩展名** | `_sl` |   | `_lf` |   | `_sr` |
|   |   |   |   |   |   |
| **扬声器** | 后左 |   |   |   | 后右 |
| **扩展名** | `_bl` |   |   |   | `_br` |

此表显示了用于 5.1 环绕声系统的文件：

| **扬声器** | 前左 |   | 前中 |   | 前右 |
| --- | --- | --- | --- | --- | --- |
| **扩展名** | `_fl` |   | `_fc` |   | `_fr` |
|   |   |   |   |   |   |
| **扬声器** | 左侧 |   | 低频（通常称为低音炮） |   | 右侧 |
| **扩展名** | `_sl` |   | `_lf` |   | `_sr` |

此表显示了用于 4.0 系统的文件：

| **扬声器** | 前左 |   |   |   | 前右 |
| --- | --- | --- | --- | --- | --- |
| **扩展名** | `_fl` |   |   |   | `_fr` |
|   |   |   |   |   |   |
| **扬声器** | 左侧 |   |   |   | 右侧 |
| **扩展名** | `_sl` |   | `_lf` |   | `_sr` |

# 虚幻引擎声音格式和术语

在虚幻引擎声音系统中，有几个术语我们需要熟悉：

+   **声音波**：这些是实际以`.wav`格式存在的音频文件。

+   **声音提示**：这是声音波文件的控制系统。声音提示是我们用来操纵声音波音量、开始和结束的工具。因此，为了控制音频文件在游戏中的播放方式，您可以在声音提示上编辑属性，这反过来会影响与之关联的波形文件或文件。

+   **环境声音演员**：这是您添加到游戏关卡中的类演员。此演员与声音提示相关联，以播放您为游戏所需的音频文件。

现在，我们已准备好在虚幻引擎中使用声音编辑器。

# 声音提示编辑器

由于我们并非编辑实际的音频文件，因此虚幻引擎中的声音编辑器被称为声音提示编辑器。实际上，我们正在编辑通过称为声音提示的控制设备播放声音的方式。

让我们更深入地了解声音提示编辑器的功能。

## 如何打开声音提示编辑器

前往**内容浏览器** | **音频**。打开任何声音提示文件，双击以打开声音提示编辑器。此截图显示了在**内容浏览器**中找到声音提示的位置：

![如何打开声音提示编辑器](img/B03679_06_10.jpg)

当您双击声音提示时，声音提示编辑器会打开，其外观与蓝图编辑器非常相似，具有模块和线条。此截图显示了**Collapse_Cue**的声音提示编辑器的外观：

![如何打开声音提示编辑器](img/B03679_06_11.jpg)

注意，在前面的屏幕截图 **Collapse_Cue** 中，它有两个输入，分别称为 **Wave Player: Collapse 01** 和 **Wave Player: Collapse 02**。这些输入连接到一个 **Random** 节点，输出连接到最后一个节点，称为 **Output**。这样做的作用是，当播放这个声音提示时，两个折叠声音中的一个会被随机选择并播放。这为在相同情况下播放的声音创造了多样性；它们都是折叠声音效果，但略有不同。

我们将在稍后了解更多关于我们可以用来设计声音提示的组件。我们还将进行一个练习，在编辑器中创建自己的声音提示。

# 练习 – 将声音导入到虚幻编辑器中

你可能会遇到这样的情况，你创建了自己的音频效果文件，并想在游戏中使用它。我们将首先从导入这个文件开始。

对于这个练习，我使用了一个从维基百科网站下载的音频剪辑（[`en.wikipedia.org/wiki/The_Four_Seasons_(Vivaldi)`](https://en.wikipedia.org/wiki/The_Four_Seasons_(Vivaldi)))，其中包含维瓦尔第的《四季》作品。这是由 John Harrison 分享的。

这个文件是 Oggs 格式，是的，虚幻引擎只支持 `.wav` 文件。首先，我使用 Vorbis 网站上列出的软件将文件类型从 `.ogg` 转换为 `.wav`（[`vorbis.com/software/`](http://vorbis.com/software/)）。请注意 Unreal 对 WAV 文件设置的要求。

在获得正确的 wav 文件后，我们就可以将其导入到声音编辑器中。转到 **内容浏览器** | **内容** | **音频**，右键单击以显示上下文菜单，导航到 **新建资产** | **导入到 /Game/Audio**，然后浏览到保存 `.wav` 文件的文件夹并选择它。这张截图显示了在编辑器中找到导入 `.wav` 文件功能的位置：

![练习 – 将声音导入到虚幻编辑器中](img/B03679_06_12.jpg)

这张截图显示了如何将 Vivaldi WAV 文件成功导入到 `Audio` 文件夹中，并使用 WAV 文件设置：

![练习 – 将声音导入到虚幻编辑器中](img/B03679_06_13.jpg)

接下来，为刚刚导入的维瓦尔第声音波形创建一个声音提示。为了回顾，声音提示用于控制声音波形文件的播放。声音波形文件仅包含音频文件的内容。如截图所示，右键单击声音波形资产，在上下文菜单中选择 **创建提示**：

![练习 – 将声音导入到虚幻编辑器中](img/B03679_06_14.jpg)

双击新创建的声音提示（其默认名称与声音波形文件同名，并带有`Cue`后缀）。在此例中，它将是`Vivaldi_Spring_Allegro_ByJohnHarrison_Cue`。双击此提示以查看内容。以下截图显示了`Vivaldi_Spring_Allegro_ByJohnHarrison_Cue`的内容。波形播放器的输出直接连接到**输出**。这是声音提示中最简单的连接，我们将波形输入到**输出**。

![练习 – 将声音导入 Unreal 编辑器](img/B03679_06_15.jpg)

现在，让我们听听我们导入的声音。在声音提示编辑器中，查找编辑器左上角的**播放提示**按钮。查看以下截图以确定按钮的位置。点击按钮后，你会听到我们刚刚导入的音乐。你刚刚成功地将自定义波形文件导入到 Unreal 中。现在，让我们将其转移到游戏关卡中。

![练习 – 将声音导入 Unreal 编辑器](img/B03679_06_16.jpg)

# 练习 – 向关卡添加自定义声音

为了在关卡中放置声音，你需要使用**环境声音**节点将其与声音提示关联，这将反过来播放音频文件。

要创建一个**环境声音**节点，转到**模式** | **所有类**，将**环境声音**拖放到游戏关卡中：

![练习 – 向关卡添加自定义声音](img/B03679_06_17.jpg)

点击你刚刚放置到关卡中的环境声音演员，并将其重命名为`AmbientSound_Vivaldi`。在**详细信息**面板中，滚动到**声音**部分，点击**声音**旁边的箭头以显示你在游戏关卡包中的声音资产，如下面的截图所示。选择**Vivaldi_Spring_Allegro_ByJohnHarrison_Cue**。

![练习 – 向关卡添加自定义声音](img/B03679_06_18.jpg)

通过点击**AmbientSound_Vivaldi**的**详细信息**面板中的**播放**按钮，检查你是否还能听到音乐。现在，让我们构建关卡并运行它。注意，当你开始关卡时，音乐会播放。

# 配置声音提示编辑器

双击**Vivaldi_Spring_Allegro_ByJohnHarrison_Cue**以打开声音提示编辑器。注意，在右侧有一个**调色板**，其中包含节点列表，如下面的截图所示。这些节点可以用来控制声音的播放或听到的方式。

![配置声音提示编辑器](img/B03679_06_19.jpg)

如果你发现无法使用列表中的节点来实现你的声音设计，你可以通过 UE4 源代码请求创建新的节点。

# 概述

粒子和声音都是游戏中的非常有趣的组件，它们需要非常专业的技能，非常适合它们的设计和创建。粒子系统创建者通常拥有强大的艺术和技术背景；需要艺术感来创建合适的纹理，而技术能力有助于调整分布/值，以创建适当的整体效果。音频工程师通常拥有强大的音乐背景。他们可能是作曲家和音乐家，对游戏充满热情。

在本章的前半部分，我们学习了什么是粒子系统。我们学习了粒子系统是如何用于创建游戏中的效果的，例如下雪、降雨、火焰、烟花、爆炸效果等等。粒子系统可以通过发射器的组合，有效地使用纹理渲染小型的移动模糊粒子。每个发射器都有许多可配置的模块，可以控制属性，如出生率、寿命、速度以及创建所需效果所需的加速度。在本章中，我们介绍了如何编辑现有的火爆炸粒子系统，将其转变为壁炉效果，并将其放置在客厅中。通过这个例子，我们还探讨了可以应用于粒子系统设计过程的一些基本原理，以及如何对几个流行的基本模块进行微调，以创建我们想要的效果。

本章的后半部分介绍了如何在关卡中包含声音。我们学习了声音/音乐的构思、创作、录制，以及最终导入到 Unreal 编辑器中的过程。我们还介绍了 Unreal 编辑器目前支持的音频格式，并对每个组件进行了一些解释，以便您更好地了解声音。接下来，我们进行了一个简单的练习，导入在线音频文件，并在游戏关卡中播放我们下载的音乐。

我希望您对本章中游戏所需的粒子系统创建过程和音频效果有了更深入的理解。我们将通过一些地形编辑继续提升我们的游戏关卡，并在下一章中创建电影般的效果。
