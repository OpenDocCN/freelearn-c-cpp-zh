- en: '*Chapter 12*: COVID-19 Digital Body Temperature Measurement (Thermometer)'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*第12章*：COVID-19数字体温测量（体温计）'
- en: This chapter describes an interesting project where you will develop a touchless
    thermometer to measure human body temperature. This digital thermometer could
    be useful for supporting the diagnosis of people with COVID-19\. The electronics
    project explained in this chapter involves the use of a very capable **infrared**
    (**IR**) temperature sensor that will check the body temperature. Additionally,
    you will learn and practice how to connect an IR temperature sensor to a microcontroller
    board using the **Inter-Integrated Circuit** (**I2C**) data transmission protocol.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章描述了一个有趣的项目，你将开发一个非接触式体温计来测量人体温度。这种数字体温计可能对支持COVID-19患者的诊断有所帮助。本章中解释的电子项目涉及使用一个非常强大的**红外**（**IR**）温度传感器来检测体温。此外，你将学习和练习如何使用**集成电路间**（**I2C**）数据传输协议将红外温度传感器连接到微控制器板。
- en: Important note
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: The body temperature measurement project described in this chapter should not
    be used as a definitive and accurate way to determine whether a person has COVID-19
    or not. It is for demonstration and learning purposes only.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章中描述的体温测量项目不应作为确定一个人是否患有COVID-19的最终和准确方法。它仅用于演示和学习目的。
- en: 'In this chapter, we will cover the following main topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主要主题：
- en: Programming the I2C interface
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 编程I2C接口
- en: Connecting an IR temperature sensor to the microcontroller board
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将红外温度传感器连接到微控制器板
- en: Showing the temperature on an LCD
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在LCD上显示温度
- en: Testing the thermometer
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 测试体温计
- en: By the end of this chapter, you will have learned how to get useful data from
    an IR temperature sensor and how to effectively show body temperature data on
    an LCD connected to a microcontroller board. You will also learn how the I2C data
    transmission protocol works to get data from the IR sensor, and how to properly
    test an IR temperature sensor.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 到本章结束时，你将学会如何从红外温度传感器获取有用的数据，以及如何有效地在连接到微控制器板的LCD上显示体温数据。你还将了解I2C数据传输协议是如何从红外传感器获取数据，以及如何正确测试红外温度传感器。
- en: Technical requirements
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'The software tool that you will be using in this chapter is the **Arduino IDE**
    for editing and uploading your programs to the Blue Pill microcontroller board.
    The code used in this chapter can be found in the book''s GitHub repository:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 本章中你将使用的软件工具是**Arduino IDE**，用于编辑和上传你的程序到Blue Pill微控制器板。本章中使用的代码可以在本书的GitHub仓库中找到：
- en: '[https://github.com/PacktPublishing/DIY-Microcontroller-Projects-for-Hobbyists/tree/master/Chapter12](https://github.com/PacktPublishing/DIY-Microcontroller-Projects-for-Hobbyists/tree/master/Chapter12)'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://github.com/PacktPublishing/DIY-Microcontroller-Projects-for-Hobbyists/tree/master/Chapter12](https://github.com/PacktPublishing/DIY-Microcontroller-Projects-for-Hobbyists/tree/master/Chapter12)'
- en: 'The Code in Action video for this chapter can be found here: [https://bit.ly/2SMUkPw](https://bit.ly/2SMUkPw)'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的“代码在行动”视频可在此处找到：[https://bit.ly/2SMUkPw](https://bit.ly/2SMUkPw)
- en: 'In this chapter, we will use the following pieces of hardware:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将使用以下硬件设备：
- en: One solderless breadboard.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个无焊面包板。
- en: One Blue Pill microcontroller board.
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个Blue Pill微控制器板。
- en: One micro-USB cable for connecting your microcontroller board to a computer
    and a power bank.
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一条micro-USB电缆，用于将微控制器板连接到计算机和移动电源。
- en: One Arduino Uno microcontroller board.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个Arduino Uno微控制器板。
- en: One USB 2.0 A to B cable for the Arduino Uno board.
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个USB 2.0 A到B电缆，用于Arduino Uno板。
- en: Two USB power banks.
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 两个USB移动电源。
- en: One ST-Link/V2 electronic interface, needed for uploading the compiled code
    to the Blue Pill. Bear in mind that the ST-Link/V2 requires four female-to-female
    DuPont wires.
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个ST-Link/V2电子接口，用于将编译后的代码上传到Blue Pill。请注意，ST-Link/V2需要四条公对公的杜邦线。
- en: One MLX90614ESF-DCA-000 temperature sensor (it works with 3.3 volts).
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个MLX90614ESF-DCA-000温度传感器（它适用于3.3伏特）。
- en: One 0.1 microfarad capacitor. It generally has a 104 label on it.
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个0.1微法拉电容器。它通常有一个104的标签。
- en: One 1602 16x2 I2C LCD.
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个1602 16x2 I2C LCD。
- en: A dozen male-to-male and a dozen male-to-female DuPont wires.
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一打公对公和一打公对母的杜邦线。
- en: The next section describes how to code the I2C protocol and the code that will
    run on the Blue Pill and Arduino Uno microcontroller boards. The Arduino Uno is
    used for getting data from the IR sensor.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个部分将描述如何编写I2C协议以及将在Blue Pill和Arduino Uno微控制器板上运行的代码。Arduino Uno用于从红外传感器获取数据。
- en: Programming the I2C interface
  id: totrans-27
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 编程I2C接口
- en: In this section, we will review how to obtain useful data from the MLX90614
    temperature sensor to be transmitted using the **I2C** protocol, also known as
    **IIC**. It is a serial data communication protocol that is practical for interfacing
    sensors, LCDs, and other devices to microcontroller boards that support I2C. The
    next section defines what I2C is.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将回顾如何从 MLX90614 温度传感器获取有用的数据，并使用 **I2C** 协议（也称为 **IIC**）进行传输。这是一个实用的串行数据通信协议，适用于将传感器、LCD
    和其他设备连接到支持 I2C 的微控制器板。下一节将定义 I2C 是什么。
- en: The I2C protocol
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: I2C 协议
- en: 'I2C is a synchronous serial communication protocol that allows interconnecting
    sensors, microcontrollers, displays, **analog-to-digital converters** (**ADCs**),
    and so on, at a short distance using a common **bus** (a bus works as a main digital
    road). The I2C bus is composed of a few lines (wires) that all the devices share
    and use for transmitting and exchanging data. The I2C protocol is practical and
    beneficial because it uses only two wires for data communication. Another benefit
    of I2C is that in theory, it can support up to 1,008 devices connected to the
    same I2C bus! It is also worth mentioning that more than one microcontroller can
    be connected to the same bus, although they must take turns to access data from
    the I2C bus. *Figure 12.1* shows an overview of the I2C bus configuration:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: I2C 是一种同步串行通信协议，允许通过一个共同的 **总线**（总线作为主要的数字道路）在短距离内连接传感器、微控制器、显示器、**模数转换器**（**ADCs**）等设备。I2C
    总线由几条所有设备共享并用于传输和交换数据的线路（电线）组成。I2C 协议实用且有益，因为它仅使用两条电线进行数据通信。I2C 的另一个好处是，从理论上讲，它可以支持多达
    1,008 个设备连接到同一个 I2C 总线！也值得提到的是，可以连接多个微控制器到同一个总线，尽管它们必须轮流从 I2C 总线访问数据。*图 12.1*
    展示了 I2C 总线配置的概述：
- en: '![Figure 12.1 – An overview of the I2C bus](img/Figure_12.1_B16413.jpg)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![图 12.1 – I2C 总线概述](img/Figure_12.1_B16413.jpg)'
- en: Figure 12.1 – An overview of the I2C bus
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 图 12.1 – I2C 总线概述
- en: 'As *Figure 12.1* shows, the bus allows the connection of two main types of
    devices: a **controller** (also known as a **master**) and a **peripheral** (also
    known as a **slave**). The controller is usually a microcontroller board, but
    it can also be a personal computer or another type of device that will take, send,
    process, and use data from and to the peripheral(s). A peripheral can be a sensor
    that will provide data to a controller, or a display (such as an LCD) where data
    coming from a controller is displayed. There are other types of peripherals that
    can be connected to an I2C bus.'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 如 *图 12.1* 所示，总线允许连接两种主要类型的设备：一个 **控制器**（也称为 **主设备**）和一个 **外围设备**（也称为 **从设备**）。控制器通常是微控制器板，但它也可以是个人计算机或其他类型的设备，它将从外围设备（s）接收、发送、处理和使用数据。外围设备可以是提供数据给控制器的传感器，或者是一个显示设备（如
    LCD），其中控制器发送的数据将被显示。还可以连接其他类型的设备到 I2C 总线。
- en: Note
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Not all LCDs can be directly connected to an I2C bus. To do that, the LCD must
    have an I2C adapter connected to it, often called an **I2C backpack** or **I2C
    module**. This is a small electronic circuit that handles I2C communications,
    typically attached at the back of some LCDs.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 并非所有液晶显示器（LCDs）都可以直接连接到 I2C 总线。为了做到这一点，LCD 必须连接一个 I2C 适配器，通常称为 **I2C 背包** 或
    **I2C 模块**。这是一个处理 I2C 通信的小型电子电路，通常附着在一些 LCD 的背面。
- en: An I2C bus contains two data lines (wires) called **SDA** and **SCL**. The SCL
    wire transports the clock signal necessary for synchronizing the transmitted data
    on the bus, and the SDA wire is the data signal transporting all the data between
    the controller(s) and the peripheral(s).
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: I2C 总线包含两条数据线（电线），称为 **SDA** 和 **SCL**。SCL 线传输总线上传送数据所需的时钟信号，而 SDA 线是数据信号，负责在控制器（s）和外围设备（s）之间传输所有数据。
- en: The devices connected to the I2C bus also have two more wires. One of them is
    the ground (sometimes labeled `GND` or `Vss`). This wire should be connected to
    the common ground of the electronic circuit where the microcontroller board is
    connected to, and a voltage wire (labeled `Vdd`). This is connected to 5 volts,
    but it sometimes works with 3.3 volts. The I2C protocol is quite robust, allowing
    a bit rate of up to 5 Mbit/s. Generally, either 5 or 3.3 volts are provided by
    the microcontroller board, used by the devices connected to the I2C bus.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 连接到I2C总线的设备还有两根额外的线。其中一根是地线（有时标记为`GND`或`Vss`）。这根线应该连接到电子电路的公共地，其中微控制器板连接到，并且一根电压线（标记为`Vdd`）。这根线连接到5伏，但有时也可以用3.3伏。I2C协议相当健壮，允许最高达到5
    Mbit/s的比特率。通常，微控制器板为连接到I2C总线的设备提供5伏或3.3伏。
- en: Many microcontroller boards support the I2C protocol. Fortunately, the Blue
    Pill includes I2C pins for that. In fact, the Blue Pill has three sets of pins
    for connecting three I2C devices directly. In this chapter, we will use the Blue
    Pill's B6 (SCL) and B7 (SDA) pins for the I2C communication only.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 许多微控制器板支持I2C协议。幸运的是，Blue Pill包含用于此目的的I2C引脚。实际上，Blue Pill有三组引脚，可以直接连接三个I2C设备。在本章中，我们将使用Blue
    Pill的B6（SCL）和B7（SDA）引脚进行I2C通信。
- en: Note
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: The Arduino microcontroller boards also support the I2C protocol. For example,
    the pins A4 and A5 from the Arduino Uno board provide the connection for the SDA
    and SCL wires, respectively.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: Arduino微控制器板也支持I2C协议。例如，Arduino Uno板的A4和A5引脚分别提供SDA和SCL线的连接。
- en: It is worth noting that the I2C protocol is handled by the `Wire.h` library,
    found by default in the Arduino IDE configuration. You don't need to install this
    library.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 值得注意的是，I2C协议由`Wire.h`库处理，该库默认位于Arduino IDE配置中。您不需要安装此库。
- en: In the next section, we will review how to code the I2C protocol to get temperature
    data from the IR sensor using an *Arduino Uno* microcontroller board.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将回顾如何使用Arduino Uno微控制器板编写I2C协议以获取红外传感器的温度数据。
- en: I2C coding
  id: totrans-43
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: I2C编码
- en: In this section, we review the code for reading the temperature data from the
    MLX90614 IR sensor by an Arduino Uno microcontroller board, working as a peripheral
    (slave). This board will send the temperature data to the Blue Pill through the
    I2C bus, and the Blue Pill (working as a controller) will display it on an LCD.
    This LCD is also connected to the I2C bus. The full description of the Blue Pill
    and the Arduino Uno connections is found in the *Connecting an IR temperature
    sensor to the microcontroller board* section.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们回顾了通过Arduino Uno微控制器板作为外围设备（从设备）读取MLX90614红外传感器温度数据的代码。该板将通过I2C总线将温度数据发送到Blue
    Pill，而Blue Pill（作为控制器）将在LCD上显示它。这个LCD也连接到I2C总线。关于Blue Pill和Arduino Uno连接的完整描述可以在*将红外温度传感器连接到微控制器板*部分找到。
- en: The next section explains the necessary code that runs on the Arduino Uno board.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 下一节将解释在Arduino Uno板上运行的必要代码。
- en: Coding the Arduino Uno software (peripheral)
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 编写Arduino Uno软件（外围设备）
- en: 'In order to code an application on the Arduino Uno for reading the MLX90614
    IR sensor data, we will use a library to be included in our Arduino IDE program,
    called `Adafruit_MLX90614.h`. You can install this library from the Arduino IDE:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 为了在Arduino Uno上编写读取MLX90614红外传感器数据的程序，我们将使用一个库，该库将包含在我们的Arduino IDE程序中，称为`Adafruit_MLX90614.h`。您可以从Arduino
    IDE安装此库：
- en: Go to **Tools** | **Manage Libraries**.
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到**工具** | **管理库**。
- en: Set **Type** as **All** and **Topic** as **All**.
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**类型**设置为**所有**，将**主题**设置为**所有**。
- en: In the search field, type `Adafruit MLX90614`.
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在搜索框中，输入`Adafruit MLX90614`。
- en: Install the latest version of the `Adafruit MLX90614` library (do not install
    the Mini one). The `Wire.h` library controls the I2C protocol, which is already
    installed on the Arduino IDE's files.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 安装`Adafruit MLX90614`库的最新版本（不要安装Mini版本）。`Wire.h`库控制I2C协议，该库已安装在Arduino IDE的文件中。
- en: 'The following is the code that runs on the Arduino Uno (its file is called
    `peripheral.ino`; you can find it on the GitHub page). `0X8` is the hexadecimal
    address assigned to the Arduino Uno board as the peripheral (slave) for the I2C
    protocol. We assigned 0x8 arbitrarily; it can be any hexadecimal address, but
    make sure to use the same address for both the master and the slave:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是在Arduino Uno上运行的代码（其文件名为`peripheral.ino`；您可以在GitHub页面上找到它）。`0X8`是分配给Arduino
    Uno板作为I2C协议的从设备（外围设备）的十六进制地址。我们任意分配了0x8；它可以是任何十六进制地址，但请确保主设备和从设备使用相同的地址：
- en: '[PRE0]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'This function sets up the Arduino Uno as a peripheral, assigning it the 0x8
    address. The Blue Pill will identify the Arduino Uno with this address. This function
    also sets up the interrupt that handles incoming requests from the controller
    (master), which is the Blue Pill. The Blue Pill will be acquiring the temperature
    data from the sensor:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 此函数将Arduino Uno设置为从设备，分配给它0x8地址。Blue Pill将使用此地址识别Arduino Uno。此函数还设置了处理来自控制器（主设备）的请求的中断，即Blue
    Pill。Blue Pill将从传感器获取温度数据：
- en: '[PRE1]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'This function will read the temperature from the sensor continuously. The `delay`
    function makes a small pause to allow the sensor to get new temperature readings:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 此函数将连续从传感器读取温度。`delay`函数使传感器有机会获取新的温度读数：
- en: '[PRE2]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'This function runs every time the controller (master) requests data from the
    peripheral (slave):'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 此函数每次控制器（主设备）从外围设备（从设备）请求数据时都会运行：
- en: '[PRE3]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: From the previous code snippet, we see that the `write()` function is used to
    send the temperature data to the controller (the Blue Pill).
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 从之前的代码片段中，我们可以看到`write()`函数用于将温度数据发送到控制器（Blue Pill）。
- en: We added the value of `3` to the `AmbientobjC` variable to compensate for the
    ambient temperature. It is important to clarify that the temperature readings
    are not absolute and will slightly change depending on a number of factors, including
    the ambient temperature, whether the person is outside. So, you may need to test
    the temperature readings a number of times and adjust the `AmbientobjC` variable
    accordingly, perhaps comparing the sensor readings against medical body thermometer
    readings.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将`3`的值添加到`AmbientobjC`变量中，以补偿环境温度。重要的是要明确，温度读数不是绝对的，并且会因多种因素略有变化，包括环境温度、是否有人在外面。因此，您可能需要多次测试温度读数，并相应地调整`AmbientobjC`变量，也许可以将传感器读数与医疗体温计读数进行比较。
- en: Note
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: The code uploaded to the GitHub platform contains extensive comments that explain
    most of the code lines.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 上传到GitHub平台的代码包含大量注释，解释了大多数代码行。
- en: The next section explains the necessary code for running the Blue Pill as a
    controller.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个部分解释了运行Blue Pill作为控制器所需的代码。
- en: Coding the Blue Pill software (controller)
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 编写Blue Pill软件（控制器）
- en: 'The following code (its file is called `controller.ino`; you can find it on
    the GitHub page) will run on the Blue Pill microcontroller board (the controller).
    This code will serve to obtain the temperature data sent by the the Arduino Uno
    board, and then display it on an LCD connected to the I2C bus:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码（其文件名为`controller.ino`；您可以在GitHub页面上找到它）将在Blue Pill微控制器板上运行（控制器）。此代码将用于获取由Arduino
    Uno板发送的温度数据，并将其显示在连接到I2C总线的LCD上：
- en: '[PRE4]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The previous code snippet shows the `LiquidCrystal_I2C.h` library for controlling
    the LCD using the I2C protocol. Its next line sets up the LCD address to `0x27`
    for a 16-character and 2-line (16x2) LCD. The library can be downloaded from [https://github.com/fdebrabander/Arduino-LiquidCrystal-I2C-library](https://github.com/fdebrabander/Arduino-LiquidCrystal-I2C-library).
    Download the `LiquidCrystal_I2C.h` file and copy it to the Arduino libraries folder,
    usually `Arduino/libraries`.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 之前的代码片段展示了用于通过I2C协议控制LCD的`LiquidCrystal_I2C.h`库。其下一行将LCD地址设置为`0x27`，用于16字符和2行（16x2）LCD。该库可以从[https://github.com/fdebrabander/Arduino-LiquidCrystal-I2C-library](https://github.com/fdebrabander/Arduino-LiquidCrystal-I2C-library)下载。下载`LiquidCrystal_I2C.h`文件并将其复制到Arduino库文件夹中，通常为`Arduino/libraries`。
- en: 'The next code snippet starts an I2C connection using a peripheral (slave) address,
    initializing the Serial Monitor and the LCD:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 下一代码片段开始使用外围（从设备）地址启动I2C连接，初始化串行监视器和LCD：
- en: '[PRE5]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'This `loop()` function continuously reads the temperature data sent by the
    peripheral (the Arduino Uno):'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 此`loop()`函数连续读取由外围设备（Arduino Uno）发送的温度数据：
- en: '[PRE6]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: The previous code snippet shows how to read the data in bytes from the Arduino
    Uno. Remember that we can't transmit float values directly over the I2C bus. The
    code that runs on the Arduino Uno converts each floating-point temperature data
    reading into four character bytes. The code running on the Blue Pill converts
    the four bytes back to a floating-point number.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 之前的代码片段展示了如何从Arduino Uno读取字节数据。请记住，我们无法直接通过I2C总线传输浮点值。运行在Arduino Uno上的代码将每个浮点温度数据读数转换为四个字符的字节。运行在Blue
    Pill上的代码将这四个字节转换回浮点数。
- en: The code submitted to the GitHub page contains many comments explaining the
    code lines.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 提交给GitHub页面的代码包含许多注释，解释了代码行。
- en: The following section explains how to connect the IR sensor to the Blue Pill
    microcontroller board.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 以下部分解释了如何将红外传感器连接到Blue Pill微控制器板。
- en: Connecting an IR temperature sensor to the microcontroller board
  id: totrans-76
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将红外温度传感器连接到微控制器板
- en: This section explains the main technical characteristics of the MLX90614 temperature
    sensor. It also shows how to connect it to the Blue Pill microcontroller board
    using the *I2C protocol*.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 本节解释了MLX90614温度传感器的主要技术特性，并展示了如何使用*I2C协议*将其连接到Blue Pill微控制器板。
- en: First, let's explain the main characteristics of the MLX90614 sensor.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们解释MLX90614传感器的主要特性。
- en: The MLX90614 IR sensor
  id: totrans-79
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: MLX90614红外传感器
- en: The MLX90614 sensor, manufactured by the company Melexis, is a powerful yet
    compact IR sensor. This sensor uses IR rays to measure the amount of heat generated
    by the human body or by basically any object. Being a non-contact thermometer,
    it reduces chance of spreading disease when checking the body temperature, and
    you don't need to clean it.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: MLX90614传感器由Melexis公司制造，是一款功能强大且紧凑的红外传感器。该传感器使用红外线来测量人体或任何物体产生的热量。作为一种非接触式体温计，它减少了在检查体温时传播疾病的机会，并且不需要清洁。
- en: The MLX0-614 is technically a sensor contained in an **integrated circuit**
    (**IC**), since it has extra electronic components and smaller circuits, including
    an ADC, a voltage regulator, and a **digital-signal processor** (**DSP**).
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: MLX0-614在技术上是一个包含在**集成电路**（**IC**）中的传感器，因为它具有额外的电子组件和较小的电路，包括ADC、电压调节器和**数字信号处理器**（**DSP**）。
- en: 'The following are some of the sensor''s technical characteristics:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一些传感器的技术特性：
- en: Body temperature range of -40 to +125 degrees Celsius.
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 体温范围为-40至+125摄氏度。
- en: Ambient temperature range of -70 to 382.2 degrees Celsius.
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 环境温度范围为-70至382.2摄氏度。
- en: Medical (high) accuracy calibration.
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 医疗（高）精度校准。
- en: Measurement resolution close to 0.02 degrees Celsius.
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 测量分辨率接近0.02摄氏度。
- en: This sensor is available in both 3-volt and 5-volt versions.
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 该传感器有3伏和5伏两种版本。
- en: A convenient sleep mode that reduces power consumption.
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一种方便的睡眠模式，可降低功耗。
- en: 'The MLX90614 family of sensors'' datasheet can be downloaded from the following
    link:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: MLX90614系列传感器的数据表可以从以下链接下载：
- en: '[https://www.melexis.com/-/media/files/documents/datasheets/mlx90614-datasheet-melexis.pdf](https://www.melexis.com/-/media/files/documents/datasheets/mlx90614-datasheet-melexis.pdf)'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://www.melexis.com/-/media/files/documents/datasheets/mlx90614-datasheet-melexis.pdf](https://www.melexis.com/-/media/files/documents/datasheets/mlx90614-datasheet-melexis.pdf)'
- en: 'The MLX90614 IR sensor generates two types of temperature measurements: ambient
    temperature and an object temperature reading. The **ambient temperature** is
    the temperature registered on the IR-sensitive part of the sensor (an internal
    component), which is close to room temperature. The **object temperature** measures
    how much IR light is emitted by an object, which can be used for measuring body
    temperature. In this chapter, we will use only the object temperature measurement.'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: MLX90614红外传感器生成两种类型的温度测量：环境温度和物体温度读数。**环境温度**是传感器红外敏感部分（内部组件）上记录的温度，接近室温。**物体温度**测量物体发出的红外光量，可用于测量体温。在本章中，我们将仅使用物体温度测量。
- en: '*Figure 12.2* shows the MLX90614 sensor:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '*图12.2*显示了MLX90614传感器：'
- en: '![Figure 12.2 – The MLX90614 sensor showing its four pins](img/Figure_12.2_B16413.jpg)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![图12.2 – 显示其四个引脚的MLX90614传感器](img/Figure_12.2_B16413.jpg)'
- en: Figure 12.2 – The MLX90614 sensor showing its four pins
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.2 – 显示其四个引脚的MLX90614传感器
- en: In *Figure 12.2*, please note that there is a round transparent window on the
    sensor, where the IR light passes through, hitting an internal sensitive part.
    This part will convert IR light into electrical impulses.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 在*图12.2*中，请注意传感器上有一个圆形透明窗口，红外光线通过该窗口，击中内部敏感部分。这个部分将红外光转换为电脉冲。
- en: '*Figure 12.3* shows the *top* view of the MLX90614 sensor diagram pinout:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: '*图12.3*显示了MLX90614传感器图引脚图的**顶部**视图：'
- en: '![Figure 12.3 – MLX90614 IR sensor pinout](img/Figure_12.3_B16413.jpg)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![图12.3 – MLX90614红外传感器引脚图](img/Figure_12.3_B16413.jpg)'
- en: Figure 12.3 – MLX90614 IR sensor pinout
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.3 – MLX90614红外传感器引脚图
- en: In *Figure 12.3*, you will notice that there is a small notch on top of the
    sensor. This notch helps you identify which pin is which.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 在*图12.3*中，你会注意到传感器顶部有一个小缺口。这个缺口有助于你识别哪个引脚是哪个。
- en: The MLX90614's SCL and SDA pins are connected to a microcontroller board's SCL
    and SDA, respectively. The ground pin is connected to the microcontroller board's
    ground, and the voltage pin is connected to either 3.3 or 5 volts.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: MLX90614的SCL和SDA引脚分别连接到微控制器板的SCL和SDA，地线引脚连接到微控制器板的地线，电压引脚连接到3.3伏或5伏。
- en: 'The MLX90614 sensor is manufactured in different types or versions. One of
    the most important differences is its supply voltage. It is important to verify
    its part number:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: MLX90614传感器以不同的类型或版本制造。其中最重要的区别之一是其供电电压。验证其零件号非常重要：
- en: '**MLX90614ESF-Axx**, **MLX90614KSF-Axx**: Their supply voltage is 5.5 volts.'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**MLX90614ESF-Axx**，**MLX90614KSF-Axx**：它们的供电电压为5.5伏。'
- en: '**MLX90614ESF-Bxx**, **MLX90614ESF-Dxx**: Their supply voltage is 3.6 volts.'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**MLX90614ESF-Bxx**，**MLX90614ESF-Dxx**：它们的供电电压为3.6伏。'
- en: For example, the IR sensor that we use in this chapter is the MLX90614ESF-DCA-000,
    which, according to the manufacturer's datasheet, requires 3.6 volts to work.
    So, you can use the 3.3 volts supplied by many microcontroller boards for using
    this type of sensor.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，我们本章使用的红外传感器是MLX90614ESF-DCA-000，根据制造商的数据表，它需要3.6伏才能工作。因此，你可以使用许多微控制器板提供的3.3伏电压来使用这种类型的传感器。
- en: Important note
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: Always check the IR sensor part number to determine what type of supply voltage
    it will need. If you apply a voltage higher than its required supply voltage,
    you can damage the sensor.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 总是检查红外传感器的零件号以确定其所需的供电电压。如果你施加高于其所需供电电压的电压，可能会损坏传感器。
- en: Another technical aspect that you should take into account is the sensor's field
    of view. It is a relationship between the distance between the sensor and an object
    that its temperature is being measured. This will determine the sensing area being
    observed by the sensor. For every 1 centimeter that the object moves away from
    the sensor's surface, the sensing area grows by 2 centimeters. Ideally, the distance
    between the sensor and the object (for example, human skin) to be measured should
    be between 2 and 5 centimeters.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个你应该考虑的技术方面是传感器的视野范围。这是指传感器与被测物体之间的距离关系。这将决定传感器观察到的感应区域。每当物体从传感器表面移动1厘米，感应区域就会增加2厘米。理想情况下，传感器与被测物体（例如，人体皮肤）之间的距离应该在2到5厘米之间。
- en: The next section explains the GY-906 module, containing an IR sensor.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个部分将解释GY-906模块，其中包含一个红外传感器。
- en: The GY-906 sensor module
  id: totrans-109
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: GY-906传感器模块
- en: 'This section describes the main characteristics and pinout of the GY-906 sensor
    module. The MLX90614 sensor (see *Figure 12.4*) is also sold embedded in a module
    called **GY-906**:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 本节描述了GY-906传感器模块的主要特性和引脚配置。MLX90614传感器（见*图12.4*）也以模块形式出售，称为**GY-906**：
- en: '![Figure 12.4 – The GY-906 module](img/Figure_12.4_B16413.jpg)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![图12.4 – GY-906模块](img/Figure_12.4_B16413.jpg)'
- en: Figure 12.4 – The GY-906 module
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.4 – GY-906模块
- en: As *Figure 12.4* shows, the GY-906 module has four pins dedicated to I2C communication.
    The VIN pin is connected to voltage, either 3.3 volts or 5 volts depending on
    the type of MLX90641 sensor that it contains. Please refer to the *The MLX90614
    IR sensor* section to help identify what voltage the embedded sensor will need
    in the module. You will also need to consult the module's datasheet. For example,
    a GY-906 module may have an MLX90614ESF-DCA-000 IR sensor embedded in it, needing
    3.3 volts to work. So, GY-906 modules could have any MLX90614 sensor type embedded
    in them. The module's GND pin is connected to the microcontroller board's ground.
    The SCL pin is for transmitting the signal clock, and the SDA pin transmits the
    signal data.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 如*图12.4*所示，GY-906模块有四个专用引脚用于I2C通信。VIN引脚连接到电压，具体为3.3伏或5伏，这取决于它所包含的MLX90641传感器的类型。请参考*MLX90614红外传感器*部分以帮助识别模块中嵌入式传感器的所需电压。你还需要查阅模块的数据表。例如，一个GY-906模块可能内置了MLX90614ESF-DCA-000红外传感器，需要3.3伏才能工作。因此，GY-906模块可能内置了任何MLX90614传感器类型。模块的GND引脚连接到微控制器板的地线。SCL引脚用于传输时钟信号，SDA引脚用于传输数据信号。
- en: Besides the MLX90614 sensor, the GY-906 module also contains other electronic
    components, such as pull-up resistors.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 除了MLX90614传感器外，GY-906模块还包含其他电子元件，例如上拉电阻。
- en: The decision on using either an MLX90614 sensor or a GY-906 module rests on
    a number of factors, including cost, type of application, and size. Bear in mind
    that the GY-906 module is somewhat larger than the MLX90614 sensor. In this chapter,
    we will use the MLX90614 sensor and not the module, because the sensor alone is
    a cost-effective option and to demonstrate how to directly connect the sensor
    to an I2C bus. However, both the GY-906 module and the MLX90614 sensor have the
    same functions.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 使用MLX90614传感器或GY-906模块的决定取决于多个因素，包括成本、应用类型和尺寸。请注意，GY-906模块比MLX90614传感器略大。在本章中，我们将使用MLX90614传感器而不是模块，因为单独的传感器是一个经济实惠的选择，并且可以展示如何直接将传感器连接到I2C总线。然而，GY-906模块和MLX90614传感器具有相同的功能。
- en: The next section shows how to connect the MLX90614 sensor to a microcontroller
    board.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 下一节将展示如何将MLX90614传感器连接到微控制器板。
- en: Connection of the IR sensor to an Arduino Uno
  id: totrans-117
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 红外传感器与Arduino Uno的连接
- en: 'In this section, we describe how to connect the MLX90614 sensor to the I2C
    pins of an Arduino Uno microcontroller board, which will be working as a peripheral
    (slave). The Blue Pill board will be the controller (master), receiving temperature
    data sent by the Arduino Uno through the I2C bus, as shown in *Figure 12.5*:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们描述了如何将MLX90614传感器连接到Arduino Uno微控制器板上的I2C引脚，该板将作为外围设备（从设备）。Blue Pill板将是控制器（主设备），通过I2C总线接收Arduino
    Uno发送的温度数据，如图*12.5*所示：
- en: '![Figure 12.5 – The controller and peripherals](img/Figure_12.5_B16413.jpg)'
  id: totrans-119
  prefs: []
  type: TYPE_IMG
  zh: '![图12.5 – 控制器和外围设备](img/Figure_12.5_B16413.jpg)'
- en: Figure 12.5 – The controller and peripherals
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.5 – 控制器和外围设备
- en: As *Figure 12.5* shows, both the Blue Pill and the Arduino Uno boards are connected
    to the I2C bus.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 如*图12.5*所示，Blue Pill和Arduino Uno板都连接到I2C总线。
- en: 'We connected the MLX90614 to an Arduino Uno board working as a peripheral (slave)
    for the following reasons:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将MLX90614连接到Arduino Uno板，作为外围设备（从设备），以下是一些原因：
- en: For taking advantage of the I2C data transmission protocol, which only requires
    two data wires.
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了利用I2C数据传输协议，该协议只需要两条数据线。
- en: For practicing the implementation of the I2C protocol using controller (master)
    and peripheral (slave) devices.
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了练习使用控制器（主设备）和外围设备（从设备）实现I2C协议。
- en: For using MLX90614 software libraries that are fully compatible with other microcontroller
    boards (for example, the Arduino family), but not with the Blue Pill board. That
    is why we are connecting the IR sensor to an Arduino Uno board using its respective
    library. This way we could use the Arduino Uno as a peripheral (slave) that is
    100% compatible with the IR sensor.
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了使用与Arduino系列等其他微控制器板（例如）完全兼容的MLX90614软件库，但不与Blue Pill板兼容。这就是为什么我们使用相应的库将红外传感器连接到Arduino
    Uno板。这样，我们可以使用Arduino Uno作为外围设备（从设备），它与红外传感器100%兼容。
- en: For freeing up the Blue Pill (the controller) from processing the sensor's data
    directly, so the Blue Pill can be used to do other processing-intensive tasks.
    In addition, the Blue Pill can be dedicated to obtain the sensor's data and display
    it on an LCD.
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了让Blue Pill（控制器）从直接处理传感器数据中解放出来，以便Blue Pill可以用于执行其他处理密集型任务。此外，Blue Pill可以专门用于获取传感器数据并在LCD上显示。
- en: 'First, we will explain how to connect the MLX90614 IR sensor to an Arduino
    Uno microcontroller board. The connections are shown in *Figure 12.6*:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们将解释如何将MLX90614红外传感器连接到Arduino Uno微控制器板。连接图示在*图12.6*中：
- en: '![Figure 12.6 – The Arduino Uno and IR sensor''s connections](img/Figure_12.6_B16413.jpg)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![图12.6 – Arduino Uno和红外传感器的连接](img/Figure_12.6_B16413.jpg)'
- en: Figure 12.6 – The Arduino Uno and IR sensor's connections
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.6 – Arduino Uno和红外传感器的连接
- en: 'As you can see from *Figure 12.6*, the sensor is connected to analog ports
    A4 and A5, which are also the Arduino Uno''s I2C pins. The 0.1 microfarad capacitor
    is recommended by the sensor''s datasheet to smooth out any high-frequency or
    very-high frequency electrical noise that may be present in the sensor that may
    affect the temperature readings. Here are the steps for connecting everything:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 如*图12.6*所示，传感器连接到模拟端口A4和A5，这些也是Arduino Uno的I2C引脚。传感器数据手册建议使用0.1微法拉电容器来平滑掉传感器中可能存在的任何高频或超高频电气噪声，这些噪声可能会影响温度读数。以下是连接所有设备的步骤：
- en: Connect the sensor's voltage (VDD) pin to Arduino Uno's 3.3 volts pin. Do this
    if you are using an MLX90614ESF-DCA-000 or an MLX90614ESF-BAA-000 sensor. If you
    are using an MLX90614ESF-AAA-000 or an MLX90614KSF-ACC-000 sensor, connect it
    to Arduino Uno's 5 volts pin.
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您使用的是MLX90614ESF-DCA-000或MLX90614ESF-BAA-000传感器，请将其电压（VDD）引脚连接到Arduino Uno的3.3伏特引脚。如果您使用的是MLX90614ESF-AAA-000或MLX90614KSF-ACC-000传感器，请将其连接到Arduino
    Uno的5伏特引脚。
- en: Connect the sensor's ground (VSS) pin to Arduino Uno's ground (GND) pin.
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将传感器的地线（VSS）引脚连接到Arduino Uno的地线（GND）引脚。
- en: Connect the sensor's SDA pin to Arduino Uno's A4 analog port.
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将传感器的SDA引脚连接到Arduino Uno的A4模拟端口。
- en: Connect the sensor's SCL pin to Arduino Uno's A5 analog port.
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将传感器的SCL引脚连接到Arduino Uno的A5模拟端口。
- en: Connect one leg of the 0.1 microfarad capacitor to the sensor's voltage pin
    and the other capacitor's leg to the sensor's ground pin.
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将0.1微法拉电容的一端连接到传感器的电压引脚，另一端连接到传感器的地线引脚。
- en: 'Once you connected the wires and components, upload and run the code to the
    Arduino Uno board called `peripheral.ino`, explained in the *Programming the I2C
    interface* section. It should be showing the temperature data on the Arduino IDE''s
    Serial Monitor. Follow these steps for opening the Serial Monitor for the Arduino
    Uno:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 连接好电线和组件后，将代码上传到名为`peripheral.ino`的Arduino Uno板，该代码在*编程I2C接口*部分中解释。它应该在Arduino
    IDE的串行监视器上显示温度数据。按照以下步骤打开Arduino Uno的串行监视器：
- en: Open **Tools** from the IDE's main menu.
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从IDE的主菜单中打开**工具**。
- en: Select the **Serial Monitor** option.
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**串行监视器**选项。
- en: From the Serial Monitor, make sure to select **9600** bauds.
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从串行监视器中，确保选择**9600**波特率。
- en: Don't forget to select **Arduino Uno** from **Tools** | **Board**.
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 不要忘记从**工具** | **板**中选择**Arduino Uno**。
- en: Select the right USB port where the Arduino Uno is connected, clicking on **Tool**
    | **Port** from the Arduino IDE.
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择Arduino Uno连接的正确USB端口，从Arduino IDE中点击**工具** | **端口**。
- en: The next section describes how to connect a Blue Pill to the Arduino Uno using
    the I2C bus and how to transmit temperature data from the Arduino Uno to the Blue
    Pill.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 下一节描述了如何使用I2C总线将Blue Pill连接到Arduino Uno，以及如何从Arduino Uno传输温度数据到Blue Pill。
- en: Connecting the Blue Pill to the Arduino Uno
  id: totrans-143
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将Blue Pill连接到Arduino Uno
- en: 'This section shows how to connect the Arduino Uno and the Blue Pill through
    the I2C bus. The Arduino Uno will send the IR temperature data to the Blue Pill.
    Remember that the Blue Pill works as a controller (master) and the Arduino Uno
    is the peripheral (slave). *Figure 12.7* shows a Fritzing diagram with the two
    microcontroller boards:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 本节展示了如何通过I2C总线连接Arduino Uno和Blue Pill。Arduino Uno将发送红外温度数据到Blue Pill。请记住，Blue
    Pill作为控制器（主设备）工作，而Arduino Uno是外围设备（从设备）。*图12.7*显示了两个微控制器板的Fritzing图。
- en: '![Figure 12.7 – The Blue Pill and Arduino Uno I2C connections](img/Figure_12.7_B16413.jpg)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![图12.7 – Blue Pill和Arduino Uno的I2C连接](img/Figure_12.7_B16413.jpg)'
- en: Figure 12.7 – The Blue Pill and Arduino Uno I2C connections
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.7 – Blue Pill和Arduino Uno的I2C连接
- en: 'As *Figure 12.7* shows, here are the steps for connecting the Blue Pill to
    the I2C bus:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 如*图12.7*所示，以下是连接Blue Pill到I2C总线的步骤：
- en: Connect Arduino Uno's ground (GND) to Blue Pill's ground (G or `GND`).
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Arduino Uno的地线（GND）连接到Blue Pill的地线（G或`GND`）。
- en: Connect Blue Pill's B7 pin to MLX90614's SDA pin.
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Blue Pill的B7引脚连接到MLX90614的SDA引脚。
- en: Connect Blue Pill's B6 pin to MLX90614's SCL pin.
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Blue Pill的B6引脚连接到MLX90614的SCL引脚。
- en: As you can see from all the connections from *Figure 12.7*, the Blue Pill, the
    IR sensor, and the Arduino Uno board are all connected by the SDA and the SCL
    pins. This is the I2C bus in our application.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 如*图12.7*中所示的所有连接，Blue Pill、红外传感器和Arduino Uno板都通过SDA和SCL引脚连接。这是我们应用中的I2C总线。
- en: Important note
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: Make sure to connect Blue Pill's ground (`G` or `GND`) to Arduino Uno's ground
    (`GND`). This will allow for correct data transmission across the I2C bus between
    the two microcontroller boards.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 确保将Blue Pill的地线（`G`或`GND`）连接到Arduino Uno的地线（`GND`）。这将允许两个微控制器板之间通过I2C总线正确传输数据。
- en: The following section describes how to show the IR temperature measurements
    on an LCD using the I2C bus.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 以下部分描述了如何使用I2C总线在LCD上显示红外温度测量值。
- en: Showing the temperature on an LCD
  id: totrans-155
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在LCD上显示温度
- en: 'This section describes how to display the IR temperature measurement on an
    LCD through the I2C bus. The temperature data is sent by the Arduino Uno to the
    Blue Pill, as shown in the previous section. *Figure 12.8* shows a Fritzing diagram
    containing the microcontroller boards, the LCD, and the IR temperature sensor:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 本节描述了如何通过I2C总线在LCD上显示红外温度测量值。温度数据由Arduino Uno发送到Blue Pill，如前所述。*图12.8* 展示了一个包含微控制器板、LCD和红外温度传感器的Fritzing图：
- en: '![Figure 12.8 – The LCD connected to the I2C bus](img/Figure_12.8_B16413.jpg)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![图12.8 – LCD连接到I2C总线](img/Figure_12.8_B16413.jpg)'
- en: Figure 12.8 – The LCD connected to the I2C bus
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.8 – LCD连接到I2C总线
- en: 'As *Figure 12.8* shows, the LCD connection is simple. It requires four wires
    only, because the LCD used in this chapter is I2C-capable, having an I2C interface
    in the back. The following are the steps for connecting the LCD to the Blue Pill:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 如 *图12.8* 所示，LCD的连接很简单。它只需要四根线，因为本章使用的LCD是I2C兼容的，后面有一个I2C接口。以下是连接LCD到Blue Pill的步骤：
- en: Connect the LCD's ground (`GND`) pin to Blue Pill's ground (`G` or `GND`) pin.
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的接地（`GND`）引脚连接到Blue Pill的接地（`G`或`GND`）引脚。
- en: Connect the LCD's voltage (`VCC`) pin to Blue Pill's 5-volt (5V) pin.
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的电压（`VCC`）引脚连接到Blue Pill的5伏（5V）引脚。
- en: Connect the LCD's SDA pin to Blue Pill's B7 pin.
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的SDA引脚连接到Blue Pill的B7引脚。
- en: Connect the LCD's SCL pin to Blue Pill's B6 pin.
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的SCL引脚连接到Blue Pill的B6引脚。
- en: '*Figure 12.9* depicts the back of the LCD, showing its I2C interface backpack
    attached to it:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: '*图12.9* 描述了LCD的背面，显示了其I2C接口背板连接到它：'
- en: '![Figure 12.9 – The back of the LCD](img/Figure_12.9_B16413.jpg)'
  id: totrans-165
  prefs: []
  type: TYPE_IMG
  zh: '![图12.9 – LCD的背面](img/Figure_12.9_B16413.jpg)'
- en: Figure 12.9 – The back of the LCD
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.9 – LCD的背面
- en: From *Figure 12.9*, you can see that the LCD's I2C interface has a small variable
    resistor, just right of the big IC. You can rotate it to adjust the LCD contrast.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 从 *图12.9* 中，你可以看到LCD的I2C接口有一个小可变电阻，位于大IC的右侧。你可以旋转它来调整LCD的对比度。
- en: The LCD can display up to 16 characters on each of its two rows. This is enough
    to show the IR sensor temperature with two-digit precision and two decimals.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: LCD的每行可以显示多达16个字符。这足以以两位精度和两位小数显示红外传感器的温度。
- en: Important note
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: Make sure to connect the LCD's voltage (`VCC`) to Blue Pill's `5V`. If you connect
    it to a 3.3-volt pin, it may not work properly.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 确保将LCD的电压（`VCC`）连接到Blue Pill的`5V`。如果你将其连接到3.3伏引脚，它可能无法正常工作。
- en: '*Figure 12.10* shows how everything is connected:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: '*图12.10* 展示了所有连接方式：'
- en: '![Figure 12.10 – The microcontroller boards, the sensor, and the LCD](img/Figure_12.10_B16413.jpg)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![图12.10 – 微控制器板、传感器和LCD](img/Figure_12.10_B16413.jpg)'
- en: Figure 12.10 – The microcontroller boards, the sensor, and the LCD
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.10 – 微控制器板、传感器和LCD
- en: '*Figure 12.10* shows that the LCD is showing a temperature of 28.53 degrees
    Celsius, because the IR sensor was unintentionally measuring the temperature of
    an LED lamp when the photo was taken! However, this circuit is intended to be
    used for body temperature measurement. The next section shows how to test the
    sensor by checking the temperature on different parts of the human body. We used
    two power banks connected to the Blue Pill and the Arduino Uno to try them out.
    If you finished the connection of the temperature sensor and the microcontroller
    boards, and if your LCD is displaying a temperature value, congratulations! You
    know how to use a touchless IR temperature sensor.'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: '*图12.10* 显示LCD显示的温度为28.53摄氏度，因为当拍照时，红外传感器无意中测量了LED灯的温度！然而，这个电路的目的是用于测量体温。下一节将展示如何通过检查人体不同部位的温度来测试传感器。我们使用了两个连接到Blue
    Pill和Arduino Uno的移动电源来尝试。如果你已经完成了温度传感器和微控制器板的连接，并且如果你的LCD正在显示温度值，恭喜你！你学会了如何使用非接触式红外温度传感器。'
- en: Testing the thermometer
  id: totrans-175
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 测试温度计
- en: In this section, we will test out how the IR sensor works as a thermometer by
    measuring the temperature of a human body. It seems that different body parts
    will get you slightly different temperature measurements. You should do a number
    of tests by measuring the body temperature from different parts, such as the forehead
    and the earlobe of a person. Remember that the distance between the sensor and
    the skin should be between 2 and 5 centimeters, although you should try out different
    distances and see what happens.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将测试红外传感器作为温度计的工作情况，通过测量人体温度。似乎不同的身体部位会得到略微不同的温度测量值。你应该通过测量不同部位的温度，如人的额头和耳垂，进行多次测试。记住，传感器和皮肤之间的距离应在2至5厘米之间，尽管你应该尝试不同的距离并观察结果。
- en: Before testing the thermometer, make sure that the skin is dry, clean, and unobstructed.
    In addition, confirm that the person has not been exposed to high heat, such as
    being out on a hot and sunny day, because this will change your measurements.
    If you are measuring skin temperature with the thermometer, make sure that the
    person is out of direct sunlight or you will get incorrect readings.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 在测试温度计之前，确保皮肤干燥、清洁且无遮挡。此外，确认此人没有暴露在高温环境中，例如在炎热的阳光下，因为这会改变你的测量结果。如果你使用温度计测量皮肤温度，确保此人不在直射阳光下，否则你会得到错误的读数。
- en: Medical studies indicate that the average skin surface temperature of the human
    body is in the range of 36.3 to 36.6 degrees Celsius. This is considered normal.
    However, a temperature higher than 37 degrees Celsius is suggestive of fever.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 医学研究显示，人体平均皮肤表面温度在36.3至36.6摄氏度之间。这被认为是正常的。然而，高于37摄氏度的温度提示可能是发烧。
- en: 'With these tips in mind, let''s see how our thermometer works. *Figure 12.11*
    shows a person testing the IR sensor:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 在考虑了这些提示之后，让我们看看我们的温度计是如何工作的。*图12.11*显示了一个正在测试红外传感器的个人：
- en: '![Figure 12.11 – Measuring the temperature](img/Figure_12.11_B16413.jpg)'
  id: totrans-180
  prefs: []
  type: TYPE_IMG
  zh: '![图12.11 – 测量温度](img/Figure_12.11_B16413.jpg)'
- en: Figure 12.11 – Measuring the temperature
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.11 – 测量温度
- en: As *Figure 12.11* shows, the measured temperature was 36.55 degrees Celsius,
    which is within the normal range for adults. The tester needed to place her forefront
    close to the IR sensor to get reliable measurements. The distance between the
    forehead and the sensor can be increased by using a mirror tube placed on top
    of the sensor to steer the IR light through it.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 如*图12.11*所示，测量的温度为36.55摄氏度，这是成年人的正常范围。测试者需要将她的额头靠近红外传感器以获得可靠的测量值。可以通过在传感器上方放置一个镜子管来增加额头和传感器之间的距离，以引导红外光通过它。
- en: Now that we have tested the chapter and realized that the thermometer works
    perfectly, let's recap in the *Summary* what we have learned.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经测试了本章，并意识到温度计工作得非常完美，让我们在*摘要*中回顾一下我们学到了什么。
- en: Summary
  id: totrans-184
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, you learned the basics of connecting an IR temperature sensor
    to a microcontroller board using the I2C serial data transmission protocol. As
    you could see, the I2C bus is an important part of the IR thermometer that we
    built in this chapter. This IR thermometer can be effective for checking human
    body temperature, like a regular thermometer will do. Since the temperature measurement
    is contactless, this can prevent the human body from touching the sensor and thus
    avoiding spreading viruses such as SARS-CoV-2.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你学习了使用I2C串行数据传输协议将红外温度传感器连接到微控制器板的基本知识。正如你所见，I2C总线是我们本章构建的红外温度计的一个重要部分。这种红外温度计可以有效地检查人体温度，就像普通温度计一样。由于温度测量是非接触式的，这可以防止人体接触传感器，从而避免传播如SARS-CoV-2等病毒。
- en: This touchless thermometer may help to check whether a person has a fever and
    thus determine (along with other measurements) whether the person has contracted
    COVID-19\. However, the IR temperature measurements explained in this chapter
    should not be definitive data to determine whether a person has COVID-19.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 这种非接触式温度计可以帮助检查一个人是否发烧，从而确定（与其他测量结果一起）此人是否感染了COVID-19。然而，本章中解释的红外温度测量不应作为确定一个人是否患有COVID-19的最终数据。
- en: The next chapter explains another COVID-19-related project about measuring the
    recommended 2-meter distance between two people using an ultrasonic sensor.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 下一章解释了另一个与COVID-19相关的项目，即使用超声波传感器测量两人之间推荐的2米距离。
- en: Further reading
  id: totrans-188
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'Body Temperature (2020). Body temperature: What is (and isn''t) normal? Available
    from [https://health.clevelandclinic.org/body-temperature-what-is-and-isnt-normal/](https://health.clevelandclinic.org/body-temperature-what-is-and-isnt-normal/)'
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 体温 (2020)。体温：什么是（以及什么不是）正常的？可从 [https://health.clevelandclinic.org/body-temperature-what-is-and-isnt-normal/](https://health.clevelandclinic.org/body-temperature-what-is-and-isnt-normal/)
    获取
- en: 'Gay, W. (2018) I2C, *In: Beginning STM32*, Apress, Berkeley, CA'
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Gay, W. (2018) I2C, *《STM32入门》*，Apress，加利福尼亚州伯克利
- en: I2C (2021), *I2C tutorial*. Available from [https://learn.sparkfun.com/tutorials/i2c/all](https://learn.sparkfun.com/tutorials/i2c/all)
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: I2C (2021)，*I2C教程*。可从 [https://learn.sparkfun.com/tutorials/i2c/all](https://learn.sparkfun.com/tutorials/i2c/all)
    获取
- en: Mankar, J., Darode, C., Trivedi, K., Kanoje, M., and Shahare, P. (2014), *Review
    of I2C protocol*, International Journal of Research in Advent Technology, 2(1)
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Mankar, J., Darode, C., Trivedi, K., Kanoje, M. 和 Shahare, P. (2014), *I2C协议综述*，国际研究前沿技术杂志，2(1)
