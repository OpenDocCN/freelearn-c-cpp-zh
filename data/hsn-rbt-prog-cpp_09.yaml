- en: Accessing the RPi Camera with OpenCV
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用OpenCV访问RPi相机
- en: One of the most exciting things we can do with Raspberry Pi is recognize objects
    and faces by connecting it to an external USB webcam or **Raspberry Pi camera**
    (**RPi camera**).
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用树莓派连接到外部USB网络摄像头或**树莓派相机**（**RPi相机**）来识别对象和人脸，这是树莓派最令人兴奋的事情之一。
- en: To process these inputs from the camera, we will use the OpenCV libraries. As
    the installation of OpenCV takes a long time and involves multiple steps, this
    whole chapter will be dedicated to getting you up and running.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 为了处理来自相机的输入，我们将使用OpenCV库。由于安装OpenCV需要很长时间并涉及多个步骤，本章将专门用于让您开始运行。
- en: 'In this chapter, you will explore the following topics:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您将探索以下主题：
- en: Installing OpenCV 4.0.0 on Raspberry Pi
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在树莓派上安装OpenCV 4.0.0
- en: Enabling and connecting the RPi camera to RPi
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启用并连接RPi相机到RPi
- en: Capturing images and video with the RPi camera
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用RPi相机捕获图像和视频
- en: Reading an image using OpenCV
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用OpenCV读取图像
- en: Technical requirements
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'In this chapter, you will need the following:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您将需要以下内容：
- en: A Raspberry Pi camera module – as of 2019, the latest RPi camera module is called
    **RPi Camera V2 1080P**
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 树莓派相机模块-截至2019年，最新的RPi相机模块称为**RPi相机V2 1080P**
- en: A Raspberry Pi camera case (mount)
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 树莓派相机外壳（安装支架）
- en: The code file for this chapter can be downloaded from [https://github.com/PacktPublishing/Hands-On-Robotics-Programming-with-Cpp/tree/master/Chapter06](https://github.com/PacktPublishing/Hands-On-Robotics-Programming-with-Cpp/tree/master/Chapter06).
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的代码文件可以从[https://github.com/PacktPublishing/Hands-On-Robotics-Programming-with-Cpp/tree/master/Chapter06](https://github.com/PacktPublishing/Hands-On-Robotics-Programming-with-Cpp/tree/master/Chapter06)下载。
- en: Installing OpenCV 4.0.0 on Raspberry Pi
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在树莓派上安装OpenCV 4.0.0
- en: The **Open Source Computer Vision Library** (**OpenCV**) is an open source computer
    vision and machine learning library. The OpenCV library consists of more than
    2,500 computer vision and machine learning algorithms that can be used to recognize
    objects, detect colors, and track moving objects in real life or in a video. OpenCV
    supports the C++, Python, and Java programming languages, and can run on Windows,
    macOS, Android, and Linux.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '**开源计算机视觉库**（**OpenCV**）是一个开源的计算机视觉和机器学习库。OpenCV库包括2500多个计算机视觉和机器学习算法，可用于识别对象、检测颜色和跟踪现实生活中或视频中的运动物体。OpenCV支持C++、Python和Java编程语言，并可以在Windows、macOS、Android和Linux上运行。'
- en: Installing OpenCV on a Raspberry Pi is a time-consuming and lengthy process.
    There are multiple libraries and files that we have to install along with the
    OpenCV library to make it work properly. The steps to install OpenCV will be performed
    on my Raspberry Pi 3B+ model, which is running Raspbian Stretch. The OpenCV version
    we are going to install is OpenCV 4.0.0.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在树莓派上安装OpenCV是一个耗时且冗长的过程。除了OpenCV库，我们还必须安装多个库和文件，以使其正常工作。安装OpenCV的步骤将在我运行Raspbian
    Stretch的树莓派3B+型号上执行。我们要安装的OpenCV版本是OpenCV 4.0.0。
- en: While installing OpenCV, we will download multiple files. If you live in a big
    house, make sure that you sit near the Wi-Fi router so that the RPi receives good
    signal strength. If the RPi is far away from the Wi-Fi, the download speed may
    be affected and it may take you more time to install OpenCV on your RPi. It took
    me around 3 hours to install OpenCV on my RPi 3B+ with a download speed of around
    500-560 Kbps.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 在安装OpenCV时，我们将下载多个文件。如果您住在大房子里，请确保您坐在Wi-Fi路由器附近，以便RPi接收良好的信号强度。如果RPi离Wi-Fi很远，下载速度可能会受到影响，安装OpenCV可能需要更长的时间。我在我的RPi
    3B+上安装OpenCV大约花了3个小时，下载速度大约为500-560 Kbps。
- en: Uninstalling Wolfram and LibreOffice
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 卸载Wolfram和LibreOffice
- en: If you are using a 32 GB microSD card, Raspbian Stretch will occupy only 15%
    of the storage space, but if you are using an 8 GB microSD card, it will occupy
    50% of the space. If you are using an 8 GB microSD card, you will need to free
    up some space. You can do this by uninstalling some unused apps. Two such apps
    are Wolfram engine and LibreOffice.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您使用32GB的microSD卡，Raspbian Stretch将只占用存储空间的15%，但如果您使用8GB的microSD卡，它将占用50%的空间。如果您使用8GB的microSD卡，您需要释放一些空间。您可以通过卸载一些未使用的应用程序来实现。其中两个应用程序是Wolfram引擎和LibreOffice。
- en: 'Uninstalling apps on Raspbian Stretch is easy. You just need to enter a command
    in a Terminal window. Let''s begin by uninstalling the Wolfram engine:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在Raspbian Stretch上卸载应用程序很容易。您只需要在终端窗口中输入一个命令。让我们从卸载Wolfram引擎开始：
- en: '[PRE0]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Next, use the same command to uninstall LibreOffice:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，使用相同的命令卸载LibreOffice：
- en: '[PRE1]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'After uninstalling both pieces of software, let''s do some cleaning by using
    two simple commands:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 卸载两个软件后，我们可以使用两个简单的命令进行清理：
- en: '[PRE2]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Now that we have freed up some space, let's update our RPi.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经释放了一些空间，让我们更新RPi。
- en: Updating your RPi
  id: totrans-26
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 更新您的RPi
- en: 'Updating your RPi involves a few simple steps:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 更新您的RPi涉及一些简单的步骤：
- en: 'Open a Terminal window and enter the following command:'
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开终端窗口，输入以下命令：
- en: '[PRE3]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Upgrade the RPi by entering the following command:'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过输入以下命令升级RPi：
- en: '[PRE4]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Reboot the RPi:'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重新启动RPi：
- en: '[PRE5]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Once your RPi restarts, open the Terminal window again.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您的RPi重新启动，再次打开终端窗口。
- en: While running certain commands in the Terminal window, you may get a prompt
    that asks you whether you want to continue. In the commands for this process,
    we have already added the `-y` command (at the end of the line), which will automatically
    apply the **yes** command to the prompts.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 在终端窗口运行某些命令时，您可能会收到提示，询问您是否要继续。在此过程的命令中，我们已经添加了`-y`命令（在行的末尾），它将自动应用**yes**命令到提示。
- en: Installing the cmake, image, video, and gtk packages
  id: totrans-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装cmake、image、video和gtk软件包
- en: '`cmake` is a configuration utility. Using `cmake`, we can configure different
    OpenCV and Python modules after installing them. To install the `cmake` package,
    enter the following command:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: '`cmake`是一个配置实用程序。使用`cmake`，我们可以在安装后配置不同的OpenCV和Python模块。要安装`cmake`软件包，请输入以下命令：'
- en: '[PRE6]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Next, to install the image I/O package, enter the following command:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，要安装图像I/O软件包，请输入以下命令：
- en: '[PRE7]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'After this, we will install the two video I/O packages by typing the following
    commands:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 之后，我们将通过输入以下命令安装两个视频I/O软件包：
- en: '[PRE8]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Next, we will download and install the **Gimp Toolkit** (**GTK**) packages.
    This toolkit is used for making graphical interfaces for our program. We will
    execute the following commands to download and install the GTK packages:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将下载并安装**Gimp Toolkit**（**GTK**）软件包。此工具包用于为我们的程序制作图形界面。我们将执行以下命令来下载和安装GTK软件包：
- en: '[PRE9]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Downloading and unzipping OpenCV 4.0 and its contribution repository
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 下载和解压OpenCV 4.0及其贡献存储库
- en: 'Once we have installed these packages, we can move on to OpenCV. Let''s begin
    by downloading Open CV 4.0:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 安装了这些软件包后，我们可以继续进行OpenCV。让我们开始下载Open CV 4.0：
- en: 'Type the following command into your Terminal window:'
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在终端窗口中输入以下命令：
- en: '[PRE10]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Download the `opencv_contrib` repository, which contains some additional modules.
    Enter the following command:'
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载包含一些附加模块的`opencv_contrib`存储库。输入以下命令：
- en: '[PRE11]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: The commands in *step 1* and *step 2* are both single-line commands.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '*步骤1*和*步骤2*中的命令都是单行命令。'
- en: 'Unzip the `opencv.zip` file using the following command:'
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令解压`opencv.zip`文件：
- en: '[PRE12]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Unzip the `opencv_contrib.zip`file:'
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 解压`opencv_contrib.zip`文件：
- en: '[PRE13]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: After unzipping `opencv` and `opencv_contrib`, you should see the `opencv-4.0.0`
    and `opencv_contrib-4.0.0` folders inside the `pi` folder.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 解压`opencv`和`opencv_contrib`后，您应该在`pi`文件夹中看到`opencv-4.0.0`和`opencv_contrib-4.0.0`文件夹。
- en: Installing Python
  id: totrans-57
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装Python
- en: Next, we will install Python 3 and some of its support tools. Even though we
    are going to program in OpenCV using C++, it is still a good idea to install and
    link Python packages with OpenCV so that you have the option to write or compile
    Python codes using OpenCV.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将安装Python 3及其一些支持工具。即使我们将使用C++编程OpenCV，安装并链接Python包与OpenCV仍然是一个好主意，这样您就可以选择使用OpenCV编写或编译Python代码。
- en: 'To install Python and its developments tools, type in the following commands:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装Python及其开发工具，请输入以下命令：
- en: '[PRE14]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: After installing the Python packages, we can compile and build OpenCV.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 安装Python软件包后，我们可以编译和构建OpenCV。
- en: Compiling and installing OpenCV
  id: totrans-62
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 编译和安装OpenCV
- en: 'To compile and install OpenCV, we need to go through the following steps:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 要编译和安装OpenCV，我们需要按照以下步骤进行：
- en: 'Go inside the `opencv-4.0.0` folder. Change the directory to the `opencv-4.0.0`
    folder using the following command:'
  id: totrans-64
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 进入`opencv-4.0.0`文件夹。使用以下命令更改目录到`opencv-4.0.0`文件夹：
- en: '[PRE15]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Inside this folder, create a `build` folder. To do so, type the following command:'
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在此文件夹中创建一个`build`文件夹。为此，请输入以下命令：
- en: '[PRE16]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'To open the `build` directory, type the following command:'
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要打开`build`目录，请输入以下命令：
- en: '[PRE17]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'After changing the directory to `build`, enter the following command:'
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更改目录到`build`后，输入以下命令：
- en: '[PRE18]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Make sure that you copy the two dots, `..`, at the end when entering this command
    in the Terminal window.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 在输入此命令时，请确保在终端窗口中输入两个点`..`。
- en: 'To enable all four cores of the RPi, open the `swapfile`file inside the nano
    editor:'
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要启用RPi的所有四个内核，请在nano编辑器中打开`swapfile`文件：
- en: '[PRE19]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'Inside this file, search for the `CONF_SWAPSIZE=100` code and change the value
    from `100` to `1024`:'
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在此文件中，搜索`CONF_SWAPSIZE=100`代码，并将值从`100`更改为`1024`：
- en: '![](img/81e9f8e3-b104-4768-b028-a36d9367b641.png)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![](img/81e9f8e3-b104-4768-b028-a36d9367b641.png)'
- en: Press *Ctrl* + *O* to save this file. You will get a prompt at the bottom of
    the file, asking you whether you want to save this file. Press *Enter* and then
    press *Ctrl *+ *X* to exit.
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按下*Ctrl* + *O*保存此文件。您将在文件底部收到提示，询问您是否要保存此文件。按*Enter*，然后按*Ctrl *+ *X*退出。
- en: 'To apply these changes, type in the following two commands:'
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要应用这些更改，请输入以下两个命令：
- en: '[PRE20]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'To compile OpenCV with all four cores of the RPi, type in the following command:'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要使用RPi的所有四个内核编译OpenCV，请输入以下命令：
- en: '[PRE21]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: This is the most time-consuming step and it will take anywhere between 1.5 to
    2 hours. If you face any errors while compiling, try compiling with one core.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 这是最耗时的步骤，需要1.5到2小时。如果在编译时遇到任何错误，请尝试使用单个内核进行编译。
- en: 'To compile with only one core, enter the following command:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用单个内核进行编译，请输入以下命令：
- en: '[PRE22]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Use the preceding two commands only if you encounter an error with the `make
    -j4` command.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 只有在使用`make -j4`命令时遇到错误时才使用前面的两个命令。
- en: 'To install OpenCV 4.0.0, enter the following commands:'
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要安装OpenCV 4.0.0，请输入以下命令：
- en: '[PRE23]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: We've now compiled and installed OpenCV. Let's connect it to Python.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在已经编译并安装了OpenCV。让我们将其连接到Python。
- en: Linking OpenCV to Python
  id: totrans-89
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将OpenCV链接到Python
- en: 'Let''s follow these steps to link OpenCV to Python:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们按照以下步骤将OpenCV链接到Python：
- en: 'Open the `python 3.5` folder (`/usr/local/python/cv2/python-3.5`):'
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开`python 3.5`文件夹(`/usr/local/python/cv2/python-3.5`)：
- en: '![](img/a1ee0334-dc02-4d84-9c54-683849c73b93.png)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a1ee0334-dc02-4d84-9c54-683849c73b93.png)'
- en: 'Inside this folder, you should see a file named `cv2.so` or `cv2.cpython-35m-arm-linux-gnueabihf.so`. If
    the filename is `cv2.so`, you do not need to make any changes. If the filename
    is `cv2.cpython-35m-arm-linux-gnueabihf.so`*,* you have to rename it to `cv2.so`*.* To
    rename this file, change the directory to `python 3.5` by entering the following
    command:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 在此文件夹中，您应该看到一个名为`cv2.so`或`cv2.cpython-35m-arm-linux-gnueabihf.so`的文件。如果文件名是`cv2.so`，则无需进行任何更改。如果文件名是`cv2.cpython-35m-arm-linux-gnueabihf.so`，则必须将其重命名为`cv2.so`。要重命名此文件，请输入以下命令更改目录到`python
    3.5`：
- en: '[PRE24]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'To rename this file from `cv2.cpython-35m-arm-linux-gnueabihf.so` to `cv2.so`,
    enter the following command:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 将此文件从`cv2.cpython-35m-arm-linux-gnueabihf.so`重命名为`cv2.so`，输入以下命令：
- en: '[PRE25]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Move this file to the `dist-package` folder (`/usr/local/lib/python3.5/dist-packages/`)
    using the following command:'
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令将此文件移动到`dist-package`文件夹(`/usr/local/lib/python3.5/dist-packages/`)：
- en: '[PRE26]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'To test whether OpenCV 4.0.0 is linked properly to Python 3, go to the `pi`
    directory by typing `cd ~` in the Terminal window***. ***Next, type `python3`:'
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要测试OpenCV 4.0.0是否正确链接到Python 3，请在终端窗口中输入`cd ~`进入`pi`目录。接下来，输入`python3`：
- en: '![](img/ad9421bb-6a69-49b1-99cb-f6da0bd9150d.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ad9421bb-6a69-49b1-99cb-f6da0bd9150d.png)'
- en: You should see a three-corner bracket. Type `import cv2`.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您应该看到一个三角括号。输入`import cv2`。
- en: 'To check the OpenCV version, type `cv2.__version__`. If you see `opencv 4.0.0`, this
    means that OpenCV is successfully installed and linked with the Python packages:'
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要检查OpenCV版本，请输入`cv2.__version__`。如果看到`opencv 4.0.0`，这意味着OpenCV已成功安装并与Python软件包链接：
- en: '![](img/e257f115-e220-444b-9e14-293973b6eca4.png)'
  id: totrans-103
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e257f115-e220-444b-9e14-293973b6eca4.png)'
- en: 'Type `exit()` and press *Enter*:'
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入`exit()`并按*Enter*：
- en: '![](img/9fec64e2-9e7f-46bb-8e97-957f02c601bb.png)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9fec64e2-9e7f-46bb-8e97-957f02c601bb.png)'
- en: 'After installing OpenCV, we need to reset `CONF_SWAPSIZE` back to `100`:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 安装OpenCV后，我们需要将`CONF_SWAPSIZE`重置为`100`：
- en: 'Open `swapfile`:'
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开`swapfile`：
- en: '[PRE27]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Change `CONF_SWAPSIZE` to `100`:'
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将`CONF_SWAPSIZE`更改为`100`：
- en: '![](img/394f4e62-3813-4d41-8430-8b1455a68a90.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![](img/394f4e62-3813-4d41-8430-8b1455a68a90.png)'
- en: 'To apply these changes, enter the following commands:'
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要应用这些更改，请输入以下命令：
- en: '[PRE28]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: You have successfully installed OpenCV 4.0.0 on your Raspberry Pi. We are now
    ready to attach the RPi camera to the RPi.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 您已成功在树莓派上安装了OpenCV 4.0.0。我们现在准备将RPi相机连接到RPi。
- en: Enabling and connecting the RPi camera to RPi
  id: totrans-114
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 启用并连接RPi相机到RPi
- en: 'Before connecting the RPi camera to the RPi, we need to enable the Camera option
    from the RPi configuration:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 在连接RPi相机到RPi之前，我们需要从RPi配置中启用相机选项：
- en: Open a Terminal window and enter `sudo raspi-config` to open the RPi configuration.
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一个终端窗口并输入`sudo raspi-config`打开RPi配置。
- en: 'Select Advanced Options and press *Enter* to open it:'
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择“高级选项”并按*Enter*打开它：
- en: '![](img/d7ddf9aa-8152-4cc6-928b-e15964e60851.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d7ddf9aa-8152-4cc6-928b-e15964e60851.png)'
- en: 'Select the Camera option and press *Enter* to open it:'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择相机选项并按*Enter*打开它：
- en: '![](img/d7e4e53a-491f-4a57-9095-254f4638e5a0.png)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d7e4e53a-491f-4a57-9095-254f4638e5a0.png)'
- en: 'Select Yes and press *Enter* to enable the Camera option:'
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择“是”并按*Enter*启用相机选项：
- en: '![](img/be9db14b-36c0-415a-9bbf-4f5e877a4b70.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![](img/be9db14b-36c0-415a-9bbf-4f5e877a4b70.png)'
- en: 'Select Ok and press *Enter*:'
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择确定并按*Enter*：
- en: '![](img/5e527a4a-f295-4b17-8607-37dfbc564bb4.png)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5e527a4a-f295-4b17-8607-37dfbc564bb4.png)'
- en: Exit the RPi configuration and shut down your RPi.
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 退出RPi配置并关闭RPi。
- en: While connecting the RPi camera to the RPi, make sure that the RPi is turned
    off.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 在连接RPi相机到RPi时，请确保RPi已关闭。
- en: Now that we have finished the setup, let's connect the camera.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经完成了设置，让我们连接相机。
- en: Connecting the RPi camera to RPi
  id: totrans-128
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 连接RPi相机到RPi
- en: 'Connecting the RPi camera to RPi is an easy, but delicate, process. The RPi
    camera has a ribbon wire connected to it. We have to insert this ribbon wire inside
    the camera slot of the RPi, which is placed between the LAN port and the HDMI
    port:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 连接RPi相机到RPi是一个简单但又微妙的过程。RPi相机有一根连接的带线。我们必须将这根带线插入RPi的相机插槽中，该插槽位于LAN端口和HDMI端口之间：
- en: '![](img/e87cff4c-92e6-4ff5-ab66-a4565df03f24.png)'
  id: totrans-130
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e87cff4c-92e6-4ff5-ab66-a4565df03f24.png)'
- en: 'The ribbon on the RPi camera consists of a blue strip on the front and nothing
    on the back:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: RPi相机上的带线由前面的蓝色条组成，后面没有：
- en: '![](img/75439b70-bb7f-4316-9ed4-1217e5bac8b4.png)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![](img/75439b70-bb7f-4316-9ed4-1217e5bac8b4.png)'
- en: 'Now that we understand the component and the port, let''s start connecting
    them:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们了解了组件和端口，让我们开始连接它们：
- en: 'Gently lift up the lid of the camera slot:'
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 轻轻抬起相机插槽的盖子：
- en: '![](img/496b322c-4916-47bb-af90-bccf043aed9a.png)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![](img/496b322c-4916-47bb-af90-bccf043aed9a.png)'
- en: Insert the camera ribbon inside the slot, making sure that the blue tape on
    the ribbon faces the LAN port.
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将相机带插入插槽，确保带子上的蓝色胶带面向LAN端口。
- en: 'Press the lid to lock the camera ribbon:'
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按下盖子锁定相机带线：
- en: '![](img/536f5eb1-d900-4f7f-be3c-95f1aab69d61.png)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![](img/536f5eb1-d900-4f7f-be3c-95f1aab69d61.png)'
- en: That's it—your RPi camera is now ready to take pictures and record videos.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 就是这样——您的RPi相机现在已准备好拍照和录制视频。
- en: Mounting the RPi camera on the robot
  id: totrans-140
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装RPi相机在机器人上
- en: 'Let''s mount the RPi camera on the robot; you will need a RPi camera case for
    this. A quick search on [amazon.com](http://amazon.com) for `RPi camera case`
    will show the following case:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们在机器人上安装RPi相机；您需要一个RPi相机盒子。在[amazon.com](http://amazon.com)上快速搜索`RPi相机盒子`将显示以下情况：
- en: '![](img/6a379ac6-97f9-413e-995e-b5634e7d872c.png)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6a379ac6-97f9-413e-995e-b5634e7d872c.png)'
- en: I do not recommend this particular case as it did not fit my RPi camera module
    properly. When the case is closed, the lens of my RPi camera did not properly
    align with the small hole of this camera case.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 我不推荐这个特定的情况，因为它没有正确安装我的RPi相机模块。当盒子关闭时，我的RPi相机的镜头没有正确对齐这个相机盒子的小孔。
- en: Since I live in India, I did not find any good RPi camera cases on the Amazon
    India website ([www.amazon.in](http://www.amazon.in)), and the ones that were
    available were expensive. The case I ended up using was from an Indian e-commerce
    website called [www.robu.in](http://www.robu.in), and it cost me only 90 Rs (less
    than $2). Before purchasing a camera case or camera mount from an e-commerce website,
    please check the reviews to ensure that it won't damage your RPi camera.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我住在印度，在亚马逊印度网站([www.amazon.in](http://www.amazon.in))上找不到好的RPi相机盒子，而且可用的盒子价格昂贵。我最终使用的盒子来自一个名为[www.robu.in](http://www.robu.in)的印度电子商务网站，只花了我90卢比（不到2美元）。在从电子商务网站购买相机盒子或相机支架之前，请检查评论以确保它不会损坏您的RPi相机。
- en: 'The image of the RPi camera case that I used is shown in the following image.
    I bought this case from an Indian website called [www.robu.in](http://www.robu.in).
    On this website, search for `Camera mount module for Raspberry Pi` to find this
    camera mount:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 我使用的RPi相机盒子的图像显示在以下图像中。我从一个名为[www.robu.in](http://www.robu.in)的印度网站购买了这个盒子。在这个网站上，搜索`树莓派相机支架模块`以找到这个相机支架：
- en: '![](img/5edb81df-b762-43f4-8229-f1e7909a64d9.png)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5edb81df-b762-43f4-8229-f1e7909a64d9.png)'
- en: 'Even though this camera mount contains four small nuts and bolts to attach
    the RPi camera to the camera mount, I found that the threading of the nut and
    bolt was inaccurate, and attaching the RPi camera to the camera mount was way
    too difficult. Therefore, I used four small pieces of double-sided tape and attached
    the tape to the holes of the RPi camera:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管此摄像头支架包含四个小螺母和螺栓将RPi摄像头固定到摄像头支架上，但我发现螺母和螺栓的螺纹不准确，并且将RPi摄像头固定到摄像头支架上非常困难。因此，我使用了四小块双面胶带，并将其粘贴到RPi摄像头的孔中：
- en: '![](img/65232c5d-c15a-4558-8cfa-8418d6510bc3.png)'
  id: totrans-148
  prefs: []
  type: TYPE_IMG
  zh: '![](img/65232c5d-c15a-4558-8cfa-8418d6510bc3.png)'
- en: 'Next, I attached the RPi camera to the camera mount. In the following image,
    the RPi camera is fitted upside down. So, when we capture an image, the image
    will appear upside down, and to view the image properly, we need to flip it (the
    process of flipping the image horizontally and vertically inside OpenCV is explained
    in [Chapter 7](b5b2dffa-7833-47cc-98d9-e60e6aba7299.xhtml), *Building an Object-Following
    Robot with OpenCV*):'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我将RPi摄像头安装到摄像头支架上。在下图中，RPi摄像头被倒置安装。因此，当我们捕获图像时，图像将呈倒置状态，为了正确查看图像，我们需要翻转它（在OpenCV中解释了在[第7章](b5b2dffa-7833-47cc-98d9-e60e6aba7299.xhtml)中水平和垂直翻转图像的过程，*使用OpenCV构建对象跟随机器人*）：
- en: '![](img/b51d7df9-723c-4abe-9eb6-81caa20d3ad9.png)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b51d7df9-723c-4abe-9eb6-81caa20d3ad9.png)'
- en: 'After this, I attached the camera mount on top of my RPi case using small strips
    of double-sided tape, thus mounting the RPi camera on the robot:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 之后，我使用双面胶带在RPi外壳顶部安装了摄像头支架，从而将RPi摄像头安装在机器人上：
- en: '![](img/ba3d6a10-11d8-4b86-a561-d7ade37e7ca4.png)'
  id: totrans-152
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ba3d6a10-11d8-4b86-a561-d7ade37e7ca4.png)'
- en: Now that we've mounted the camera case on the robot, let's see how we can capture
    images and video using the RPi camera.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经将摄像头外壳安装到机器人上，让我们看看如何使用RPi摄像头捕获图像和视频。
- en: Capturing images and video with the RPi camera
  id: totrans-154
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用RPi摄像头捕获图像和视频
- en: 'Let''s see how we can take pictures and record video with our RPi. Open the
    Terminal window and type the following command:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看如何在RPi上拍照和录制视频。打开终端窗口，输入以下命令：
- en: '[PRE29]'
  id: totrans-156
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: In this command, we used `raspistill` to take a still picture and saved it as `image1.jpg`.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 在此命令中，我们使用`raspistill`拍摄静态图片，并将其保存为`image1.jpg`。
- en: 'Since the Terminal window is pointing to the `pi` directory, this image is
    saved in the `pi` folder. To open this image, open the `pi` folder and inside
    it, you will see `image1.jpg`. Images captured using the RPi camera have a native
    resolution of 3,280 x 2,464 pixels:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 由于终端窗口指向`pi`目录，因此此图像保存在`pi`文件夹中。要打开此图像，请打开`pi`文件夹，在其中您将看到`image1.jpg`。使用RPi摄像头捕获的图像具有本机分辨率为3,280
    x 2,464像素：
- en: '![](img/7935ab8e-1b77-479d-9afd-560a4a5bb2d0.png)'
  id: totrans-159
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7935ab8e-1b77-479d-9afd-560a4a5bb2d0.png)'
- en: 'The output of `image1` is shown in the following screenshot:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '`image1`的输出如下截图所示：'
- en: '![](img/9107747b-66fe-47cd-af30-fe1e703d3c52.png)'
  id: totrans-161
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9107747b-66fe-47cd-af30-fe1e703d3c52.png)'
- en: 'If we want to flip the image horizontally, we can add the `-hf` command, and
    if we want to flip it vertically, we can add `-vf` command inside the `raspistill`
    code:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们想水平翻转图像，可以添加`-hf`命令，如果要垂直翻转图像，可以在`raspistill`代码中添加`-vf`命令：
- en: '[PRE30]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'The `image2.jpg` file is also saved in the `pi` folder, and its output is shown
    in the following screenshot:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: '`image2.jpg`文件也保存在`pi`文件夹中，其输出如下截图所示：'
- en: '![](img/ba63edc7-b341-427c-b444-a514909d811e.png)'
  id: totrans-165
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ba63edc7-b341-427c-b444-a514909d811e.png)'
- en: Now that we have captured images using the RPi camera, let's record and view
    a video.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经使用RPi摄像头捕获了图像，让我们录制并查看视频。
- en: Recording a video with the RPi camera
  id: totrans-167
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用RPi摄像头录制视频
- en: 'Now that we know how to take a picture with the RPi camera, let''s look at
    how to record video with it. The command for recording a video clip is as follows:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们知道如何使用RPi摄像头拍照，让我们看看如何录制视频。录制视频剪辑的命令如下：
- en: '[PRE31]'
  id: totrans-169
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'The preceding command doesn''t yield any output, as shown in the following
    screenshot:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 如下截图所示，上述命令不会产生任何输出：
- en: '![](img/00cea86c-1fc4-4902-a4d0-ba5e22cb2c35.png)'
  id: totrans-171
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00cea86c-1fc4-4902-a4d0-ba5e22cb2c35.png)'
- en: 'In our command, we used `raspivid` to record the video and named it `video1`.
    We recorded the video in the `h264` format. The number `5000` represents 5,000
    milliseconds, that is, we recorded a 5-second video. You can open the `pi` folder
    and double-click on the video file to open it:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的命令中，我们使用`raspivid`录制视频，并将其命名为`video1`。我们以`h264`格式录制了视频。数字`5000`代表5000毫秒，也就是说，我们录制了一个5秒的视频。您可以打开`pi`文件夹，双击视频文件以打开它：
- en: '![](img/92bdd50f-5568-4a28-a8a3-3f62e556f4b4.png)'
  id: totrans-173
  prefs: []
  type: TYPE_IMG
  zh: '![](img/92bdd50f-5568-4a28-a8a3-3f62e556f4b4.png)'
- en: Now that we know how to take a picture and record a video, let's install the `v4l2`
    driver so that the OpenCV libraries can detect the RPi camera.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们知道如何拍照和录制视频，让我们安装`v4l2`驱动程序，以便OpenCV库可以检测到RPi摄像头。
- en: Installing the v4l2 driver
  id: totrans-175
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装v4l2驱动程序
- en: 'OpenCV libraries can, by default, recognize the USB camera attached to the
    RPi''s USB port, but it cannot directly detect the RPi camera. To recognize our
    RPi camera, we need to load the `v4l2` driver inside the modules file. To open
    this file, enter the following command inside the Terminal window:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: OpenCV库默认可以识别连接到RPi USB端口的USB摄像头，但无法直接检测RPi摄像头。要识别我们的RPi摄像头，我们需要在模块文件中加载`v4l2`驱动程序。要打开此文件，请在终端窗口中输入以下命令：
- en: '[PRE32]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'To load the `v4l2` driver, add `bcm2835-v4l2` inside the following file:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 要加载`v4l2`驱动程序，请在以下文件中添加`bcm2835-v4l2`：
- en: '![](img/2e9c0b29-5143-4e74-b14c-2b229999dd33.png)'
  id: totrans-179
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2e9c0b29-5143-4e74-b14c-2b229999dd33.png)'
- en: Press *Ctrl* + *O*, followed by *Enter*, to save this file and press *Ctrl*
    + *X* to exit the file, then reboot your RPi. Once rebooted, the RPi camera will
    be recognized by the OpenCV libraries.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 按下*Ctrl* + *O*，然后按*Enter*保存此文件，按下*Ctrl* + *X*退出文件，然后重新启动您的RPi。重新启动后，OpenCV库将识别RPi摄像头。
- en: Reading an image using OpenCV
  id: totrans-181
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用OpenCV读取图像
- en: 'After playing around a little bit with the RPi camera, let''s write a simple
    C++ program using the OpenCV functions to display an image. In this program, we
    first read an image from a particular folder and then we display this image in
    a new window:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 在RPi相机上玩了一会儿之后，让我们使用OpenCV函数编写一个简单的C++程序来显示图像。在这个程序中，我们首先从一个特定的文件夹中读取图像，然后在新窗口中显示这个图像：
- en: '![](img/b18a5571-b2f1-434c-baa4-eb92163ea7ce.png)'
  id: totrans-183
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b18a5571-b2f1-434c-baa4-eb92163ea7ce.png)'
- en: 'To display the image, we first need an image. Inside the `pi` folder, I have
    created a new folder called `Data` and inside it, I have copied one image called
    `Car.png`*.* In the same folder, I have created the `DisplayImage.cpp` file, inside
    which we are going to write the program to display the image. The `DisplayImage.cpp`
    program can be download from the `Chapter06` folder of this book''s GitHub repository.
    The code is as follows:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 要显示图像，我们首先需要一张图像。在`pi`文件夹中，我创建了一个名为`Data`的新文件夹，在其中，我复制了一张名为`Car.png`的图像。在同一个文件夹中，我创建了`DisplayImage.cpp`文件，我们将在其中编写显示图像的程序。`DisplayImage.cpp`程序可以从本书的GitHub存储库的`Chapter06`文件夹中下载。代码如下：
- en: '[PRE33]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: In the preceding code, we first declared the `opencv.hpp` library, along with
    the basic C++ libraries. We then declared the `cv` namespace, which is a part
    of the OpenCV library. After this, inside the `main` function, we declared a matrix
    (`Mat`) variable called `img`.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 在上述代码中，我们首先声明了`opencv.hpp`库，以及基本的C++库。然后声明了`cv`命名空间，它是OpenCV库的一部分。在`main`函数内部，我们声明了一个名为`img`的矩阵（`Mat`）变量。
- en: Next, the `imread()` function is used to read the `Car.jpg` image and the value
    is stored in the `img` variable. If the image and `.cpp` file are in the same
    folder, you just write the image name inside the `imread()` function. If the image
    is in a different folder, the location of the image should be mentioned inside
    the `imread` function.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，使用`imread（）`函数读取`Car.jpg`图像，并将值存储在`img`变量中。如果图像和`.cpp`文件在同一个文件夹中，只需在`imread（）`函数中写入图像名称。如果图像在不同的文件夹中，则应在`imread`函数中提及图像的位置。
- en: The `imshow()` function is used to display the car image in a new window. The
    `imshow()` function takes two parameters as input. The first parameter is the
    window text (`"Car Image"`) and the second parameter is the variable name (`img`)
    of the image that is to be displayed.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: '`imshow（）`函数用于在新窗口中显示汽车图像。`imshow（）`函数接受两个参数作为输入。第一个参数是窗口文本（“Car Image”），第二个参数是要显示的图像的变量名（`img`）。'
- en: The `waitKey(0)` function is used to create an infinite delay, that is, the
    `waitKey(0)` will display the car image infinitely until you press any key. When
    a key is pressed, the next set of code will execute. Since we do not have any
    code after the `waitKey(0)` function, the program will terminate and the car image
    window will be closed.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: '`waitKey（0）`函数用于创建无限延迟，也就是说，`waitKey（0）`将无限地显示汽车图像，直到您按下任意键。按下键后，将执行下一组代码。由于在`waitKey（0）`函数之后没有任何代码，程序将终止，汽车图像窗口将关闭。'
- en: 'To compile and build OpenCV codes inside RPi, we need to add the following
    lines inside the compilation and build box:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 要在RPi内部编译和构建OpenCV代码，我们需要在编译和构建框内添加以下行：
- en: 'Click on **Build option** and then select **Set Build Commands**. Inside the
    compilation box, enter the following commands:'
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击**构建选项**，然后选择**设置构建命令**。在编译框内，输入以下命令：
- en: '[PRE34]'
  id: totrans-192
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Inside the Build box, enter the following command and then click OK:'
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在构建框内，输入以下命令，然后单击“确定”：
- en: '[PRE35]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Click on the compile button to compile the code and then click on the build
    button to test the output. In the output, a new window will be created, inside
    which the car image will be displayed:'
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击编译按钮编译代码，然后单击构建按钮测试输出。在输出中，将创建一个新窗口，在其中将显示汽车图像：
- en: '![](img/dce0a5f0-4a99-43c6-9f04-da1e4162ac6c.png)'
  id: totrans-196
  prefs: []
  type: TYPE_IMG
  zh: '![](img/dce0a5f0-4a99-43c6-9f04-da1e4162ac6c.png)'
- en: If you press any key, the program will terminate and the car image window will
    be closed.
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果按任意键，程序将终止，汽车图像窗口将关闭。
- en: Summary
  id: totrans-198
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we focused on installing OpenCV on Raspberry Pi. You were introduced
    to the RPi camera module. After setting up the RPi camera, you took pictures and
    recorded a short video clip using the RPi camera.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们专注于在树莓派上安装OpenCV。您已经了解了RPi相机模块。设置RPi相机后，您使用RPi相机拍摄了照片并录制了一个短视频剪辑。
- en: In the next chapter, we are going to write C++ programs using the OpenCV libraries.
    You will learn about different image-processing concepts so that you can scan,
    threshold, and recognize an object. After recognizing an object, we will write
    programs for the robot so that it follows the object.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将使用OpenCV库编写C++程序。您将学习不同的图像处理概念，以便可以扫描、阈值化和识别对象。在识别对象之后，我们将为机器人编写程序，使其跟随该对象。
- en: Questions
  id: totrans-201
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: What is the full form of OpenCV?
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: OpenCV的全称是什么？
- en: What is the resolution of images that are captured by the RPi camera?
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: RPi相机拍摄的图像分辨率是多少？
- en: What is the command to capture an image using the RPi camera?
  id: totrans-204
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用RPi相机拍摄图像的命令是什么？
- en: What is the command to record a video using the RPi camera?
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用RPi相机录制视频的命令是什么？
- en: What percentage of the memory does Raspbian OS occupy on an 8 GB and 32 GB SD
    card?
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Raspbian OS在8GB和32GB SD卡上占用的内存百分比是多少？
