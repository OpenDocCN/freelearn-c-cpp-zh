- en: '*Chapter 4*: Measuring the Amount of Light with a Photoresistor'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*第四章*：使用光敏电阻测量光量'
- en: This chapter focuses on how to connect a **photoresistor**, an electronic component
    that measures the amount of light from the environment, to an input port of both
    the Blue Pill and Curiosity Nano microcontroller boards. In this chapter's exercise,
    we will analyze with a photoresistor whether a plant receives enough light.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章重点介绍如何将**光敏电阻**（一种测量环境光量的电子元件）连接到蓝牙板和Curiosity Nano微控制器板的输入端口。在本章的练习中，我们将使用光敏电阻来分析植物是否接收到了足够的光。
- en: 'In this chapter, we are going to cover the following main topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主要内容：
- en: Understanding sensors
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解传感器
- en: Introducing photoresistors
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 介绍光敏电阻
- en: Connecting a photoresistor to a microcontroller board port
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将光敏电阻连接到微控制器板端口
- en: Coding the photoresistor values and setting up ports
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 编写光敏电阻值并设置端口
- en: Testing the photoresistor
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 测试光敏电阻
- en: By the end of this chapter, you will have learned how to connect an analog sensor
    to a microcontroller board, and how to analyze analog data obtained from a photoresistor.
    The knowledge and experience learned in this chapter will be useful in other chapters
    that require the use of a sensor.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 到本章结束时，你将学会如何将模拟传感器连接到微控制器板，以及如何分析从光敏电阻获得的分析数据。本章中获得的知识和经验将在其他需要使用传感器的章节中非常有用。
- en: Technical requirements
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: The software tools that you will be using in this chapter are the Arduino IDE
    and the MPLAB-X for editing and uploading your programs to the Blue Pill and the
    Curiosity Nano boards, respectively.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本章中你将使用的软件工具是Arduino IDE和MPLAB-X，分别用于编辑和上传程序到蓝牙板和Curiosity Nano板。
- en: 'The code used in this chapter can be found in the book''s GitHub repository
    here:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 本章中使用的代码可以在本书的GitHub仓库中找到：[https://github.com/PacktPublishing/DIY-Microcontroller-Projects-for-Hobbyists/tree/master/Chapter04](https://github.com/PacktPublishing/DIY-Microcontroller-Projects-for-Hobbyists/tree/master/Chapter04)
- en: '[https://github.com/PacktPublishing/DIY-Microcontroller-Projects-for-Hobbyists/tree/master/Chapter04](https://github.com/PacktPublishing/DIY-Microcontroller-Projects-for-Hobbyists/tree/master/Chapter04)'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://github.com/PacktPublishing/DIY-Microcontroller-Projects-for-Hobbyists/tree/master/Chapter04](https://github.com/PacktPublishing/DIY-Microcontroller-Projects-for-Hobbyists/tree/master/Chapter04)'
- en: 'The Code in Action video for this chapter can be found here: [https://bit.ly/3gNY4bt](https://bit.ly/3gNY4bt)'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的“代码在行动”视频可以在以下链接找到：[https://bit.ly/3gNY4bt](https://bit.ly/3gNY4bt)
- en: 'In this chapter, we will also use the following pieces of hardware:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们还将使用以下硬件设备：
- en: A solderless breadboard.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个无焊面包板。
- en: The Blue Pill and Curiosity Nano microcontroller boards.
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 蓝牙板和Curiosity Nano微控制器板。
- en: A micro-USB cable for connecting your microcontroller boards to a computer.
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用于将微控制器板连接到计算机的微型USB线。
- en: The ST-Link/V2 electronic interface needed for uploading the compiled code to
    the Blue Pill. Bear in mind that the ST-Link/V2 requires four female-to-female
    DuPont wires.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用于将编译后的代码上传到蓝牙板的ST-Link/V2电子接口。请注意，ST-Link/V2需要四根公对公的杜邦线。
- en: A green, yellow, and red LED.
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个绿色、黄色和红色的LED。
- en: Three 220-ohm resistors rated at one-quarter watt. These resistors are for the
    3 LEDs.
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 三个220欧姆电阻，额定功率为四分之一瓦。这些电阻用于3个LED。
- en: One 220-ohm resistor rated at one-quarter watt for the photoresistor connected
    to the Curiosity Nano.
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个220欧姆电阻，额定功率为四分之一瓦，用于连接到Curiosity Nano的光敏电阻。
- en: One 10 K ohm resistor, rated at one-quarter watt.
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个10 K欧姆电阻，额定功率为四分之一瓦。
- en: A **photoresistor sensor module**.
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**光敏电阻传感器模块**。'
- en: Three male-to-female DuPont wires for connecting the sensor module to the solderless
    breadboard.
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 三根公对母的杜邦线，用于将传感器模块连接到无焊面包板。
- en: A dozen male-to-male DuPont wires for connecting the resistor and the push button
    to the breadboard and the microcontroller boards.
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一打公对公的杜邦线，用于将电阻和按钮连接到面包板和微控制器板。
- en: The next section describes a brief introduction to photoresistors, their electrical
    characteristics, and how they are used in electronic projects.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 下一节将简要介绍光敏电阻、它们的电气特性和在电子项目中的应用。
- en: Understanding sensors
  id: totrans-27
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解传感器
- en: In this section, we explain what sensors are and the importance of sensor modules.
    It is important to understand first what sensors are and what their purpose is
    before you use them in practical microcontroller board applications, for example,
    using photoresistors, which are a useful type of sensor. This information about
    sensors is essential for further sections.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们解释传感器是什么以及传感器模块的重要性。在您在实际微控制器板应用中使用它们之前，例如使用光敏电阻（这是一种有用的传感器类型），首先了解传感器及其用途是很重要的。有关传感器的信息对于后续章节至关重要。
- en: Defining sensors
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 定义传感器
- en: A **sensor** is an electronic component, device, or module that measures physical
    input from an environment or a particular situation (for example, a sensor measuring
    water temperature in a fish tank). Sensors are useful for detecting changes in
    physical variables, such as humidity, temperature, light, vibrations, and movement,
    among others. Those physical variations are manifested in the sensors by changing
    their electric/electronic properties, such as changes in resistance and conductivity
    in the sensors.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '**传感器**是一种电子组件、设备或模块，它测量来自环境或特定情况（例如，测量鱼缸中水温的传感器）的物理输入。传感器对于检测物理变量的变化很有用，例如湿度、温度、光、振动和运动等。这些物理变化通过传感器改变其电/电子特性来体现，例如传感器中电阻和导电性的变化。'
- en: There are different types of sensors with different applications. For example,
    motion sensors can detect human or pet movements when they pass across the sensor's
    field of view. If this sensor detects motion, it sends a signal to a computer
    or microcontroller board and then the board should do something about it, such
    as open an automatic door, set off an alarm, turn on a lightbulb, and so on. Other
    types of sensors include infrared, ultrasonic, temperature, pressure, and touch
    sensors.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 存在着不同类型的传感器，具有不同的应用。例如，运动传感器可以在它们穿过传感器的视野时检测到人或宠物的移动。如果这个传感器检测到运动，它会向计算机或微控制器板发送信号，然后该板应该对此做出一些操作，例如打开自动门、触发警报、打开灯泡等。其他类型的传感器包括红外线、超声波、温度、压力和触摸传感器。
- en: What are sensor modules?
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 传感器模块是什么？
- en: A sensor can be part of a small electronic circuit called a **sensor module**.
    It contains other electronic components besides a sensor, such as resistors, transistors,
    LEDs, and integrated circuits, among others. The purpose of those extra components
    in a sensor module is to support and facilitate the reading, analysis, and transmission
    of signals coming from a sensor. Some sensor modules convert analog to digital
    data. Analog data are voltage variations, that is, analog to physical variables
    from an environment. For example, 0.5 volts obtained from a temperature sensor
    could be equivalent to 25 degrees Celsius. Digital data coming from a sensor module
    can contain either logical-level *HIGH* or logical-level *LOW* values.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 传感器可以是称为**传感器模块**的小型电子电路的一部分。它除了包含传感器外，还包含其他电子组件，如电阻器、晶体管、LED 和集成电路等。传感器模块中这些额外组件的目的是支持和简化来自传感器的信号读取、分析和传输。一些传感器模块将模拟信号转换为数字数据。模拟数据是电压变化，即从环境中的物理变量到模拟。例如，从温度传感器获得的
    0.5 伏特可能相当于 25 摄氏度。来自传感器模块的数字数据可以包含逻辑电平 *高* 或逻辑电平 *低* 值。
- en: Note
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Voltages representing digital logic levels change depending on the microcontroller
    board that you are using. The I/O ports from both the Blue Pill and Curiosity
    Nano microcontroller boards use 3.3 volts, which is equivalent to logical-level
    HIGH. Logical-level LOW is equivalent to 0 volts.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 表示数字逻辑电平的电压取决于您使用的微控制器板。Blue Pill 和 Curiosity Nano 微控制器板的 I/O 端口都使用 3.3 伏，相当于逻辑电平高。逻辑电平低相当于
    0 伏。
- en: 'An analog signal from a sensor is sent electronically via a wire or a wireless
    communication medium (for example, Bluetooth) to a microcontroller board, which
    will process it, and then do something about it, as shown in *Figure 4.1*:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 从传感器发出的模拟信号通过电线或无线通信介质（例如，蓝牙）电子方式发送到微控制器板，该板将对其进行处理，然后对其进行一些操作，如图 *图 4.1* 所示：
- en: '![Figure 4.1 – A temperature sensor connected to the microcontroller board''s
    port](img/Figure_4.1_B16413.jpg)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![图 4.1 – 连接到微控制器板端口的温度传感器](img/Figure_4.1_B16413.jpg)'
- en: Figure 4.1 – A temperature sensor connected to the microcontroller board's port
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.1 – 连接到微控制器板端口的温度传感器
- en: The data coming from the sensor (displayed in the diagram from *Figure 4.1*)
    is read by the microcontroller board's input port. This data can be adapted and
    shown to be human-readable (for example, showing the temperature numerically in
    a display as degrees Celsius or Fahrenheit). The same happens with analog and/or
    digital signals coming from a sensor module. Its data is sent to a microcontroller
    board port or ports via a wired or wireless medium.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 来自传感器的数据（如图 *图 4.1* 中的图所示）由微控制器板的输入端口读取。这些数据可以调整并显示为人类可读的格式（例如，在显示屏上以摄氏度或华氏度显示温度）。来自传感器模块的模拟和/或数字信号也是如此。其数据通过有线或无线介质发送到微控制器板的端口或端口。
- en: Note
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Microcontroller boards' ports can be set up as either input or output ports
    via coding. Please refer to [*Chapter 2*](B16413_02_Final_NM_ePub.xhtml#_idTextAnchor029),
    *Software Setup and C Programming for Microcontroller Boards*, on how to program
    them.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 通过编码，微控制器板的端口可以设置为输入或输出端口。请参阅 [*第 2 章*](B16413_02_Final_NM_ePub.xhtml#_idTextAnchor029)，*微控制器板的软件设置和
    C 语言编程*，了解如何编程它们。
- en: The next section focuses on photoresistors, a commonly used type of sensor,
    describing their function, representation, and applications.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 下一节将重点介绍光敏电阻，这是一种常用的传感器类型，描述其功能、表示方法和应用。
- en: Introducing photoresistors
  id: totrans-43
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍光敏电阻
- en: This section introduces you to photoresistors, which are very useful for many
    applications, for example, for measuring the amount of light. In this chapter,
    we will define what photoresistors are, their classification, and how they are
    connected to an electronic circuit.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 本节向您介绍光敏电阻，它在许多应用中非常有用，例如，用于测量光量。在本章中，我们将定义光敏电阻是什么，它们的分类，以及它们如何连接到电子电路。
- en: A **photoresistor** is an electronic component made with light-sensitive material,
    changing its resistance according to the amount of visible light that it detects.
    There are different types of photoresistors. Some of them detect **ultraviolet**
    (**UV**) light and others detect infrared light. The latter is used in TV sets,
    where its infrared light sensor receives data from a remote control. *Figure 4.2*
    shows a common photoresistor used in the examples of this chapter. The photoresistor
    used in this chapter detects regular light that humans can see. It does not detect
    infrared nor UV light.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '**光敏电阻**是一种由光敏材料制成的电子元件，根据其检测到的可见光量改变其电阻。光敏电阻有多种类型。其中一些检测 **紫外线**（**UV**）光，而另一些检测红外光。后者用于电视，其红外光传感器从遥控器接收数据。*图
    4.2* 显示了本章示例中使用的常见光敏电阻。本章中使用的光敏电阻检测人类可见的光。它不检测红外光或紫外线。'
- en: '![Figure 4.2 – A typical photoresistor](img/Figure_4.2_B16413.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![图 4.2 – 典型的光敏电阻](img/Figure_4.2_B16413.jpg)'
- en: Figure 4.2 – A typical photoresistor
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.2 – 典型的光敏电阻
- en: 'From *Figure 4.2*, you can see that the photoresistor has two pins (also called
    legs). They are connected to an electronic circuit similar to regular resistors,
    so photoresistors do not have polarity. They work as a regular resistor that changes
    its resistance according to the amount of light it receives through its transparent
    cover. Here are some technical specifications of the photoresistor:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 从 *图 4.2* 中，您可以看到光敏电阻有两个引脚（也称为腿）。它们连接到与普通电阻类似的电子电路，因此光敏电阻没有极性。它们作为普通电阻工作，其电阻根据通过其透明盖板接收到的光量而变化。以下是光敏电阻的一些技术规格：
- en: 'Size: 5mm diameter (width)'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 尺寸：直径 5mm（宽度）
- en: 'Range of resistance: 200 K ohms (dark) to typically 5 K to 10 K ohms and nearly
    0 ohms when it receives full brightness.'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 电阻范围：200 K 欧姆（暗态）到通常 5 K 到 10 K 欧姆，在接收到全亮度时几乎为 0 欧姆。
- en: 'Power supply: Up to 100V, using less than 1 milliamp of current on average,
    depending on the power supply voltage.'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 电源：最高 100V，平均电流小于 1 毫安，具体取决于电源电压。
- en: '*Figure 4.3* shows an electrical diagram containing a photoresistor and how
    it can be connected to a microcontroller board.'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 4.3* 显示了一个包含光敏电阻的电气图以及如何将其连接到微控制器板。'
- en: '![Figure 4.3 – Electrical diagram with a photoresistor](img/Figure_4.3_B16413.jpg)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![图 4.3 – 含光敏电阻的电气图](img/Figure_4.3_B16413.jpg)'
- en: Figure 4.3 – Electrical diagram with a photoresistor
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.3 – 含光敏电阻的电气图
- en: As you can see in *Figure 4.3*, a photoresistor's electrical symbol is represented
    with a circle and some incoming arrows indicating that light rays are hitting
    the photoresistor's surface. The photoresistor is connected to the power supply
    to a **Ground** pin from a microcontroller board and the other pin is connected
    to a voltage pin (**Vcc**) and an **Input port** from a microcontroller board.
    That is one way to connect a photoresistor. The **10K ohm** resistor works as
    a pull-down resistor. This is because the input port where the photoresistor is
    connected to at some point will receive zero volts when the photoresistor is not
    receiving any light. Remember that we should not leave an input pin without connecting
    to anything, otherwise its state will be floating (inputting random voltages).
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 如*图4.3*所示，光敏电阻的电气符号用一个圆和一些指向圆的箭头表示，这表明光线正在照射光敏电阻的表面。光敏电阻连接到微控制器板的**地**（Ground）引脚，另一个引脚连接到电压引脚（**Vcc**）和微控制器板的**输入端口**。这是连接光敏电阻的一种方式。**10K欧姆**电阻作为下拉电阻使用。这是因为当光敏电阻没有接收到任何光线时，连接到光敏电阻的输入端口将接收零伏特。请记住，我们不应该让输入引脚没有连接到任何东西，否则其状态将是浮动的（输入随机电压）。
- en: Note
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: The photoresistor should be connected to an analog input port from the microcontroller
    board since the port will receive a changing analog voltage from the photoresistor
    because the resistance presented at the photoresistor will change according to
    the amount of light received by the photoresistor.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 光敏电阻应该连接到微控制器板的一个模拟输入端口，因为该端口将接收来自光敏电阻的变化电压，因为光敏电阻呈现的电阻将根据光敏电阻接收到的光照量而变化。
- en: The next section explains how to connect and use photoresistors in both the
    Blue Pill and Curiosity Nano boards to measure the amount of light in an environment.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 下一节将解释如何连接和使用光敏电阻，以测量环境中的光照量，无论是在Blue Pill板还是在Curiosity Nano板上。
- en: Connecting a photoresistor to a microcontroller board port
  id: totrans-59
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将光敏电阻连接到微控制器板端口
- en: This section shows how to connect a photoresistor to the Blue Pill and the Curiosity
    Nano boards to *read* the amount of light from an environment (for example, a
    living room).
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 本节展示了如何将光敏电阻连接到Blue Pill和Curiosity Nano板，以*读取*环境中的光照量（例如，客厅）。
- en: In this section, we also explain how to use three LEDs to indicate that a room
    is well illuminated by turning a green LED on, that the light is dim by turning
    a yellow LED on, or that it is dark by turning a red LED on. The electronic circuit
    with the photoresistor sensor can be placed close to a plant and the circuit can
    be useful to know whether a plant needs more light or not. The next section shows
    how to build the circuit with the Blue Pill board.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们还将解释如何使用三个LED灯来指示房间是否得到良好的照明：通过点亮绿色LED灯表示房间照明良好，通过点亮黄色LED灯表示光线较暗，或者通过点亮红色LED灯表示房间昏暗。带有光敏电阻传感器的电子电路可以放置在植物附近，该电路可以用来判断植物是否需要更多的光照。下一节将展示如何使用Blue
    Pill板构建电路。
- en: Connecting a photoresistor to a Blue Pill board
  id: totrans-62
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将光敏电阻连接到Blue Pill板
- en: The connection of a photoresistor sensor to a Blue Pill microcontroller board
    is simple. It can be directly connected to an input analog port, provided that
    you use a pull-down resistor. The circuit shown in *Figure 4.4* describes how
    to do it, and it is based on the electrical diagram from *Figure 4.3*.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 将光敏电阻传感器连接到Blue Pill微控制器板的连接很简单。只要使用下拉电阻，就可以直接连接到输入模拟端口。*图4.4*中所示的电路描述了如何进行连接，它基于*图4.3*中的电气图。
- en: '![Figure 4.4 – The LEDs and photoresistor connected to a Blue Pill board](img/Figure_4.4_B16413.jpg)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![图4.4 – 连接到Blue Pill板的LED灯和光敏电阻](img/Figure_4.4_B16413.jpg)'
- en: Figure 4.4 – The LEDs and photoresistor connected to a Blue Pill board
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.4 – 连接到Blue Pill板的LED灯和光敏电阻
- en: 'As you can see in *Figure 4.4*, the three LEDs will show the amount of light
    detected by the photoresistor. The following are the steps for connecting the
    components to the Blue Pill board:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 如*图4.4*所示，三个LED灯将显示光敏电阻检测到的光照量。以下是连接组件到Blue Pill板的步骤：
- en: Connect the Curiosity Nano's GND pins to the upper and lower rails, of the solderless
    breadboard, as shown in *Figure 4.4*.
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Curiosity Nano的GND引脚连接到无焊面包板的上下轨，如*图4.4*所示。
- en: Connect one pin of the photoresistor to the microcontroller board's ground pin
    labeled **3V3**.
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将光敏电阻的一个引脚连接到微控制器板标有**3V3**的接地引脚。
- en: Connect the other pin of the photoresistor to the Blue Pill's pin labeled **B1**.
    **B1** will be used as an analog input port.
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将光敏电阻的另一端连接到Blue Pill上标记为**B1**的引脚。**B1**将被用作模拟输入端口。
- en: Connect a **10K ohm** resistor to the ground and to the photoresistor's leg
    that is connected to input port **B1** of the Blue Pill.
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将一个**10K欧姆**电阻连接到地以及连接到Blue Pill输入端口**B1**的光敏电阻的腿。
- en: Now, connect the resistors to the output ports **B12**, **B14**, and **B15**
    of the Blue Pill.
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，将电阻连接到Blue Pill的输出端口**B12**、**B14**和**B15**。
- en: As the last step, connect the green, yellow, and red LEDs' anodes to the three
    resistors and then connect the LEDs' cathodes to the ground.
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 作为最后一步，将绿色、黄色和红色LED的正极连接到三个电阻，然后将LED的负极连接到地。
- en: The 3V3 pin from the Blue Pill provides 3.3 volts, which are enough for applying
    voltage (feeding) to the photoresistor.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: Blue Pill的3V3引脚提供3.3伏，这对于施加电压（供电）到光敏电阻是足够的。
- en: Important note
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: Do not apply **5 volts** (**5V**) to the Blue Pill's input ports, because you
    may damage the Blue Pill. That's why you will connect the 3V3 voltage pin to the
    photoresistor, so it will provide up to 3.3 volts as an analog voltage output
    and the Blue Pill will use up that voltage to measure the amount of light. Remember
    that the voltage coming from the photoresistor will change according to its resistance.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 不要将**5伏**（**5V**）应用到Blue Pill的输入端口，因为这样可能会损坏Blue Pill。这就是为什么你需要将3V3电压引脚连接到光敏电阻，这样它将提供高达3.3伏的模拟电压输出，而Blue
    Pill将使用这电压来测量光量。记住，来自光敏电阻的电压将根据其电阻而变化。
- en: We are connecting a **10K ohm** pull-down resistor to the Blue Pill's input
    port **B1**, as shown in *Figure 4.4*, forcing the port to have a 0-volt input
    when there's no voltage coming from the photoresistor. Remember that the input
    ports should receive some voltage or even 0 volts to avoid random voltages.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将一个**10K欧姆**下拉电阻连接到Blue Pill的输入端口**B1**，如图*图4.4*所示，强制端口在没有来自光敏电阻的电压时具有0伏输入。记住，输入端口应该接收一些电压，甚至0伏，以避免随机电压。
- en: Note
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: You may want to try a different value for the pull-down 10K ohm resistor connected
    to the Blue Pill, shown in *Figure 4.4*, depending on the light level range that
    you would like to detect.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 根据你想要检测的光照水平范围，你可能想要尝试将*图4.4*中连接到Blue Pill的下拉10K欧姆电阻的值改为不同的值。
- en: '*Figure 4.5* shows how all the components are connected to the microcontroller
    board. This circuit is based on the Fritzing diagram shown in *Figure 4.4*.'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: '*图4.5*显示了所有组件如何连接到微控制器板。此电路基于*图4.4*中显示的Fritzing图。'
- en: '![Figure 4.5 – Connecting the photoresistor and the LEDs to the Blue Pill](img/Figure_4.5_B16413.jpg)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![图4.5 – 将光敏电阻和LED连接到Blue Pill](img/Figure_4.5_B16413.jpg)'
- en: Figure 4.5 – Connecting the photoresistor and the LEDs to the Blue Pill
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.5 – 将光敏电阻和LED连接到Blue Pill
- en: As you can see in *Figure 4.5*, the photoresistor is connected to the Blue Pill's
    port B1\. The green LED is turning on, meaning that the amount of light that the
    plant is receiving should be OK. Remember that you will need to connect the ST-Link/V2
    electronic interface to the Blue Pill in order to upload the program to it from
    the Arduino IDE, as explained in [*Chapter 1*](B16413_01_Final_NM_ePub.xhtml#_idTextAnchor014),
    *Introduction to Microcontrollers and Microcontroller Boards*.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 如*图4.5*所示，光敏电阻连接到Blue Pill的端口B1。绿色LED亮起，意味着植物接收到的光量应该是正常的。记住，你需要将ST-Link/V2电子接口连接到Blue
    Pill，以便从Arduino IDE上传程序，如[*第1章*](B16413_01_Final_NM_ePub.xhtml#_idTextAnchor014)，*微控制器和微控制器板简介*中所述。
- en: In this section, you learned how to connect an easy-to-use photoresistor to
    the Blue Pill board and how to show its values through LEDs.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，你学习了如何将易于使用的光敏电阻连接到Blue Pill板，以及如何通过LED显示其值。
- en: The next section describes how to code the photoresistor example shown in *Figure
    4.4* and *Figure 4.5*.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 下一节描述了如何编写*图4.4*和*图4.5*中所示的光敏电阻示例的代码。
- en: Coding the photoresistor values and setting up ports
  id: totrans-85
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 编写光敏电阻值和设置端口
- en: This section shows how to code a Blue Pill application for reading data from
    a photoresistor.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 本节展示了如何编写Blue Pill应用程序以从光敏电阻读取数据。
- en: 'The following code should run on the microcontroller board circuit shown in
    *Figure 4.4* and *Figure 4.5*:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码应在*图4.4*和*图4.5*所示的微控制器板电路中运行：
- en: '[PRE0]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'As you can see from the code, one of its most important functions is this one:
    `analogRead(photoresistorPin);`. Internally, that function will perform an `pinMode()`
    function to declare the PB12, PB14, and PB15 ports as outputs.'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 如您从代码中看到的，其中最重要的功能之一是：`analogRead(photoresistorPin);`。内部，该函数将执行一个`pinMode()`函数来声明PB12、PB14和PB15端口为输出。
- en: The code can be downloaded from the book's GitHub repository. Its filename is
    `photoresistor_bluepill.ino`. The code from the repository contains useful comments
    explaining the functions and variables used in it.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 代码可以从本书的GitHub仓库下载。其文件名为`photoresistor_bluepill.ino`。仓库中的代码包含有用的注释，解释了其中使用的函数和变量。
- en: Note
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: You can run the same code for the Blue Pill on Arduino microcontroller boards
    such as the Arduino Uno. Just change the Blue Pill's input port PB1 for the Arduino's
    analog port 0 (it is labeled as A0 on the Arduino Uno), and change the Blue Pill's
    output ports PB12, PB14, and PB15 for the Arduino digital ports 8, 9, and 10\.
    You may also need to change the values (thresholds) for the decisions from the
    code.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在Arduino Uno等Arduino微控制器板上运行相同的Blue Pill代码。只需将Blue Pill的输入端口PB1更改为Arduino的模拟端口0（在Arduino
    Uno上标记为A0），并将Blue Pill的输出端口PB12、PB14和PB15更改为Arduino的数字端口8、9和10。您可能还需要更改代码中的决策值（阈值）。
- en: The following section describes how to connect the LEDs and a photoresistor
    to the Curiosity Nano microcontroller board, following the example from the Blue
    Pill board.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 以下部分描述了如何根据Blue Pill板的示例将LED和光敏电阻连接到Curiosity Nano微控制器板。
- en: Connecting a photoresistor to a Curiosity Nano board
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将光敏电阻连接到Curiosity Nano板
- en: Following the Blue Pill example from the previous section, we can show the amount
    of light in an environment by turning on LED lights using the Curiosity Nano microcontroller
    board, as depicted in *Figure 4.6*.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 按照上一节中的Blue Pill示例，我们可以通过使用Curiosity Nano微控制器板打开LED灯来显示环境中的光照量，如图*图4.6*所示。
- en: '![Figure 4.6 – The LEDs and photoresistor connected to a Blue Pill board](img/Figure_4.6_B16413.jpg)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
  zh: '![图4.6 – 连接到Blue Pill板的LED和光敏电阻](img/Figure_4.6_B16413.jpg)'
- en: Figure 4.6 – The LEDs and photoresistor connected to a Blue Pill board
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.6 – 连接到Blue Pill板的LED和光敏电阻
- en: 'As it is shown in *Figure 4.6*, the three LEDs will be used to show the amount
    of light detected by the photoresistor. The following are the steps for connecting
    the components to the Curiosity Nano board:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 如*图4.6*所示，三个LED将被用来显示光敏电阻检测到的光照量。以下是连接组件到Curiosity Nano板的步骤：
- en: Connect the Curiosity Nano's GND pins to the upper and lower rails of the solderless
    breadboard, as shown in *Figure 4.6*.
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Curiosity Nano的GND引脚连接到无焊面包板的上下轨，如图*图4.6*所示。
- en: Connect one pin of the photoresistor to the Curiosity Nano's pin labeled VTG.
    This pin provides 3.3 volts.
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将光敏电阻的一个引脚连接到Curiosity Nano上标记为VTG的引脚。此引脚提供3.3伏。
- en: Connect the other pin of the photoresistor to the Curiosity Nano's pin labeled
    RA0\. RA0 will be used as an analog input port.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将光敏电阻的另一端连接到Curiosity Nano上标记为RA0的引脚。RA0将被用作模拟输入端口。
- en: Connect a 220-ohm resistor to the ground and to the photoresistor's leg that
    is connected to port RA0\. This will be a pull-down resistor.
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将一个220欧姆电阻连接到地以及连接到RA0端口的photoresistor的腿。这将是一个下拉电阻。
- en: Now, connect the 220-ohm resistors to ports RD1, RD2, and RD3 and to the anodes
    of the 3 LEDs, respectively.
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，将220欧姆电阻分别连接到RD1、RD2和RD3端口以及3个LED的正极。
- en: As the last step, connect the LEDs' cathodes to the ground.
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 作为最后一步，将LED的负极连接到地。
- en: We are connecting a 220-ohm pull-down resistor to the Curiosity Nano's input
    port, as shown in *Figure 4.6*, forcing the port to have a 0-volt input when there's
    no voltage coming from the photoresistor. Remember that the input ports should
    receive some voltage or even 0 volts to avoid random voltages.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将一个220欧姆的下拉电阻连接到Curiosity Nano的输入端口，如图*图4.6*所示，当光敏电阻没有电压输入时，强制端口具有0伏输入。记住，输入端口应该接收一些电压，甚至0伏，以避免随机电压。
- en: Note
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: You may want to try a different value for the pull-down 220-ohm resistor shown
    in *Figure 4.6*, depending on the light level range that you would like to detect.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 根据您希望检测的光照水平范围，您可能想尝试在*图4.6*中显示的不同下拉220欧姆电阻的值。
- en: The photoresistor from *Figure 4.6* will change its resistance according to
    the amount of light that it receives from the environment, thus the voltage that
    passes through it will change. These voltage differences will be read by a microcontroller
    board's input port. Our code running on the microcontroller board will then compare
    the analog voltage values and determine whether the light is very low, normal,
    or too bright by turning on the yellow, green, or red LEDs respectively.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 4.6* 中的光敏电阻将根据其从环境中接收到的光照量改变其电阻，因此通过它的电压将改变。这些电压差异将被微控制器板的输入端口读取。然后，运行在微控制器板上的我们的代码将比较模拟电压值，并通过分别开启黄色、绿色或红色
    LED 来确定光照是极低、正常还是过亮。'
- en: 'The next code shows how to read the photoresistor values through the analog
    port RA0:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 下一段代码展示了如何通过模拟端口 RA0 读取光敏电阻值：
- en: '[PRE1]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Please bear in mind that the code uploaded to the book's GitHub online repository
    has many comments explaining almost all its instructions. In the preceding code,
    one of the most important functions is `ADC_GetConversion(channel_ANA0);`, which
    reads the voltage changes from the photoresistor and performs the analog to digital
    conversion of those values. `channel_ana0` is a label given to port RA0.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，上传到本书 GitHub 在线仓库的代码中包含许多注释，解释了几乎所有的指令。在前面代码中，最重要的函数之一是 `ADC_GetConversion(channel_ANA0);`，它读取光敏电阻的电压变化并执行这些值的模拟到数字转换。`channel_ana0`
    是分配给端口 RA0 的标签。
- en: The code can be downloaded from the book's GitHub repository. Its filename is
    `Chapter4_Curiosity_Nano_code_project.zip`. The code from the repository contains
    useful comments explaining the functions and variables used in it.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 代码可以从本书的 GitHub 仓库下载。其文件名为 `Chapter4_Curiosity_Nano_code_project.zip`。仓库中的代码包含有用的注释，解释了其中使用的函数和变量。
- en: '*Figure 4.7* shows how the photoresistor and the LEDs are connected to the
    Curiosity Nano''s ports. The circuit shown in *Figure 4.7* is based on the Fritzing
    diagram shown in *Figure 4.6*.'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 4.7* 展示了光敏电阻和 LED 如何连接到 Curiosity Nano 的端口。*图 4.7* 中所示的电路基于 *图 4.6* 中的 Fritzing
    图。'
- en: '![Figure 4.7 – Connecting the photoresistor and the LEDs to the Curiosity Nano](img/Figure_4.7_B16413.jpg)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![图 4.7 – 将光敏电阻和 LED 连接到 Curiosity Nano](img/Figure_4.7_B16413.jpg)'
- en: Figure 4.7 – Connecting the photoresistor and the LEDs to the Curiosity Nano
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.7 – 将光敏电阻和 LED 连接到 Curiosity Nano
- en: As you can see in *Figure 4.7*, the photoresistor is connected to the Curiosity
    Nano's port RA0\. The green LED is turning on in the figure, meaning that the
    amount of light that the plant is receiving should be OK.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 如您在 *图 4.7* 中所见，光敏电阻连接到 Curiosity Nano 的端口 RA0。图中的绿色 LED 正在开启，这意味着植物接收到的光照量应该是正常的。
- en: The next section shows how to obtain analog data about the amount of light from
    an environment using a photoresistor sensor module.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 下一节将展示如何使用光敏电阻传感器模块获取关于环境光照量的模拟数据。
- en: Connecting a photoresistor sensor module to the microcontroller boards
  id: totrans-118
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将光敏电阻传感器模块连接到微控制器板
- en: This section explains how to use a photoresistor sensor module for measuring
    the amount of light from an environment. This module can be bought separately
    or as part of a sensors kit from many online sources. The photoresistor sensor
    module contains tiny electronic components that facilitate the connection to a
    microcontroller board and its photoresistor use. For example, the module that
    we are using in this section contains extra components such as resistors and a
    variable resistor that adjusts the threshold level of a digital *high* value,
    which is sent by the sensor module if it receives a certain amount of light. Of
    course, this digital value must be sent to a digital input port of the microcontroller
    board.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 本节解释了如何使用光敏电阻传感器模块来测量环境中的光照量。此模块可以从许多在线来源单独购买或作为传感器套件的一部分购买。光敏电阻传感器模块包含微小的电子组件，便于连接到微控制器板及其光敏电阻的使用。例如，本节中使用的模块包含额外的组件，如电阻和可变电阻，该可变电阻调整传感器模块发送的数字
    *高* 值的阈值水平，如果它接收一定量的光。当然，这个数字值必须发送到微控制器板的数字输入端口。
- en: The next section shows how to connect the photoresistor sensor module to the
    Blue Pill.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 下一节将展示如何将光敏电阻传感器模块连接到 Blue Pill。
- en: Connecting the photoresistor sensor module to the Blue Pill board
  id: totrans-121
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 将光敏电阻传感器模块连接到 Blue Pill 板
- en: 'This section explains how to connect a photoresistor module to the microcontroller
    board using just three wires. The photoresistor sensor module shown in *Figure
    4.8* has four connectors: **GND** (short for **ground**), **A0** (short for **analog
    output**), **D0** (short for **digital output**), and +5V. The order of these
    connectors may change if your sensor module is from a different brand, but their
    purpose is the same.'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 本节解释了如何仅使用三根线将光敏电阻模块连接到微控制器板。*图4.8*中所示的光敏电阻传感器模块有四个连接器：**GND**（代表**地**），**A0**（代表**模拟输出**），**D0**（代表**数字输出**），和+5V。如果您的传感器模块来自不同的品牌，这些连接器的顺序可能会改变，但它们的作用是相同的。
- en: '![ Figure 4.8 – A photoresistor sensor module connected to a Blue Pill board](img/Figure_4.8_B16413.jpg)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
  zh: '![图4.8 – 连接到Blue Pill板的传感器模块的光敏电阻传感器模块](img/Figure_4.8_B16413.jpg)'
- en: Figure 4.8 – A photoresistor sensor module connected to a Blue Pill board
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.8 – 连接到Blue Pill板的光敏电阻传感器模块
- en: 'Here are the steps on how to connect the sensor module to the Blue Pill:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是如何将传感器模块连接到Blue Pill的步骤：
- en: Connect the sensor module's GND pin (in some sensor modules, it is labeled with
    the – symbol) to the microcontroller board's ground connector labeled GND.
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将传感器模块的GND引脚（在某些传感器模块上，它标有-符号）连接到微控制器板的GND接地连接器。
- en: Connect the sensor module's +5V (in some modules, it is labeled with the + symbol)
    pin to the 3V3 voltage pin from the microcontroller board. Even though the 3V3
    pin provides 3.3 volts, it is enough for applying voltage (feeding) to the sensor
    module.
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将传感器模块的+5V（在某些模块上，它标有+符号）引脚连接到微控制器板的3V3电压引脚。尽管3V3引脚提供3.3伏，但对于向传感器模块供电（馈电）来说已经足够了。
- en: Important note
  id: totrans-128
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 重要提示
- en: Do not apply **5 volts** (**5V**) to the Blue Pill's input ports, because you
    may damage the Blue Pill. That's why you will connect the 3V3 voltage pin to the
    sensor module's +5V pin, so the module will provide up to 3.3 Volts as an analog
    voltage output, and the Blue Pill will use up that voltage to measure the amount
    of light.
  id: totrans-129
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 不要将**5伏**（**5V**）应用到Blue Pill的输入端口，因为这可能会损坏Blue Pill。这就是为什么你会将3V3电压引脚连接到传感器模块的+5V引脚，这样模块将提供高达3.3伏的模拟电压输出，而Blue
    Pill将使用这部分电压来测量光量。
- en: Connect the module's A0 pin to the Blue Pill's B1 pin (which is an input port).
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将模块的A0引脚连接到Blue Pill的B1引脚（它是一个输入端口）。
- en: Now, connect the resistors to Blue Pill ports B12, B14, and B15\. They are output
    ports.
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，将电阻连接到Blue Pill的B12、B14和B15端口。它们是输出端口。
- en: As the last step, connect the green, yellow, and red LEDs' anodes to those resistors
    and then connect the LEDs' cathodes to the ground.
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 作为最后一步，将绿色、黄色和红色LED的正极连接到这些电阻上，然后将LED的负极连接到地。
- en: As you can see in *Figure 4.8*, we are not connecting a pull-down resistor to
    the Blue Pill's input port because the sensor module already contains a pull-down
    resistor. This allows us to save some space in the circuit and time to connect
    extra components to it.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 如*图4.8*所示，我们没有将下拉电阻连接到Blue Pill的输入端口，因为传感器模块已经包含下拉电阻。这允许我们在电路中节省一些空间，并节省连接额外组件的时间。
- en: The following section describes how to use the sensor module with the Curiosity
    Nano.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 以下部分描述了如何使用传感器模块与Curiosity Nano配合。
- en: Connecting the photoresistor sensor module to the Curiosity Nano board
  id: totrans-135
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 将光敏电阻传感器模块连接到Curiosity Nano板
- en: In this section, we will analyze how the sensor module's analog pin is connected
    to the Curiosity Nano, as is shown in *Figure 4.9*. Please remember that this
    circuit does not need the pull-down resistor. We are using the same input port
    that was used for connecting the single photoresistor, described in an earlier
    section of this chapter. *Figure 4.9* shows a Fritzing diagram that includes the
    photoresistor module connected to the Curiosity Nano board.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将分析传感器模块的模拟引脚是如何连接到Curiosity Nano的，如图*图4.9*所示。请记住，这个电路不需要下拉电阻。我们使用的是之前章节中描述的用于连接单个光敏电阻的相同输入端口。*图4.9*显示了一个包含连接到Curiosity
    Nano板的传感器模块的Fritzing图。
- en: '![Figure 4.9 – The photoresistor module connected to Curiosity Nano''s RA5
    input port](img/Figure_4.9_B16413.jpg)'
  id: totrans-137
  prefs: []
  type: TYPE_IMG
  zh: '![图4.9 – 连接到Curiosity Nano的RA5输入端口的光敏电阻模块](img/Figure_4.9_B16413.jpg)'
- en: Figure 4.9 – The photoresistor module connected to Curiosity Nano's RA5 input
    port
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.9 – 连接到Curiosity Nano的RA5输入端口的光敏电阻模块
- en: 'Following the Fritzing diagram from *Figure 4.9*, these are the steps for connecting
    the photoresistor sensor module to the Curiosity Nano:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 根据*图4.9*中的Fritzing图，连接光敏电阻传感器模块到Curiosity Nano的步骤如下：
- en: Connect the module's GND pin (in some modules, it is labeled with the - symbol)
    to the microcontroller board's ground connector, labeled GND.
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将模块的GND引脚（在某些模块上，它标有-符号）连接到微控制器板的GND接地器，标记为GND。
- en: Connect the module's +5V pin (in some modules, it is labeled with the + symbol)
    to the VTG pin from the microcontroller board. Even though the VTG pin provides
    3.3 volts, it may be enough to apply voltage (feeding) to the sensor module.
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将模块的+5V引脚（在某些模块上，它标有+符号）连接到微控制器板的VTG引脚。尽管VTG引脚提供3.3伏，但它可能足以向传感器模块供电。
- en: Important note
  id: totrans-142
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 重要提示
- en: Do not apply 5V to the Curiosity Nano's input ports because you may damage the
    microcontroller board. That's why you will connect the Curiosity Nano's VTG voltage
    pin to the sensor module's +5V pin, so the sensor module will provide up to 3.3
    Volts as an output and the Curiosity Nano will use up that voltage to measure
    the amount of light.
  id: totrans-143
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 不要将5V应用到Curiosity Nano的输入端口，因为这可能会损坏微控制器板。这就是为什么你会将Curiosity Nano的VTG电压引脚连接到传感器模块的+5V引脚，这样传感器模块将提供高达3.3伏的输出，Curiosity
    Nano将使用该电压来测量光量。
- en: Connect the sensor module's A0 pin to the Curiosity Nano's RA5 pin (which is
    an input port).
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将传感器模块的A0引脚连接到Curiosity Nano的RA5引脚（这是一个输入端口）。
- en: Now, connect the resistors that will protect the 3 LEDs to ports RD1, RD2, and
    RD3\. They are output ports.
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，将保护3个LED灯的电阻连接到RD1、RD2和RD3端口。它们是输出端口。
- en: As the last step, connect the green, yellow, and red LEDs' anodes to those resistors
    and then connect the LEDs' cathodes to the ground.
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 作为最后一步，将绿色、黄色和红色LED灯的正极连接到这些电阻，然后将LED灯的负极连接到地。
- en: As you can see from *Figure 4.9*, similar to the example with the Blue Pill,
    we are not connecting a pull-down resistor to the Curiosity Nano's input port
    because the sensor module already contains a pull-down resistor.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 如*图4.9*所示，与Blue Pill的示例类似，我们不会将下拉电阻连接到Curiosity Nano的输入端口，因为传感器模块已经包含下拉电阻。
- en: You can use the same code used for the photoresistor used in *Figure 4.6* and
    *Figure 4.7* to get analog values from the photoresistor sensor module shown in
    *Figure 4.9*. You may need to adjust the values in the code if necessary. You
    can experiment with a number of environments (for example, using the sensor in
    a living room or a bedroom) to see the analog values obtained by the microcontroller
    board from the sensor change and thus adjust the code accordingly.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用与*图4.6*和*图4.7*中使用的光敏电阻相同的代码，从*图4.9*中所示的光敏电阻传感器模块获取模拟值。如果需要，你可能需要调整代码中的值。你可以通过在多种环境中进行实验（例如，在客厅或卧室中使用传感器）来观察微控制器板从传感器获得的模拟值的变化，并相应地调整代码。
- en: The next section describes how to test the photoresistor if something is wrong
    with it, for example, the LEDs are not turning on, as a way to troubleshoot it.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个部分将描述如何测试光敏电阻，如果它有问题，例如LED灯不亮，作为故障排除的方法。
- en: In this section, you learned how to connect the photoresistor module and the
    LEDs to the Curiosity Nano's ports. This section is important because it shows
    how practical and easy to use the photoresistor modules are, which facilitate
    the connections in microcontroller board projects.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，你学习了如何将光敏电阻模块和LED灯连接到Curiosity Nano的端口。本节很重要，因为它展示了光敏电阻模块的实用性和易用性，这有助于微控制器板项目中的连接。
- en: Testing out the photoresistor
  id: totrans-151
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 测试光敏电阻
- en: This section focuses on how to test out a photoresistor to see if it is working
    OK. First of all, remember that the photoresistor used in this chapter does not
    have polarity, so you can safely connect any of its pins (legs) to a microcontroller
    board's input port.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 本节重点介绍如何测试光敏电阻，以查看它是否正常工作。首先，记住本章中使用的光敏电阻没有极性，因此你可以安全地将它的任何引脚（腿）连接到微控制器板的输入端口。
- en: You also need to make sure that the pull-down resistor connected to the photoresistor
    has the right value. For example, the pull-down resistor used in the Blue Pill
    example from *Figure 4.4* is 10K ohm, and we used a 220-ohm resistor for the Curiosity
    Nano example from *Figure 4.6*. We found those resistor values experimentally.
    You can try out different resistors connected to the photoresistor to see if the
    voltage passing through the photoresistor changes widely. Ideally, that voltage
    should be changing between 0 and 3.3 volts, or close to those values, because
    in our circuit examples from this chapter, we connected one pin of the photoresistor
    to 3.3 volts.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 你还需要确保连接到光敏电阻的拉低电阻具有正确的值。例如，*图4.4*中的Blue Pill示例中使用的拉低电阻是10K欧姆，而*图4.6*中的Curiosity
    Nano示例中我们使用了220欧姆的电阻。我们通过实验找到了这些电阻值。你可以尝试将不同的电阻连接到光敏电阻，看看通过光敏电阻的电压是否变化很大。理想情况下，该电压应在0到3.3伏特之间变化，或接近这些值，因为在本章的电路示例中，我们将光敏电阻的一个引脚连接到了3.3伏特。
- en: 'In order to see if the photoresistor is working OK, you can use a multimeter.
    Follow the next steps for testing the photoresistor with a multimeter:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 为了检查光敏电阻是否正常工作，你可以使用万用表。按照以下步骤使用万用表测试光敏电阻：
- en: Connect the multimeter's red probe (test lead) to one pin of the photoresistor.
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将万用表的红表笔（测试线）连接到光敏电阻的一个引脚。
- en: Connect the multimeter's black probe to the other pin of the photoresistor.
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将万用表的黑表笔连接到光敏电阻的另一端。
- en: Turn on the multimeter and set it up for measuring resistance (ohms).
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开万用表并设置为测量电阻（欧姆）。
- en: Cover the photoresistor with your hand and uncover it. Its resistance should
    change in the multimeter because the light the photoresistor is receiving changes.
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用手覆盖光敏电阻并揭开它。由于光敏电阻接收到的光线发生变化，其电阻应该在万用表中发生变化。
- en: 'If you don''t have a multimeter, you can test out a photoresistor with just
    a voltage source, such as batteries, and an LED (any color will do). *Figure 4.10*
    shows how to connect the photoresistor to the LED:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你没有万用表，你可以使用电压源（如电池）和LED（任何颜色都可以）来测试光敏电阻。*图4.10*显示了如何将光敏电阻连接到LED：
- en: '![Figure 4.10 – Testing out the photoresistor](img/Figure_4.10_B16413.jpg)'
  id: totrans-160
  prefs: []
  type: TYPE_IMG
  zh: '![图4.10 – 测试光敏电阻](img/Figure_4.10_B16413.jpg)'
- en: Figure 4.10 – Testing out the photoresistor
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.10 – 测试光敏电阻
- en: 'As you can see from *Figure 4.10*, the light from the LED should change (for
    example, changing from dim to bright) when the photoresistor receives different
    amounts of light, so try to cover it with your hand and see what happens. If the
    LED light does not change, it is probable that the photoresistor is damaged, so
    you will need to replace it. Here are the steps for connecting the components:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 如*图4.10*所示，当光敏电阻接收到的光线量不同时，LED的光线应该发生变化（例如，从暗到亮），所以试着用手覆盖它并看看会发生什么。如果LED的光线没有变化，那么很可能是光敏电阻损坏了，因此你需要更换它。以下是连接组件的步骤：
- en: Connect the positive (`+`) battery terminal to one pin of the photoresistor.
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将正极（`+`）电池端连接到光敏电阻的一个引脚。
- en: Connect the other photoresistor pin to the LED's anode pin.
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将光敏电阻的另一引脚连接到LED的正极引脚。
- en: Connect the LED's cathode pin to the negative (`-`) battery terminal.
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LED的负极引脚连接到负极（`-`）电池端。
- en: Be careful when connecting the LED's pins. If it is connected in reverse, the
    LED will not turn on.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 在连接LED的引脚时要小心。如果反向连接，LED将不会点亮。
- en: Summary
  id: totrans-167
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we learned what sensors are and their applications in electronic
    projects. This is important because we will continue applying sensors in other
    chapters from this book. We also defined photoresistors, and how they are classified.
    We also learned how to connect a photoresistor sensor module to the Blue Pill
    and Curiosity Nano boards' input ports, and how to analyze and use analog data
    from a photoresistor.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了传感器及其在电子项目中的应用。这很重要，因为我们将在本书的其他章节继续应用传感器。我们还定义了光敏电阻，以及它们的分类。我们还学习了如何将光敏电阻传感器模块连接到Blue
    Pill和Curiosity Nano板的输入端口，以及如何分析和使用光敏电阻的模拟数据。
- en: In this chapter, you learned important pieces of information. We have defined
    what a sensor and a photosensor is. You can now read data from them using microcontroller
    boards. The chapter also described how to connect a photosensor module to a microcontroller
    board.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你学习了重要信息。我们定义了什么是传感器和光传感器。你现在可以使用微控制器板从它们中读取数据。本章还描述了如何将光传感器模块连接到微控制器板。
- en: '[*Chapter 5*](B16413_05_Final_NM_ePub.xhtml#_idTextAnchor069), *Humidity and
    Temperature Measurement*, will explain what a humidity and temperature sensor
    is and how can we acquire and use its analog data with both the Blue Pill and
    Curiosity Nano microcontroller boards. This can have a number of applications,
    such as measuring the temperature and humidity of a greenhouse.'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第五章*](B16413_05_Final_NM_ePub.xhtml#_idTextAnchor069), *湿度和温度测量*，将解释什么是湿度和温度传感器，以及我们如何使用Blue
    Pill和Curiosity Nano微控制器板获取和使用其模拟数据。这可以应用于多种场合，例如测量温室的温度和湿度。'
- en: Further reading
  id: totrans-171
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'Horowitz, P., Hill, W. (2015), *The art of electronics* [3rd ed.], Cambridge
    University Press: New York, NY.'
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Horowitz, P., Hill, W. (2015), *电子艺术* [第3版]，剑桥大学出版社：纽约，纽约。
- en: 'Microchip (2019), *PIC16F15376 Curiosity Nano Hardware User Guide*, Microchip
    Technology, Inc. Available from: [http://ww1.microchip.com/downloads/en/DeviceDoc/50002900B.pdf](http://ww1.microchip.com/downloads/en/DeviceDoc/50002900B.pdf)'
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Microchip (2019), *PIC16F15376 Curiosity Nano 硬件用户指南*, Microchip Technology,
    Inc. 可从：[http://ww1.microchip.com/downloads/en/DeviceDoc/50002900B.pdf](http://ww1.microchip.com/downloads/en/DeviceDoc/50002900B.pdf)
- en: 'Mims, F.M. (2000), *Getting started in electronics*, Lincolnwood, IL: Master
    Publishing, Inc.'
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Mims, F.M. (2000), *电子入门*, 林肯伍德，伊利诺伊州：Master Publishing, Inc.
